<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="report.xsl"?><!DOCTYPE xsl:stylesheet [<!ENTITY nbsp "&#160;">]><CoverageReport> <File name="lua\openrtm\BufferBase.lua" anchor="lua_openrtm_BufferBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file BufferBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief バッファの基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! バッファはBufferBaseテーブルをメタテーブルに設定して作成する</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.BufferBase"] = BufferBase</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="False" visited="False">	<span class="comment">-- バッファ初期化</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">-- @return バッファオブジェクト</span></Line>  <Line no="18" valid="False" visited="False">	<span class="identifier">BufferBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティ設定</span></Line>  <Line no="21" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ長設定</span></Line>  <Line no="25" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n バッファ長</span></Line>  <Line no="26" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス(nがnilの場合は長さ)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">length</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="29" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">0</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="31" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファポインタをリセット</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reset</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定位置まで書き込みポインタを進めた場合のバッファ取得</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 現在の位置のバッファ</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">wptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 書き込みポインタの位置を進める</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">advanceWptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value データ</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value データ</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nsec タイムアウト時間[ns]</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">nsec</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 書き込み可能なバッファ残り長さ</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 長さ</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">writable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">0</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファフルの判定</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：バッファフル</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">full</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定位置まで読み込みポインタを進めた場合のバッファ取得</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 現在の位置のバッファ</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 読み込みポインタの位置を進める</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常に位置設定、PRECONDITION_NOT_MET：位置が不正</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value value._dataにデータ格納</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス(valueがnilの場合はバッファの値を返す)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value value._dataにデータ格納</span></Line>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]、デフォルトは-1</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nsec タイムアウト時間[ns]、デフォルトは0</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常にデータ読み込み、BUFFER_EMPTY：バッファが空</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">nsec</span><span class="misc">)</span></Line>  <Line no="97" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 読み込み可能なデータ長さ取得</span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return データ長さ</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">readable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">0</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファが空かの判定</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：空</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">empty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="107" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="110" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="111" valid="False" visited="False"/>  <Line no="112" valid="True" visited="True">	<span class="identifier">BufferBase.NullBuffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="False" visited="False">	<span class="comment">-- 空のバッファ初期化</span></Line>  <Line no="115" valid="False" visited="False">	<span class="comment">-- @return バッファオブジェクト</span></Line>  <Line no="116" valid="True" visited="True">	<span class="identifier">BufferBase.NullBuffer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">size</span><span class="misc">)</span></Line>  <Line no="117" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">BufferBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="120" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">BufferBase</span></Line>  <FileSummary valid="55" visited="39" totalLines="124" coverage="70"/> </File> <File name="lua\openrtm\BufferStatus.lua" anchor="lua_openrtm_BufferStatus_lua">  <PerfectCoverage/>   <FileSummary valid="18" visited="18" totalLines="46" coverage="100"/> </File> <File name="lua\openrtm\CdrBufferBase.lua" anchor="lua_openrtm_CdrBufferBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CdrBufferBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief リングバッファ基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! バッファ生成ファクトリはCdrBufferFactoryに登録する</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferBase</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.CdrBufferBase"] = CdrBufferBase</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferBase"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False">	<span class="comment">-- リングバッファ初期化</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @return バッファオブジェクト</span></Line>  <Line no="21" valid="False" visited="False">	<span class="identifier">CdrBufferBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">BufferBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="25" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="True" visited="True">	<span class="identifier">CdrBufferBase.CdrBufferFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="29" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">CdrBufferBase.CdrBufferFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="30" valid="False" visited="False"/>  <Line no="31" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">CdrBufferBase.CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="33" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False"/>  <Line no="36" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CdrBufferBase</span></Line>  <FileSummary valid="14" visited="11" totalLines="36" coverage="78"/> </File> <File name="lua\openrtm\CdrRingBuffer.lua" anchor="lua_openrtm_CdrRingBuffer_lua">  <PerfectCoverage/>   <FileSummary valid="14" visited="14" totalLines="37" coverage="100"/> </File> <File name="lua\openrtm\ComponentActionListener.lua" anchor="lua_openrtm_ComponentActionListener_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ComponentActionListener.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コンポーネントコールバック定義クラス</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ComponentActionListener</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ComponentActionListener"] = ComponentActionListener</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="15" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_INITIALIZE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="16" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_FINALIZE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="17" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_STARTUP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_SHUTDOWN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span><span class="misc">,</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_ACTIVATED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span><span class="misc">,</span></Line>  <Line no="20" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_DEACTIVATED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">6</span><span class="misc">,</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_ABORTING</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">7</span><span class="misc">,</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_ERROR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">8</span><span class="misc">,</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_RESET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">9</span><span class="misc">,</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_EXECUTE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">10</span><span class="misc">,</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_STATE_UPDATE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">11</span><span class="misc">,</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_ON_RATE_CHANGED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">12</span><span class="misc">,</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PRE_COMPONENT_ACTION_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">13</span></Line>  <Line no="28" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"PRE_ON_INITIALIZE"</span><span class="misc">,</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_FINALIZE"</span><span class="misc">,</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_STARTUP"</span><span class="misc">,</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_SHUTDOWN"</span><span class="misc">,</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_ACTIVATED"</span><span class="misc">,</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_DEACTIVATED"</span><span class="misc">,</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_ABORTING"</span><span class="misc">,</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_ERROR"</span><span class="misc">,</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_RESET"</span><span class="misc">,</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_EXECUTE"</span><span class="misc">,</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_STATE_UPDATE"</span><span class="misc">,</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_ON_RATE_CHANGED"</span><span class="misc">,</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PRE_COMPONENT_ACTION_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="49" valid="False" visited="False"/>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ComponentActionListener.PreComponentActionListenerType.PRE_COMPONENT_ACTION_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="54" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False"/>  <Line no="56" valid="False" visited="False"/>  <Line no="57" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="67" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="False" visited="False"/>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_INITIALIZE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_FINALIZE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_STARTUP</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_SHUTDOWN</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span><span class="misc">,</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_ACTIVATED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span><span class="misc">,</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_DEACTIVATED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">6</span><span class="misc">,</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_ABORTING</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">7</span><span class="misc">,</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_ERROR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">8</span><span class="misc">,</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_RESET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">9</span><span class="misc">,</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_EXECUTE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">10</span><span class="misc">,</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_STATE_UPDATE</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">11</span><span class="misc">,</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_ON_RATE_CHANGED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">12</span><span class="misc">,</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">POST_COMPONENT_ACTION_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">13</span></Line>  <Line no="87" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="88" valid="False" visited="False"/>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False"/>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"POST_ON_INITIALIZE"</span><span class="misc">,</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_FINALIZE"</span><span class="misc">,</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_STARTUP"</span><span class="misc">,</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_SHUTDOWN"</span><span class="misc">,</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_ACTIVATED"</span><span class="misc">,</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_DEACTIVATED"</span><span class="misc">,</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_ABORTING"</span><span class="misc">,</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_ERROR"</span><span class="misc">,</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_RESET"</span><span class="misc">,</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_EXECUTE"</span><span class="misc">,</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_STATE_UPDATE"</span><span class="misc">,</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_ON_RATE_CHANGED"</span><span class="misc">,</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"POST_COMPONENT_ACTION_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="109" valid="False" visited="False"/>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ComponentActionListener.PostComponentActionListenerType.POST_COMPONENT_ACTION_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="114" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="123" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="127" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="False" visited="False"/>  <Line no="131" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ADD_PORT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">REMOVE_PORT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PORT_ACTION_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span></Line>  <Line no="135" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="136" valid="False" visited="False"/>  <Line no="137" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="138" valid="False" visited="False"/>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="False" visited="False"/>  <Line no="141" valid="False" visited="False"/>  <Line no="142" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ADD_PORT"</span><span class="misc">,</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"REMOVE_PORT"</span><span class="misc">,</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PORT_ACTION_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ComponentActionListener.PortActionListenerType.PORT_ACTION_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="151" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="False" visited="False"/>  <Line no="154" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="164" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="165" valid="False" visited="False"/>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="False" visited="False"/>  <Line no="168" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">EC_ATTACHED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">EC_DETACHED</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">EC_ACTION_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span></Line>  <Line no="172" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="False" visited="False"/>  <Line no="178" valid="False" visited="False"/>  <Line no="179" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"EC_ATTACHED"</span><span class="misc">,</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"EC_DETACHED"</span><span class="misc">,</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"EC_ACTION_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="183" valid="False" visited="False"/>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ComponentActionListener.ExecutionContextActionListenerType.EC_ACTION_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="188" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="189" valid="False" visited="False"/>  <Line no="190" valid="False" visited="False"/>  <Line no="191" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="201" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="202" valid="False" visited="False"/>  <Line no="203" valid="False" visited="False"/>  <Line no="204" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Entry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="205" valid="False" visited="False">	<span class="identifier">Entry.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.listener</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">autoclean</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="210" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="211" valid="False" visited="False"/>  <Line no="212" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="213" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PreComponentActionListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="229" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="231" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="234" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="235" valid="False" visited="False"/>  <Line no="236" valid="False" visited="False"/>  <Line no="237" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="238" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PostComponentActionListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="250" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="251" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="259" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="260" valid="False" visited="False"/>  <Line no="261" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="262" valid="True" visited="True">	<span class="identifier">ComponentActionListener.PortActionListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="269" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="273" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">pprofile</span><span class="misc">)</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">pprofile</span><span class="misc">)</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="283" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="False" visited="False"/>  <Line no="286" valid="False" visited="False"/>  <Line no="287" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="288" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ExecutionContextActionListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="300" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="309" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="310" valid="False" visited="False"/>  <Line no="311" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ComponentActionListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="312" valid="True" visited="True">	<span class="identifier">ComponentActionListener.ComponentActionListeners.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.preaction_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PreComponentActionListenerType.PRE_COMPONENT_ACTION_LISTENER_NUM</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.preaction_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.preaction_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.preaction_</span><span class="misc">,</span>&nbsp;<span class="identifier">ComponentActionListener.PreComponentActionListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="318" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="319" valid="False" visited="False"/>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.postaction_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PostComponentActionListenerType.POST_COMPONENT_ACTION_LISTENER_NUM</span></Line>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.postaction_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.postaction_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.postaction_</span><span class="misc">,</span>&nbsp;<span class="identifier">ComponentActionListener.PostComponentActionListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="324" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False"/>  <Line no="326" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portaction_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PortActionListenerType.PORT_ACTION_LISTENER_NUM</span></Line>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portaction_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.portaction_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.portaction_</span><span class="misc">,</span>&nbsp;<span class="identifier">ComponentActionListener.PortActionListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="330" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False"/>  <Line no="332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.ecaction_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.ExecutionContextActionListenerType.EC_ACTION_LISTENER_NUM</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.ecaction_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.ecaction_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.ecaction_</span><span class="misc">,</span>&nbsp;<span class="identifier">ComponentActionListener.ExecutionContextActionListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="337" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="339" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="340" valid="False" visited="False"/>  <Line no="341" valid="False" visited="False"/>  <Line no="342" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ComponentActionListener</span></Line>  <FileSummary valid="241" visited="229" totalLines="342" coverage="95"/> </File> <File name="lua\openrtm\ConfigAdmin.lua" anchor="lua_openrtm_ConfigAdmin_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ConfigAdmin.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コンフィギュレーション管理クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigAdmin</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ConfigAdmin"] = ConfigAdmin</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConfigurationListener"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationListeners</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationParamListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationParamListenerType</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationSetListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetListenerType</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationSetNameListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerType</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションパラメータ管理オブジェクト初期化</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- 変換関数には以下の関数を使用する</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- ret, value = trans(type, str)</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param name 名前</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @param var 変数</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param def_val デフォルト値</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- @param trans 変換関数</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーションパラメータ管理オブジェクト</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">Config.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">,</span>&nbsp;<span class="identifier">trans</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.default_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">def_val</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.string_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.callback</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">var</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">trans</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._trans</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">trans</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="42" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._trans</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.stringTo</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コールバック関数設定</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cbf コールバック関数</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setCallback</span><span class="misc">(</span><span class="identifier">cbf</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.callback</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cbf</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータ更新の通知</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param val 値</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notifyUpdate</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.callback</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータの更新</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key 値</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：更新成功・更新済み、false：更新失敗</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 変換関数がfalseを返した場合は更新失敗</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.string_value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.string_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">val</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._trans</span><span class="misc">(</span><span class="identifier">self._var._value</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._var._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">notifyUpdate</span><span class="misc">(</span><span class="identifier">self.name</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._trans</span><span class="misc">(</span><span class="identifier">self._var._value</span><span class="misc">,</span>&nbsp;<span class="identifier">self.default_value</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._var._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">notifyUpdate</span><span class="misc">(</span><span class="identifier">self.name</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="80" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False">	<span class="comment">-- コンフィギュレーション管理オブジェクト初期化</span></Line>  <Line no="83" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーション管理オブジェクト</span></Line>  <Line no="84" valid="False" visited="False">	<span class="identifier">ConfigAdmin.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">configsets</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configsets</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">configsets</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._activeId</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"default"</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._active</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._changed</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._params</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._emptyconf</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._newConfig</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListeners.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._changedParam</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 変数をコンフィギュレーションパラメータ設定に割り当てる</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param param_name パラメータ名</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param var 変数</span></Line>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param def_val デフォルト値 </span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param trans 変換関数(デフォルトはstringTo関数)</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：バインド成功、false：バインド失敗</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindParameter</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">,</span>&nbsp;<span class="identifier">trans</span><span class="misc">)</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">trans</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">trans</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.stringTo</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">param_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">def_val</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="108" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="110" valid="False" visited="False"/>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:isExist(param_name))</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isExist</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="113" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">trans</span><span class="misc">(</span><span class="identifier">var._value</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">)</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if type(value) == "table" then</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(#value)</span></Line>  <Line no="119" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">var._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="122" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Config.new</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">,</span>&nbsp;<span class="identifier">trans</span><span class="misc">)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">,</span>&nbsp;<span class="identifier">conf_</span><span class="misc">)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._params)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf_</span><span class="misc">:</span><span class="identifier">setCallback</span><span class="misc">(</span><span class="keyword">function</span><span class="misc">(</span><span class="identifier">config_param</span><span class="misc">,</span>&nbsp;<span class="identifier">config_value</span><span class="misc">)</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">onUpdateParam</span><span class="misc">(</span><span class="identifier">config_param</span><span class="misc">,</span>&nbsp;<span class="identifier">config_value</span><span class="misc">)</span>&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:getActiveId())</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getActiveId</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">param_name</span><span class="misc">)</span></Line>  <Line no="130" valid="False" visited="False"/>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="133" valid="False" visited="False"/>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータ削除</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param param_name パラメータ名</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbindParameter</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">)</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">find_idx</span><span class="misc">,</span>&nbsp;<span class="identifier">param</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">param.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">param_name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">find_idx</span></Line>  <Line no="144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_index</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="False" visited="False"/>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">,</span>&nbsp;<span class="identifier">ret_index</span><span class="misc">)</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="False" visited="False"/>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getLeaf</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">leaf</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="156" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">removeNode</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">)</span></Line>  <Line no="158" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="False" visited="False"/>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="False" visited="False"/>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットの存在確認</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：存在する、false：存在する</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">haveConfig</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットのアクティブ化</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- "_"から始まるIDは指定できない</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="177" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：アクティブ化成功、false：アクティブ化失敗</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="180" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="182" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'_'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="186" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._activeId</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config_id</span></Line>  <Line no="189" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="190" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="191" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onActivateSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="192" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットアクティブ化時のコールバック呼び出し</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivateSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_ACTIVATE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="199" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータ更新</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ID指定の場合は、指定IDのコンフィギュレーションセットの更新</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータ、ID指定の場合は、指定パラメータの更新</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータ、ID未指定の場合は、現在アクティブなコンフィギュレーションセット更新</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセットID</span></Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_param パラメータ名</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param</span><span class="misc">)</span></Line>  <Line no="206" valid="False" visited="False"/>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_set</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">config_param</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="209" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changedParam</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">param</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">param.name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(type(param.name))</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop:getProperty(param.name))</span></Line>  <Line no="217" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">param</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">param.name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onUpdate</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="False" visited="False"/>  <Line no="223" valid="False" visited="False"/>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_set</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">config_param</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changedParam</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config_set</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">key..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">config_param</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(conf.name, config_param)</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">conf.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">config_param</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="231" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._configsets:getProperty(key))</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="233" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="235" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="236" valid="False" visited="False"/>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_set</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">config_param</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changedParam</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._changed</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._active</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">self._activeId</span><span class="misc">)</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="244" valid="False" visited="False"/>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="246" valid="False" visited="False"/>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パラメータの存在確認</span></Line>  <Line no="248" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param param_name パラメータ名</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：存在する、false：存在しない</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isExist</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">)</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._params</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="254" valid="False" visited="False"/>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._params</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">conf.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">param_name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="258" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="259" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="260" valid="False" visited="False"/>  <Line no="261" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="263" valid="False" visited="False"/>  <Line no="264" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータに変更があったかの確認</span></Line>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：変更あり、false：変更なし</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isChanged</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="267" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._changed</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="269" valid="False" visited="False"/>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 変更のあったコンフィギュレーションパラメータを取得</span></Line>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 更新したコンフィギュレーションパラメータは</span></Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 変更のあったコンフィギュレーションパラメータ一覧</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">changedParameters</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._changedParam</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="False" visited="False"/>  <Line no="277" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブなコンフィギュレーションセットID取得</span></Line>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return アクティブなコンフィギュレーションセットID</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getActiveId</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._activeId</span></Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="282" valid="False" visited="False"/>  <Line no="283" valid="False" visited="False"/>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="False" visited="False"/>  <Line no="286" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション管理オブジェクトがアクティブかを確認</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return true：アクティブ、false：非アクティブ</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isActive</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._active</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="291" valid="False" visited="False"/>  <Line no="292" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット一覧取得</span></Line>  <Line no="293" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return コンフィギュレーションセット一覧</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getConfigurationSets</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getLeaf</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="297" valid="False" visited="False"/>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット取得</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="300" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーションセット</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="302" valid="False" visited="False"/>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="305" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._emptyconf</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="309" valid="False" visited="False"/>  <Line no="310" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットの設定</span></Line>  <Line no="311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定コンフィギュレーションセットがない場合に、新規にノードは生成しない</span></Line>  <Line no="312" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセット</span></Line>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConfigurationSetValues</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">node_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config_set</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">node_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">node_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="317" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="318" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="319" valid="False" visited="False"/>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">node_</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="323" valid="False" visited="False"/>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">node_</span><span class="misc">)</span></Line>  <Line no="325" valid="False" visited="False"/>  <Line no="326" valid="False" visited="False"/>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSetConfigurationSet</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="331" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="333" valid="False" visited="False"/>  <Line no="334" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブなコンフィギュレーションセット取得</span></Line>  <Line no="335" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return アクティブなコンフィギュレーションセット</span></Line>  <Line no="336" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getActiveConfigurationSet</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">self._activeId</span><span class="misc">)</span></Line>  <Line no="338" valid="False" visited="False"/>  <Line no="339" valid="False" visited="False"/>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">p</span></Line>  <Line no="341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="342" valid="False" visited="False"/>  <Line no="343" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット追加</span></Line>  <Line no="344" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定コンフィギュレーションセットがない場合に、新規にノードを生成する</span></Line>  <Line no="345" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param configset コンフィギュレーションセット</span></Line>  <Line no="346" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：追加成功、false：追加失敗</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConfigurationSet</span><span class="misc">(</span><span class="identifier">configset</span><span class="misc">)</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">configset</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="349" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="350" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">node</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">configset</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="352" valid="False" visited="False"/>  <Line no="353" valid="False" visited="False"/>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">createNode</span><span class="misc">(</span><span class="identifier">node</span><span class="misc">)</span></Line>  <Line no="355" valid="False" visited="False"/>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">node</span><span class="misc">)</span></Line>  <Line no="357" valid="False" visited="False"/>  <Line no="358" valid="False" visited="False"/>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">configset</span><span class="misc">)</span></Line>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._newConfig</span><span class="misc">,</span>&nbsp;<span class="identifier">node</span><span class="misc">)</span></Line>  <Line no="361" valid="False" visited="False"/>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAddConfigurationSet</span><span class="misc">(</span><span class="identifier">configset</span><span class="misc">)</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="367" valid="False" visited="False"/>  <Line no="368" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット削除</span></Line>  <Line no="369" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"default"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="373" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="375" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._activeId</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="376" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="377" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="378" valid="False" visited="False"/>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">find_flg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="380" valid="False" visited="False"/>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">idx</span><span class="misc">,</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._newConfig</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">idx</span></Line>  <Line no="385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="386" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="387" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="388" valid="False" visited="False"/>  <Line no="389" valid="False" visited="False"/>  <Line no="390" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_idx</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="391" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="392" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="393" valid="False" visited="False"/>  <Line no="394" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">getRoot</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">removeNode</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="397" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="398" valid="False" visited="False"/>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._newConfig</span><span class="misc">,</span>&nbsp;<span class="identifier">ret_idx</span><span class="misc">)</span></Line>  <Line no="400" valid="False" visited="False"/>  <Line no="401" valid="False" visited="False"/>  <Line no="402" valid="False" visited="False"/>  <Line no="403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onRemoveConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="406" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="407" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="408" valid="False" visited="False"/>  <Line no="409" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットのアクティブ化</span></Line>  <Line no="410" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="411" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：アクティブ化成功、false：アクティブ化失敗</span></Line>  <Line no="412" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="414" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="415" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="416" valid="False" visited="False"/>  <Line no="417" valid="False" visited="False"/>  <Line no="418" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'_'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="419" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="420" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="421" valid="False" visited="False"/>  <Line no="422" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="424" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._activeId</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config_id</span></Line>  <Line no="426" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="427" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._changed</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onActivateSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="431" valid="False" visited="False"/>  <Line no="432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション更新時コールバック設定</span></Line>  <Line no="433" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb コンフィギュレーションコールバック</span></Line>  <Line no="434" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnUpdate</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnUpdate function is obsolete."</span><span class="misc">)</span></Line>  <Line no="436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationSetNameListener instead."</span><span class="misc">)</span></Line>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_UPDATE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="438" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="439" valid="False" visited="False"/>  <Line no="440" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータ更新時コールバック設定</span></Line>  <Line no="441" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb コンフィギュレーションパラメータコールバック</span></Line>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnUpdateParam</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnUpdateParam function is obsolete."</span><span class="misc">)</span></Line>  <Line no="444" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationParamListener instead."</span><span class="misc">)</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configparam_</span><span class="misc">[</span><span class="identifier">ConfigurationParamListenerType.ON_UPDATE_CONFIG_PARAM</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="446" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="447" valid="False" visited="False"/>  <Line no="448" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット設定時コールバック設定</span></Line>  <Line no="449" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb コンフィギュレーションセット設定時コールバック</span></Line>  <Line no="450" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnSetConfigurationSet</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="451" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnSetConfigurationSet function is obsolete."</span><span class="misc">)</span></Line>  <Line no="452" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationSetListener instead."</span><span class="misc">)</span></Line>  <Line no="453" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">ConfigurationSetListenerType.ON_SET_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="455" valid="False" visited="False"/>  <Line no="456" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット追加時コールバック設定</span></Line>  <Line no="457" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb コンフィギュレーションセット追加時コールバック</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnAddConfigurationSet</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnAddConfigurationSet function is obsolete."</span><span class="misc">)</span></Line>  <Line no="460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationSetListener instead."</span><span class="misc">)</span></Line>  <Line no="461" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">ConfigurationSetListenerType.ON_ADD_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="463" valid="False" visited="False"/>  <Line no="464" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット削除時コールバック設定</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb コンフィギュレーションセット削除時コールバック</span></Line>  <Line no="466" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnRemoveConfigurationSet</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnRemoveConfigurationSet function is obsolete."</span><span class="misc">)</span></Line>  <Line no="468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationSetNameListener instead."</span><span class="misc">)</span></Line>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_REMOVE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="identifier">False</span><span class="misc">)</span></Line>  <Line no="470" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="471" valid="False" visited="False"/>  <Line no="472" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブなコンフィギュレーションセット設定時コールバック設定</span></Line>  <Line no="473" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cb アクティブなコンフィギュレーションセット設定時コールバック	</span></Line>  <Line no="474" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnActivateSet</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">)</span></Line>  <Line no="475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"setOnActivateSet function is obsolete."</span><span class="misc">)</span></Line>  <Line no="476" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Use addConfigurationSetNameListener instead."</span><span class="misc">)</span></Line>  <Line no="477" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_ACTIVATE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">cb</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="479" valid="False" visited="False"/>  <Line no="480" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータコールバック設定</span></Line>  <Line no="481" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="482" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションパラメータコールバック</span></Line>  <Line no="483" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConfigurationParamListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="485" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="486" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="487" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="488" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configparam_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="489" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="490" valid="False" visited="False"/>  <Line no="491" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータコールバック削除</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="493" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションパラメータコールバック</span></Line>  <Line no="494" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConfigurationParamListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="495" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configparam_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="496" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="497" valid="False" visited="False"/>  <Line no="498" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットコールバック設定</span></Line>  <Line no="499" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="500" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションセットコールバック</span></Line>  <Line no="501" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConfigurationSetListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="503" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="504" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="505" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="506" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="507" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="508" valid="False" visited="False"/>  <Line no="509" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットコールバック削除</span></Line>  <Line no="510" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="511" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションセットコールバック</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConfigurationSetListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="515" valid="False" visited="False"/>  <Line no="516" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット名のコールバック設定</span></Line>  <Line no="517" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="518" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションセット名のコールバック設定</span></Line>  <Line no="519" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConfigurationSetNameListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="521" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="522" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="523" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="524" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="526" valid="False" visited="False"/>  <Line no="527" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット名のコールバック削除</span></Line>  <Line no="528" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type コールバックの種別</span></Line>  <Line no="529" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listener コンフィギュレーションセット名のコールバック</span></Line>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConfigurationSetNameListener</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="531" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="532" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="533" valid="False" visited="False"/>  <Line no="534" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション更新時コールバック呼び出し</span></Line>  <Line no="535" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセット</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onUpdate</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_UPDATE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="538" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="539" valid="False" visited="False"/>  <Line no="540" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータ更新時コールバック呼び出し</span></Line>  <Line no="541" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_param パラメータ名</span></Line>  <Line no="542" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_value 値</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onUpdateParam</span><span class="misc">(</span><span class="identifier">config_param</span><span class="misc">,</span>&nbsp;<span class="identifier">config_value</span><span class="misc">)</span></Line>  <Line no="544" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._changedParam</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param</span><span class="misc">)</span></Line>  <Line no="545" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configparam_</span><span class="misc">[</span><span class="identifier">ConfigurationParamListenerType.ON_UPDATE_CONFIG_PARAM</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_param</span><span class="misc">,</span>&nbsp;<span class="identifier">config_value</span><span class="misc">)</span></Line>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="547" valid="False" visited="False"/>  <Line no="548" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション設定時コールバック呼び出し</span></Line>  <Line no="549" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセット</span></Line>  <Line no="550" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSetConfigurationSet</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="551" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">ConfigurationSetListenerType.ON_SET_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="553" valid="False" visited="False"/>  <Line no="554" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション追加時コールバック呼び出し</span></Line>  <Line no="555" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセット</span></Line>  <Line no="556" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAddConfigurationSet</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="557" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configset_</span><span class="misc">[</span><span class="identifier">ConfigurationSetListenerType.ON_ADD_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="559" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション削除時コールバック呼び出し</span></Line>  <Line no="560" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRemoveConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="562" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_REMOVE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="563" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="564" valid="False" visited="False"/>  <Line no="565" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションアクティブ化時コールバック呼び出し</span></Line>  <Line no="566" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットID</span></Line>  <Line no="567" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivateSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="568" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.configsetname_</span><span class="misc">[</span><span class="identifier">ConfigurationSetNameListenerType.ON_ACTIVATE_CONFIG_SET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="569" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="570" valid="False" visited="False"/>  <Line no="571" valid="False" visited="False"/>  <Line no="572" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="574" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="575" valid="False" visited="False"/>  <Line no="576" valid="False" visited="False"/>  <Line no="577" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ConfigAdmin</span></Line>  <FileSummary valid="302" visited="239" totalLines="577" coverage="79"/> </File> <File name="lua\openrtm\ConfigurationListener.lua" anchor="lua_openrtm_ConfigurationListener_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ConfigurationListener.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コンフィギュレーションコールバック定義クラス</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigurationListener</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ConfigurationListener"] = ConfigurationListener</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="14" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_UPDATE_CONFIG_PARAM</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="15" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CONFIG_PARAM_LISTENER_NUM</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span></Line>  <Line no="16" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="False" visited="False"/>  <Line no="24" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_UPDATE_CONFIG_PARAM"</span><span class="misc">,</span></Line>  <Line no="26" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"CONFIG_PARAM_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationParamListenerType.CONFIG_PARAM_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="29" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="31" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="32" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param_name</span><span class="misc">)</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="False" visited="False"/>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">config_set_name</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param_name</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param_name</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="47" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="48" valid="False" visited="False"/>  <Line no="49" valid="False" visited="False"/>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_SET_CONFIG_SET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_ADD_CONFIG_SET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CONFIG_SET_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span></Line>  <Line no="57" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False"/>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_SET_CONFIG_SET"</span><span class="misc">,</span></Line>  <Line no="67" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_ADD_CONFIG_SET"</span><span class="misc">,</span></Line>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"CONFIG_SET_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetListenerType.CONFIG_SET_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="71" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="74" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="False" visited="False"/>  <Line no="77" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="False" visited="False"/>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="89" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False"/>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_UPDATE_CONFIG_SET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_REMOVE_CONFIG_SET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_ACTIVATE_CONFIG_SET</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CONFIG_SET_NAME_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span></Line>  <Line no="100" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="101" valid="False" visited="False"/>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="False" visited="False"/>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="109" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_UPDATE_CONFIG_SET"</span><span class="misc">,</span></Line>  <Line no="110" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_REMOVE_CONFIG_SET"</span><span class="misc">,</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_ACTIVATE_CONFIG_SET"</span><span class="misc">,</span></Line>  <Line no="112" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"CONFIG_SET_NAME_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerType.CONFIG_SET_NAME_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="115" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="118" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="119" valid="False" visited="False"/>  <Line no="120" valid="False" visited="False"/>  <Line no="121" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">)</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="126" valid="False" visited="False"/>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">config_set_name</span><span class="misc">)</span></Line>  <Line no="129" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="133" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="False" visited="False"/>  <Line no="137" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Entry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="138" valid="False" visited="False">	<span class="identifier">Entry.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.listener</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">autoclean</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="143" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="148" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationParamListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="156" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="158" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param_name</span><span class="misc">)</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="165" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">,</span>&nbsp;<span class="identifier">config_param_name</span><span class="misc">)</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="170" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="171" valid="False" visited="False"/>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="175" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="182" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="198" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="199" valid="False" visited="False"/>  <Line no="200" valid="False" visited="False"/>  <Line no="201" valid="False" visited="False"/>  <Line no="202" valid="False" visited="False"/>  <Line no="203" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="204" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="211" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="212" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="213" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="214" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="217" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">config_set_name</span><span class="misc">)</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="227" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="228" valid="False" visited="False"/>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="231" valid="True" visited="True">	<span class="identifier">ConfigurationListener.ConfigurationListeners.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configparam_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationParamListenerType.CONFIG_PARAM_LISTENER_NUM</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configparam_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.configparam_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.configparam_</span><span class="misc">,</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationParamListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="237" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configset_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetListenerType.CONFIG_SET_LISTENER_NUM</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configset_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.configset_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.configset_</span><span class="misc">,</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configsetname_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerType.CONFIG_SET_NAME_LISTENER_NUM</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.configsetname_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.configsetname_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.configsetname_</span><span class="misc">,</span>&nbsp;<span class="identifier">ConfigurationListener.ConfigurationSetNameListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="249" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="250" valid="False" visited="False"/>  <Line no="251" valid="False" visited="False"/>  <Line no="252" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ConfigurationListener</span></Line>  <FileSummary valid="154" visited="116" totalLines="252" coverage="75"/> </File> <File name="lua\openrtm\ConnectorBase.lua" anchor="lua_openrtm_ConnectorBase_lua">  <PerfectCoverage/>   <FileSummary valid="28" visited="28" totalLines="65" coverage="100"/> </File> <File name="lua\openrtm\ConnectorListener.lua" anchor="lua_openrtm_ConnectorListener_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ConnectorListener.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コネクタコールバック定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.ConnectorListener"]&nbsp;=&nbsp;ConnectorListener</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="14" valid="True" visited="True">	<span class="blockcomment">ConnectorListener.ConnectorListenerStatus&nbsp;=&nbsp;{</span></Line>  <Line no="15" valid="True" visited="True">	<span class="blockcomment">&nbsp;NO_CHANGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1,</span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">&nbsp;INFO_CHANGED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2,</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">&nbsp;DATA_CHANGED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3,</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">&nbsp;BOTH_CHANGED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">}</span></Line>  <Line no="20" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="21" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">ConnectorListener.ConnectorDataListenerType&nbsp;=&nbsp;{</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_BUFFER_WRITE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1,</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_BUFFER_FULL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2,</span></Line>  <Line no="25" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_BUFFER_WRITE_TIMEOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3,</span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_BUFFER_OVERWRITE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4,</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_BUFFER_READ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5,</span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_SEND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6,</span></Line>  <Line no="29" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_RECEIVED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7,</span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_RECEIVER_FULL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8,</span></Line>  <Line no="31" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_RECEIVER_TIMEOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9,</span></Line>  <Line no="32" valid="True" visited="True">	<span class="blockcomment">&nbsp;ON_RECEIVER_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10,</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">&nbsp;CONNECTOR_DATA_LISTENER_NUM&nbsp;&nbsp;=&nbsp;11</span></Line>  <Line no="34" valid="True" visited="True">	<span class="blockcomment">}</span></Line>  <Line no="35" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="37" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">ConnectorListener.ConnectorDataListener&nbsp;=&nbsp;{}</span></Line>  <Line no="39" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="40" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="41" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="42" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="43" valid="True" visited="True">	<span class="blockcomment">ConnectorListener.ConnectorDataListener.toString&nbsp;=&nbsp;function(_type)</span></Line>  <Line no="44" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;typeString&nbsp;=&nbsp;{"ON_BUFFER_WRITE",</span></Line>  <Line no="45" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_BUFFER_FULL",</span></Line>  <Line no="46" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_BUFFER_WRITE_TIMEOUT",</span></Line>  <Line no="47" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_BUFFER_OVERWRITE",</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_BUFFER_READ",&nbsp;</span></Line>  <Line no="49" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_SEND",&nbsp;</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_RECEIVED",</span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_RECEIVER_FULL",&nbsp;</span></Line>  <Line no="52" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_RECEIVER_TIMEOUT",&nbsp;</span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ON_RECEIVER_ERROR",</span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"CONNECTOR_DATA_LISTENER_NUM"}</span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="56" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;_type&nbsp;&lt;&nbsp;ConnectorListener.ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM&nbsp;then</span></Line>  <Line no="57" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;typeString[_type]</span></Line>  <Line no="58" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="59" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;""</span></Line>  <Line no="60" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="61" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="63" valid="True" visited="True">	<span class="blockcomment">ConnectorListener.ConnectorDataListener.new&nbsp;=&nbsp;function()</span></Line>  <Line no="64" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="65" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:call(info,&nbsp;data)</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;</span></Line>  <Line no="67" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:__call__(info,&nbsp;cdrdata,&nbsp;dataType)</span></Line>  <Line no="70" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="71" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;_data&nbsp;=&nbsp;Manager:instance():cdrUnmarshal(cdrdata,&nbsp;dataType)</span></Line>  <Line no="72" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;_data</span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="74" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="75" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;info,&nbsp;data)</span></Line>  <Line no="76" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self:call(info,&nbsp;data)</span></Line>  <Line no="77" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="78" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="81" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="82" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="83" valid="False" visited="False">	<span class="blockcomment">ConnectorListener.ConnectorDataListenerT&nbsp;=&nbsp;{}</span></Line>  <Line no="84" valid="False" visited="False">	<span class="blockcomment">ConnectorListener.ConnectorDataListenerT.new&nbsp;=&nbsp;function()</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="86" valid="False" visited="False">	<span class="blockcomment">&nbsp;function&nbsp;obj:__call__(info,&nbsp;cdrdata,&nbsp;dataType)</span></Line>  <Line no="87" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="88" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;_data&nbsp;=&nbsp;Manager:instance():cdrUnmarshal(cdrdata,&nbsp;dataType)</span></Line>  <Line no="89" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;_data&nbsp;</span></Line>  <Line no="90" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;info,&nbsp;cdrdata,&nbsp;data)</span></Line>  <Line no="92" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self:call(info,&nbsp;cdrdata,&nbsp;data)</span></Line>  <Line no="93" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="94" valid="False" visited="False">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="95" valid="False" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="96" valid="False" visited="False">	<span class="blockcomment">end</span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="98" valid="False" visited="False"/>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="False" visited="False"/>  <Line no="101" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_BUFFER_EMPTY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_BUFFER_READ_TIMEOUT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_SENDER_EMPTY</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_SENDER_TIMEOUT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span><span class="misc">,</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_SENDER_ERROR</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span><span class="misc">,</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_CONNECT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">6</span><span class="misc">,</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_DISCONNECT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">7</span><span class="misc">,</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">8</span></Line>  <Line no="110" valid="True" visited="True">	<span class="misc">}</span></Line>  <Line no="111" valid="False" visited="False"/>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_BUFFER_EMPTY"</span><span class="misc">,</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_BUFFER_READ_TIMEOUT"</span><span class="misc">,</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_SENDER_EMPTY"</span><span class="misc">,</span>&nbsp;</Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_SENDER_TIMEOUT"</span><span class="misc">,</span>&nbsp;</Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_SENDER_ERROR"</span><span class="misc">,</span>&nbsp;</Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_CONNECT"</span><span class="misc">,</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_DISCONNECT"</span><span class="misc">,</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"CONNECTOR_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType.CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="133" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="142" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="146" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="147" valid="False" visited="False"/>  <Line no="148" valid="False" visited="False"/>  <Line no="149" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Entry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="150" valid="False" visited="False">	<span class="identifier">Entry.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.listener</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">autoclean</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="155" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="156" valid="False" visited="False"/>  <Line no="157" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorDataListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="158" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorDataListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="168" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="169" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">cdrdata</span><span class="misc">)</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(cdrdata)</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerStatus.NO_CHANGE</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">cdrdata</span><span class="misc">)</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="182" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False"/>  <Line no="184" valid="False" visited="False"/>  <Line no="185" valid="False" visited="False"/>  <Line no="186" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="187" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="197" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="199" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerStatus.NO_CHANGE</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="210" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="211" valid="False" visited="False"/>  <Line no="212" valid="False" visited="False"/>  <Line no="213" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="214" valid="False" visited="False"/>  <Line no="215" valid="True" visited="True">	<span class="identifier">ConnectorListener.ConnectorListeners.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.connector_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.connectorData_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.connector_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.connectorData_</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.connector_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType.CONNECTOR_LISTENER_NUM</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.connector_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.connector_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.connector_</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="228" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="False" visited="False"/>  <Line no="231" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ConnectorListener</span></Line>  <FileSummary valid="148" visited="137" totalLines="231" coverage="92"/> </File> <File name="lua\openrtm\CorbaConsumer.lua" anchor="lua_openrtm_CorbaConsumer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CorbaConsumer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CORBAコンシューマ定義クラス</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaConsumer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.CorbaConsumer"] = CorbaConsumer</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="identifier">CorbaConsumer.CorbaConsumerBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False">	<span class="comment">-- CORBAコンシューマオブジェクト初期化関数</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @param consumer CORBAコンシューマオブジェクト</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @return CORBAコンシューマオブジェクト</span></Line>  <Line no="23" valid="True" visited="True">	<span class="identifier">CorbaConsumer.CorbaConsumerBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="27" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer._objref</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _obj オブジェクトリファレンス</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _obj オブジェクトリファレンス</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._objref)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスをnullに設定する</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスをnullに設定する</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="67" valid="False" visited="False"/>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="69" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="70" valid="False" visited="False"/>  <Line no="71" valid="False" visited="False">	<span class="comment">-- CORBAコンシューマオブジェクト初期化関数</span></Line>  <Line no="72" valid="False" visited="False">	<span class="comment">-- @param interfaceType インターフェース型</span></Line>  <Line no="73" valid="False" visited="False">	<span class="comment">-- @param consumer CORBAコンシューマオブジェクト</span></Line>  <Line no="74" valid="False" visited="False">	<span class="comment">-- @return CORBAコンシューマオブジェクト</span></Line>  <Line no="75" valid="False" visited="False">	<span class="identifier">CorbaConsumer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">interfaceType</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._interfaceType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">interfaceType</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">CorbaConsumer.CorbaConsumerBase.new</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer._var</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _obj オブジェクトリファレンス</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="89" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 同一プロセスの場合はサーバント取得</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param get_ref trueの場合にはサーバント取得可能でもオブジェクトリファレンスを取得</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス、もしくはサーバント</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="identifier">get_ref</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">get_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">get_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._var</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンスを設定</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 設定したインターフェース型に変換する</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ior IOR文字列</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setIOR</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ior)</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._interfaceType)</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">,</span><span class="identifier">self._interfaceType</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_setObject</span><span class="misc">(</span><span class="identifier">obj_</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="125" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスにnullを設定する</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_releaseObject</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sev</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="140" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False"/>  <Line no="142" valid="False" visited="False"/>  <Line no="143" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CorbaConsumer</span></Line>  <FileSummary valid="70" visited="59" totalLines="143" coverage="84"/> </File> <File name="lua\openrtm\CorbaNaming.lua" anchor="lua_openrtm_CorbaNaming_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CorbaNaming.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ネームサーバーヘルパクラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaNaming</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.CorbaNaming"] = CorbaNaming</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- ネームサーバーヘルパオブジェクト初期化</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @param orb ORBオブジェクト</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @param name_server ネームサーバーのアドレス(例：localhost:2809)</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @return ネームサーバヘルパオブジェクト</span></Line>  <Line no="22" valid="False" visited="False">	<span class="identifier">CorbaNaming.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._nameServer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rootContext</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._blLength</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">100</span></Line>  <Line no="28" valid="False" visited="False"/>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">name_server</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._nameServer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"corbaloc:iiop:"</span><span class="operator">..</span><span class="identifier">name_server..</span><span class="string">"/NameService"</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj._nameServer)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rootContext</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">obj._orb</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._nameServer</span><span class="misc">,</span><span class="string">"IDL:omg.org/CosNaming/NamingContext:1.0"</span><span class="misc">)</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._rootContext)</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if self._rootContext == nil then</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print("CorbaNaming: Failed to narrow the root naming context.")</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="41" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバーにオブジェクトを登録</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 登録パスは以下のように設定する</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- test1.host_cxt/test2.rtc</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param string_name 登録パス(文字列)</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクトリファレンス</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param force trueの場合には同じパスに登録済みの場合でも強制的に上書きする</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rebindByString</span><span class="misc">(</span><span class="identifier">string_name</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">force</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">force</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="52" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">force</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:toName(string_name))</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">rebind</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">toName</span><span class="misc">(</span><span class="identifier">string_name</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">force</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバーにオブジェクトを登録</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Nameリストは以下のように指定</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="id1",kind="kind1"},...}</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name_list 登録パス(Nameリスト)</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクトリファレンス</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param force trueの場合には同じパスに登録済みの場合でも強制的に上書きする</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rebind</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">force</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">force</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="65" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">force</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--error("")</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rootContext</span><span class="misc">:</span><span class="identifier">rebind</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">force</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test1")</span></Line>  <Line no="76" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">rebindRecursive</span><span class="misc">(</span><span class="identifier">self._rootContext</span><span class="misc">,</span>&nbsp;<span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test2")</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバーにオブジェクトを登録する</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定パスのコンテキストがない場合は生成する</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Nameリストは以下のように指定</span></Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="id1",kind="kind1"},...}</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param context ルートコンテキスト</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name_list 登録パス(Nameリスト)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rebindRecursive</span><span class="misc">(</span><span class="identifier">context</span><span class="misc">,</span>&nbsp;<span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">name_list</span></Line>  <Line no="92" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span><span class="number">1</span><span class="misc">,</span><span class="identifier">length</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="93" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test1")</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">context</span><span class="misc">:</span><span class="identifier">rebind</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">subName</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test2")</span></Line>  <Line no="97" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="99" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">objIsNamingContext</span><span class="misc">(</span><span class="identifier">context</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">context</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">context</span><span class="misc">:</span><span class="identifier">bind_new_context</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">subName</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="103" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="106" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">context</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">context</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">subName</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="107" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="109" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">"CosNaming.NamingContext.CannotProceed"</span><span class="misc">)</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトがコンテキストかを判定</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：オブジェクトはコンテキスト、false：それ以外</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">objIsNamingContext</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="120" valid="False" visited="False"/>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列をNameリストに変換</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列で以下のように設定する</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- test1.host_cxt/test2.rtc</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param 設定パス(文字列)</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 設定パス(Nameリスト)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 戻り値は以下のようになる</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="test1",kind="host_cxt"},{id="test2",kind="rtc"}}</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">toName</span><span class="misc">(</span><span class="identifier">sname</span><span class="misc">)</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sname</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="130" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">"CosNaming.NamingContext.InvalidName"</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">string_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sname</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(string_name)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">string_name</span><span class="misc">,</span><span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">name_comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span><span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span></Line>  <Line no="142" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">kind</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="operator">=</span><span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">s</span><span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n..s</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="operator">#</span><span class="identifier">s</span><span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n..</span><span class="string">"."</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">kind</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">s</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">s</span><span class="misc">]</span></Line>  <Line no="153" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">name_list</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Nameリストから、指定したインデックス間の要素を抽出する</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Nameリストは以下のように指定</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="id1",kind="kind1"},...}</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param Nameリスト</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param begin 開始インデックス</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _end 終了インデックス</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 抽出したリスト</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subName</span><span class="misc">(</span><span class="identifier">name_list</span><span class="misc">,</span>&nbsp;<span class="identifier">begin</span><span class="misc">,</span>&nbsp;<span class="identifier">_end</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_end</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">_end</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="166" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_end</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">name_list</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sub_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span><span class="identifier">begin</span><span class="misc">,</span><span class="identifier">_end</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">sub_name</span><span class="misc">,</span>&nbsp;<span class="identifier">name_list</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">sub_name</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバーから指定パスのオブジェクトを削除</span></Line>  <Line no="177" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Nameリストは以下のように指定</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="id1",kind="kind1"},...}</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 削除パス(Nameオブジェクト)</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbind</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">toName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="185" valid="False" visited="False"/>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rootContext</span><span class="misc">:</span><span class="identifier">unbind</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="191" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="194" valid="False" visited="False"/>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 名前からオブジェクトを取得</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 名前リスト</span></Line>  <Line no="197" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- {{id="id1",kind="kind1"},...}</span></Line>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクト</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="202" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">toName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="208" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._rootContext</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="211" valid="False" visited="False"/>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="218" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="False" visited="False"/>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 名前からオブジェクトを取得</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param string_name 名前</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- test1.host_cxt/test2.rtc</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクト</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">resolveStr</span><span class="misc">(</span><span class="identifier">string_name</span><span class="misc">)</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">toName</span><span class="misc">(</span><span class="identifier">string_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="228" valid="False" visited="False"/>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ルートコンテキスト取得</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ルートコンテキスト</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getRootContext</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._rootContext</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False"/>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="236" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="237" valid="False" visited="False"/>  <Line no="238" valid="False" visited="False"/>  <Line no="239" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CorbaNaming</span></Line>  <FileSummary valid="117" visited="82" totalLines="239" coverage="70"/> </File> <File name="lua\openrtm\CorbaPort.lua" anchor="lua_openrtm_CorbaPort_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CorbaPort.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CORBAポートクラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaPort</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.CorbaPort"] = CorbaPort</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.PortBase"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaProviderHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- プロバイダ保持オブジェクト初期化関数</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param type_name 型名</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @param servant サーバント</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- @return プロバイダ保持オブジェクト</span></Line>  <Line no="27" valid="False" visited="False">	<span class="identifier">CorbaProviderHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">servant</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インスタンス名取得</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return インスタンス名</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">instanceName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._instanceName</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="False" visited="False"/>  <Line no="36" valid="False" visited="False"/>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 種別名取得</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 種別名</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">itypeName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._typeName</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列取得</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return IOR文字列</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">ior</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ior</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="49" valid="False" visited="False"/>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 記述子取得</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 記述子</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._typeName..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">self._instanceName</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="56" valid="False" visited="False"/>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースのアクティブ化</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのアクティブ化時にインターフェースのアクティブ化を行い使用可能にする</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースの非アクティブ化</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの非アクティブ化時にインターフェースの非アクティブ化を行い使用不可にする</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="False" visited="False"/>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._typeName</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">type_name</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._instanceName</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">instance_name</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._servant</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">servant</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--obj.._oid = _mgr:getPOA():tostring(obj.._servant)</span></Line>  <Line no="74" valid="False" visited="False"/>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">obj._servant</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--obj:deactivate()</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="78" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaConsumerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="False" visited="False">	<span class="comment">-- コンシューマ保持オブジェクト初期化</span></Line>  <Line no="84" valid="False" visited="False">	<span class="comment">-- @param type_name 種別名</span></Line>  <Line no="85" valid="False" visited="False">	<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="86" valid="False" visited="False">	<span class="comment">-- @param consumer コンシューマオブジェクト</span></Line>  <Line no="87" valid="False" visited="False">	<span class="comment">-- @param owner 親オブジェクト</span></Line>  <Line no="88" valid="False" visited="False">	<span class="comment">-- @return コンシューマ保持オブジェクト</span></Line>  <Line no="89" valid="False" visited="False">	<span class="identifier">CorbaConsumerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">owner</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インスタンス名取得</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return インスタンス名</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">instanceName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._instanceName</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 型名取得</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 型名</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">typeName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._typeName</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 記述子取得</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 記述子(型名.インスタンス名)</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._typeName..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">self._instanceName</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンス設定</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ior IOR文字列</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ior</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._consumer</span><span class="misc">:</span><span class="identifier">setIOR</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">)</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスをnullに設定する</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumer</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列取得</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getIor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ior</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._typeName</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">type_name</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._instanceName</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">instance_name</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._owner</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">owner</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="137" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="138" valid="False" visited="False"/>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="False" visited="False">	<span class="comment">-- CORBAポート初期化関数</span></Line>  <Line no="141" valid="False" visited="False">	<span class="comment">-- @param name ポート名</span></Line>  <Line no="142" valid="False" visited="False">	<span class="comment">-- @return CORBAポート</span></Line>  <Line no="143" valid="False" visited="False">	<span class="identifier">CorbaPort.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">PortBase.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._PortInterfacePolarity</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::PortInterfacePolarity"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="149" valid="False" visited="False"/>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- CORBAポートのプロパティ設定</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"init()"</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="False" visited="False"/>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="157" valid="False" visited="False"/>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"connection_limit"</span><span class="misc">,</span><span class="string">"-1"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"invalid connection_limit value: "</span><span class="operator">..</span></Line>  <Line no="161" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"connection_limit"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="False" visited="False"/>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setConnectionLimit</span><span class="misc">(</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロバイダ登録</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="169" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param type_name 型名</span></Line>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param provider プロバイダオブジェクト</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param idl_file idlファイルパス(例："../idl/MyService.idl")</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param interface_type インターフェース型(例："IDL:SimpleService/MyService:1.0")</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerProvider</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">,</span>&nbsp;<span class="identifier">idl_file</span><span class="misc">,</span>&nbsp;<span class="identifier">interface_type</span><span class="misc">)</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"registerProvider(instance="</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">", type_name="</span><span class="operator">..</span><span class="identifier">type_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">interface_type</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">idl_file</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">idl_file</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="identifier">interface_type</span><span class="misc">)</span></Line>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">,</span>&nbsp;<span class="identifier">CorbaProviderHolder.new</span><span class="misc">(</span><span class="identifier">type_name</span><span class="misc">,</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">instance_name</span><span class="misc">,</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="188" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"appending provider interface failed"</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="192" valid="False" visited="False"/>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">appendInterface</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">self._PortInterfacePolarity.PROVIDED</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="195" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="200" valid="False" visited="False"/>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマ登録</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param type_name 型名</span></Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param idl_file IDLファイルパス(例："../idl/MyService.idl")</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerConsumer</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">idl_file</span><span class="misc">)</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"registerConsumer()"</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">idl_file</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">idl_file</span><span class="misc">)</span></Line>  <Line no="211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">appendInterface</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">self._PortInterfacePolarity.REQUIRED</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="213" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="214" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="215" valid="False" visited="False"/>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">,</span><span class="identifier">CorbaConsumerHolder.new</span><span class="misc">(</span><span class="identifier">type_name</span><span class="misc">,</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">instance_name</span><span class="misc">,</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">,</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="False" visited="False"/>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースのアクティブ化</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCアクティブ化時にインターフェースのアクティブ化を行い使用可能にする</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="231" valid="False" visited="False"/>  <Line no="232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースの非アクティブ化</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC非アクティブ化時にインターフェースの非アクティブ化を行い使用不可にする</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"deactivateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="240" valid="False" visited="False"/>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルにオブジェクトを設定する</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下の要素名にIOR文字列を登録</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC名.port.ポート名.型名.インスタンス名</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- port.型名.インスタンス名</span></Line>  <Line no="245" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：登録成功、RTC_ERROR：コネクタ数上限により登録失敗</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterfaces()"</span><span class="misc">)</span></Line>  <Line no="250" valid="False" visited="False"/>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">returnvalue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_publishInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="252" valid="False" visited="False"/>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">returnvalue</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="254" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">returnvalue</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="256" valid="False" visited="False"/>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="258" valid="False" visited="False"/>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">newdesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">self._profile.name</span><span class="misc">,</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">self._ownerInstanceName</span><span class="misc">)</span><span class="operator">..</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">".port"</span><span class="operator">..</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">self._profile.name</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">self._ownerInstanceName</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">newdesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">newdesc..</span><span class="string">".provided."</span><span class="operator">..</span><span class="identifier">provider</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="263" valid="False" visited="False"/>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.newNV</span><span class="misc">(</span><span class="identifier">newdesc</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">ior</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="265" valid="False" visited="False"/>  <Line no="266" valid="False" visited="False"/>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">olddesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"port."</span><span class="operator">..</span><span class="identifier">provider</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.newNV</span><span class="misc">(</span><span class="identifier">olddesc</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">ior</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="269" valid="False" visited="False"/>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="271" valid="False" visited="False"/>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.push_back_list</span><span class="misc">(</span><span class="identifier">connector_profile.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="273" valid="False" visited="False"/>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="False" visited="False"/>  <Line no="277" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルからオブジェクトリファレンスを設定する</span></Line>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下の要素名からIOR文字列を取り出してオブジェクトリファレンスを取得</span></Line>  <Line no="279" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC名.port.ポート名</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- port.型名.インスタンス名</span></Line>  <Line no="281" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="283" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：設定成功、RTC_ERROR：設定失敗、オブジェクトリファレンスが取得できない</span></Line>  <Line no="284" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「port.connection.strictness」の要素が「strict」に設定されている場合は、</span></Line>  <Line no="285" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスを取得できなかった場合にRTC_ERRORになる</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeInterfaces()"</span><span class="misc">)</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nv</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.properties</span></Line>  <Line no="289" valid="False" visited="False"/>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">strict</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="string">"port.connection.strictness"</span><span class="misc">)</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="293" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">strictness</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="294" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="string">"best_effort"</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">strictness</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="295" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">strict</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="296" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="string">"strict"</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">strictness</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">strict</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False"/>  <Line no="300" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Connetion strictness is: "</span><span class="operator">..</span><span class="identifier">strictness</span><span class="misc">)</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="302" valid="False" visited="False"/>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="305" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(nv, consumer)</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:findProvider(nv, consumer, ior))</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findProvider</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="operator">#</span><span class="identifier">ior</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="308" valid="False" visited="False"/>  <Line no="309" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="310" valid="False" visited="False"/>  <Line no="311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:findProviderOld(nv, consumer, ior), #ior)</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findProviderOld</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="operator">#</span><span class="identifier">ior</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="315" valid="False" visited="False"/>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="317" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="318" valid="False" visited="False"/>  <Line no="319" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">strict</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="320" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"subscribeInterfaces() failed."</span><span class="misc">)</span></Line>  <Line no="321" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="323" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="324" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="326" valid="False" visited="False"/>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeInterfaces() successfully finished."</span><span class="misc">)</span></Line>  <Line no="328" valid="False" visited="False"/>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False"/>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルのオブジェクトリファレンスの設定を解除</span></Line>  <Line no="333" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下の要素名からIOR文字列を取り出してオブジェクトリファレンスを取得</span></Line>  <Line no="334" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC名.port.ポート名</span></Line>  <Line no="335" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- port.型名.インスタンス名</span></Line>  <Line no="336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeInterfaces()"</span><span class="misc">)</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nv</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.properties</span></Line>  <Line no="340" valid="False" visited="False"/>  <Line no="341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findProvider</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="operator">#</span><span class="identifier">ior</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="344" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Correspoinding consumer found."</span><span class="misc">)</span></Line>  <Line no="345" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="346" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findProviderOld</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="operator">#</span><span class="identifier">ior</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Correspoinding consumer found."</span><span class="misc">)</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="352" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="353" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="354" valid="False" visited="False"/>  <Line no="355" valid="False" visited="False"/>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="357" valid="False" visited="False"/>  <Line no="358" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルのプロパティからIOR文字列を取得</span></Line>  <Line no="359" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からオブジェクトリファレンスを保持している要素名を取得する</span></Line>  <Line no="360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC名.port.ポート名.required.型名.インスタンス名</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nv コネクタプロファイルのプロパティ</span></Line>  <Line no="362" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cons コンシューマ保持オブジェクト</span></Line>  <Line no="363" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param iorstr IOR文字列リスト</span></Line>  <Line no="364" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：取得成功、false：取得失敗</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findProvider</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">cons</span><span class="misc">,</span>&nbsp;<span class="identifier">iorstr</span><span class="misc">)</span></Line>  <Line no="366" valid="False" visited="False"/>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">newdesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">self._profile.name</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">self._ownerInstanceName</span><span class="misc">)</span><span class="operator">..</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">".port"</span><span class="operator">..</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">self._profile.name</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">self._ownerInstanceName</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">newdesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">newdesc..</span><span class="string">".required."</span><span class="operator">..</span><span class="identifier">cons</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="370" valid="False" visited="False"/>  <Line no="371" valid="False" visited="False"/>  <Line no="372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cons_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">newdesc</span><span class="misc">)</span></Line>  <Line no="373" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(newdesc)</span></Line>  <Line no="374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#nv)</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i,v in ipairs(nv) do</span></Line>  <Line no="376" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(v.name, v.value)</span></Line>  <Line no="377" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">cons_index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="380" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="381" valid="False" visited="False"/>  <Line no="382" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">[</span><span class="identifier">cons_index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="383" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="384" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Cannot extract Provider interface descriptor"</span><span class="misc">)</span></Line>  <Line no="385" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="386" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="387" valid="False" visited="False"/>  <Line no="388" valid="False" visited="False"/>  <Line no="389" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prov_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="390" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prov_index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="391" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="392" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="393" valid="False" visited="False"/>  <Line no="394" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">[</span><span class="identifier">prov_index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="396" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Cannot extract Provider IOR string"</span><span class="misc">)</span></Line>  <Line no="397" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="398" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="399" valid="False" visited="False"/>  <Line no="400" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">iorstr</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"table"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="401" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">iorstr</span><span class="misc">,</span>&nbsp;<span class="identifier">ior_</span><span class="misc">)</span></Line>  <Line no="402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="403" valid="False" visited="False"/>  <Line no="404" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"interface matched with new descriptor: "</span><span class="operator">..</span><span class="identifier">newdesc</span><span class="misc">)</span></Line>  <Line no="405" valid="False" visited="False"/>  <Line no="406" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="407" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="408" valid="False" visited="False"/>  <Line no="409" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルのプロパティからIOR文字列を取得</span></Line>  <Line no="410" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下の要素名からオブジェクトリファレンスを取得する</span></Line>  <Line no="411" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- port.型名.インスタンス名</span></Line>  <Line no="412" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nv コネクタプロファイルのプロパティ</span></Line>  <Line no="413" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cons コンシューマ保持オブジェクト</span></Line>  <Line no="414" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param iorstr IOR文字列リスト</span></Line>  <Line no="415" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：取得成功、false：取得失敗</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findProviderOld</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">cons</span><span class="misc">,</span>&nbsp;<span class="identifier">iorstr</span><span class="misc">)</span></Line>  <Line no="417" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">olddesc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"port."</span><span class="operator">..</span><span class="identifier">cons</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="418" valid="False" visited="False"/>  <Line no="419" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(olddesc)</span></Line>  <Line no="420" valid="False" visited="False"/>  <Line no="421" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i,v in ipairs(nv) do</span></Line>  <Line no="422" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(v.name, v.value)</span></Line>  <Line no="423" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="424" valid="False" visited="False"/>  <Line no="425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">olddesc</span><span class="misc">)</span></Line>  <Line no="426" valid="False" visited="False"/>  <Line no="427" valid="False" visited="False"/>  <Line no="428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="429" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="430" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="431" valid="False" visited="False"/>  <Line no="432" valid="False" visited="False"/>  <Line no="433" valid="False" visited="False"/>  <Line no="434" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="435" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ior_)</span></Line>  <Line no="436" valid="False" visited="False"/>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="438" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Cannot extract Provider IOR string"</span><span class="misc">)</span></Line>  <Line no="439" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="440" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="441" valid="False" visited="False"/>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">iorstr</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"table"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">iorstr</span><span class="misc">,</span>&nbsp;<span class="identifier">ior_</span><span class="misc">)</span></Line>  <Line no="444" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="445" valid="False" visited="False"/>  <Line no="446" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"interface matched with old descriptor: "</span><span class="operator">..</span><span class="identifier">olddesc</span><span class="misc">)</span></Line>  <Line no="447" valid="False" visited="False"/>  <Line no="448" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="449" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="450" valid="False" visited="False"/>  <Line no="451" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマ保持オブジェクトにオブジェクトリファレンス設定</span></Line>  <Line no="452" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ior IOR文字列</span></Line>  <Line no="453" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cons コンシューマ保持オブジェクト</span></Line>  <Line no="454" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">,</span>&nbsp;<span class="identifier">cons</span><span class="misc">)</span></Line>  <Line no="456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="string">"null"</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="458" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="459" valid="False" visited="False"/>  <Line no="460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="string">"nil"</span>&nbsp;&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="461" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="462" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="463" valid="False" visited="False"/>  <Line no="464" valid="False" visited="False"/>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if "IOR:" ~= string.sub(ior,1,4) then</span></Line>  <Line no="466" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	return false</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="468" valid="False" visited="False"/>  <Line no="469" valid="False" visited="False"/>  <Line no="470" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">cons</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Cannot narrow reference"</span><span class="misc">)</span></Line>  <Line no="472" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="473" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="474" valid="False" visited="False"/>  <Line no="475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setObject() done"</span><span class="misc">)</span></Line>  <Line no="476" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="477" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="478" valid="False" visited="False"/>  <Line no="479" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマ保持オブジェクトからオブジェクトリファレンスを解除</span></Line>  <Line no="480" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ior IOR文字列</span></Line>  <Line no="481" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cons コンシューマ保持オブジェクト</span></Line>  <Line no="482" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：解除成功、false：解除失敗</span></Line>  <Line no="483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="identifier">ior</span><span class="misc">,</span>&nbsp;<span class="identifier">cons</span><span class="misc">)</span></Line>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">cons</span><span class="misc">:</span><span class="identifier">getIor</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cons</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Consumer "</span><span class="operator">..</span><span class="identifier">cons</span><span class="misc">:</span><span class="identifier">descriptor</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" released."</span><span class="misc">)</span></Line>  <Line no="487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="488" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="489" valid="False" visited="False"/>  <Line no="490" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"IORs between Consumer and Connector are different."</span><span class="misc">)</span></Line>  <Line no="491" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="492" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="False" visited="False"/>  <Line no="494" valid="False" visited="False"/>  <Line no="495" valid="False" visited="False"/>  <Line no="496" valid="False" visited="False"/>  <Line no="497" valid="False" visited="False"/>  <Line no="498" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addProperty</span><span class="misc">(</span><span class="string">"port.port_type"</span><span class="misc">,</span>&nbsp;<span class="string">"CorbaPort"</span><span class="misc">)</span></Line>  <Line no="499" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._providers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="502" valid="False" visited="False"/>  <Line no="503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="504" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="505" valid="False" visited="False"/>  <Line no="506" valid="False" visited="False"/>  <Line no="507" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CorbaPort</span></Line>  <FileSummary valid="236" visited="186" totalLines="507" coverage="78"/> </File> <File name="lua\openrtm\CORBA_RTCUtil.lua" anchor="lua_openrtm_CORBA_RTCUtil_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CORBA_RTCUtil.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTC操作関数定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.CORBA_RTCUtil"] = CORBA_RTCUtil</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTObject</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTObject"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- コンポーネントプロファイル取得</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @return コンポーネントプロファイル(プロパティ形式)</span></Line>  <Line no="25" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_component_profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_component_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">prof.properties</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="33" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False"/>  <Line no="36" valid="False" visited="False">	<span class="comment">-- RTCの存在確認</span></Line>  <Line no="37" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="38" valid="False" visited="False">	<span class="comment">-- @return true：存在する</span></Line>  <Line no="39" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.is_existing</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._non_existent</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="42" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="45" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="False" visited="False">	<span class="comment">-- RTCがデフォルトの実行コンテキストで生存しているかを確認</span></Line>  <Line no="48" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="49" valid="False" visited="False">	<span class="comment">-- @return true：生存</span></Line>  <Line no="50" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.is_alive_in_default_ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">is_alive</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False">	<span class="comment">-- RTCから指定IDの実行コンテキストを取得</span></Line>  <Line no="63" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="64" valid="False" visited="False">	<span class="comment">-- @param ec_id</span></Line>  <Line no="65" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="66" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_actual_ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="False" visited="False"/>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">eclist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_owned_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">eclist</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">eclist</span><span class="misc">[</span><span class="identifier">ec_id</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">eclist</span><span class="misc">[</span><span class="identifier">ec_id</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">eclist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_participating_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(pec_id, #eclist)</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pec_id</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">eclist</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">eclist</span><span class="misc">[</span><span class="identifier">pec_id</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">eclist</span><span class="misc">[</span><span class="identifier">pec_id</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="False" visited="False"/>  <Line no="106" valid="False" visited="False">	<span class="comment">-- 対象RTCの指定実行コンテキストのIDを取得</span></Line>  <Line no="107" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="108" valid="False" visited="False">	<span class="comment">-- @param ec 実行コンテキスト</span></Line>  <Line no="109" valid="False" visited="False">	<span class="comment">-- @return ID</span></Line>  <Line no="110" valid="False" visited="False">	<span class="comment">-- 存在しない場合は-1</span></Line>  <Line no="111" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">eclist_own</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_owned_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="120" valid="False" visited="False"/>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">e</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">eclist_own</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">e</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">e</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span><span class="misc">,</span>&nbsp;<span class="identifier">e.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">ec.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">count</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">eclist_pec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_participating_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">e</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">eclist_pec</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">e</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">e</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span><span class="misc">,</span>&nbsp;<span class="identifier">e.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">ec.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="identifier">RTObject.ECOTHER_OFFSET</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="141" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="142" valid="False" visited="False"/>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="False" visited="False">	<span class="comment">-- RTCのアクティブ化</span></Line>  <Line no="146" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="147" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="148" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="149" valid="False" visited="False">	<span class="comment">-- RTC_OK：アクティブ化成功</span></Line>  <Line no="150" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.activate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">activate_component</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="164" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="165" valid="False" visited="False"/>  <Line no="166" valid="False" visited="False">	<span class="comment">-- RTCの非アクティブ化</span></Line>  <Line no="167" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="168" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="169" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="170" valid="False" visited="False">	<span class="comment">-- RTC_OK：非アクティブ化成功</span></Line>  <Line no="171" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.deactivate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="175" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">deactivate_component</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="185" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="False" visited="False"/>  <Line no="188" valid="False" visited="False">	<span class="comment">-- RTCのリセット</span></Line>  <Line no="189" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="190" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="191" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="192" valid="False" visited="False">	<span class="comment">-- RTC_OK：リセット成功</span></Line>  <Line no="193" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.reset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="197" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">reset_component</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="207" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="208" valid="False" visited="False"/>  <Line no="209" valid="False" visited="False"/>  <Line no="210" valid="False" visited="False">	<span class="comment">-- RTCの状態取得</span></Line>  <Line no="211" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="212" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="213" valid="False" visited="False">	<span class="comment">-- @return ret、state</span></Line>  <Line no="214" valid="False" visited="False">	<span class="comment">-- ret true：状態取得成功</span></Line>  <Line no="215" valid="False" visited="False">	<span class="comment">-- state 状態(取得に失敗した場合はCREATED_STATE)</span></Line>  <Line no="216" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_state</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="220" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span><span class="misc">,</span>&nbsp;<span class="identifier">LifeCycleState.CREATED_STATE</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="226" valid="False" visited="False"/>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span><span class="misc">,</span>&nbsp;<span class="identifier">LifeCycleState.CREATED_STATE</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">get_component_state</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="231" valid="False" visited="False"/>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.getLifeCycleState</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="233" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False"/>  <Line no="235" valid="False" visited="False"/>  <Line no="236" valid="False" visited="False">	<span class="comment">-- RTCが非アクティブ状態かを確認</span></Line>  <Line no="237" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="238" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="239" valid="False" visited="False">	<span class="comment">-- @return true：非アクティブ状態</span></Line>  <Line no="240" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.is_in_inactive</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="243" valid="False" visited="False"/>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_state</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">LifeCycleState.INACTIVE_STATE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="251" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="252" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="253" valid="False" visited="False"/>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="255" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="256" valid="False" visited="False"/>  <Line no="257" valid="False" visited="False">	<span class="comment">-- RTCがアクティブ状態かを確認</span></Line>  <Line no="258" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="259" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="260" valid="False" visited="False">	<span class="comment">-- @return true：アクティブ状態</span></Line>  <Line no="261" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.is_in_active</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="264" valid="False" visited="False"/>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_state</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="269" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">LifeCycleState.ACTIVE_STATE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="273" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="274" valid="False" visited="False"/>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="276" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="False" visited="False">	<span class="comment">-- RTCがエラー状態かを確認</span></Line>  <Line no="279" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="280" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="281" valid="False" visited="False">	<span class="comment">-- @return true：エラー状態</span></Line>  <Line no="282" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.is_in_error</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="284" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="285" valid="False" visited="False"/>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="288" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_state</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">LifeCycleState.ERROR_STATE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="292" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="293" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="294" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="295" valid="False" visited="False"/>  <Line no="296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="297" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="298" valid="False" visited="False"/>  <Line no="299" valid="False" visited="False"/>  <Line no="300" valid="False" visited="False">	<span class="comment">-- 対象RTCのデフォルトの実行コンテキストでの実行周期を取得</span></Line>  <Line no="301" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="302" valid="False" visited="False">	<span class="comment">-- @return 実行周期</span></Line>  <Line no="303" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_default_rate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">get_rate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="306" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="307" valid="False" visited="False"/>  <Line no="308" valid="False" visited="False">	<span class="comment">-- 対象RTCのデフォルトの実行コンテキストでの実行周期を設定</span></Line>  <Line no="309" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="310" valid="False" visited="False">	<span class="comment">-- @param 実行周期</span></Line>  <Line no="311" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="312" valid="False" visited="False">	<span class="comment">-- RTC_OK：設定成功</span></Line>  <Line no="313" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.set_default_rate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">set_rate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="317" valid="False" visited="False"/>  <Line no="318" valid="False" visited="False">	<span class="comment">-- 対象RTCのデフォルトの実行コンテキストでの実行周期を取得</span></Line>  <Line no="319" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="320" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="321" valid="False" visited="False">	<span class="comment">-- @return 実行周期</span></Line>  <Line no="322" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_current_rate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">get_rate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="325" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="326" valid="False" visited="False"/>  <Line no="327" valid="False" visited="False">	<span class="comment">-- 対象RTCのデフォルトの実行コンテキストでの実行周期を設定</span></Line>  <Line no="328" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="329" valid="False" visited="False">	<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="330" valid="False" visited="False">	<span class="comment">-- @param 実行周期</span></Line>  <Line no="331" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="332" valid="False" visited="False">	<span class="comment">-- RTC_OK：設定成功</span></Line>  <Line no="333" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.set_current_rate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">set_rate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="336" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="337" valid="False" visited="False"/>  <Line no="338" valid="False" visited="False"/>  <Line no="339" valid="False" visited="False">	<span class="comment">-- RTC1のデフォルトの実行コンテキストにRTC2を追加</span></Line>  <Line no="340" valid="False" visited="False">	<span class="comment">-- @param localcomp RTC1</span></Line>  <Line no="341" valid="False" visited="False">	<span class="comment">-- @param othercomp RTC2</span></Line>  <Line no="342" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="343" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.add_rtc_to_default_ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">localcomp</span><span class="misc">,</span>&nbsp;<span class="identifier">othercomp</span><span class="misc">)</span></Line>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">othercomp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="348" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">localcomp</span><span class="misc">)</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="352" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">add_component</span><span class="misc">(</span><span class="identifier">othercomp</span><span class="misc">)</span></Line>  <Line no="354" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="355" valid="False" visited="False"/>  <Line no="356" valid="False" visited="False"/>  <Line no="357" valid="False" visited="False">	<span class="comment">-- RTC1のデフォルトの実行コンテキストからRTC2を削除</span></Line>  <Line no="358" valid="False" visited="False">	<span class="comment">-- @param localcomp RTC1</span></Line>  <Line no="359" valid="False" visited="False">	<span class="comment">-- @param othercomp RTC2</span></Line>  <Line no="360" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="361" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.remove_rtc_to_default_ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">localcomp</span><span class="misc">,</span>&nbsp;<span class="identifier">othercomp</span><span class="misc">)</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">othercomp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="366" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">localcomp</span><span class="misc">)</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">remove_component</span><span class="misc">(</span><span class="identifier">othercomp</span><span class="misc">)</span></Line>  <Line no="372" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="373" valid="False" visited="False"/>  <Line no="374" valid="False" visited="False"/>  <Line no="375" valid="False" visited="False">	<span class="comment">-- RTCのデフォルトの実行コンテキストにアタッチしている外部のRTCを取得</span></Line>  <Line no="376" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="377" valid="False" visited="False">	<span class="comment">-- @return RTC一覧</span></Line>  <Line no="378" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_participants_rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_actual_ec</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="382" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">get_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">profile.participants</span></Line>  <Line no="385" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="386" valid="False" visited="False"/>  <Line no="387" valid="False" visited="False">	<span class="comment">-- RTCのポート名一覧を取得</span></Line>  <Line no="388" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="389" valid="False" visited="False">	<span class="comment">-- @return ポート名一覧</span></Line>  <Line no="390" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_port_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="391" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="392" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="393" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="394" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="398" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp.name</span></Line>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="401" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="402" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="403" valid="False" visited="False"/>  <Line no="404" valid="False" visited="False"/>  <Line no="405" valid="False" visited="False">	<span class="comment">-- RTCのInPort名一覧を取得</span></Line>  <Line no="406" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="407" valid="False" visited="False">	<span class="comment">-- @return InPort名一覧</span></Line>  <Line no="408" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_inport_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="409" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="410" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="411" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="412" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="415" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="417" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">pp.properties</span><span class="misc">)</span></Line>  <Line no="418" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"port.port_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"DataInPort"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="419" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp.name</span></Line>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="421" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="422" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="424" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="425" valid="False" visited="False"/>  <Line no="426" valid="False" visited="False"/>  <Line no="427" valid="False" visited="False">	<span class="comment">-- RTCのOutPort名一覧を取得</span></Line>  <Line no="428" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="429" valid="False" visited="False">	<span class="comment">-- @return OutPort名一覧</span></Line>  <Line no="430" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_outport_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="432" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="433" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="434" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="438" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="439" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">pp.properties</span><span class="misc">)</span></Line>  <Line no="440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"port.port_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"DataOutPort"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp.name</span></Line>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="443" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="444" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="446" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="447" valid="False" visited="False"/>  <Line no="448" valid="False" visited="False"/>  <Line no="449" valid="False" visited="False">	<span class="comment">-- RTCのサービスポート名一覧を取得</span></Line>  <Line no="450" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="451" valid="False" visited="False">	<span class="comment">-- @return サービスポート名一覧</span></Line>  <Line no="452" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_svcport_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="453" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="456" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="457" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="461" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">pp.properties</span><span class="misc">)</span></Line>  <Line no="462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"port.port_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"CorbaPort"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp.name</span></Line>  <Line no="464" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="465" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="466" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="468" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="469" valid="False" visited="False"/>  <Line no="470" valid="False" visited="False"/>  <Line no="471" valid="False" visited="False"/>  <Line no="472" valid="False" visited="False"/>  <Line no="473" valid="False" visited="False"/>  <Line no="474" valid="False" visited="False"/>  <Line no="475" valid="False" visited="False"/>  <Line no="476" valid="False" visited="False"/>  <Line no="477" valid="False" visited="False"/>  <Line no="478" valid="False" visited="False"/>  <Line no="479" valid="False" visited="False">	<span class="comment">-- ポート名からポートを取得</span></Line>  <Line no="480" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="481" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="482" valid="False" visited="False">	<span class="comment">-- @return ポート</span></Line>  <Line no="483" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_port_by_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="486" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="488" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="489" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="490" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp.name</span></Line>  <Line no="491" valid="False" visited="False"/>  <Line no="492" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="493" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">p</span></Line>  <Line no="494" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="495" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="496" valid="False" visited="False"/>  <Line no="497" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="498" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="499" valid="False" visited="False"/>  <Line no="500" valid="False" visited="False">	<span class="comment">-- ポートからコネクタ名一覧を取得</span></Line>  <Line no="501" valid="False" visited="False">	<span class="comment">-- @param port ポート</span></Line>  <Line no="502" valid="False" visited="False">	<span class="comment">-- @return コネクタ名一覧</span></Line>  <Line no="503" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_connector_names_by_portref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="505" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="507" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="508" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="509" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="510" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">c.name</span><span class="misc">)</span></Line>  <Line no="511" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="513" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="514" valid="False" visited="False"/>  <Line no="515" valid="False" visited="False">	<span class="comment">-- RTCとポート名からコネクタ名一覧を取得</span></Line>  <Line no="516" valid="False" visited="False">	<span class="comment">-- @param RTC rtc</span></Line>  <Line no="517" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="518" valid="False" visited="False">	<span class="comment">-- @return コネクタ名一覧</span></Line>  <Line no="519" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_connector_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="521" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="523" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="524" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="526" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="527" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">c.name</span><span class="misc">)</span></Line>  <Line no="528" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="529" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="530" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="531" valid="False" visited="False"/>  <Line no="532" valid="False" visited="False">	<span class="comment">-- ポートからコネクタID一覧を取得</span></Line>  <Line no="533" valid="False" visited="False">	<span class="comment">-- @param port ポート</span></Line>  <Line no="534" valid="False" visited="False">	<span class="comment">-- @return コネクタID一覧</span></Line>  <Line no="535" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_connector_ids_by_portref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ids</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="538" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ids</span></Line>  <Line no="539" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="540" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="541" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="542" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ids</span><span class="misc">,</span>&nbsp;<span class="identifier">c.connector_id</span><span class="misc">)</span></Line>  <Line no="543" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ids</span></Line>  <Line no="545" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="546" valid="False" visited="False"/>  <Line no="547" valid="False" visited="False">	<span class="comment">-- RTCとポート名からコネクタID一覧を取得</span></Line>  <Line no="548" valid="False" visited="False">	<span class="comment">-- @param RTC rtc</span></Line>  <Line no="549" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="550" valid="False" visited="False">	<span class="comment">-- @return コネクタID一覧</span></Line>  <Line no="551" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_connector_ids</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ids</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="554" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="555" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ids</span></Line>  <Line no="556" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="557" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ids</span><span class="misc">,</span>&nbsp;<span class="identifier">c.connector_id</span><span class="misc">)</span></Line>  <Line no="560" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ids</span></Line>  <Line no="562" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="563" valid="False" visited="False"/>  <Line no="564" valid="False" visited="False"/>  <Line no="565" valid="False" visited="False"/>  <Line no="566" valid="False" visited="False">	<span class="comment">-- コネクタプロファイルの生成</span></Line>  <Line no="567" valid="False" visited="False">	<span class="comment">-- @param name コネクタ名</span></Line>  <Line no="568" valid="False" visited="False">	<span class="comment">-- @param prop_arg 設定</span></Line>  <Line no="569" valid="False" visited="False">	<span class="comment">-- データフロー型はデフォルトでpush</span></Line>  <Line no="570" valid="False" visited="False">	<span class="comment">-- インターフェース型はデフォルトでdata_service</span></Line>  <Line no="571" valid="False" visited="False">	<span class="comment">-- @param port0 ポート0</span></Line>  <Line no="572" valid="False" visited="False">	<span class="comment">-- @param port1 ポート1</span></Line>  <Line no="573" valid="False" visited="False">	<span class="comment">-- @return コネクタプロファイル</span></Line>  <Line no="574" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.create_connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop_arg</span><span class="misc">,</span>&nbsp;<span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">)</span></Line>  <Line no="575" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop_arg</span></Line>  <Line no="576" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conn_prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">connector_id</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span>&nbsp;<span class="identifier">ports</span><span class="operator">=</span><span class="misc">{</span><span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">}</span><span class="misc">,</span>&nbsp;<span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="577" valid="False" visited="False"/>  <Line no="578" valid="False" visited="False"/>  <Line no="579" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"dataport.dataflow_type"</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="580" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"dataport.dataflow_type"</span><span class="misc">,</span><span class="string">"push"</span><span class="misc">)</span></Line>  <Line no="581" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="582" valid="False" visited="False"/>  <Line no="583" valid="False" visited="False"/>  <Line no="584" valid="False" visited="False"/>  <Line no="585" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"dataport.interface_type"</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="586" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"dataport.interface_type"</span><span class="misc">,</span><span class="string">"data_service"</span><span class="misc">)</span></Line>  <Line no="587" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="588" valid="False" visited="False"/>  <Line no="589" valid="False" visited="False"/>  <Line no="590" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conn_prof.properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="591" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">conn_prof.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="592" valid="False" visited="False"/>  <Line no="593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">conn_prof</span></Line>  <Line no="594" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="595" valid="False" visited="False"/>  <Line no="596" valid="False" visited="False">	<span class="comment">-- 指定ポート同士が接続済みかを確認</span></Line>  <Line no="597" valid="False" visited="False">	<span class="comment">-- @param localport ポート1</span></Line>  <Line no="598" valid="False" visited="False">	<span class="comment">-- @param otherport ポート2</span></Line>  <Line no="599" valid="False" visited="False">	<span class="comment">-- @return true：接続済み</span></Line>  <Line no="600" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.already_connected</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">localport</span><span class="misc">,</span>&nbsp;<span class="identifier">otherport</span><span class="misc">)</span></Line>  <Line no="601" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">localport</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="602" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="603" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">c.ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="604" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">p</span><span class="misc">,</span>&nbsp;<span class="identifier">otherport</span><span class="misc">,</span>&nbsp;<span class="identifier">p.getPortRef</span><span class="misc">,</span>&nbsp;<span class="identifier">otherport.getPortRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="605" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="606" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="607" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="608" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="609" valid="False" visited="False"/>  <Line no="610" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="611" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="612" valid="False" visited="False"/>  <Line no="613" valid="False" visited="False"/>  <Line no="614" valid="False" visited="False">	<span class="comment">-- ポートの接続</span></Line>  <Line no="615" valid="False" visited="False">	<span class="comment">-- @param name コネクタ名</span></Line>  <Line no="616" valid="False" visited="False">	<span class="comment">-- @param prop 設定</span></Line>  <Line no="617" valid="False" visited="False">	<span class="comment">-- @param port0 ポート0</span></Line>  <Line no="618" valid="False" visited="False">	<span class="comment">-- @param port1 ポート1</span></Line>  <Line no="619" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="620" valid="False" visited="False">	<span class="comment">-- RTC_OK：接続成功</span></Line>  <Line no="621" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.connect</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">)</span></Line>  <Line no="622" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="623" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="624" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port0</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="625" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="626" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="627" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="628" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="629" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="630" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">,</span>&nbsp;<span class="identifier">port0.getPortRef</span><span class="misc">,</span>&nbsp;<span class="identifier">port1.getPortRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="631" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="632" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="633" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.create_connector</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">)</span></Line>  <Line no="634" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="635" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port0</span><span class="misc">:</span><span class="identifier">connect</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">)</span></Line>  <Line no="636" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="637" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="638" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret)</span></Line>  <Line no="639" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="640" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="641" valid="False" visited="False"/>  <Line no="642" valid="False" visited="False"/>  <Line no="643" valid="False" visited="False">	<span class="comment">-- 複数のポートを接続</span></Line>  <Line no="644" valid="False" visited="False">	<span class="comment">-- @param name コネクタ名</span></Line>  <Line no="645" valid="False" visited="False">	<span class="comment">-- @param prop 設定</span></Line>  <Line no="646" valid="False" visited="False">	<span class="comment">-- @param port 接続元のポート</span></Line>  <Line no="647" valid="False" visited="False">	<span class="comment">-- @param target_ports 接続先のポート一覧</span></Line>  <Line no="648" valid="False" visited="False">	<span class="comment">-- @param リターンコード</span></Line>  <Line no="649" valid="False" visited="False">	<span class="comment">-- RTC_OK：すべてのコネクタが接続成功</span></Line>  <Line no="650" valid="False" visited="False">	<span class="comment">-- BAD_PARAMETER：いずれかのコネクタが接続失敗</span></Line>  <Line no="651" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.connect_multi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">target_ports</span><span class="misc">)</span></Line>  <Line no="652" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="653" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="654" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ReturnCode_t.RTC_OK</span></Line>  <Line no="655" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="656" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="657" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="658" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">target_ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="659" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="660" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="661" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="662" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">p</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">p.getPortRef</span><span class="misc">,</span>&nbsp;<span class="identifier">port.getPortRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="663" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="664" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="665" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">CORBA_RTCUtil.already_connected</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="666" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="667" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="668" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ReturnCode_t.RTC_OK</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.connect</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="669" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="670" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="671" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="672" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="673" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="674" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="675" valid="False" visited="False"/>  <Line no="676" valid="False" visited="False"/>  <Line no="677" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="678" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="679" valid="False" visited="False"/>  <Line no="680" valid="False" visited="False">	<span class="comment">-- ポート検索用関数オブジェクトの初期化</span></Line>  <Line no="681" valid="False" visited="False">	<span class="comment">-- @param name ポート名</span></Line>  <Line no="682" valid="False" visited="False">	<span class="comment">-- @return ポート検索用関数オブジェクト</span></Line>  <Line no="683" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.find_port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="684" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="685" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="686" valid="False" visited="False"/>  <Line no="687" valid="False" visited="False"/>  <Line no="688" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート検索用関数</span></Line>  <Line no="689" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="690" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param p 比較対象のポート</span></Line>  <Line no="691" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致</span></Line>  <Line no="692" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="693" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="694" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prof.name</span></Line>  <Line no="695" valid="False" visited="False"/>  <Line no="696" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="697" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="698" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="699" valid="False" visited="False"/>  <Line no="700" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="701" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="702" valid="False" visited="False"/>  <Line no="703" valid="False" visited="False"/>  <Line no="704" valid="False" visited="False">	<span class="comment">-- ポート名指定でコネクタを接続</span></Line>  <Line no="705" valid="False" visited="False">	<span class="comment">-- @param name コネクタ名</span></Line>  <Line no="706" valid="False" visited="False">	<span class="comment">-- @param prop 設定</span></Line>  <Line no="707" valid="False" visited="False">	<span class="comment">-- @param rtc0 RTC0</span></Line>  <Line no="708" valid="False" visited="False">	<span class="comment">-- @param port_name0 RTC0の保持するポート名</span></Line>  <Line no="709" valid="False" visited="False">	<span class="comment">-- @param rtc1 RTC1</span></Line>  <Line no="710" valid="False" visited="False">	<span class="comment">-- @param port_name1 RTC1の保持するポート名</span></Line>  <Line no="711" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="712" valid="False" visited="False">	<span class="comment">-- RTC_OK：接続成功</span></Line>  <Line no="713" valid="False" visited="False">	<span class="comment">-- BAD_PARAMETER：ポートが存在しない場合など</span></Line>  <Line no="714" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.connect_by_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc0</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name0</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc1</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name1</span><span class="misc">)</span></Line>  <Line no="715" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="716" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="717" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc0</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="718" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="719" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="720" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="721" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="722" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="723" valid="False" visited="False"/>  <Line no="724" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port0</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">rtc0</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name0</span><span class="misc">)</span></Line>  <Line no="725" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port0</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="726" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="727" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="728" valid="False" visited="False"/>  <Line no="729" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port1</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">rtc1</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name1</span><span class="misc">)</span></Line>  <Line no="730" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="731" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="732" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="733" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="734" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.connect</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port0</span><span class="misc">,</span>&nbsp;<span class="identifier">port1</span><span class="misc">)</span></Line>  <Line no="735" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="736" valid="False" visited="False"/>  <Line no="737" valid="False" visited="False">	<span class="comment">-- コネクタ切断</span></Line>  <Line no="738" valid="False" visited="False">	<span class="comment">-- @param connector_prof コネクタプロファイル</span></Line>  <Line no="739" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="740" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="741" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">connector_prof</span><span class="misc">)</span></Line>  <Line no="742" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_prof.ports</span></Line>  <Line no="743" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.disconnect_by_portref_connector_id</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">connector_prof.connector_id</span><span class="misc">)</span></Line>  <Line no="744" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="745" valid="False" visited="False"/>  <Line no="746" valid="False" visited="False"/>  <Line no="747" valid="False" visited="False">	<span class="comment">-- コネクタ名指定でコネクタ切断</span></Line>  <Line no="748" valid="False" visited="False">	<span class="comment">-- @param port_ref ポート</span></Line>  <Line no="749" valid="False" visited="False">	<span class="comment">-- @param conn_name コネクタ名</span></Line>  <Line no="750" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="751" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="752" valid="False" visited="False">	<span class="comment">-- BAD_PARAMETER：コネクタが存在しない場合など</span></Line>  <Line no="753" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_by_portref_connector_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">,</span>&nbsp;<span class="identifier">conn_name</span><span class="misc">)</span></Line>  <Line no="754" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="755" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="756" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="757" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="758" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="759" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="760" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="761" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">conn_name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="762" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.disconnect</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="763" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="764" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="765" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="766" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="767" valid="False" visited="False"/>  <Line no="768" valid="False" visited="False"/>  <Line no="769" valid="False" visited="False">	<span class="comment">-- ポート名、コネクタ名指定でコネクタ切断</span></Line>  <Line no="770" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="771" valid="False" visited="False">	<span class="comment">-- RTCをrtcloc、rtcname形式で指定する</span></Line>  <Line no="772" valid="False" visited="False">	<span class="comment">-- rtcname://localhost/test.host_cxt/ConsoleIn0.out</span></Line>  <Line no="773" valid="False" visited="False">	<span class="comment">-- @param conn_name コネクタ名</span></Line>  <Line no="774" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="775" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="776" valid="False" visited="False">	<span class="comment">-- BAD_PARAMETER：コネクタが存在しない場合など</span></Line>  <Line no="777" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_by_portname_connector_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">,</span>&nbsp;<span class="identifier">conn_name</span><span class="misc">)</span></Line>  <Line no="778" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="779" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="780" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_url</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="781" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="782" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="783" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="784" valid="False" visited="False"/>  <Line no="785" valid="False" visited="False"/>  <Line no="786" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="787" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="788" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">conn_name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="789" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.disconnect</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="790" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="791" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="792" valid="False" visited="False"/>  <Line no="793" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="794" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="795" valid="False" visited="False"/>  <Line no="796" valid="False" visited="False"/>  <Line no="797" valid="False" visited="False">	<span class="comment">-- コネクタID指定でコネクタ切断</span></Line>  <Line no="798" valid="False" visited="False">	<span class="comment">-- @param port_ref ポート</span></Line>  <Line no="799" valid="False" visited="False">	<span class="comment">-- @param conn_name コネクタ名</span></Line>  <Line no="800" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="801" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="802" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_by_portref_connector_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">,</span>&nbsp;<span class="identifier">conn_id</span><span class="misc">)</span></Line>  <Line no="803" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="804" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="805" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="806" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="807" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="808" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="identifier">conn_id</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="809" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="810" valid="False" visited="False"/>  <Line no="811" valid="False" visited="False"/>  <Line no="812" valid="False" visited="False">	<span class="comment">-- ポート名、コネクタID指定でコネクタ切断</span></Line>  <Line no="813" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="814" valid="False" visited="False">	<span class="comment">-- RTCをrtcloc、rtcname形式で指定する</span></Line>  <Line no="815" valid="False" visited="False">	<span class="comment">-- rtcname://localhost/test.host_cxt/ConsoleIn0.out</span></Line>  <Line no="816" valid="False" visited="False">	<span class="comment">-- @param conn_name コネクタ名</span></Line>  <Line no="817" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="818" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="819" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_by_portname_connector_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">,</span>&nbsp;<span class="identifier">conn_id</span><span class="misc">)</span></Line>  <Line no="820" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="821" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="822" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_url</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="823" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="824" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="825" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="826" valid="False" visited="False"/>  <Line no="827" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="identifier">conn_id</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="828" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="829" valid="False" visited="False"/>  <Line no="830" valid="False" visited="False">	<span class="comment">-- 全コネクタ切断</span></Line>  <Line no="831" valid="False" visited="False">	<span class="comment">-- @param port_ref ポート</span></Line>  <Line no="832" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="833" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="834" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_all_by_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">)</span></Line>  <Line no="835" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="836" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="837" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="838" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="839" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="840" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">disconnect_all</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="841" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="842" valid="False" visited="False"/>  <Line no="843" valid="False" visited="False">	<span class="comment">-- ポート名、全コネクタ切断</span></Line>  <Line no="844" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="845" valid="False" visited="False">	<span class="comment">-- RTCをrtcloc、rtcname形式で指定する</span></Line>  <Line no="846" valid="False" visited="False">	<span class="comment">-- rtcname://localhost/test.host_cxt/ConsoleIn0.out</span></Line>  <Line no="847" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="848" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="849" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_all_by_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="850" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="851" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="852" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_url</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="853" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_ref</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="854" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="855" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="856" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">:</span><span class="identifier">disconnect_all</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="857" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="858" valid="False" visited="False"/>  <Line no="859" valid="False" visited="False"/>  <Line no="860" valid="False" visited="False">	<span class="comment">-- rtcloc、rtcname形式でポートを取得する</span></Line>  <Line no="861" valid="False" visited="False">	<span class="comment">-- @param port_name ポート名</span></Line>  <Line no="862" valid="False" visited="False">	<span class="comment">-- RTCをrtcloc、rtcname形式で指定する</span></Line>  <Line no="863" valid="False" visited="False">	<span class="comment">-- rtcname://localhost/test.host_cxt/ConsoleIn0.out</span></Line>  <Line no="864" valid="False" visited="False">	<span class="comment">-- @return ポート</span></Line>  <Line no="865" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_port_by_url</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="866" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="867" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="868" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nm</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span><span class="misc">:</span><span class="identifier">getNaming</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="869" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="870" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">p</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">2</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="871" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="872" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="873" valid="False" visited="False"/>  <Line no="874" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="875" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">tmp</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="876" valid="False" visited="False"/>  <Line no="877" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(StringUtil.flatten(tmp, "%."))</span></Line>  <Line no="878" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">nm</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="879" valid="False" visited="False"/>  <Line no="880" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="881" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="882" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="883" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pn</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port_name</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="884" valid="False" visited="False"/>  <Line no="885" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">rtcs</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span><span class="identifier">pn</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">pn</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="886" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="887" valid="False" visited="False"/>  <Line no="888" valid="False" visited="False"/>  <Line no="889" valid="False" visited="False">	<span class="comment">-- ポート1と接続しているポートとポート2が一致した場合にコネクタを切断</span></Line>  <Line no="890" valid="False" visited="False">	<span class="comment">-- @param localport ポート1</span></Line>  <Line no="891" valid="False" visited="False">	<span class="comment">-- @param othername ポート2</span></Line>  <Line no="892" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="893" valid="False" visited="False">	<span class="comment">-- RTC_OK：切断成功</span></Line>  <Line no="894" valid="False" visited="False">	<span class="comment">-- BAD_PARAMETER：接続していなかった場合など</span></Line>  <Line no="895" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.disconnect_by_port_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">localport</span><span class="misc">,</span>&nbsp;<span class="identifier">othername</span><span class="misc">)</span></Line>  <Line no="896" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="897" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ReturnCode_t</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager._ReturnCode_t</span></Line>  <Line no="898" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">localport</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="899" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="900" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="901" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">localport</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="902" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prof.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">othername</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="903" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="904" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="905" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="906" valid="False" visited="False"/>  <Line no="907" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">localport</span><span class="misc">:</span><span class="identifier">get_connector_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="908" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">conprof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="909" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k2</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">c.ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="910" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="911" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="912" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(pp.name,othername)</span></Line>  <Line no="913" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pp.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">othername</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="914" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil.disconnect</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="915" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="916" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="917" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="918" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="919" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="920" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="921" valid="False" visited="False"/>  <Line no="922" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションセットをプロパティ形式で取得</span></Line>  <Line no="923" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="924" valid="False" visited="False">	<span class="comment">-- @param conf_name コンフィギュレーションセット名</span></Line>  <Line no="925" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーションセット(プロパティ形式)</span></Line>  <Line no="926" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_configuration</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">conf_name</span><span class="misc">)</span></Line>  <Line no="927" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="928" valid="False" visited="False"/>  <Line no="929" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_configuration_set</span><span class="misc">(</span><span class="identifier">conf_name</span><span class="misc">)</span></Line>  <Line no="930" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confData</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">confset.configuration_data</span></Line>  <Line no="931" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="932" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">confData</span><span class="misc">)</span></Line>  <Line no="933" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="934" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="935" valid="False" visited="False"/>  <Line no="936" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションパラメータの取得</span></Line>  <Line no="937" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="938" valid="False" visited="False">	<span class="comment">-- @param confset_name コンフィギュレーションセット名</span></Line>  <Line no="939" valid="False" visited="False">	<span class="comment">-- @param value_name パラメータ名</span></Line>  <Line no="940" valid="False" visited="False">	<span class="comment">-- @return パラメータ</span></Line>  <Line no="941" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_parameter_by_key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">confset_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">)</span></Line>  <Line no="942" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="943" valid="False" visited="False"/>  <Line no="944" valid="False" visited="False"/>  <Line no="945" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_configuration_set</span><span class="misc">(</span><span class="identifier">confset_name</span><span class="misc">)</span></Line>  <Line no="946" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confData</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">confset.configuration_data</span></Line>  <Line no="947" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="948" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">confData</span><span class="misc">)</span></Line>  <Line no="949" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">value_name</span><span class="misc">)</span></Line>  <Line no="950" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="951" valid="False" visited="False"/>  <Line no="952" valid="False" visited="False"/>  <Line no="953" valid="False" visited="False">	<span class="comment">-- アクティブなコンフィギュレーションセット名を取得</span></Line>  <Line no="954" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="955" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーションセット名</span></Line>  <Line no="956" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_active_configuration_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="957" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="958" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_active_configuration_set</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="959" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">confset.id</span></Line>  <Line no="960" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="961" valid="False" visited="False"/>  <Line no="962" valid="False" visited="False"/>  <Line no="963" valid="False" visited="False">	<span class="comment">-- アクティブなコンフィギュレーションセットをプロパティ形式で取得</span></Line>  <Line no="964" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="965" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーションセット(プロパティ形式)</span></Line>  <Line no="966" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.get_active_configuration</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="967" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="968" valid="False" visited="False"/>  <Line no="969" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_active_configuration_set</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="970" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confData</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">confset.configuration_data</span></Line>  <Line no="971" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="972" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">confData</span><span class="misc">)</span></Line>  <Line no="973" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="974" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="975" valid="False" visited="False"/>  <Line no="976" valid="False" visited="False"/>  <Line no="977" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションパラメータの設定</span></Line>  <Line no="978" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="979" valid="False" visited="False">	<span class="comment">-- @param confset_name コンフィギュレーションセット名</span></Line>  <Line no="980" valid="False" visited="False">	<span class="comment">-- @param value_name パラメータ名</span></Line>  <Line no="981" valid="False" visited="False">	<span class="comment">-- @param value 設定する値</span></Line>  <Line no="982" valid="False" visited="False">	<span class="comment">-- @return true:設定成功</span></Line>  <Line no="983" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.set_configuration</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">confset_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="984" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="985" valid="False" visited="False"/>  <Line no="986" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_configuration_set</span><span class="misc">(</span><span class="identifier">confset_name</span><span class="misc">)</span></Line>  <Line no="987" valid="False" visited="False"/>  <Line no="988" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_RTCUtil.set_configuration_parameter</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">confset</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="989" valid="False" visited="False"/>  <Line no="990" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">activate_configuration_set</span><span class="misc">(</span><span class="identifier">confset_name</span><span class="misc">)</span></Line>  <Line no="991" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="992" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="993" valid="False" visited="False"/>  <Line no="994" valid="False" visited="False"/>  <Line no="995" valid="False" visited="False">	<span class="comment">-- アクティブなコンフィギュレーションセットのパラメータを設定</span></Line>  <Line no="996" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="997" valid="False" visited="False">	<span class="comment">-- @param value_name パラメータ名</span></Line>  <Line no="998" valid="False" visited="False">	<span class="comment">-- @param value 設定する値</span></Line>  <Line no="999" valid="False" visited="False">	<span class="comment">-- @return true:設定成功</span></Line>  <Line no="1000" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.set_active_configuration</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="1001" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1002" valid="False" visited="False"/>  <Line no="1003" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">get_active_configuration_set</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1004" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_RTCUtil.set_configuration_parameter</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">confset</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="1005" valid="False" visited="False"/>  <Line no="1006" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">activate_configuration_set</span><span class="misc">(</span><span class="identifier">confset.id</span><span class="misc">)</span></Line>  <Line no="1007" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1008" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1009" valid="False" visited="False"/>  <Line no="1010" valid="False" visited="False"/>  <Line no="1011" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションパラメータ設定</span></Line>  <Line no="1012" valid="False" visited="False">	<span class="comment">-- @param conf コンフィギュレーション</span></Line>  <Line no="1013" valid="False" visited="False">	<span class="comment">-- @param confset コンフィギュレーションセット</span></Line>  <Line no="1014" valid="False" visited="False">	<span class="comment">-- @param value_name パラメータ名</span></Line>  <Line no="1015" valid="False" visited="False">	<span class="comment">-- @param value 設定する値</span></Line>  <Line no="1016" valid="False" visited="False">	<span class="comment">-- @return true:設定成功</span></Line>  <Line no="1017" valid="False" visited="False">	<span class="identifier">CORBA_RTCUtil.set_configuration_parameter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">confset</span><span class="misc">,</span>&nbsp;<span class="identifier">value_name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="1018" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">confData</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">confset.configuration_data</span></Line>  <Line no="1019" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1020" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">confData</span><span class="misc">)</span></Line>  <Line no="1021" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">value_name</span><span class="misc">,</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="1022" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">confData</span><span class="misc">,</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="1023" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">confset.configuration_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">confData</span></Line>  <Line no="1024" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf</span><span class="misc">:</span><span class="identifier">set_configuration_set_values</span><span class="misc">(</span><span class="identifier">confset</span><span class="misc">)</span></Line>  <Line no="1025" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1026" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1027" valid="False" visited="False"/>  <Line no="1028" valid="False" visited="False"/>  <Line no="1029" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_RTCUtil</span></Line>  <FileSummary valid="478" visited="446" totalLines="1029" coverage="93"/> </File> <File name="lua\openrtm\CORBA_SeqUtil.lua" anchor="lua_openrtm_CORBA_SeqUtil_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file CORBA_SeqUtil.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 配列操作ヘルプ関数</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.CORBA_SeqUtil"] = CORBA_SeqUtil</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False">	<span class="comment">-- 指定関数がtrueになる要素を配列から検索</span></Line>  <Line no="14" valid="False" visited="False">	<span class="comment">-- 指定関数をすべての要素に実行して判定する</span></Line>  <Line no="15" valid="False" visited="False">	<span class="comment">-- @param seq 配列</span></Line>  <Line no="16" valid="False" visited="False">	<span class="comment">-- @param f 関数</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">-- @return 配列の要素インデックス</span></Line>  <Line no="18" valid="False" visited="False">	<span class="identifier">CORBA_SeqUtil.find</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">,</span>&nbsp;<span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="20" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(f(s))</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">f</span><span class="misc">(</span><span class="identifier">s</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">i</span></Line>  <Line no="23" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="26" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="False" visited="False">	<span class="comment">-- オブジェクトリファレンスをIOR文字列に変換</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- 未実装</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- @param objlist オブジェクトリファレンスのリスト</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @return IRO文字列のリスト</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">CORBA_SeqUtil.refToVstring</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">objlist</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">iorlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local orb = Manager:instance():getORB()</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">objlist</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">iorlist</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">iorlist</span></Line>  <Line no="40" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False"/>  <Line no="42" valid="False" visited="False">	<span class="comment">-- 指定関数がtrueになる場合に配列から要素を削除する</span></Line>  <Line no="43" valid="False" visited="False">	<span class="comment">-- @param seq 配列</span></Line>  <Line no="44" valid="False" visited="False">	<span class="comment">-- @param f 関数</span></Line>  <Line no="45" valid="False" visited="False">	<span class="identifier">CORBA_SeqUtil.erase_if</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">,</span>&nbsp;<span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">,</span>&nbsp;<span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">seq</span>&nbsp;<span class="misc">,</span><span class="identifier">index</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False">	<span class="comment">-- 配列を連結する</span></Line>  <Line no="54" valid="False" visited="False">	<span class="comment">-- @param seq1 連結先の配列</span></Line>  <Line no="55" valid="False" visited="False">	<span class="comment">-- @param seq2 後ろに連結する配列</span></Line>  <Line no="56" valid="False" visited="False">	<span class="identifier">CORBA_SeqUtil.push_back_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">seq1</span><span class="misc">,</span>&nbsp;<span class="identifier">seq2</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">elem</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">seq2</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">seq1</span><span class="misc">,</span>&nbsp;<span class="identifier">elem</span><span class="misc">)</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False">	<span class="comment">-- 指定関数を配列の要素全てに実行する</span></Line>  <Line no="63" valid="False" visited="False">	<span class="comment">-- @param seq 配列</span></Line>  <Line no="64" valid="False" visited="False">	<span class="comment">-- @param f 関数</span></Line>  <Line no="65" valid="False" visited="False">	<span class="identifier">CORBA_SeqUtil.for_each</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">,</span>&nbsp;<span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">seq</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span><span class="misc">(</span><span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="70" valid="False" visited="False"/>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="False" visited="False"/>  <Line no="74" valid="False" visited="False"/>  <Line no="75" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span></Line>  <FileSummary valid="25" visited="24" totalLines="75" coverage="96"/> </File> <File name="lua\openrtm\DataPortStatus.lua" anchor="lua_openrtm_DataPortStatus_lua">  <PerfectCoverage/>   <FileSummary valid="32" visited="32" totalLines="65" coverage="100"/> </File> <File name="lua\openrtm\DefaultConfiguration.lua" anchor="lua_openrtm_DefaultConfiguration_lua">  <PerfectCoverage/>   <FileSummary valid="77" visited="77" totalLines="98" coverage="100"/> </File> <File name="lua\openrtm\ECFactory.lua" anchor="lua_openrtm_ECFactory_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ECFactory.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 実行コンテキスト生成用ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ECFactory</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ECFactory"] = ECFactory</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト削除関数</span></Line>  <Line no="14" valid="False" visited="False">	<span class="comment">-- @param ec 実行コンテキスト</span></Line>  <Line no="15" valid="False" visited="False">	<span class="identifier">ECFactory.ECDelete</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="True" visited="True">	<span class="identifier">ECFactory.ECFactoryBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト生成ファクトリ基底オブジェクトの初期化関数</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト生成ファクトリ</span></Line>  <Line no="23" valid="True" visited="True">	<span class="identifier">ECFactory.ECFactoryBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="25" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト名取得</span></Line>  <Line no="26" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト名</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト生成</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">create</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト削除</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec 実行コンテキスト</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">destroy</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="39" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="True" visited="True">	<span class="identifier">ECFactory.ECFactoryLua</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト生成ファクトリの初期化関数</span></Line>  <Line no="44" valid="False" visited="False">	<span class="comment">-- @param name 実行コンテキスト名</span></Line>  <Line no="45" valid="False" visited="False">	<span class="comment">-- @param new_func 実行コンテキスト初期化関数</span></Line>  <Line no="46" valid="False" visited="False">	<span class="comment">-- 実行コンテキストを返す関数を指定する</span></Line>  <Line no="47" valid="False" visited="False">	<span class="comment">-- @param delete_func 実行コンテキスト削除関数</span></Line>  <Line no="48" valid="False" visited="False">	<span class="comment">-- 実行コンテキストを引数とする関数を指定</span></Line>  <Line no="49" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト生成ファクトリ</span></Line>  <Line no="50" valid="True" visited="True">	<span class="identifier">ECFactory.ECFactoryLua.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">new_func</span><span class="misc">,</span>&nbsp;<span class="identifier">delete_func</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ECFactory.ECFactoryBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._New</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">new_func</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._Delete</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">delete_func</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト名取得</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト名</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._name</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト生成</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">create</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._New</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト削除</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec 実行コンテキスト</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">destroy</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Delete</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="72" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="73" valid="False" visited="False"/>  <Line no="74" valid="False" visited="False"/>  <Line no="75" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ECFactory</span></Line>  <FileSummary valid="33" visited="32" totalLines="75" coverage="96"/> </File> <File name="lua\openrtm\ExecutionContextBase.lua" anchor="lua_openrtm_ExecutionContextBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ExecutionContextBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 実行コンテキスト基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! 実行コンテキストを作成する場合はExecutionContextBaseをメタテーブルに設定する</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.ExecutionContextBase"] = ExecutionContextBase</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">TimeValue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.TimeValue"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextWorker</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextWorker"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextProfile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextProfile"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DEFAULT_EXECUTION_RATE</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1000</span></Line>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト基底オブジェクト初期化関数</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- @param name 名前</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="28" valid="False" visited="False">	<span class="identifier">ExecutionContextBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"ec_base"</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._activationTimeout</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">5</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._degetConfigvationTimeout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">5</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._resetTimeout</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">5</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._syncActivation</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._syncDeactivation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._syncReset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._worker</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextWorker.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextProfile.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時に実行コンテキストにプロパティを設定する</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param props プロパティ</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"init()"</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(props)</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setExecutionRate</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncActivation</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncDeactivation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncReset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストを終了する</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"exit()"</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期を設定する</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「rate」の要素名から実行周期を取得する</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param props プロパティ</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期を数値に変換できなかった場合はfalse</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setExecutionRate</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">props</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="string">"rate"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rate_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"rate"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rate_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setRate</span><span class="misc">(</span><span class="identifier">rate_</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期設定</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rate 実行周期</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onSettingRate、onSetRateがRTC_OKを返す</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：不正な周期を指定</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setRate("</span><span class="operator">..</span><span class="identifier">rate..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">setRate</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSettingRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Setting execution rate failed. "</span><span class="operator">..</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="89" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">rateChanged</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="94" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invoking on_rate_changed() for each RTC failed."</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSetRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onSetRate("</span><span class="operator">..</span><span class="identifier">rate..</span><span class="string">") failed."</span><span class="misc">)</span></Line>  <Line no="101" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"setRate("</span><span class="operator">..</span><span class="identifier">rate..</span><span class="string">") done"</span><span class="misc">)</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="False" visited="False"/>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティの設定</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param props プロパティ</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">props</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_ptr オブジェクトリファレンス</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObjRef</span><span class="misc">(</span><span class="identifier">ec_ptr</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">setECRef</span><span class="misc">(</span><span class="identifier">ec_ptr</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">setObjRef</span><span class="misc">(</span><span class="identifier">ec_ptr</span><span class="misc">)</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストの種類設定</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param 実行コンテキストの種類</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常に設定</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：RTC::ExecutionKindに定義のない値</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setKind</span><span class="misc">(</span><span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">setKind</span><span class="misc">(</span><span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="False" visited="False"/>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストにRTCを関連付ける</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtc RTC</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常にバインド</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：RTCが不正</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_ERROR：実行コンテキストが不正</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindComponent</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">bindComponent</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False"/>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="147" valid="False" visited="False"/>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストを開始する</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onStarting、onStartedがRTC_OKを返す</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：既に実行状態</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">start</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"start()"</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStarting</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="156" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onStarting() failed. Starting EC aborted."</span><span class="misc">)</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False"/>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">start</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invoking on_startup() for each RTC failed."</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="165" valid="False" visited="False"/>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStarted</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="168" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onStartted() failed. Started EC aborted.."</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">stop</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"on_shutdown() was invoked, because of onStarted"</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行状態が変化時のコールバック</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param running 実行状態</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行状態</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onIsRunning</span><span class="misc">(</span><span class="identifier">running</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">running</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始時のコールバック</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStarting</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始後のコールバック</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStarted</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止時のコールバック</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStopping</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止後のコールバック</span></Line>  <Line no="199" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStopped</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期取得時のコールバック</span></Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rate 実行周期</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行周期</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onGetRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rate</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期設定時のコールバック</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rate 実行周期</span></Line>  <Line no="211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行周期</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSettingRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(rate)</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rate</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="False" visited="False"/>  <Line no="217" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期設定後のコールバック</span></Line>  <Line no="218" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rate 実行周期</span></Line>  <Line no="219" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSetRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC追加時のコールバック</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAddingComponent</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC追加後のコールバック</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="231" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAddedComponent</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="235" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC削除時のコールバック</span></Line>  <Line no="236" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="237" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRemovingComponent</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC削除後のコールバック</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRemovedComponent</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ時のコールバック</span></Line>  <Line no="248" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivating</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移待機後のコールバック</span></Line>  <Line no="254" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onWaitingActivated</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="258" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="260" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移後のコールバック</span></Line>  <Line no="261" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivated</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移開始時のコールバック</span></Line>  <Line no="268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivating</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="273" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移開始時のコールバック</span></Line>  <Line no="274" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDeactivating</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="279" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移後のコールバック</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="281" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onWaitingDeactivated</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="284" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="286" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移後のコールバック</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="288" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDeactivated</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="293" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行開始時のコールバック</span></Line>  <Line no="294" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="295" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onResetting</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット待機時のコールバック</span></Line>  <Line no="300" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="302" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onWaitingReset</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行時のコールバック</span></Line>  <Line no="307" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="308" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param count 待機回数</span></Line>  <Line no="309" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReset</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">count</span><span class="misc">)</span></Line>  <Line no="311" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC状態取得時のコールバック</span></Line>  <Line no="314" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="315" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onGetComponentState</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">state</span></Line>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="319" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト種別取得時のコールバック</span></Line>  <Line no="320" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param kind 種別</span></Line>  <Line no="321" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 種別</span></Line>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onGetKind</span><span class="misc">(</span><span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">kind</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル得時のコールバック</span></Line>  <Line no="326" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile プロファイル</span></Line>  <Line no="327" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onGetProfile</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">profile</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行前に呼び出す処理</span></Line>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onActivated、onAborting、onDeactivated、onResetが実行される</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行時に呼び出す処理</span></Line>  <Line no="337" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onExecute、onErrorが実行される</span></Line>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="341" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行後に呼び出す処理</span></Line>  <Line no="342" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onStateUpdateが実行される</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="346" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期取得</span></Line>  <Line no="347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行周期(秒)</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPeriod</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getPeriod</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期取得</span></Line>  <Line no="352" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行周期(Hz)</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getRate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rate_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getRate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onGetRate</span><span class="misc">(</span><span class="identifier">rate_</span><span class="misc">)</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="357" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのアクティブ化</span></Line>  <Line no="358" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="359" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onActivating、onActivatedがRTC_OKを返す</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="362" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：非アクティブ状態以外の状態</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activateComponent()"</span><span class="misc">)</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onActivating</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="367" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onActivating() failed."</span><span class="misc">)</span></Line>  <Line no="368" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="369" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="370" valid="False" visited="False"/>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">object</span><span class="operator">=</span><span class="keyword">nil</span><span class="misc">}</span></Line>  <Line no="372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">activateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj_</span><span class="misc">)</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="374" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="376" valid="False" visited="False"/>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._syncActivation</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onActivated</span><span class="misc">(</span><span class="identifier">rtobj_.object</span><span class="misc">,</span>&nbsp;<span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="380" valid="False" visited="False"/>  <Line no="381" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onActivated() failed."</span><span class="misc">)</span></Line>  <Line no="382" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="383" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret_)</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="385" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="386" valid="False" visited="False"/>  <Line no="387" valid="False" visited="False"/>  <Line no="388" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Synchronous activation mode. "</span><span class="misc">)</span></Line>  <Line no="389" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Waiting for the RTC to be ACTIVE state. "</span><span class="misc">)</span></Line>  <Line no="390" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">waitForActivated</span><span class="misc">(</span><span class="identifier">rtobj_.object</span><span class="misc">)</span></Line>  <Line no="391" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="392" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのアクティブ状態遷移まで待機する</span></Line>  <Line no="393" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="394" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">waitForActivated</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="396" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="398" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの非アクティブ化</span></Line>  <Line no="399" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="401" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onDeactivating、onDeactivated</span></Line>  <Line no="402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="403" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：アクティブ状態以外の状態</span></Line>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"deactivateComponent()"</span><span class="misc">)</span></Line>  <Line no="406" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDeactivating</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="407" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="408" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onDeactivating() failed."</span><span class="misc">)</span></Line>  <Line no="409" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="410" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="411" valid="False" visited="False"/>  <Line no="412" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">object</span><span class="operator">=</span><span class="keyword">nil</span><span class="misc">}</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">deactivateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj_</span><span class="misc">)</span></Line>  <Line no="414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="415" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="416" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="417" valid="False" visited="False"/>  <Line no="418" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._syncDeactivation</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="419" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDeactivated</span><span class="misc">(</span><span class="identifier">rtobj_</span><span class="misc">[</span><span class="number">0</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="421" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onActivated() failed."</span><span class="misc">)</span></Line>  <Line no="422" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="424" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="425" valid="False" visited="False"/>  <Line no="426" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Synchronous deactivation mode. "</span><span class="misc">)</span></Line>  <Line no="427" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Waiting for the RTC to be INACTIVE state. "</span><span class="misc">)</span></Line>  <Line no="428" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">waitForDeactivated</span><span class="misc">(</span><span class="identifier">rtobj_.object</span><span class="misc">)</span></Line>  <Line no="429" valid="False" visited="False"/>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="431" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの非アクティブ状態遷移まで待機する</span></Line>  <Line no="432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="433" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="434" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">waitForDeactivated</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="435" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="437" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのリセット</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="439" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="440" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onResetting、onReset</span></Line>  <Line no="441" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="442" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：エラー状態以外の状態</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">resetComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="444" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"resetComponent()"</span><span class="misc">)</span></Line>  <Line no="445" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onResetting</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="446" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="447" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onResetting() failed."</span><span class="misc">)</span></Line>  <Line no="448" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="449" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="450" valid="False" visited="False"/>  <Line no="451" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">object</span><span class="operator">=</span><span class="keyword">nil</span><span class="misc">}</span></Line>  <Line no="452" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">resetComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj_</span><span class="misc">)</span></Line>  <Line no="453" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="454" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="455" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="456" valid="False" visited="False"/>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._syncReset</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="458" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReset</span><span class="misc">(</span><span class="identifier">rtobj_</span><span class="misc">[</span><span class="number">0</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="459" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="460" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onReset() failed."</span><span class="misc">)</span></Line>  <Line no="461" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="462" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="463" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="464" valid="False" visited="False"/>  <Line no="465" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Synchronous deactivation mode. "</span><span class="misc">)</span></Line>  <Line no="466" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Waiting for the RTC to be INACTIVE state. "</span><span class="misc">)</span></Line>  <Line no="467" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">waitForReset</span><span class="misc">(</span><span class="identifier">rtobj_.object</span><span class="misc">)</span></Line>  <Line no="468" valid="False" visited="False"/>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="470" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのリセット完了まで待機する</span></Line>  <Line no="471" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="472" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="473" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">waitForReset</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="474" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="476" valid="False" visited="False"/>  <Line no="477" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行状態を取得</span></Line>  <Line no="478" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行状態</span></Line>  <Line no="479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isRunning</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="480" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"isRunning()"</span><span class="misc">)</span></Line>  <Line no="481" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">isRunning</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="483" valid="False" visited="False"/>  <Line no="484" valid="False" visited="False"/>  <Line no="485" valid="False" visited="False"/>  <Line no="486" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行状態を取得</span></Line>  <Line no="487" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行状態</span></Line>  <Line no="488" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">is_running</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="489" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"is_running()"</span><span class="misc">)</span></Line>  <Line no="490" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isRunning</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="491" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="492" valid="False" visited="False"/>  <Line no="493" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期を取得</span></Line>  <Line no="494" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行周期</span></Line>  <Line no="495" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_rate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="496" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getRate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="497" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="498" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期を設定</span></Line>  <Line no="499" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rate 実行周期</span></Line>  <Line no="500" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_rate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setRate</span><span class="misc">(</span><span class="identifier">rate</span><span class="misc">)</span></Line>  <Line no="503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="504" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのアクティブ化</span></Line>  <Line no="505" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="506" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="507" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="508" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("activate_component")</span></Line>  <Line no="509" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">activateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="510" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="511" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの非アクティブ化</span></Line>  <Line no="512" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="513" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="515" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deactivateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="517" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのリセット</span></Line>  <Line no="518" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="519" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reset_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="521" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">resetComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="523" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの状態取得</span></Line>  <Line no="524" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="525" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態</span></Line>  <Line no="526" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_component_state</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="527" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentState</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="528" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="529" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストの種別取得</span></Line>  <Line no="530" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 種別</span></Line>  <Line no="531" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_kind</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="532" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getKind</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="533" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="534" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getKind</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="535" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">kind_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getKind</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getKind() = %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getKindString</span><span class="misc">(</span><span class="identifier">kind_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">kind_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onGetKind</span><span class="misc">(</span><span class="identifier">kind_</span><span class="misc">)</span></Line>  <Line no="538" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"onGetKind() returns %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getKindString</span><span class="misc">(</span><span class="identifier">kind_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="539" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">kind_</span></Line>  <Line no="540" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="541" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの追加</span></Line>  <Line no="542" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="543" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="545" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addComponent()"</span><span class="misc">)</span></Line>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAddingComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="548" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: onAddingComponent(). RTC is not attached."</span><span class="misc">)</span></Line>  <Line no="549" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="550" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="551" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">addComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="554" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: ECWorker addComponent() faild."</span><span class="misc">)</span></Line>  <Line no="555" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="556" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="557" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">addComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="560" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: ECProfile addComponent() faild."</span><span class="misc">)</span></Line>  <Line no="561" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="562" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="563" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="564" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAddedComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="565" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="566" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: onAddedComponent() faild."</span><span class="misc">)</span></Line>  <Line no="567" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Removing attached RTC."</span><span class="misc">)</span></Line>  <Line no="568" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="569" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="570" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="571" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="572" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Component has been added to this EC."</span><span class="misc">)</span></Line>  <Line no="574" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="575" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="576" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの追加</span></Line>  <Line no="577" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="578" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="579" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="580" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">addComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="581" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="582" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの削除</span></Line>  <Line no="583" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="584" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="585" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="586" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeComponent()"</span><span class="misc">)</span></Line>  <Line no="587" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onRemovingComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="588" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="589" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: onRemovingComponent(). RTC will not not attached."</span><span class="misc">)</span></Line>  <Line no="590" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="591" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="592" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="594" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="595" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: ECWorker removeComponent() faild."</span><span class="misc">)</span></Line>  <Line no="596" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="597" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="598" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="599" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="600" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="601" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: ECProfile removeComponent() faild."</span><span class="misc">)</span></Line>  <Line no="602" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="603" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="604" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="605" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onRemovedComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="606" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="607" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Error: onRemovedComponent() faild."</span><span class="misc">)</span></Line>  <Line no="608" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Removing attached RTC."</span><span class="misc">)</span></Line>  <Line no="609" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="610" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="611" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="612" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="613" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="614" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Component has been removeed to this EC."</span><span class="misc">)</span></Line>  <Line no="615" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="616" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="617" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの削除</span></Line>  <Line no="618" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="619" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="620" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">remove_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="621" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="622" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="623" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="624" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="625" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="626" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="627" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="628" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="629" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="630" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="631" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getProfile()"</span><span class="misc">)</span></Line>  <Line no="632" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="633" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"kind: "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getKindString</span><span class="misc">(</span><span class="identifier">prof_.kind</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="634" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"rate: "</span><span class="operator">..</span><span class="identifier">prof_.rate</span><span class="misc">)</span></Line>  <Line no="635" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"properties:"</span><span class="misc">)</span></Line>  <Line no="636" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">props_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="637" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">props_</span><span class="misc">,</span>&nbsp;<span class="identifier">prof_.properties</span><span class="misc">)</span></Line>  <Line no="638" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">props_</span><span class="misc">)</span></Line>  <Line no="639" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onGetProfile</span><span class="misc">(</span><span class="identifier">prof_</span><span class="misc">)</span></Line>  <Line no="640" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="641" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストの種別取得</span></Line>  <Line no="642" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 種別</span></Line>  <Line no="643" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getKindString</span><span class="misc">(</span><span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="644" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span><span class="misc">:</span><span class="identifier">getKindString</span><span class="misc">(</span><span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="645" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="646" valid="False" visited="False"/>  <Line no="647" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの状態取得</span></Line>  <Line no="648" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="649" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態</span></Line>  <Line no="650" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getComponentState</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="651" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">state_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">getComponentState</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="652" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getComponentState() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getStateString</span><span class="misc">(</span><span class="identifier">state_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="653" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">state_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._LifeCycleState.CREATED_STATE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="654" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"CREATED state: not initialized "</span><span class="operator">..</span></Line>  <Line no="655" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"RTC or unknwon RTC specified."</span><span class="misc">)</span></Line>  <Line no="656" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="657" valid="False" visited="False"/>  <Line no="658" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onGetComponentState</span><span class="misc">(</span><span class="identifier">state_</span><span class="misc">)</span></Line>  <Line no="659" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="660" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの状態を文字列に変換</span></Line>  <Line no="661" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="662" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 文字列化した状態</span></Line>  <Line no="663" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getStateString</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="664" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">getStateString</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="665" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="666" valid="False" visited="False"/>  <Line no="667" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストの停止</span></Line>  <Line no="668" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="669" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：onStopping、onStoppedがRTC_OKを返す</span></Line>  <Line no="670" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：既に停止状態</span></Line>  <Line no="671" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">stop</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="672" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"stop()"</span><span class="misc">)</span></Line>  <Line no="673" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStopping</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="674" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="675" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onStopping() failed. Stopping EC aborted."</span><span class="misc">)</span></Line>  <Line no="676" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="677" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="678" valid="False" visited="False"/>  <Line no="679" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">stop</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="680" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="681" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invoking on_shutdown() for each RTC failed."</span><span class="misc">)</span></Line>  <Line no="682" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="683" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="684" valid="False" visited="False"/>  <Line no="685" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStopped</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="686" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="687" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onStopped() failed. Stopped EC aborted."</span><span class="misc">)</span></Line>  <Line no="688" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="689" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="690" valid="False" visited="False"/>  <Line no="691" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="692" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="693" valid="False" visited="False"/>  <Line no="694" valid="False" visited="False"/>  <Line no="695" valid="False" visited="False"/>  <Line no="696" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="697" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="698" valid="False" visited="False"/>  <Line no="699" valid="False" visited="False"/>  <Line no="700" valid="True" visited="True">	<span class="identifier">ExecutionContextBase.ExecutionContextFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="701" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">ExecutionContextBase.ExecutionContextFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">GlobalFactory.Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="702" valid="False" visited="False"/>  <Line no="703" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">ExecutionContextBase.ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="704" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="705" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="706" valid="False" visited="False"/>  <Line no="707" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ExecutionContextBase</span></Line>  <FileSummary valid="393" visited="309" totalLines="707" coverage="78"/> </File> <File name="lua\openrtm\ExecutionContextProfile.lua" anchor="lua_openrtm_ExecutionContextProfile_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ExecutionContextProfile.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 実行コンテキストのプロファイル保持クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ExecutionContextProfile=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.ExecutionContextProfile"]&nbsp;=&nbsp;ExecutionContextProfile</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="True" visited="True">	<span class="blockcomment">local&nbsp;oil&nbsp;=&nbsp;require&nbsp;"oil"</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="15" valid="True" visited="True">	<span class="blockcomment">local&nbsp;TimeValue&nbsp;=&nbsp;require&nbsp;"openrtm.TimeValue"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NVUtil&nbsp;=&nbsp;require&nbsp;"openrtm.NVUtil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CORBA_SeqUtil&nbsp;=&nbsp;require&nbsp;"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="18" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;DEFAULT_PERIOD&nbsp;=&nbsp;0.000001</span></Line>  <Line no="20" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="21" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="22" valid="False" visited="False">	<span class="blockcomment">local&nbsp;find_participant&nbsp;=&nbsp;function(comp)</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._comp&nbsp;=&nbsp;comp</span></Line>  <Line no="25" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="26" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;comp)</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;NVUtil._is_equivalent(comp,&nbsp;self._comp,&nbsp;comp.getObjRef,&nbsp;self._comp.getObjRef)</span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="29" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="31" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="32" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="33" valid="False" visited="False">	<span class="blockcomment">--&nbsp;実行コンテキストのプロファイル保持オブジェクト初期化関数</span></Line>  <Line no="34" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;kind&nbsp;種別</span></Line>  <Line no="35" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;実行コンテキストのプロファイル保持オブジェクト</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment">ExecutionContextProfile.new&nbsp;=&nbsp;function(kind)</span></Line>  <Line no="37" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="39" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ExecutionKind&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::ExecutionKind").labelvalue</span></Line>  <Line no="40" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ReturnCode_t&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::ReturnCode_t").labelvalue</span></Line>  <Line no="41" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="42" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;kind&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="43" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;kind&nbsp;=&nbsp;obj._ExecutionKind.PERIODIC</span></Line>  <Line no="44" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="45" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._rtcout&nbsp;=&nbsp;Manager:instance():getLogbuf("periodic_ecprofile")</span></Line>  <Line no="46" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._period&nbsp;=&nbsp;TimeValue.new(DEFAULT_PERIOD)</span></Line>  <Line no="47" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_TRACE("ExecutionContextProfile.__init__()")</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("Actual&nbsp;rate:&nbsp;"..obj._period:sec().."&nbsp;[sec],&nbsp;"..obj._period:usec().."&nbsp;[usec]")</span></Line>  <Line no="49" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._ref&nbsp;=&nbsp;oil.corba.idl.null</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._profile&nbsp;=&nbsp;{kind=obj._ExecutionKind.PERIODIC,</span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rate=1.0/obj._period:toDouble(),</span></Line>  <Line no="52" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owner=oil.corba.idl.null,&nbsp;participants={},</span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;properties={}}</span></Line>  <Line no="54" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;実行コンテキスト終了</span></Line>  <Line no="56" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:exit()</span></Line>  <Line no="57" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("exit")</span></Line>  <Line no="58" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile.owner&nbsp;=&nbsp;oil.corba.idl.null</span></Line>  <Line no="59" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile.participants&nbsp;=&nbsp;{}</span></Line>  <Line no="60" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile.properties&nbsp;=&nbsp;{}</span></Line>  <Line no="61" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._ref&nbsp;=&nbsp;oil.corba.idl.null</span></Line>  <Line no="62" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="63" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;実行周期設定</span></Line>  <Line no="64" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;rate&nbsp;実行周期</span></Line>  <Line no="65" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_OK：onSettingRate、onSetRateがRTC_OKを返す</span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;BAD_PARAMETER：不正な周期を指定</span></Line>  <Line no="68" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setRate(rate)</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("setRate("..rate..")")</span></Line>  <Line no="70" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;rate&nbsp;&lt;=&nbsp;0.0&nbsp;then</span></Line>  <Line no="71" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="72" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile.rate&nbsp;=&nbsp;rate</span></Line>  <Line no="74" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._period&nbsp;=&nbsp;TimeValue.new(1.0&nbsp;/&nbsp;rate)</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="76" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="77" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;プロパティ設定</span></Line>  <Line no="78" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;props&nbsp;プロパティ</span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setProperties(props)</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("setProperties()")</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_DEBUG(props)</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;NVUtil.copyFromProperties(self._profile.properties,&nbsp;props)</span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="84" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;オブジェクトリファレンス設定</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ec_ptr&nbsp;オブジェクトリファレンス</span></Line>  <Line no="86" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setObjRef(ec_ptr)</span></Line>  <Line no="87" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("setObjRef()")</span></Line>  <Line no="88" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._ref&nbsp;=&nbsp;ec_ptr</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="90" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;オブジェクトリファレンス取得</span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;オブジェクトリファレンス</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getObjRef()</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("getObjRef()")</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ref</span></Line>  <Line no="95" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="96" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;種別設定</span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;kind&nbsp;種別</span></Line>  <Line no="98" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="99" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_OK：正常に設定</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;BAD_PARAMETER：RTC::ExecutionKindに定義のない値</span></Line>  <Line no="101" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setKind(kind)</span></Line>  <Line no="102" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;kind&nbsp;&lt;&nbsp;self._ExecutionKind.PERIODIC&nbsp;or&nbsp;kind&nbsp;&gt;&nbsp;self._ExecutionKind.OTHER&nbsp;then</span></Line>  <Line no="103" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Invalid&nbsp;kind&nbsp;is&nbsp;given.&nbsp;"..kind)</span></Line>  <Line no="104" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="105" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="106" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="107" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("setKind("..self:getKindString(kind)..")")</span></Line>  <Line no="108" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self:getKindString(kind))</span></Line>  <Line no="109" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile.kind&nbsp;=&nbsp;kind</span></Line>  <Line no="110" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="111" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="112" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getKind()</span></Line>  <Line no="113" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("%s&nbsp;=&nbsp;getKind()",&nbsp;self:getKindString(self._profile.kind))</span></Line>  <Line no="114" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._profile.kind</span></Line>  <Line no="115" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="116" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;実行コンテキストの種別を文字列に変換</span></Line>  <Line no="117" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;kind&nbsp;種別</span></Line>  <Line no="118" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;文字列に変換した種別</span></Line>  <Line no="119" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getKindString(kind)</span></Line>  <Line no="120" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;kinds_&nbsp;=&nbsp;{"PERIODIC",&nbsp;"EVENT_DRIVEN",&nbsp;"OTHER"}</span></Line>  <Line no="121" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;kind_&nbsp;=&nbsp;kind</span></Line>  <Line no="122" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;kind_&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="123" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;kind_&nbsp;=&nbsp;self._profile.kind</span></Line>  <Line no="124" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="125" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;kind_&nbsp;=&nbsp;kind</span></Line>  <Line no="126" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="127" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="128" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;kind_&nbsp;&lt;&nbsp;self._ExecutionKind.PERIODIC&nbsp;or&nbsp;kind_&nbsp;&gt;&nbsp;self._ExecutionKind.OTHER&nbsp;then</span></Line>  <Line no="129" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;""</span></Line>  <Line no="130" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="131" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="132" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;kinds_[kind_+1]</span></Line>  <Line no="133" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="134" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;実行周期取得</span></Line>  <Line no="135" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;実行周期(Hz)</span></Line>  <Line no="136" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getRate()</span></Line>  <Line no="137" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._profile.rate</span></Line>  <Line no="138" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="139" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;実行周期取得</span></Line>  <Line no="140" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;実行周期(秒)</span></Line>  <Line no="141" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getPeriod()</span></Line>  <Line no="142" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._period</span></Line>  <Line no="143" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="144" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;プロファイル取得</span></Line>  <Line no="145" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロファイル</span></Line>  <Line no="146" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getProfile()</span></Line>  <Line no="147" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("getProfile()")</span></Line>  <Line no="148" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._profile</span></Line>  <Line no="149" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="150" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="151" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:addComponent(comp)</span></Line>  <Line no="152" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("addComponent()")</span></Line>  <Line no="153" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;comp&nbsp;==&nbsp;oil.corba.idl.null&nbsp;then</span></Line>  <Line no="154" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("A&nbsp;nil&nbsp;reference&nbsp;was&nbsp;given.")</span></Line>  <Line no="155" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="156" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="157" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;rtobj_&nbsp;=&nbsp;comp</span></Line>  <Line no="158" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--[[</span></Line>  <Line no="159" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;rtobj_&nbsp;==&nbsp;oil.corba.idl.null&nbsp;then</span></Line>  <Line no="160" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Narrowing&nbsp;was&nbsp;failed.")</span></Line>  <Line no="161" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="162" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="163" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--]]</span></Line>  <Line no="164" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;table.insert(self._profile.participants,&nbsp;rtobj_)</span></Line>  <Line no="165" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></Line>  <Line no="166" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="167" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="168" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="169" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="170" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:removeComponent(comp)</span></Line>  <Line no="171" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("removeComponent()")</span></Line>  <Line no="172" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;comp&nbsp;==&nbsp;oil.corba.idl.null&nbsp;then</span></Line>  <Line no="173" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("A&nbsp;nil&nbsp;reference&nbsp;was&nbsp;given.")</span></Line>  <Line no="174" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="175" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="176" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="177" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;rtobj_&nbsp;=&nbsp;comp</span></Line>  <Line no="178" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[</span></Line>  <Line no="179" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;rtobj_==&nbsp;oil.corba.idl.null&nbsp;then</span></Line>  <Line no="180" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Narrowing&nbsp;was&nbsp;failed.")</span></Line>  <Line no="181" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="182" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="183" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--]]</span></Line>  <Line no="184" valid="False" visited="False"/>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._profile.participants</span><span class="misc">,</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_participant</span><span class="misc">(</span><span class="identifier">rtobj_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index_</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="189" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"The given RTObject does not exist in the EC."</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._profile.participants</span><span class="misc">,</span>&nbsp;<span class="identifier">index_</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="195" valid="False" visited="False"/>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="197" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="198" valid="False" visited="False"/>  <Line no="199" valid="False" visited="False"/>  <Line no="200" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ExecutionContextProfile</span></Line>  <FileSummary valid="114" visited="103" totalLines="200" coverage="90"/> </File> <File name="lua\openrtm\ExecutionContextWorker.lua" anchor="lua_openrtm_ExecutionContextWorker_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ExecutionContextWorker.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 実行コンテキスト状態遷移マシン駆動クラス</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextWorker</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ExecutionContextWorker"] = ExecutionContextWorker</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTObjectStateMachine</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTObjectStateMachine"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト状態遷移マシン駆動オブジェクト初期化</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト状態遷移マシン駆動オブジェクト</span></Line>  <Line no="22" valid="False" visited="False">	<span class="identifier">ExecutionContextWorker.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">RTObject</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTObject"</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"ec_worker"</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._running</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"ExecutionContextWorker.__init__"</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._addedComps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._removedComps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト終了</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"exit"</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期変更後に実行する関数</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：全てのRTCのonRateChangedコールバックがRTC_OKを返す</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rateChanged</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"rateChanged()"</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">onRateChanged</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ref オブジェクトリファレンス</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setECRef</span><span class="misc">(</span><span class="identifier">ref</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ref</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCを関連付ける</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtc RTC</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常にバインド</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：RTCが不正</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_ERROR：実行コンテキストが不正</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindComponent</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"bindComponent()"</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"NULL pointer is given."</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getECRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ec_)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">bindContext</span><span class="misc">(</span><span class="identifier">ec_</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id_</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">id_</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="76" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"bindContext returns invalid id: "</span><span class="operator">..</span><span class="identifier">id_</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"bindContext returns id = "</span><span class="operator">..</span><span class="identifier">id_</span><span class="misc">)</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local comp_ = rtc:getObjRef()</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">,</span>&nbsp;<span class="identifier">RTObjectStateMachine.new</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">,</span>&nbsp;<span class="identifier">comp_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"bindComponent() succeeded."</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getECRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ref</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：既に実行状態</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">start</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"start()"</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._running</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"ExecutionContext is already running."</span><span class="misc">)</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._comps)</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">onStartup</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="operator">#</span><span class="identifier">self._comps..</span><span class="string">" components started."</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._running</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：既に停止状態</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">stop</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"stop()"</span><span class="misc">)</span></Line>  <Line no="119" valid="False" visited="False"/>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._running</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"ExecutionContext is already stopped."</span><span class="misc">)</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="False" visited="False"/>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._running</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="126" valid="False" visited="False"/>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">onShutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="130" valid="False" visited="False"/>  <Line no="131" valid="False" visited="False"/>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行前に実行する処理</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onActivated、onAborting、onDeactivated、onResetが実行される</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"invokeWorkerPreDo()"</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">workerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onExecute、onErrorが実行される</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"invokeWorkerDo()"</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">workerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC実行後に実行する処理</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- onStateUpdateが実行される</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"invokeWorkerPostDo()"</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">workerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">updateComponentList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのアクティブ化</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTCのオブジェクトリファレンス</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj 状態遷移マシンを格納する変数</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：非アクティブ状態以外の状態</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activateComponent()"</span><span class="misc">)</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Given RTC is not participant of this EC."</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component found in the EC."</span><span class="misc">)</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj_:isCurrentState(self._LifeCycleState.INACTIVE_STATE))</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._ReturnCode_t.INACTIVE_STATE)</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"State of the RTC is not INACTIVE_STATE."</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component is in INACTIVE state. Going to ACTIVE state."</span><span class="misc">)</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("aaaaaa")</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ACTIVE_STATE</span><span class="misc">)</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj.object</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj_</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"activateComponent() done."</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="190" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの非アクティブ化</span></Line>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp 状態遷移マシン</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj オブジェクトリファレンスを格納する変数</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：アクティブ状態以外の状態</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"deactivateComponent()"</span><span class="misc">)</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="201" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Given RTC is not participant of this EC."</span><span class="misc">)</span></Line>  <Line no="202" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="204" valid="False" visited="False"/>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component found in the EC."</span><span class="misc">)</span></Line>  <Line no="206" valid="False" visited="False"/>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="208" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"State of the RTC is not ACTIVE_STATE."</span><span class="misc">)</span></Line>  <Line no="209" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="False" visited="False"/>  <Line no="212" valid="False" visited="False"/>  <Line no="213" valid="False" visited="False"/>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj.object</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj_</span></Line>  <Line no="216" valid="False" visited="False"/>  <Line no="217" valid="False" visited="False"/>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのリセット</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp 状態遷移マシン</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj オブジェクトリファレンスを格納する変数</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：指定RTCがバインドされていない</span></Line>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET：エラー状態以外の状態</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">resetComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="228" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"resetComponent()"</span><span class="misc">)</span></Line>  <Line no="229" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="230" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="231" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Given RTC is not participant of this EC."</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False"/>  <Line no="235" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component found in the EC."</span><span class="misc">)</span></Line>  <Line no="236" valid="False" visited="False"/>  <Line no="237" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="238" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"State of the RTC is not ERROR_STATE."</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="241" valid="False" visited="False"/>  <Line no="242" valid="False" visited="False"/>  <Line no="243" valid="False" visited="False"/>  <Line no="244" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj_</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj.object</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj_</span></Line>  <Line no="246" valid="False" visited="False"/>  <Line no="247" valid="False" visited="False"/>  <Line no="248" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="250" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定のRTCのオブジェクトリファレンスから状態遷移マシンを検索</span></Line>  <Line no="251" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTCのオブジェクトリファレンス</span></Line>  <Line no="252" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態遷移マシン</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">comp_</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp_:isEquivalent(comp))</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp_</span><span class="misc">:</span><span class="identifier">isEquivalent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">comp_</span></Line>  <Line no="258" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="259" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="260" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="262" valid="False" visited="False"/>  <Line no="263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのリスト更新</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">updateComponentList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._addedComps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Component added."</span><span class="misc">)</span></Line>  <Line no="268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="269" valid="False" visited="False"/>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._addedComps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="273" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._removedComps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">lwrtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getRTObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">lwrtobj_</span><span class="misc">:</span><span class="identifier">detach_context</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getExecutionContextHandle</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">idx_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.table_index</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="279" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">idx_</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._comps</span><span class="misc">,</span>&nbsp;<span class="identifier">idx_</span><span class="misc">)</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Component deleted."</span><span class="misc">)</span></Line>  <Line no="283" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="284" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="285" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._removedComps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="288" valid="False" visited="False"/>  <Line no="289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定のRTCのオブジェクトリファレンスから状態を取得</span></Line>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTCのオブジェクトリファレンス</span></Line>  <Line no="291" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getComponentState</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getComponentState()"</span><span class="misc">)</span></Line>  <Line no="294" valid="False" visited="False"/>  <Line no="295" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Given RTC is not participant of this EC."</span><span class="misc">)</span></Line>  <Line no="298" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._LifeCycleState.CREATED_STATE</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="300" valid="False" visited="False"/>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">state_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtobj_</span><span class="misc">:</span><span class="identifier">getState</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="302" valid="False" visited="False"/>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"getComponentState() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getStateString</span><span class="misc">(</span><span class="identifier">state_</span><span class="misc">)</span><span class="operator">..</span><span class="string">" done"</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">state_</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="306" valid="False" visited="False"/>  <Line no="307" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態を文字列に変換</span></Line>  <Line no="308" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="309" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 文字列に変換した状態</span></Line>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getStateString</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">st</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"CREATED_STATE"</span><span class="misc">,</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"INACTIVE_STATE"</span><span class="misc">,</span></Line>  <Line no="313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ACTIVE_STATE"</span><span class="misc">,</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ERROR_STATE"</span><span class="misc">}</span></Line>  <Line no="315" valid="False" visited="False"/>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">st</span><span class="misc">[</span><span class="identifier">state</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="317" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="318" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">st</span><span class="misc">[</span><span class="identifier">state</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="320" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="322" valid="False" visited="False"/>  <Line no="323" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行状態を取得</span></Line>  <Line no="324" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行状態</span></Line>  <Line no="325" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isRunning</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="326" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"isRunning()"</span><span class="misc">)</span></Line>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._running</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="329" valid="False" visited="False"/>  <Line no="330" valid="False" visited="False"/>  <Line no="331" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addComponent()"</span><span class="misc">)</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="334" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"nil reference is given."</span><span class="misc">)</span></Line>  <Line no="335" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="338" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getECRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">attach_context</span><span class="misc">(</span><span class="identifier">ec_</span><span class="misc">)</span></Line>  <Line no="341" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._addedComps</span><span class="misc">,</span>&nbsp;<span class="identifier">RTObjectStateMachine.new</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="345" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addComponent() failed."</span><span class="misc">)</span></Line>  <Line no="346" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="348" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="349" valid="False" visited="False"/>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"addComponent() succeeded."</span><span class="misc">)</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if self._running == false then</span></Line>  <Line no="352" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	self.updateComponentList()</span></Line>  <Line no="353" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">updateComponentList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="357" valid="False" visited="False"/>  <Line no="358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeComponent()"</span><span class="misc">)</span></Line>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="361" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"nil reference is given."</span><span class="misc">)</span></Line>  <Line no="362" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="363" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="364" valid="False" visited="False"/>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="366" valid="False" visited="False"/>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="368" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"no RTC found in this context."</span><span class="misc">)</span></Line>  <Line no="369" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="371" valid="False" visited="False"/>  <Line no="372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._removedComps</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj_</span><span class="misc">)</span></Line>  <Line no="373" valid="False" visited="False"/>  <Line no="374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if self._running == false then</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	self:updateComponentList()</span></Line>  <Line no="376" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">updateComponentList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="380" valid="False" visited="False"/>  <Line no="381" valid="False" visited="False"/>  <Line no="382" valid="False" visited="False"/>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="384" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="385" valid="False" visited="False"/>  <Line no="386" valid="False" visited="False"/>  <Line no="387" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ExecutionContextWorker</span></Line>  <FileSummary valid="210" visited="170" totalLines="387" coverage="80"/> </File> <File name="lua\openrtm\Factory.lua" anchor="lua_openrtm_Factory_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file Factory.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTC生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.Factory"] = Factory</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="False" visited="False">	<span class="comment">-- RTC削除関数</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">-- @param rtc RTC</span></Line>  <Line no="18" valid="False" visited="False">	<span class="identifier">Factory.Delete</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtc</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="identifier">Factory.FactoryBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="False" visited="False">	<span class="comment">-- RTC生成ファクトリ基底オブジェクト初期化</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @param profile RTCのプロファイル</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @return RTC生成ファクトリ</span></Line>  <Line no="26" valid="True" visited="True">	<span class="identifier">Factory.FactoryBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化に呼ばれる関数</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">profile</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Number</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの生成</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return RTC</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">create</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの削除</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">destroy</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._Profile</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの数取得</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC数</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">number</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._Number</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="56" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="True" visited="True">	<span class="identifier">Factory.FactoryLua</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False">	<span class="comment">-- RTC生成ファクトリ初期化</span></Line>  <Line no="63" valid="False" visited="False">	<span class="comment">-- @param profile RTCのプロファイル</span></Line>  <Line no="64" valid="False" visited="False">	<span class="comment">-- @param new_func 生成関数</span></Line>  <Line no="65" valid="False" visited="False">	<span class="comment">-- @param delete_func 削除関数</span></Line>  <Line no="66" valid="False" visited="False">	<span class="comment">-- @param policy 番号付けポリシー</span></Line>  <Line no="67" valid="False" visited="False">	<span class="comment">-- @return RTC生成ファクトリ</span></Line>  <Line no="68" valid="True" visited="True">	<span class="identifier">Factory.FactoryLua.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">new_func</span><span class="misc">,</span>&nbsp;<span class="identifier">delete_func</span><span class="misc">,</span>&nbsp;<span class="identifier">policy</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.FactoryBase.new</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時に呼び出される関数</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicy"</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._policy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NumberingPolicy.ProcessUniquePolicy.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._policy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">policy</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._New</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">new_func</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Delete</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">delete_func</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC生成</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 生成するたびにカウントアップする</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCを削除した場合は、削除済みの番号に割り当てる</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return RTC</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">create</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mgr)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._New</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="94" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Number</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._Number</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">getTypeName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">instance_name..self._policy</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">setInstanceName</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtobj</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC削除</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">destroy</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Number</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._Number</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._policy</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._Delete</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="120" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">Factory</span></Line>  <FileSummary valid="60" visited="55" totalLines="124" coverage="91"/> </File> <File name="lua\openrtm\FactoryInit.lua" anchor="lua_openrtm_FactoryInit_lua">  <PerfectCoverage/>   <FileSummary valid="23" visited="23" totalLines="56" coverage="100"/> </File> <File name="lua\openrtm\GlobalFactory.lua" anchor="lua_openrtm_GlobalFactory_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file GlobalFactory.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief オブジェクト生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! FACTORY_OK：正常</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! FACTORY_ERROR：エラー</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">--! ALREADY_EXISTS：既に指定ファクトリが存在</span></Line>  <Line no="7" valid="False" visited="False">	<span class="comment">--! NOT_FOUND：指定ファクトリがない</span></Line>  <Line no="8" valid="False" visited="False">	<span class="comment">--! INVALID_ARG：不正な引数</span></Line>  <Line no="9" valid="False" visited="False">	<span class="comment">--! UNKNOWN_ERROR：それ以外のエラー</span></Line>  <Line no="10" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">--_G["openrtm.GlobalFactory"] = GlobalFactory</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="22" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.FACTORY_ERROR</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="23" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.ALREADY_EXISTS</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span></Line>  <Line no="24" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.NOT_FOUND</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span></Line>  <Line no="25" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.INVALID_ARG</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span></Line>  <Line no="26" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.UNKNOWN_ERROR</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span></Line>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">FactoryEntry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="False" visited="False">	<span class="comment">-- オブジェクト生成ファクトリ関数初期化</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @param id 識別子</span></Line>  <Line no="32" valid="False" visited="False">	<span class="comment">-- @param creator 生成関数</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- @param destructor 削除関数</span></Line>  <Line no="34" valid="False" visited="False">	<span class="comment">-- @return 生成オブジェクト</span></Line>  <Line no="35" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">FactoryEntry.new</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">creator</span><span class="misc">,</span>&nbsp;<span class="identifier">destructor</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.id_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">id</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.creator_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">creator</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.destructor_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">destructor</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="41" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="False" visited="False">	<span class="comment">-- ファクトリ登録オブジェクト初期化</span></Line>  <Line no="44" valid="False" visited="False">	<span class="comment">-- @return ファクトリ登録オブジェクト</span></Line>  <Line no="45" valid="True" visited="True">	<span class="identifier">GlobalFactory.Factory.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._creators</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objects</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定IDのファクトリが存在するかの確認</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：存在する、false：存在しない</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">hasFactory</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 登録ファクトリのID一覧を取得</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ID一覧</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getIdentifiers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">idlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ver</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._creators</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">idlist</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">idlist</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファクトリ追加</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param creator 生成関数</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param destructor 削除関数</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- FACTORY_OK：正常に追加</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ALREADY_EXISTS：既に指定IDで追加済み</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- INVALID_ARG：不正な引数</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">creator</span><span class="misc">,</span>&nbsp;<span class="identifier">destructor</span><span class="misc">)</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test",creator,destructor)</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">creator</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">destructor</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="81" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.INVALID_ARG</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="83" valid="False" visited="False"/>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.ALREADY_EXISTS</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">FactoryEntry.new</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">creator</span><span class="misc">,</span>&nbsp;<span class="identifier">destructor</span><span class="misc">)</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファクトリ削除</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- FACTORY_OK：正常に削除</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- NOT_FOUND：ファクトリがない</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeFactory</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.NOT_FOUND</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトを生成</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクト</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="string">"Factory.createObject return nil id: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">creator_</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj_</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for k,v in pairs(self._objects) do</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(k,v)</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj_</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="False" visited="False"/>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトを削除</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクト</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="130" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- FACTORY_OK：正常に削除</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- NOT_FOUND：オブジェクトがない</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="133" valid="False" visited="False"/>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="135" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="136" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">destructor_</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._creators</span><span class="misc">[</span><span class="identifier">id</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False"/>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.NOT_FOUND</span></Line>  <Line no="144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">destructor_</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._objects)</span></Line>  <Line no="149" valid="False" visited="False"/>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for k,v in pairs(self._objects) do</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(k,v)</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._objects)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False"/>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 作成済みオブジェクト一覧を取得</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 作成済みオブジェクト一覧</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createdObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="161" valid="False" visited="False"/>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">objects_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ver</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">objects_</span><span class="misc">,</span>&nbsp;<span class="identifier">ver</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">objects_</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="False" visited="False"/>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトの存在確認</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- true：存在する、false：存在しない</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isProducerOf</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="False" visited="False"/>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトのID取得</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクト</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ID、リターンコード</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">objectToIdentifier</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">GlobalFactory.Factory.NOT_FOUND</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">id_</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">GlobalFactory.Factory.FACTORY_OK</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトの生成関数を取得</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクト</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 生成関数</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">objectToCreator</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isProducerOf</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">creator_</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="203" valid="False" visited="False"/>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定オブジェクトの削除関数を取得</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj オブジェクト</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 削除関数</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">objectToDestructor</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isProducerOf</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">obj</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">destructor_</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="214" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="215" valid="False" visited="False"/>  <Line no="216" valid="False" visited="False"/>  <Line no="217" valid="True" visited="True">	<span class="identifier">GlobalFactory.GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="218" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">GlobalFactory.GlobalFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">GlobalFactory.Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="219" valid="False" visited="False"/>  <Line no="220" valid="False" visited="False"/>  <Line no="221" valid="False" visited="False"/>  <Line no="222" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">GlobalFactory.GlobalFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="223" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="224" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="225" valid="False" visited="False"/>  <Line no="226" valid="False" visited="False"/>  <Line no="227" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">GlobalFactory</span></Line>  <FileSummary valid="101" visited="95" totalLines="227" coverage="94"/> </File> <File name="lua\openrtm\InPort.lua" anchor="lua_openrtm_InPort_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPort.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief インポートオブジェクト定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPort</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPort"] = InPort</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortBase"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- InPort初期化</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @param name ポート名</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @param value データ変数</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @param data_type データ型</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param read_block 読み込み時ブロックの設定</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @param write_block 書き込み時時ブロックの設定</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @param read_timeout 読み込み時のタイムアウト</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- @param write_timeout 書き込み時のタイムアウト</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @return InPort</span></Line>  <Line no="28" valid="False" visited="False">	<span class="identifier">InPort.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">data_type</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">,</span>&nbsp;<span class="identifier">read_block</span><span class="misc">,</span>&nbsp;<span class="identifier">write_block</span><span class="misc">,</span>&nbsp;<span class="identifier">read_timeout</span><span class="misc">,</span>&nbsp;<span class="identifier">write_timeout</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">read_block</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">read_block</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">write_block</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">write_block</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">read_timeout</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">read_timeout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">write_timeout</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">write_timeout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(data_type)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">InPortBase.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">data_type</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._OnRead</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._OnReadConvert</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート名取得</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ※プロファイルのポート名ではない</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ポート名</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._name</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 新規データの存在確認</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- true；存在する、false：存在しない</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isNew</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"isNew()"</span><span class="misc">)</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._connectors</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"no connectors"</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._connectors</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">getBuffer</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">readable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"isNew() = True, readable data: "</span><span class="operator">..</span><span class="identifier">r</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"isNew() = False, no readable data"</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 新規データがないことを確認</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：存在しない、false：存在する</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"isEmpty()"</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._connectors</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"no connectors"</span><span class="misc">)</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._connectors</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">getBuffer</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">readable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="93" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"isEmpty() = true, buffer is empty"</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"isEmpty() = false, data exists in the buffer"</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="100" valid="False" visited="False"/>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 変換関数を設定している場合は、変換後のデータを返す</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ数が0、もしくはデータ読み込みに失敗した場合は、保持している変数をそのまま返す</span></Line>  <Line no="104" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return データ</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"DataType read()"</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._OnRead</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnRead</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"OnRead called"</span><span class="misc">)</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._connectors</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"no connectors"</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">_data</span><span class="operator">=</span><span class="identifier">self._value</span><span class="misc">}</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._connectors</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">)</span></Line>  <Line no="126" valid="False" visited="False"/>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"data read succeeded"</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cdr._data</span></Line>  <Line no="131" valid="False" visited="False"/>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._OnReadConvert</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._OnReadConvert</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">self._value</span><span class="misc">)</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"OnReadConvert called"</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="137" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="138" valid="False" visited="False"/>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_EMPTY</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"buffer empty"</span><span class="misc">)</span></Line>  <Line no="142" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="145" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"buffer read timeout"</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="148" valid="False" visited="False"/>  <Line no="149" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"unknown retern value from buffer.read()"</span><span class="misc">)</span></Line>  <Line no="150" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 変数に最新値格納</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み時コールバックの設定</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param on_read データ読み込み時コールバック</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnRead</span><span class="misc">(</span><span class="identifier">on_read</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnRead</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">on_read</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ変換関数設定</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param on_rconvert データ変換関数</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- out_value = on_rconvert(in_value)という関数を指定</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnReadConvert</span><span class="misc">(</span><span class="identifier">on_rconvert</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnReadConvert</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">on_rconvert</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="False" visited="False"/>  <Line no="168" valid="False" visited="False"/>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="171" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPort</span></Line>  <FileSummary valid="83" visited="64" totalLines="174" coverage="77"/> </File> <File name="lua\openrtm\InPortBase.lua" anchor="lua_openrtm_InPortBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief InPort基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortBase=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.InPortBase"]&nbsp;=&nbsp;InPortBase</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CORBA_SeqUtil&nbsp;=&nbsp;require&nbsp;"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Properties&nbsp;=&nbsp;require&nbsp;"openrtm.Properties"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener&nbsp;=&nbsp;require&nbsp;"openrtm.ConnectorListener"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListeners&nbsp;=&nbsp;ConnectorListener.ConnectorListeners</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PublisherBase&nbsp;=&nbsp;require&nbsp;"openrtm.PublisherBase"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PublisherFactory&nbsp;=&nbsp;PublisherBase.PublisherFactory</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortBase&nbsp;=&nbsp;require&nbsp;"openrtm.PortBase"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">local&nbsp;StringUtil&nbsp;=&nbsp;require&nbsp;"openrtm.StringUtil"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CdrBufferBase&nbsp;=&nbsp;require&nbsp;"openrtm.CdrBufferBase"</span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CdrBufferFactory&nbsp;=&nbsp;CdrBufferBase.CdrBufferFactory</span></Line>  <Line no="23" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="24" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="25" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorDataListenerType&nbsp;=&nbsp;ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListenerType&nbsp;=&nbsp;ConnectorListener.ConnectorListenerType</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorDataListener&nbsp;=&nbsp;ConnectorListener.ConnectorDataListener</span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener&nbsp;=&nbsp;ConnectorListener.ConnectorListener</span></Line>  <Line no="29" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortConsumer&nbsp;=&nbsp;require&nbsp;"openrtm.OutPortConsumer"</span></Line>  <Line no="31" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortConsumerFactory&nbsp;=&nbsp;OutPortConsumer.OutPortConsumerFactory</span></Line>  <Line no="32" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortProvider&nbsp;=&nbsp;require&nbsp;"openrtm.InPortProvider"</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortProviderFactory&nbsp;=&nbsp;InPortProvider.InPortProviderFactory</span></Line>  <Line no="34" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="35" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NVUtil&nbsp;=&nbsp;require&nbsp;"openrtm.NVUtil"</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="37" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorBase&nbsp;=&nbsp;require&nbsp;"openrtm.ConnectorBase"</span></Line>  <Line no="39" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorInfo&nbsp;=&nbsp;ConnectorBase.ConnectorInfo</span></Line>  <Line no="40" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortPushConnector&nbsp;=&nbsp;require&nbsp;"openrtm.InPortPushConnector"</span></Line>  <Line no="42" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortPullConnector&nbsp;=&nbsp;require&nbsp;"openrtm.InPortPullConnector"</span></Line>  <Line no="43" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="44" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="45" valid="False" visited="False">	<span class="blockcomment">--&nbsp;InPort基底オブジェクト初期化</span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;name&nbsp;ポート名</span></Line>  <Line no="47" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;data_type&nbsp;データ型(例：::RTC::TimedLong)</span></Line>  <Line no="48" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;InPort</span></Line>  <Line no="49" valid="False" visited="False">	<span class="blockcomment">InPortBase.new&nbsp;=&nbsp;function(name,&nbsp;data_type)</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__index=PortBase.new(name)})</span></Line>  <Line no="52" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ReturnCode_t&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::ReturnCode_t").labelvalue</span></Line>  <Line no="54" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="55" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._rtcout&nbsp;=&nbsp;Manager:instance():getLogbuf(name)</span></Line>  <Line no="56" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._rtcout:RTC_DEBUG("Port&nbsp;name:&nbsp;"..name)</span></Line>  <Line no="57" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="58" valid="False" visited="False">	<span class="blockcomment">&nbsp;--local&nbsp;svr&nbsp;=&nbsp;Manager:instance():getORB():newservant(obj,&nbsp;nil,&nbsp;"IDL:omg.org/RTC/PortService:1.0")</span></Line>  <Line no="59" valid="False" visited="False">	<span class="blockcomment">&nbsp;--local&nbsp;str&nbsp;=&nbsp;Manager:instance():getORB():tostring(svr)</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment">&nbsp;--obj._objref&nbsp;=&nbsp;Manager:instance():getORB():newproxy(str,"IDL:omg.org/RTC/PortService:1.0")</span></Line>  <Line no="61" valid="False" visited="False">	<span class="blockcomment">&nbsp;--obj._profile.port_ref&nbsp;=&nbsp;obj._objref</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="63" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="64" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._singlebuffer&nbsp;&nbsp;=&nbsp;true</span></Line>  <Line no="65" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._thebuffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;nil</span></Line>  <Line no="66" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._properties&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="67" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._providerTypes&nbsp;=&nbsp;""</span></Line>  <Line no="68" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._consumerTypes&nbsp;=&nbsp;""</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._connectors&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;{}</span></Line>  <Line no="70" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="71" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("setting&nbsp;port.port_type:&nbsp;DataInPort")</span></Line>  <Line no="72" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("port.port_type",&nbsp;"DataInPort")</span></Line>  <Line no="73" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="74" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("setting&nbsp;port.data_type:&nbsp;"..tostring(data_type))</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;_data_type&nbsp;=&nbsp;string.sub(data_type,&nbsp;3)</span></Line>  <Line no="76" valid="True" visited="True">	<span class="blockcomment">&nbsp;_data_type&nbsp;=&nbsp;string.gsub(_data_type,&nbsp;"::",&nbsp;"/")</span></Line>  <Line no="77" valid="True" visited="True">	<span class="blockcomment">&nbsp;_data_type&nbsp;=&nbsp;"IDL:".._data_type..":1.0"</span></Line>  <Line no="78" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("dataport.data_type",&nbsp;_data_type)</span></Line>  <Line no="79" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("dataport.subscription_type",&nbsp;"Any")</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._value&nbsp;=&nbsp;nil</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._listeners&nbsp;=&nbsp;ConnectorListeners.new()</span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._data_type&nbsp;=&nbsp;data_type</span></Line>  <Line no="84" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(data_type)</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="86" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;初期化時のプロパティ設定</span></Line>  <Line no="87" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="88" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:init(prop)</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("init()")</span></Line>  <Line no="90" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:createRef()</span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._properties:mergeProperties(prop)</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._singlebuffer&nbsp;then</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("single&nbsp;buffer&nbsp;mode.")</span></Line>  <Line no="95" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._thebuffer&nbsp;=&nbsp;CdrBufferFactory:instance():createObject("ring_buffer")</span></Line>  <Line no="96" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(self._thebuffer,&nbsp;self._thebuffer.write)</span></Line>  <Line no="97" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;self._thebuffer&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="98" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("default&nbsp;buffer&nbsp;creation&nbsp;failed")</span></Line>  <Line no="99" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="101" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("multi&nbsp;buffer&nbsp;mode.")</span></Line>  <Line no="102" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="103" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="104" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="105" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="106" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initProviders()</span></Line>  <Line no="107" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initConsumers()</span></Line>  <Line no="108" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="109" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;num&nbsp;=&nbsp;tonumber(self._properties:getProperty("connection_limit","-1"))</span></Line>  <Line no="110" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;num&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="111" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("invalid&nbsp;connection_limit&nbsp;value:&nbsp;"..self._properties:getProperty("connection_limit"))</span></Line>  <Line no="112" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="113" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:setConnectionLimit(num)</span></Line>  <Line no="114" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="115" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスコンシューマ一覧初期化</span></Line>  <Line no="116" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;OutPortConsumerFactoryからサービスコンシューマ一覧を取得する</span></Line>  <Line no="117" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;「consumer_types」のプロパティが「all」の場合は、</span></Line>  <Line no="118" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスコンシューマを全て利用可能にする</span></Line>  <Line no="119" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:initConsumers()</span></Line>  <Line no="120" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("initConsumers()")</span></Line>  <Line no="121" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="122" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="123" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;factory&nbsp;=&nbsp;OutPortConsumerFactory:instance()</span></Line>  <Line no="124" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;consumer_types&nbsp;=&nbsp;factory:getIdentifiers()</span></Line>  <Line no="125" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="126" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_PARANOID("available&nbsp;InPortConsumer:&nbsp;"..StringUtil.flatten(consumer_types))</span></Line>  <Line no="127" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;tmp_str&nbsp;=&nbsp;StringUtil.normalize(self._properties:getProperty("consumer_types"))</span></Line>  <Line no="128" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;</span></Line>  <Line no="129" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._properties:hasKey("consumer_types")&nbsp;~=&nbsp;nil&nbsp;and&nbsp;tmp_str&nbsp;&nbsp;~=&nbsp;"all"&nbsp;then</span></Line>  <Line no="130" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("allowed&nbsp;consumers:&nbsp;"..self._properties:getProperty("consumer_types"))</span></Line>  <Line no="131" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="132" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;temp_types&nbsp;=&nbsp;consumer_types</span></Line>  <Line no="133" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;consumer_types&nbsp;=&nbsp;{}</span></Line>  <Line no="134" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;active_types&nbsp;=&nbsp;StringUtil.split(self._properties:getProperty("consumer_types"),&nbsp;",")</span></Line>  <Line no="135" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="136" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(temp_types)</span></Line>  <Line no="137" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(active_types)</span></Line>  <Line no="138" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="139" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;consumer_types&nbsp;=&nbsp;temp_types</span></Line>  <Line no="140" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="141" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;v&nbsp;in&nbsp;ipairs(active_types)&nbsp;do</span></Line>  <Line no="142" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;consumer_types[#consumer_types+1]&nbsp;=&nbsp;v</span></Line>  <Line no="143" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="144" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="145" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="146" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="147" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="148" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;#consumer_types&nbsp;&gt;&nbsp;0&nbsp;then</span></Line>  <Line no="149" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("dataflow_type&nbsp;pull&nbsp;is&nbsp;supported")</span></Line>  <Line no="150" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.dataflow_type",&nbsp;"pull")</span></Line>  <Line no="151" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;consumer_type&nbsp;in&nbsp;ipairs(consumer_types)&nbsp;do</span></Line>  <Line no="152" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.interface_type",consumer_type)</span></Line>  <Line no="153" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="154" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="155" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="156" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._consumerTypes&nbsp;=&nbsp;consumer_types</span></Line>  <Line no="157" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="158" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;利用可能なサービスプロバイダ一覧初期化</span></Line>  <Line no="159" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;InPortProviderFactoryからサービスプロバイダ一覧を取得する</span></Line>  <Line no="160" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;「provider_types」のプロパティが「all」の場合は、</span></Line>  <Line no="161" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスプロバイダを全て利用可能にする</span></Line>  <Line no="162" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:initProviders()</span></Line>  <Line no="163" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("initProviders()")</span></Line>  <Line no="164" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="165" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="166" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;factory&nbsp;=&nbsp;InPortProviderFactory:instance()</span></Line>  <Line no="167" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;provider_types&nbsp;&nbsp;=&nbsp;factory:getIdentifiers()</span></Line>  <Line no="168" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_PARANOID("available&nbsp;InPortProviders:&nbsp;"..StringUtil.flatten(provider_types))</span></Line>  <Line no="169" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;tmp_str&nbsp;=&nbsp;StringUtil.normalize(self._properties:getProperty("provider_types"))</span></Line>  <Line no="170" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._properties:hasKey("provider_types")&nbsp;and&nbsp;tmp_str&nbsp;&nbsp;~=&nbsp;"all"&nbsp;then</span></Line>  <Line no="171" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("allowed&nbsp;providers:&nbsp;"..self._properties:getProperty("allowed"))</span></Line>  <Line no="172" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="173" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;temp_types&nbsp;=&nbsp;provider_types</span></Line>  <Line no="174" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider_types&nbsp;=&nbsp;{}</span></Line>  <Line no="175" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;active_types&nbsp;=&nbsp;StringUtil.split(self._properties:getProperty("provider_types"),&nbsp;",")</span></Line>  <Line no="176" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="177" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(temp_types)</span></Line>  <Line no="178" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(active_types)</span></Line>  <Line no="179" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="180" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider_types&nbsp;=&nbsp;temp_types</span></Line>  <Line no="181" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="182" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;v&nbsp;in&nbsp;ipairs(active_types)&nbsp;do</span></Line>  <Line no="183" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;provider_types[#provider_types+1]&nbsp;=&nbsp;v</span></Line>  <Line no="184" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="185" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="186" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="187" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="188" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="189" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;#provider_types&nbsp;&gt;&nbsp;0&nbsp;then</span></Line>  <Line no="190" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("dataflow_type&nbsp;push&nbsp;is&nbsp;supported")</span></Line>  <Line no="191" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.dataflow_type",&nbsp;"push")</span></Line>  <Line no="192" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;provider_type&nbsp;in&nbsp;ipairs(provider_types)&nbsp;do</span></Line>  <Line no="193" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.interface_type",provider_type)</span></Line>  <Line no="194" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="195" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="196" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="197" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._providerTypes&nbsp;=&nbsp;provider_types</span></Line>  <Line no="198" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="199" valid="False" visited="False">	<span class="blockcomment">&nbsp;</span></Line>  <Line no="200" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;プロバイダの初期化してインターフェースをコネクタプロファイルに登録</span></Line>  <Line no="201" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;push型の場合はプロバイダを生成して、コネクタを生成する</span></Line>  <Line no="202" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="203" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイルの以下のノードからプロパティを取得</span></Line>  <Line no="204" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport</span></Line>  <Line no="205" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport.inport</span></Line>  <Line no="206" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="207" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_OK：正常終了</span></Line>  <Line no="208" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;BAD_PARAMETER：プロバイダの初期化失敗、不正なデータフロー型</span></Line>  <Line no="209" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_ERROR：コネクタ生成失敗</span></Line>  <Line no="210" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:publishInterfaces(cprof)</span></Line>  <Line no="211" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="212" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("publishInterfaces()")</span></Line>  <Line no="213" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="214" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="215" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;retval&nbsp;=&nbsp;self:_publishInterfaces()</span></Line>  <Line no="216" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;retval&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="217" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;retval</span></Line>  <Line no="218" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="219" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="220" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="221" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prop&nbsp;=&nbsp;Properties.new(self._properties)</span></Line>  <Line no="222" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="223" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;conn_prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="224" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;NVUtil.copyToProperties(conn_prop,&nbsp;cprof.properties)</span></Line>  <Line no="225" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport"))</span></Line>  <Line no="226" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="227" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="228" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport.inport"))</span></Line>  <Line no="229" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="230" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="231" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;dflow_type&nbsp;=&nbsp;prop:getProperty("dataflow_type")</span></Line>  <Line no="232" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;dflow_type&nbsp;=&nbsp;StringUtil.normalize(dflow_type)</span></Line>  <Line no="233" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="234" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;dflow_type&nbsp;==&nbsp;"push"&nbsp;then</span></Line>  <Line no="235" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("dataflow_type&nbsp;=&nbsp;push&nbsp;....&nbsp;create&nbsp;PushConnector")</span></Line>  <Line no="236" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="237" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="238" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;provider&nbsp;=&nbsp;self:createProvider(cprof,&nbsp;prop)</span></Line>  <Line no="239" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="240" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;provider&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="241" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("InPort&nbsp;provider&nbsp;creation&nbsp;failed.")</span></Line>  <Line no="242" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="243" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="244" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="245" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="246" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;connector&nbsp;=&nbsp;self:createConnector(cprof,&nbsp;prop,&nbsp;{provider_&nbsp;=&nbsp;provider})</span></Line>  <Line no="247" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="248" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;connector&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="249" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("PushConnector&nbsp;creation&nbsp;failed.")</span></Line>  <Line no="250" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="251" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="252" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(self._data_type)</span></Line>  <Line no="253" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;connector:setDataType(self._data_type)</span></Line>  <Line no="254" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider:setConnector(connector)</span></Line>  <Line no="255" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="256" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("publishInterfaces()&nbsp;successfully&nbsp;finished.")</span></Line>  <Line no="257" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="258" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="259" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;dflow_type&nbsp;==&nbsp;"pull"&nbsp;then</span></Line>  <Line no="260" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("dataflow_type&nbsp;=&nbsp;pull&nbsp;....&nbsp;do&nbsp;nothing")</span></Line>  <Line no="261" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="262" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="263" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="264" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_ERROR("unsupported&nbsp;dataflow_type")</span></Line>  <Line no="265" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="266" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="267" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="268" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="269" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイルからインターフェース取得</span></Line>  <Line no="270" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;pull型の場合はコンシューマ生成して、コネクタを生成する</span></Line>  <Line no="271" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="272" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイルの以下のノードからプロパティを取得</span></Line>  <Line no="273" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport</span></Line>  <Line no="274" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport.inport</span></Line>  <Line no="275" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="276" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_OK：正常終了</span></Line>  <Line no="277" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;BAD_PARAMETER：コンシューマ生成失敗、不正なデータフロー型</span></Line>  <Line no="278" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_ERROR：コネクタ生成失敗</span></Line>  <Line no="279" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:subscribeInterfaces(cprof)</span></Line>  <Line no="280" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("subscribeInterfaces()")</span></Line>  <Line no="281" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="282" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="283" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="284" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="285" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prop&nbsp;=&nbsp;Properties.new(self._properties)</span></Line>  <Line no="286" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="287" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;conn_prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="288" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="289" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;NVUtil.copyToProperties(conn_prop,&nbsp;cprof.properties)</span></Line>  <Line no="290" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(cprof.properties[1].value)</span></Line>  <Line no="291" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="292" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="293" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport"))</span></Line>  <Line no="294" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="295" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport.inport"))</span></Line>  <Line no="296" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="297" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="298" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="299" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;dflow_type&nbsp;=&nbsp;StringUtil.normalize(prop:getProperty("dataflow_type"))</span></Line>  <Line no="300" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;profile&nbsp;=&nbsp;ConnectorInfo.new(cprof.name,</span></Line>  <Line no="301" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cprof.connector_id,</span></Line>  <Line no="302" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORBA_SeqUtil.refToVstring(cprof.ports),</span></Line>  <Line no="303" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop)</span></Line>  <Line no="304" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(dflow_type)</span></Line>  <Line no="305" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;dflow_type&nbsp;==&nbsp;"push"&nbsp;then</span></Line>  <Line no="306" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="307" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;conn&nbsp;=&nbsp;self:getConnectorById(cprof.connector_id)</span></Line>  <Line no="308" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;conn&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="309" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("specified&nbsp;connector&nbsp;not&nbsp;found:&nbsp;"..cprof.connector_id)</span></Line>  <Line no="310" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="311" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="312" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="313" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;conn:setConnectorInfo(profile)</span></Line>  <Line no="314" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="315" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;ret&nbsp;==&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="316" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("subscribeInterfaces()&nbsp;successfully&nbsp;finished.")</span></Line>  <Line no="317" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="318" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;</span></Line>  <Line no="319" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="320" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("dataflow_type&nbsp;=&nbsp;push&nbsp;....&nbsp;create&nbsp;PushConnector")</span></Line>  <Line no="321" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="322" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="323" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;dflow_type&nbsp;==&nbsp;"pull"&nbsp;then</span></Line>  <Line no="324" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="325" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;consumer&nbsp;=&nbsp;self:createConsumer(cprof,&nbsp;prop)</span></Line>  <Line no="326" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(consumer)</span></Line>  <Line no="327" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;consumer&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="328" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="329" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="330" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="331" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="332" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;connector&nbsp;=&nbsp;self:createConnector(cprof,&nbsp;prop,&nbsp;{consumer_&nbsp;=&nbsp;consumer})</span></Line>  <Line no="333" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(connector)</span></Line>  <Line no="334" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="335" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="336" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;connector&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="337" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="338" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="339" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;connector:setDataType(self._data_type)</span></Line>  <Line no="340" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="341" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;connector:setConnectorInfo(profile)</span></Line>  <Line no="342" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;ret&nbsp;==&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="343" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("subscribeInterfaces()&nbsp;successfully&nbsp;finished.")</span></Line>  <Line no="344" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="345" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="346" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="347" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="348" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="349" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="350" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_ERROR("unsupported&nbsp;dataflow_type")</span></Line>  <Line no="351" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="352" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="353" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="354" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="355" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ生成</span></Line>  <Line no="356" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="357" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="358" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;args&nbsp;args.provider_：プロバイダ、args.consumer_：コンシューマ</span></Line>  <Line no="359" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;コネクタオブジェクト</span></Line>  <Line no="360" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:createConnector(cprof,&nbsp;prop,&nbsp;args)</span></Line>  <Line no="361" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;provider_&nbsp;=&nbsp;args.provider_</span></Line>  <Line no="362" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;consumer_&nbsp;=&nbsp;args.consumer_</span></Line>  <Line no="363" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;profile&nbsp;=&nbsp;ConnectorInfo.new(cprof.name,</span></Line>  <Line no="364" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cprof.connector_id,</span></Line>  <Line no="365" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORBA_SeqUtil.refToVstring(cprof.ports),</span></Line>  <Line no="366" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop)</span></Line>  <Line no="367" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;connector&nbsp;=&nbsp;nil</span></Line>  <Line no="368" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="369" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;nil</span></Line>  <Line no="370" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="371" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="372" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;provider_&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="373" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._singlebuffer&nbsp;then</span></Line>  <Line no="374" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--print(self._thebuffer)</span></Line>  <Line no="375" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector&nbsp;=&nbsp;InPortPushConnector.new(profile,&nbsp;provider_,</span></Line>  <Line no="376" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._listeners,</span></Line>  <Line no="377" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._thebuffer)</span></Line>  <Line no="378" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="379" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector&nbsp;=&nbsp;InPortPushConnector.new(profile,&nbsp;provider_,</span></Line>  <Line no="380" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._listeners)</span></Line>  <Line no="381" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="382" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="383" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;consumer_&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="384" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._singlebuffer&nbsp;then</span></Line>  <Line no="385" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector&nbsp;=&nbsp;InPortPullConnector.new(profile,&nbsp;consumer_,</span></Line>  <Line no="386" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._listeners,</span></Line>  <Line no="387" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._thebuffer)</span></Line>  <Line no="388" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="389" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector&nbsp;=&nbsp;InPortPullConnector.new(profile,&nbsp;consumer_,</span></Line>  <Line no="390" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._listeners)</span></Line>  <Line no="391" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="392" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="393" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="394" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("provider&nbsp;or&nbsp;consumer&nbsp;is&nbsp;not&nbsp;passed.&nbsp;returned&nbsp;0;")</span></Line>  <Line no="395" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;nil</span></Line>  <Line no="396" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="397" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="398" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="399" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="400" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="401" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="402" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;provider_&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="403" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_TRACE("InPortPushConnector&nbsp;created")</span></Line>  <Line no="404" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;elseif&nbsp;consumer_&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="405" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_TRACE("InPortPullConnector&nbsp;created")</span></Line>  <Line no="406" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="407" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="408" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="409" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;table.insert(self._connectors,&nbsp;connector)</span></Line>  <Line no="410" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("connector&nbsp;push&nbsp;backed:&nbsp;"..#self._connectors)</span></Line>  <Line no="411" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;connector</span></Line>  <Line no="412" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="413" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="414" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;success&nbsp;then</span></Line>  <Line no="415" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("InPortPushConnector&nbsp;creation&nbsp;failed")</span></Line>  <Line no="416" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR(exception)</span></Line>  <Line no="417" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="418" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="419" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="420" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="421" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="422" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="423" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="424" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="425" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;サービスプロバイダ作成</span></Line>  <Line no="426" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;「interface_type」の要素にインターフェース型を指定</span></Line>  <Line no="427" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;「provider」のノードにプロバイダのプロパティを指定</span></Line>  <Line no="428" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="429" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="430" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロバイダ</span></Line>  <Line no="431" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:createProvider(cprof,&nbsp;prop)</span></Line>  <Line no="432" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;prop:getProperty("interface_type")&nbsp;==&nbsp;""&nbsp;or</span></Line>  <Line no="433" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;not&nbsp;StringUtil.includes(self._providerTypes,&nbsp;prop:getProperty("interface_type"))&nbsp;then</span></Line>  <Line no="434" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("no&nbsp;provider&nbsp;found")</span></Line>  <Line no="435" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("interface_type:&nbsp;&nbsp;"..prop:getProperty("interface_type"))</span></Line>  <Line no="436" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("interface_types:&nbsp;"..StringUtil.flatten(self._providerTypes))</span></Line>  <Line no="437" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="438" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="439" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="440" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="441" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_DEBUG("interface_type:&nbsp;"..prop:getProperty("interface_type"))</span></Line>  <Line no="442" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;provider&nbsp;=&nbsp;InPortProviderFactory:instance():createObject(prop:getProperty("interface_type"))</span></Line>  <Line no="443" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="444" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="445" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;provider&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="446" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("provider&nbsp;created")</span></Line>  <Line no="447" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider:init(prop:getNode("provider"))</span></Line>  <Line no="448" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="449" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;provider:publishInterface(cprof.properties)&nbsp;then</span></Line>  <Line no="450" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("publishing&nbsp;interface&nbsp;information&nbsp;error")</span></Line>  <Line no="451" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;InPortProviderFactory:instance():deleteObject(provider)</span></Line>  <Line no="452" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="453" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="454" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--[[for&nbsp;i,v&nbsp;in&nbsp;ipairs(cprof.properties)&nbsp;do</span></Line>  <Line no="455" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(v.name,v.value)</span></Line>  <Line no="456" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;v.value&nbsp;=&nbsp;NVUtil.any_from_any(v.value)</span></Line>  <Line no="457" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end]]</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">provider</span></Line>  <Line no="459" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="460" valid="False" visited="False"/>  <Line no="461" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"provider creation failed"</span><span class="misc">)</span></Line>  <Line no="462" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="464" valid="False" visited="False"/>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスコンシューマ作成</span></Line>  <Line no="466" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「interface_type」の要素にインターフェース型を指定</span></Line>  <Line no="468" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「consumer」のノードにコンシューマのプロパティを指定</span></Line>  <Line no="469" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="470" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンシューマ</span></Line>  <Line no="471" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createConsumer</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="472" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">or</span></Line>  <Line no="473" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.includes</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="474" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"no consumer found"</span><span class="misc">)</span></Line>  <Line no="475" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type:  "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="476" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_types: "</span><span class="operator">..</span></Line>  <Line no="477" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="479" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="480" valid="False" visited="False"/>  <Line no="481" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type: "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="483" valid="False" visited="False"/>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"consumer created"</span><span class="misc">)</span></Line>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"consumer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="487" valid="False" visited="False"/>  <Line no="488" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">cprof.properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="489" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"interface subscription failed."</span><span class="misc">)</span></Line>  <Line no="490" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="491" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="494" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="495" valid="False" visited="False"/>  <Line no="496" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"consumer creation failed"</span><span class="misc">)</span></Line>  <Line no="497" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="498" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="499" valid="False" visited="False"/>  <Line no="500" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IDからコネクタを取得</span></Line>  <Line no="501" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="502" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタ</span></Line>  <Line no="503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getConnectorById</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getConnectorById(id = "</span><span class="operator">..</span><span class="identifier">id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="505" valid="False" visited="False"/>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="507" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="508" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">con</span></Line>  <Line no="509" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="510" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="511" valid="False" visited="False"/>  <Line no="512" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"ConnectorProfile with the id("</span><span class="operator">..</span><span class="identifier">id..</span><span class="string">") not found."</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="515" valid="False" visited="False"/>  <Line no="516" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定コネクタプロファイルのコネクタを削除</span></Line>  <Line no="517" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="518" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="519" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeInterfaces()"</span><span class="misc">)</span></Line>  <Line no="520" valid="False" visited="False"/>  <Line no="521" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.connector_id</span></Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"connector_id: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="523" valid="False" visited="False"/>  <Line no="524" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="526" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="527" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="528" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._connectors</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="529" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"delete connector: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="531" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="532" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="533" valid="False" visited="False"/>  <Line no="534" valid="False" visited="False"/>  <Line no="535" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"specified connector not found: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="537" valid="False" visited="False"/>  <Line no="538" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースのアクティブ化</span></Line>  <Line no="539" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="540" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="541" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="542" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"activate connector: "</span><span class="operator">..</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="545" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="547" valid="False" visited="False"/>  <Line no="548" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースの非アクティブ化</span></Line>  <Line no="549" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="550" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"deactivateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="551" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"deactivate connector: "</span><span class="operator">..</span></Line>  <Line no="554" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="555" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="556" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="557" valid="False" visited="False"/>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConnectorDataListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="560" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="561" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="562" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorDataListener()"</span><span class="misc">)</span></Line>  <Line no="563" valid="False" visited="False"/>  <Line no="564" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="565" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="566" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="567" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="568" valid="False" visited="False"/>  <Line no="569" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addConnectorDataListener(): Invalid listener type."</span><span class="misc">)</span></Line>  <Line no="570" valid="False" visited="False"/>  <Line no="571" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="572" valid="False" visited="False"/>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConnectorDataListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="574" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorDataListener()"</span><span class="misc">)</span></Line>  <Line no="575" valid="False" visited="False"/>  <Line no="576" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="577" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="578" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="579" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="580" valid="False" visited="False"/>  <Line no="581" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"removeConnectorDataListener(): Invalid listener type."</span><span class="misc">)</span></Line>  <Line no="582" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="583" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="584" valid="False" visited="False"/>  <Line no="585" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConnectorListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="586" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="587" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="588" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="589" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorListener()"</span><span class="misc">)</span></Line>  <Line no="590" valid="False" visited="False"/>  <Line no="591" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorListenerType.CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="592" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="594" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="595" valid="False" visited="False"/>  <Line no="596" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addConnectorListener(): Invalid listener type."</span><span class="misc">)</span></Line>  <Line no="597" valid="False" visited="False"/>  <Line no="598" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="599" valid="False" visited="False"/>  <Line no="600" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConnectorListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="601" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorListener()"</span><span class="misc">)</span></Line>  <Line no="602" valid="False" visited="False"/>  <Line no="603" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorListenerType.CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="604" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="605" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="606" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="607" valid="False" visited="False"/>  <Line no="608" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"removeConnectorListener(): Invalid listener type."</span><span class="misc">)</span></Line>  <Line no="609" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="610" valid="False" visited="False"/>  <Line no="611" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="612" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="613" valid="False" visited="False"/>  <Line no="614" valid="False" visited="False"/>  <Line no="615" valid="False" visited="False"/>  <Line no="616" valid="False" visited="False"/>  <Line no="617" valid="False" visited="False"/>  <Line no="618" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortBase</span></Line>  <FileSummary valid="336" visited="253" totalLines="618" coverage="75"/> </File> <File name="lua\openrtm\InPortConnector.lua" anchor="lua_openrtm_InPortConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortConnectorBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief InPortコネクタ基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortConnectorBase"] = InPortConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorBase"</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="identifier">InPortConnector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False">	<span class="comment">-- InPortコネクタ基底オブジェクト初期化</span></Line>  <Line no="18" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @return InPortコネクタ</span></Line>  <Line no="21" valid="False" visited="False">	<span class="identifier">InPortConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ConnectorBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"InPortConnector"</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">buffer</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dataType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._endian</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"profile()"</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタID取得</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタID</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"id() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ名取得</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタ名</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"name() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ取得</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getBuffer</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._data：データ格納オブジェクト</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル設定</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile プロファイル</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConnectorInfo</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">profile</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ型設定</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ型</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataType</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._dataType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._dataType)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="79" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortConnector</span></Line>  <FileSummary valid="43" visited="41" totalLines="82" coverage="95"/> </File> <File name="lua\openrtm\InPortConsumer.lua" anchor="lua_openrtm_InPortConsumer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortConsumer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief InPortコンシューマと生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! Push型通信の独自インターフェース型を実装する場合は、</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! InPortConsumerをメタテーブルに設定したコンシューマオブジェクトを生成する</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConsumer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortConsumer"] = InPortConsumer</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- InPortコンシューマオブジェクト初期化</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @return InPortコンシューマオブジェクト</span></Line>  <Line no="20" valid="False" visited="False">	<span class="identifier">InPortConsumer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.subscribe</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマのインターフェース追加関数オブジェクト初期化</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="25" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return インターフェース追加関数オブジェクト</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.subscribe.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース追加関数</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">self._prop</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.unsubscribe</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマのインターフェース削除関数オブジェクト初期化</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return インターフェース削除オブジェクト</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.unsubscribe.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース削除関数</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">unsubscribeInterface</span><span class="misc">(</span><span class="identifier">self._prop</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="55" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="56" valid="False" visited="False"/>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="True" visited="True">	<span class="identifier">InPortConsumer.InPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="59" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">InPortConsumer.InPortConsumerFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">InPortConsumer.InPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="63" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortConsumer</span></Line>  <FileSummary valid="30" visited="18" totalLines="66" coverage="60"/> </File> <File name="lua\openrtm\InPortDSConsumer.lua" anchor="lua_openrtm_InPortDSConsumer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortDSConsumer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CorbaCdrインターフェースで通信するInPortConsumer定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! 「data_service」のインターフェース型で利用可能</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! RTC.idlのPortServiceインターフェース</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortDSConsumer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortDSConsumer"] = InPortDSConsumer</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortConsumer"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CorbaConsumer"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortConsumer.InPortConsumerFactory</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="False" visited="False">	<span class="comment">-- CorbaCdrインターフェースのInPortConsumerオブジェクト初期化</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @return CorbaCdrインターフェースのInPortConsumerオブジェクト</span></Line>  <Line no="30" valid="False" visited="False">	<span class="identifier">InPortDSConsumer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">InPortConsumer.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">CorbaConsumer.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"InPortDSConsumer"</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._PortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::PortStatus"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティ設定</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"init()"</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ送信</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data 送信データ</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：putオペレーションが正常終了</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- CONNECTION_LOST：通信失敗</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"put()"</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">inportcdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">inportcdr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.getPortStatus_RTC</span><span class="misc">(</span><span class="identifier">inportcdr</span><span class="misc">:</span><span class="identifier">push</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">convertReturnCode</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="62" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="66" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティにインターフェース情報追加</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterfaceProfile</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティからインターフェース情報取得</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスの設定</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ior</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ref</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeInterface()"</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">subscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">subscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティからインターフェース設定解除</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列、もしくはリファレンスを取得</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ior</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ref</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterface</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeInterface()"</span><span class="misc">)</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unsubscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unsubscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンス設定</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からIOR文字列取得</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ior</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeFromIor()"</span><span class="misc">)</span></Line>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.inport_ior"</span><span class="misc">)</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(index)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"inport_ior not found"</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"inport_ior has no string"</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">,</span><span class="string">"IDL:omg.org/RTC/DataPushService:1.0"</span><span class="misc">)</span></Line>  <Line no="137" valid="False" visited="False"/>  <Line no="138" valid="False" visited="False"/>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"invalid IOR string has been passed"</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="145" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Setting object to consumer failed."</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="148" valid="False" visited="False"/>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="False" visited="False"/>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="False" visited="False"/>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトからオブジェクトリファレンス設定</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からリファレンスを取得</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ref</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeFromRef()"</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.inport_ref"</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"inport_ref not found"</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="False" visited="False"/>  <Line no="168" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="171" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span><span class="misc">:</span><span class="identifier">narrow</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/DataPushService:1.0"</span><span class="misc">)</span></Line>  <Line no="174" valid="False" visited="False"/>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"prop[inport_ref] is not objref"</span><span class="misc">)</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="False" visited="False"/>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Setting object to consumer failed."</span><span class="misc">)</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="189" valid="False" visited="False"/>  <Line no="190" valid="False" visited="False"/>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンス設定解除</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からIOR文字列取得</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ior</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定解除成功、false：設定解除失敗</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeFromIor()"</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.inport_ior"</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"inport_ior not found"</span><span class="misc">)</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="204" valid="False" visited="False"/>  <Line no="205" valid="False" visited="False"/>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="207" valid="False" visited="False"/>  <Line no="208" valid="False" visited="False"/>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"prop[inport_ior] is not string"</span><span class="misc">)</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="212" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="False" visited="False"/>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">,</span><span class="string">"IDL:omg.org/RTC/DataPushService:1.0"</span><span class="misc">)</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">var.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="218" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"connector property inconsistency"</span><span class="misc">)</span></Line>  <Line no="219" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="220" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="221" valid="False" visited="False"/>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="False" visited="False"/>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトからオブジェクトリファレンス設定解除</span></Line>  <Line no="227" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からリファレンスを取得</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.inport_ref</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定解除成功、false：設定解除失敗</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeFromRef()"</span><span class="misc">)</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.inport_ref"</span><span class="misc">)</span></Line>  <Line no="235" valid="False" visited="False"/>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="239" valid="False" visited="False"/>  <Line no="240" valid="False" visited="False"/>  <Line no="241" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="242" valid="False" visited="False"/>  <Line no="243" valid="False" visited="False"/>  <Line no="244" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="245" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="247" valid="False" visited="False"/>  <Line no="248" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_ptr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span></Line>  <Line no="249" valid="False" visited="False"/>  <Line no="250" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_ptr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">obj_ptr</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj_ptr.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="252" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="253" valid="False" visited="False"/>  <Line no="254" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="255" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="257" valid="False" visited="False"/>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC::PortStatusをデータポートステータスに変換</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">convertReturnCode</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="260" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="263" valid="False" visited="False"/>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="266" valid="False" visited="False"/>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_FULL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.SEND_FULL</span></Line>  <Line no="269" valid="False" visited="False"/>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.SEND_TIMEOUT</span></Line>  <Line no="272" valid="False" visited="False"/>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span></Line>  <Line no="275" valid="False" visited="False"/>  <Line no="276" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="277" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span></Line>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="280" valid="False" visited="False"/>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="282" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="283" valid="False" visited="False"/>  <Line no="284" valid="False" visited="False">	<span class="comment">-- InPortDSConsumer生成ファクトリ登録関数</span></Line>  <Line no="285" valid="False" visited="False">	<span class="identifier">InPortDSConsumer.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">InPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"data_service"</span><span class="misc">,</span></Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">InPortDSConsumer.new</span><span class="misc">,</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="289" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="290" valid="False" visited="False"/>  <Line no="291" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortDSConsumer</span></Line>  <FileSummary valid="151" visited="120" totalLines="291" coverage="79"/> </File> <File name="lua\openrtm\InPortDSProvider.lua" anchor="lua_openrtm_InPortDSProvider_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortDSProvider.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CorbaCdrインターフェースで通信するInPortProvider定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! 「data_service」のインターフェース型で利用可能</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! RTC.idlのPortServiceインターフェース</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="12" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortDSProvider=&nbsp;{}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.InPortDSProvider"]&nbsp;=&nbsp;InPortDSProvider</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="15" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="16" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;oil&nbsp;=&nbsp;require&nbsp;"oil"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortProvider&nbsp;=&nbsp;require&nbsp;"openrtm.InPortProvider"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NVUtil&nbsp;=&nbsp;require&nbsp;"openrtm.NVUtil"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">local&nbsp;BufferStatus&nbsp;=&nbsp;require&nbsp;"openrtm.BufferStatus"</span></Line>  <Line no="21" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Factory&nbsp;=&nbsp;require&nbsp;"openrtm.Factory"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortProviderFactory&nbsp;=&nbsp;InPortProvider.InPortProviderFactory</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">local&nbsp;RTCUtil&nbsp;=&nbsp;require&nbsp;"openrtm.RTCUtil"</span></Line>  <Line no="25" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener&nbsp;=&nbsp;require&nbsp;"openrtm.ConnectorListener"</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorDataListenerType&nbsp;=&nbsp;ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="28" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="29" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="30" valid="False" visited="False">	<span class="blockcomment">--&nbsp;CorbaCdrインターフェースのInPortProviderオブジェクト初期化</span></Line>  <Line no="31" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;CorbaCdrインターフェースのInPortProviderオブジェクト</span></Line>  <Line no="32" valid="False" visited="False">	<span class="blockcomment">InPortDSProvider.new&nbsp;=&nbsp;function()</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="34" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(InPortProvider.new)</span></Line>  <Line no="35" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__index=InPortProvider.new()})</span></Line>  <Line no="36" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="37" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._PortStatus&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::PortStatus").labelvalue</span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:setInterfaceType("data_service")</span></Line>  <Line no="39" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="40" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;orb&nbsp;=&nbsp;Manager:instance():getORB()</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._svr&nbsp;=&nbsp;orb:newservant(obj,&nbsp;nil,&nbsp;"IDL:omg.org/RTC/DataPushService:1.0")</span></Line>  <Line no="42" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;str&nbsp;=&nbsp;orb:tostring(obj._svr)</span></Line>  <Line no="43" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._objref&nbsp;=&nbsp;RTCUtil.getReference(orb,&nbsp;obj._svr,&nbsp;"IDL:omg.org/RTC/DataPushService:1.0")</span></Line>  <Line no="44" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="45" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="47" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._buffer&nbsp;=&nbsp;nil</span></Line>  <Line no="48" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="49" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._profile&nbsp;=&nbsp;nil</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._listeners&nbsp;=&nbsp;nil</span></Line>  <Line no="51" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="53" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;table.insert(obj._properties,&nbsp;NVUtil.newNV("dataport.data_service.inport_ior",</span></Line>  <Line no="55" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str))</span></Line>  <Line no="56" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--table.insert(obj._properties,&nbsp;NVUtil.newNV("dataport.data_service.inport_ref",</span></Line>  <Line no="57" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj._objref))</span></Line>  <Line no="58" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(obj._properties)</span></Line>  <Line no="59" valid="False" visited="False">	<span class="blockcomment">&nbsp;--for&nbsp;i,v&nbsp;in&nbsp;ipairs(obj._properties)&nbsp;do</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;print(i,v)</span></Line>  <Line no="61" valid="False" visited="False">	<span class="blockcomment">&nbsp;--end</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="63" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;終了処理</span></Line>  <Line no="64" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:exit()</span></Line>  <Line no="65" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;Manager:instance():getORB():deactivate(self._svr)</span></Line>  <Line no="66" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;初期化時にプロパティ設定</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:init(prop)</span></Line>  <Line no="70" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="71" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;バッファ設定</span></Line>  <Line no="72" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;@param&nbsp;buffer&nbsp;バッファ</span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setBuffer(buffer)</span></Line>  <Line no="74" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._buffer&nbsp;=&nbsp;buffer</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="76" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コールバック関数設定</span></Line>  <Line no="77" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;info&nbsp;プロファイル</span></Line>  <Line no="78" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;listeners&nbsp;コールバック関数</span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setListener(info,&nbsp;listeners)</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._profile&nbsp;=&nbsp;info</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._listeners&nbsp;=&nbsp;listeners</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="83" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;データ書き込み</span></Line>  <Line no="84" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;@param&nbsp;data&nbsp;データ</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="86" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;PORT_OK：正常終了</span></Line>  <Line no="87" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;PORT_ERROR：バッファがない</span></Line>  <Line no="88" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;UNKNOWN_ERROR：復号化失敗など、その他のエラー</span></Line>  <Line no="89" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;その他、バッファフル、タイムアウト等の戻り値</span></Line>  <Line no="90" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:push(data)</span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print("put")</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;status&nbsp;=&nbsp;self._PortStatus.PORT_OK</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="94" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="95" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("InPortDSProvider.put()")</span></Line>  <Line no="96" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--[[</span></Line>  <Line no="98" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._buffer&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="99" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self:onReceiverError(data)</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._PortStatus.PORT_ERROR</span></Line>  <Line no="101" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="102" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--]]</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"received data size: "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="105" valid="False" visited="False"/>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._connector)</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._connector</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span></Line>  <Line no="110" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test,",data)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._connector</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">status</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファステータスをOpenRTM::PortStatusに変換</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--コールバック呼び出し</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param status バッファステータス</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ポートステータス</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">status</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferWrite</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span></Line>  <Line no="133" valid="False" visited="False"/>  <Line no="134" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="135" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span></Line>  <Line no="137" valid="False" visited="False"/>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_FULL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="139" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_FULL</span></Line>  <Line no="142" valid="False" visited="False"/>  <Line no="143" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_EMPTY</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_EMPTY</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span></Line>  <Line no="149" valid="False" visited="False"/>  <Line no="150" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="151" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferWriteTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="152" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_TIMEOUT</span></Line>  <Line no="154" valid="False" visited="False"/>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="156" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ書き込み時コールバック</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferWrite</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_WRITE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファフル時コールバック</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="171" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_FULL</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ書き込みタイムアウト時コールバック</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferWriteTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_WRITE_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ上書き時コールバック</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferWriteOverwrite</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_OVERWRITE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 受信時コールバック</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 受信バッファフル時コールバック</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="199" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_FULL</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 受信タイムアウト時コールバック</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="206" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="207" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 受信エラー時コールバック</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="212" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="213" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="214" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="217" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="220" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="221" valid="False" visited="False"/>  <Line no="222" valid="False" visited="False">	<span class="comment">-- InPortDSProvider生成ファクトリ登録関数</span></Line>  <Line no="223" valid="False" visited="False">	<span class="identifier">InPortDSProvider.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">InPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"data_service"</span><span class="misc">,</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">InPortDSProvider.new</span><span class="misc">,</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="228" valid="False" visited="False"/>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortDSProvider</span></Line>  <FileSummary valid="118" visited="83" totalLines="230" coverage="70"/> </File> <File name="lua\openrtm\InPortProvider.lua" anchor="lua_openrtm_InPortProvider_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortProvider.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief InPortプロバイダと生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! Push型通信の独自インターフェース型を実装する場合は、</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! InPortProviderをメタテーブルに設定したプロバイダオブジェクトを生成する</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortProvider</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortProvider"] = InPortProvider</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- InPortプロバイダ初期化</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @return InPortProvider</span></Line>  <Line no="24" valid="False" visited="False">	<span class="identifier">InPortProvider.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._interfaceType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dataflowType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._subscriptionType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"InPortProvider"</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了関数</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルにインターフェース型を設定</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterfaceProfile</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterfaceProfile()"</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.appendStringValue</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="string">"dataport.interface_type"</span><span class="misc">,</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.append</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルに各種設定を行う</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterface</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterface()"</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil.isStringValue</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.interface_type"</span><span class="misc">,</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="52" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i,v in ipairs(self._properties) do</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(i,v)</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.append</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース型の設定</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param interface_type インターフェース型</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInterfaceType</span><span class="misc">(</span><span class="identifier">interface_type</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setInterfaceType("</span><span class="operator">..</span><span class="identifier">interface_type..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">interface_type</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データフロー型の設定</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param dataflow_type データフロー型</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataFlowType</span><span class="misc">(</span><span class="identifier">dataflow_type</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setDataFlowType("</span><span class="operator">..</span><span class="identifier">dataflow_type..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._dataflowType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dataflow_type</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サブスクリプション型の設定</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param subs_type サブスクリプション型</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setSubscriptionType</span><span class="misc">(</span><span class="identifier">subs_type</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setSubscriptionType("</span><span class="operator">..</span><span class="identifier">subs_type..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._subscriptionType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">subs_type</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ設定</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector コネクタ</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConnector</span><span class="misc">(</span><span class="identifier">connector</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False"/>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="86" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="True" visited="True">	<span class="identifier">InPortProvider.InPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="89" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">InPortProvider.InPortProviderFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">InPortProvider.InPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="93" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortProvider</span></Line>  <FileSummary valid="52" visited="51" totalLines="96" coverage="98"/> </File> <File name="lua\openrtm\InPortPullConnector.lua" anchor="lua_openrtm_InPortPullConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortPullConnector.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief Pull型通信InPortConnector定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortPullConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortPullConnector"] = InPortPullConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConnector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortConnector"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CdrBufferBase"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferBase.CdrBufferFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortConsumer"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortConsumer.OutPortConsumerFactory</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="23" valid="False" visited="False"/>  <Line no="24" valid="False" visited="False">	<span class="comment">-- Pull型通信InPortConnectorの初期化</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- 「buffer」という要素名にバッファの設定を格納</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @param listeners コールバック</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- 指定しない場合はリングバッファを生成する</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @return Pull型通信InPortConnector</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">InPortPullConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">InPortConnector.new</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="35" valid="False" visited="False"/>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._dataにデータを格納</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PORT_OK：get関数がPORT_OKを返す</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PORT_ERROR：コンシューマがnil、データ型が不明</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"InPortPullConnector.read()"</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._dataType)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._dataType</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">_data</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._consumer</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">cdr_data</span><span class="misc">)</span></Line>  <Line no="56" valid="False" visited="False"/>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">data._data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">cdrUnmarshal</span><span class="misc">(</span><span class="identifier">cdr_data._data</span><span class="misc">,</span>&nbsp;<span class="identifier">self._dataType</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="False" visited="False"/>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect()"</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._consumer</span><span class="misc">)</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ作成</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リングバッファを生成する</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile コネクタプロファイル</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">buf_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">profile.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"buffer_type"</span><span class="misc">,</span><span class="string">"ring_buffer"</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">buf_type</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ接続時のコールバック呼び出し</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_CONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断時のコールバック呼び出し</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_DISCONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="109" valid="False" visited="False"/>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="115" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">obj._profile</span><span class="misc">)</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj._consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"buffer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">obj._buffer</span><span class="misc">)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._listeners</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="128" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="False" visited="False"/>  <Line no="131" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortPullConnector</span></Line>  <FileSummary valid="62" visited="58" totalLines="131" coverage="93"/> </File> <File name="lua\openrtm\InPortPushConnector.lua" anchor="lua_openrtm_InPortPushConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file InPortPushConnector.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief Push型通信InPortConnector定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortPushConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.InPortPushConnector"] = InPortPushConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConnector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortConnector"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortProvider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortProvider"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortProvider.InPortProviderFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CdrBufferBase"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferBase.CdrBufferFactory</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorDataListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False">	<span class="comment">-- Push型通信InPortConnectorの初期化</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- 「buffer」という要素名にバッファの設定を格納</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param provider プロバイダ</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- @param listeners コールバック</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="32" valid="False" visited="False">	<span class="comment">-- 指定しない場合はリングバッファを生成する</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- @return Push型通信InPortConnector</span></Line>  <Line no="34" valid="False" visited="False">	<span class="identifier">InPortPushConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(buffer)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">InPortConnector.new</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="False" visited="False"/>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._dataにデータを格納</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファの読み込み結果によって、PORT_OK、BUFFER_EMPTY、BUFFER_TIMEOUT</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PRECONDITION_NOT_MET、PORT_ERRORを返す</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"read()"</span><span class="misc">)</span></Line>  <Line no="47" valid="False" visited="False"/>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">_data</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">)</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._dataType</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="56" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">data._data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">cdrUnmarshal</span><span class="misc">(</span><span class="identifier">cdr._data</span><span class="misc">,</span>&nbsp;<span class="identifier">self._dataType</span><span class="misc">)</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferRead</span><span class="misc">(</span><span class="identifier">cdr._data</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="67" valid="False" visited="False"/>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_EMPTY</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_EMPTY</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="73" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferReadTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_TIMEOUT</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="77" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect()"</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._provider</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cfactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cfactory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._provider</span><span class="misc">)</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._provider</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._deleteBuffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">bfactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">bfactory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._buffer</span><span class="misc">)</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ作成</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リングバッファを生成する</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile コネクタプロファイル</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">buf_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">profile.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"buffer_type"</span><span class="misc">,</span><span class="string">"ring_buffer"</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">buf_type</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ(CDR)</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード(バッファの書き込み結果による)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._dataType)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("write")</span></Line>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_data.data)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ接続時のコールバック呼び出し</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("onConnect")</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_CONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="False" visited="False"/>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断時のコールバック呼び出し</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_DISCONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferRead</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_READ</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="156" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_BUFFER_EMPTY</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferReadTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="162" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="163" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_BUFFER_READ_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">provider</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(buffer)</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">buffer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._deleteBuffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="174" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._deleteBuffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="False" visited="False"/>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="179" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="False" visited="False"/>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj._provider</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"buffer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">obj._buffer</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._listeners</span><span class="misc">)</span></Line>  <Line no="191" valid="False" visited="False"/>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="194" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="195" valid="False" visited="False"/>  <Line no="196" valid="False" visited="False"/>  <Line no="197" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">InPortPushConnector</span></Line>  <FileSummary valid="100" visited="80" totalLines="197" coverage="80"/> </File> <File name="lua\openrtm\ListenerHolder.lua" anchor="lua_openrtm_ListenerHolder_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ListenerHolder.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief リスナ保持クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ListenerHolder</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ListenerHolder"] = ListenerHolder</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Entry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="14" valid="False" visited="False">	<span class="identifier">Entry.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="15" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="16" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.listener</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="17" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">autoclean</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="identifier">ListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">func</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">[</span><span class="identifier">func</span><span class="misc">]</span><span class="misc">(</span><span class="identifier">listener.listener</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="44" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ListenerHolder</span></Line>  <FileSummary valid="26" visited="25" totalLines="47" coverage="96"/> </File> <File name="lua\openrtm\LogstreamBase.lua" anchor="lua_openrtm_LogstreamBase_lua">  <PerfectCoverage/>   <FileSummary valid="20" visited="20" totalLines="53" coverage="100"/> </File> <File name="lua\openrtm\LogstreamFile.lua" anchor="lua_openrtm_LogstreamFile_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file LogstreamFile.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ファイル出力ロガーストリーム定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">LogstreamBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.LogstreamBase"</span></Line>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">LogstreamFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">LogstreamBase.LogstreamFactory</span></Line>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Logger</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.SystemLogger"</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">LogstreamFile</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- LogstreamFile.s_logger = nil</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">--_G["openrtm.LogstreamFile"] = LogstreamFile</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- ファイル出力ロガーストリームオブジェクト初期化</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @return </span></Line>  <Line no="24" valid="False" visited="False">	<span class="identifier">LogstreamFile.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">LogstreamBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.handlers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティを設定</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「file_name」の要素にファイル名</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「,」で区切る</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「stdout」に設定した場合は標準出力</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 登録したロガーの数が0の場合はfalse</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.logger = require"logging.console"</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if LogstreamFile.s_logger == nil then</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	LogstreamFile.s_logger = self</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">files</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"file_name"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">files</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">addHandler</span><span class="misc">(</span><span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.getKeyCount</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロガーの登録</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param f ファイル名</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「stdout」の場合は標準出力</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 既に登録済みの場合はfalse</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 空文字列の場合はfalse</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addHandler</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="65" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">k</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">f</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="66" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="67" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.normalize</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"stdout"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">require</span>&nbsp;<span class="string">"logging.console"</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.handlers</span><span class="misc">[</span><span class="identifier">fname</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">logging.console</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">require</span>&nbsp;<span class="string">"logging.file"</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.handlers</span><span class="misc">[</span><span class="identifier">fname</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">logging.file</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力文字列</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param level ログレベル</span></Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ロガー名</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：出力成功、false：出力失敗</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 設定できないログレベルの場合はfalse</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="identifier">level</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.FATAL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">fatal</span><span class="misc">(</span><span class="identifier">name..msg</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="library">error</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.WARN</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">warn</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.INFO</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">info</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.DEBUG</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">debug</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.TRACE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">debug</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.VERBOSE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">debug</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.PARANOID</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">debug</span><span class="misc">(</span><span class="identifier">name..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログレベル設定</span></Line>  <Line no="130" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param level ログレベル</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setLogLevel</span><span class="misc">(</span><span class="identifier">level</span><span class="misc">)</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.INFO</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.INFO</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.FATAL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.FATAL</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.ERROR</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.WARN</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.WARN</span><span class="misc">)</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.DEBUG</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.DEBUG</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.SILENT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.DEBUG</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.TRACE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.DEBUG</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.VERBOSE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.DEBUG</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">level</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">Logger.PARANOID</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.DEBUG</span><span class="misc">)</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self.handlers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLevel</span><span class="misc">(</span><span class="identifier">logging.INFO</span><span class="misc">)</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロガー終了</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true；成功、false：失敗</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.handlers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--function obj:getLogger(name)</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	if name ~= nil then</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--		logging.getLogger("file."+name)</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	else</span></Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--		logging.getLogger("file."+name)</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	end</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="190" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="192" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="False" visited="False"/>  <Line no="195" valid="False" visited="False">	<span class="comment">-- ファイル出力ロガー生成ファクトリ登録</span></Line>  <Line no="196" valid="False" visited="False">	<span class="identifier">LogstreamFile.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">LogstreamFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"file"</span><span class="misc">,</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">LogstreamFile.new</span><span class="misc">,</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="201" valid="False" visited="False"/>  <Line no="202" valid="False" visited="False"/>  <Line no="203" valid="False" visited="False"/>  <Line no="204" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">LogstreamFile</span></Line>  <FileSummary valid="121" visited="116" totalLines="204" coverage="95"/> </File> <File name="lua\openrtm\Manager.lua" anchor="lua_openrtm_Manager_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file Manager.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTC管理マネージャ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! ORB初期化、RTCの生成、モジュールのロード、ロガー初期化、ファクトリ初期化等を実行</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Manager=&nbsp;{}</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.Manager"]&nbsp;=&nbsp;Manager</span></Line>  <Line no="15" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">local&nbsp;oil&nbsp;=&nbsp;require&nbsp;"oil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ObjectManager&nbsp;=&nbsp;require&nbsp;"openrtm.ObjectManager"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Properties&nbsp;=&nbsp;require&nbsp;"openrtm.Properties"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;StringUtil&nbsp;=&nbsp;require&nbsp;"openrtm.StringUtil"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ManagerConfig&nbsp;=&nbsp;require&nbsp;"openrtm.ManagerConfig"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="blockcomment">local&nbsp;SystemLogger&nbsp;=&nbsp;require&nbsp;"openrtm.SystemLogger"</span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">local&nbsp;LogStream&nbsp;=&nbsp;SystemLogger.LogStream</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NumberingPolicyBase&nbsp;=&nbsp;require&nbsp;"openrtm.NumberingPolicyBase"</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NumberingPolicyFactory&nbsp;=&nbsp;NumberingPolicyBase.NumberingPolicyFactory</span></Line>  <Line no="25" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ManagerActionListener&nbsp;=&nbsp;require&nbsp;"openrtm.ManagerActionListener"</span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ManagerActionListeners&nbsp;=&nbsp;ManagerActionListener.ManagerActionListeners</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ManagerServant&nbsp;=&nbsp;require&nbsp;"openrtm.ManagerServant"</span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CompParam&nbsp;=&nbsp;ManagerServant.CompParam</span></Line>  <Line no="29" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NamingManager&nbsp;=&nbsp;require&nbsp;"openrtm.NamingManager"</span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">local&nbsp;FactoryInit&nbsp;=&nbsp;require&nbsp;"openrtm.FactoryInit"</span></Line>  <Line no="31" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PeriodicExecutionContext&nbsp;=&nbsp;require&nbsp;"openrtm.PeriodicExecutionContext"</span></Line>  <Line no="32" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Factory&nbsp;=&nbsp;require&nbsp;"openrtm.Factory"</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">local&nbsp;FactoryLua&nbsp;=&nbsp;Factory.FactoryLua</span></Line>  <Line no="34" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OpenHRPExecutionContext&nbsp;=&nbsp;require&nbsp;"openrtm.OpenHRPExecutionContext"</span></Line>  <Line no="35" valid="True" visited="True">	<span class="blockcomment">local&nbsp;SimulatorExecutionContext&nbsp;=&nbsp;require&nbsp;"openrtm.SimulatorExecutionContext"</span></Line>  <Line no="36" valid="True" visited="True">	<span class="blockcomment">local&nbsp;LogstreamBase&nbsp;=&nbsp;require&nbsp;"openrtm.LogstreamBase"</span></Line>  <Line no="37" valid="True" visited="True">	<span class="blockcomment">local&nbsp;LogstreamFactory&nbsp;=&nbsp;LogstreamBase.LogstreamFactory</span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ModuleManager&nbsp;=&nbsp;require&nbsp;"openrtm.ModuleManager"</span></Line>  <Line no="39" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Task&nbsp;=&nbsp;require&nbsp;"openrtm.Task"</span></Line>  <Line no="40" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CORBA_RTCUtil&nbsp;=&nbsp;require&nbsp;"openrtm.CORBA_RTCUtil"</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">local&nbsp;SdoServiceConsumerBase&nbsp;=&nbsp;require&nbsp;"openrtm.SdoServiceConsumerBase"</span></Line>  <Line no="42" valid="True" visited="True">	<span class="blockcomment">local&nbsp;SdoServiceConsumerFactory&nbsp;=&nbsp;SdoServiceConsumerBase.SdoServiceConsumerFactory</span></Line>  <Line no="43" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="44" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="45" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ORB_Dummy_ENABLEをtrueに設定した場合、</span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment">--&nbsp;oil関連の処理はすべてダミー関数に置き換えられる</span></Line>  <Line no="47" valid="True" visited="True">	<span class="blockcomment">if&nbsp;ORB_Dummy_ENABLE&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">&nbsp;ORB_Dummy_ENABLE&nbsp;=&nbsp;false</span></Line>  <Line no="49" valid="False" visited="False">	<span class="blockcomment">end</span></Line>  <Line no="50" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">if&nbsp;ORB_Dummy_ENABLE&nbsp;then</span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;oil.corba&nbsp;=&nbsp;{}</span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;oil.corba.idl&nbsp;=&nbsp;{}</span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="56" valid="False" visited="False">	<span class="blockcomment">&nbsp;oil.newthread&nbsp;=&nbsp;function(obj)</span></Line>  <Line no="57" valid="False" visited="False">	<span class="blockcomment">&nbsp;--obj()</span></Line>  <Line no="58" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="59" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;oil.tasks:suspend(t)</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="61" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="63" valid="True" visited="True">	<span class="blockcomment">&nbsp;ORB_Dummy&nbsp;=&nbsp;{}</span></Line>  <Line no="64" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="65" valid="True" visited="True">	<span class="blockcomment">&nbsp;ORB_Dummy.types&nbsp;=&nbsp;{}</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">&nbsp;--oil&nbsp;=&nbsp;{}</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment">&nbsp;oil.main&nbsp;=&nbsp;function(func)</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;func()</span></Line>  <Line no="70" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="71" valid="False" visited="False">	<span class="blockcomment">&nbsp;</span></Line>  <Line no="72" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:loadidlfile(name)</span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="74" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy.types:lookup(name)</span></Line>  <Line no="76" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;{}</span></Line>  <Line no="77" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;ret.labelvalue&nbsp;=&nbsp;{}</span></Line>  <Line no="78" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;name&nbsp;==&nbsp;"::RTC::ReturnCode_t"&nbsp;then</span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.RTC_OK&nbsp;=&nbsp;0</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.RTC_ERROR&nbsp;=&nbsp;1</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BAD_PARAMETER&nbsp;=&nbsp;2</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.UNSUPPORTED&nbsp;=&nbsp;3</span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.OUT_OF_RESOURCES&nbsp;=&nbsp;4</span></Line>  <Line no="84" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PRECONDITION_NOT_MET&nbsp;=&nbsp;5</span></Line>  <Line no="85" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;name&nbsp;==&nbsp;"::RTC::ExecutionKind"&nbsp;then</span></Line>  <Line no="86" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PERIODIC&nbsp;=&nbsp;0</span></Line>  <Line no="87" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.EVENT_DRIVEN&nbsp;=&nbsp;1</span></Line>  <Line no="88" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.OTHER&nbsp;=&nbsp;2</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;name&nbsp;==&nbsp;"::RTC::LifeCycleState"&nbsp;then</span></Line>  <Line no="90" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.CREATED_STATE&nbsp;=&nbsp;0</span></Line>  <Line no="91" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.INACTIVE_STATE&nbsp;=&nbsp;1</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.ACTIVE_STATE&nbsp;=&nbsp;2</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.ERROR_STATE&nbsp;=&nbsp;3</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;name&nbsp;==&nbsp;"::OpenRTM::PortStatus"&nbsp;then</span></Line>  <Line no="95" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PORT_OK&nbsp;=&nbsp;0</span></Line>  <Line no="96" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PORT_ERROR&nbsp;=&nbsp;1</span></Line>  <Line no="97" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_FULL&nbsp;=&nbsp;2</span></Line>  <Line no="98" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_EMPTY&nbsp;=&nbsp;3</span></Line>  <Line no="99" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_TIMEOUT&nbsp;=&nbsp;4</span></Line>  <Line no="100" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.UNKNOWN_ERROR&nbsp;=&nbsp;5</span></Line>  <Line no="101" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;name&nbsp;==&nbsp;"::RTC::PortStatus"&nbsp;then</span></Line>  <Line no="102" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PORT_OK&nbsp;=&nbsp;0</span></Line>  <Line no="103" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PORT_ERROR&nbsp;=&nbsp;1</span></Line>  <Line no="104" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_FULL&nbsp;=&nbsp;2</span></Line>  <Line no="105" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_EMPTY&nbsp;=&nbsp;3</span></Line>  <Line no="106" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.BUFFER_TIMEOUT&nbsp;=&nbsp;4</span></Line>  <Line no="107" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.UNKNOWN_ERROR&nbsp;=&nbsp;5</span></Line>  <Line no="108" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;name&nbsp;==&nbsp;"::RTC::PortInterfacePolarity"&nbsp;then</span></Line>  <Line no="109" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.PROVIDED&nbsp;=&nbsp;0</span></Line>  <Line no="110" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret.labelvalue.REQUIRED&nbsp;=&nbsp;1</span></Line>  <Line no="111" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="112" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="113" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="114" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="115" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:newservant(obj,&nbsp;name,&nbsp;idl)</span></Line>  <Line no="116" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;obj</span></Line>  <Line no="117" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="118" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="119" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:tostring(ref)</span></Line>  <Line no="120" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ref</span></Line>  <Line no="121" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="122" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="123" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:newencoder()</span></Line>  <Line no="124" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;encoder&nbsp;=&nbsp;{}</span></Line>  <Line no="125" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;encoder.data&nbsp;=&nbsp;0</span></Line>  <Line no="126" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;encoder:put(data,&nbsp;data_type)</span></Line>  <Line no="127" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self.data&nbsp;=&nbsp;data</span></Line>  <Line no="128" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="129" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;encoder:getdata()</span></Line>  <Line no="130" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="131" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self.data</span></Line>  <Line no="132" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="133" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="134" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="135" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;encoder</span></Line>  <Line no="136" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="137" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="138" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:newdecoder(cdr)</span></Line>  <Line no="139" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;decoder&nbsp;=&nbsp;{}</span></Line>  <Line no="140" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;decoder.cdr&nbsp;=&nbsp;cdr</span></Line>  <Line no="141" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="142" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;decoder:get(data_type)</span></Line>  <Line no="143" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self.cdr</span></Line>  <Line no="144" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="145" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="146" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;decoder</span></Line>  <Line no="147" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="148" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="149" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="150" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:deactivate(object)</span></Line>  <Line no="151" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="152" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="153" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="154" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_NameServer&nbsp;=&nbsp;{}</span></Line>  <Line no="155" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="156" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_NameServer.new&nbsp;=&nbsp;function()</span></Line>  <Line no="157" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="158" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:rebind(name_list,&nbsp;obj)</span></Line>  <Line no="159" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;print("rebind:")</span></Line>  <Line no="160" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;name&nbsp;in&nbsp;ipairs(name_list)&nbsp;do</span></Line>  <Line no="161" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(name.id,&nbsp;name.kind)</span></Line>  <Line no="162" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="163" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="164" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="165" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:unbind(name_list)</span></Line>  <Line no="166" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;print("unbind:")</span></Line>  <Line no="167" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;name&nbsp;in&nbsp;ipairs(name_list)&nbsp;do</span></Line>  <Line no="168" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(name.id,&nbsp;name.kind)</span></Line>  <Line no="169" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="170" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="171" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:bind_new_context(name_list)</span></Line>  <Line no="172" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;name&nbsp;in&nbsp;ipairs(name_list)&nbsp;do</span></Line>  <Line no="173" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(name.id,&nbsp;name.kind)</span></Line>  <Line no="174" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="175" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;Dummy_NameServer.new()</span></Line>  <Line no="176" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="177" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:resolve(name_list)</span></Line>  <Line no="178" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;name&nbsp;in&nbsp;ipairs(name_list)&nbsp;do</span></Line>  <Line no="179" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(name.id,&nbsp;name.kind)</span></Line>  <Line no="180" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="181" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;Dummy_NameServer.new()</span></Line>  <Line no="182" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="183" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;obj</span></Line>  <Line no="184" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="185" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="186" valid="True" visited="True">	<span class="blockcomment">&nbsp;NameServer_dummy&nbsp;=&nbsp;Dummy_NameServer.new()</span></Line>  <Line no="187" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="188" valid="True" visited="True">	<span class="blockcomment">&nbsp;Manager.Dummy_InPortCDR&nbsp;=&nbsp;{}</span></Line>  <Line no="189" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_InPortCDR&nbsp;=&nbsp;Manager.Dummy_InPortCDR</span></Line>  <Line no="190" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_InPortCDR.new&nbsp;=&nbsp;function()</span></Line>  <Line no="191" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="192" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:put(data)</span></Line>  <Line no="193" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ORB_Dummy.types:lookup("::OpenRTM::PortStatus").PORT_OK</span></Line>  <Line no="194" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="195" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:push(data)</span></Line>  <Line no="196" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ORB_Dummy.types:lookup("::RTC::PortStatus").PORT_OK</span></Line>  <Line no="197" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="198" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:getObjRef()</span></Line>  <Line no="199" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self</span></Line>  <Line no="200" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="201" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;obj</span></Line>  <Line no="202" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="203" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="204" valid="True" visited="True">	<span class="blockcomment">&nbsp;Manager.Dummy_OutPortCDR&nbsp;=&nbsp;{}</span></Line>  <Line no="205" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_OutPortCDR&nbsp;=&nbsp;Manager.Dummy_OutPortCDR</span></Line>  <Line no="206" valid="True" visited="True">	<span class="blockcomment">&nbsp;Dummy_OutPortCDR.new&nbsp;=&nbsp;function()</span></Line>  <Line no="207" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="208" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:get()</span></Line>  <Line no="209" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ORB_Dummy.types:lookup("::OpenRTM::PortStatus").PORT_OK,&nbsp;""</span></Line>  <Line no="210" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="211" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:pull()</span></Line>  <Line no="212" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ORB_Dummy.types:lookup("::RTC::PortStatus").PORT_OK,&nbsp;""</span></Line>  <Line no="213" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="214" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:getObjRef()</span></Line>  <Line no="215" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self</span></Line>  <Line no="216" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="217" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;obj</span></Line>  <Line no="218" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="219" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="220" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="221" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="222" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;ORB_Dummy:newproxy(ref,&nbsp;proxy,idl)</span></Line>  <Line no="223" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;ref</span></Line>  <Line no="224" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;oil.VERSION&nbsp;==&nbsp;"OiL&nbsp;0.4&nbsp;beta"&nbsp;then</span></Line>  <Line no="225" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;idl&nbsp;=&nbsp;proxy</span></Line>  <Line no="226" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="227" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="228" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;idl&nbsp;==&nbsp;"IDL:omg.org/CosNaming/NamingContext:1.0"&nbsp;then</span></Line>  <Line no="229" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;NameServer_dummy</span></Line>  <Line no="230" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;idl&nbsp;==&nbsp;"IDL:openrtm.aist.go.jp/OpenRTM/InPortCdr:1.0"&nbsp;and&nbsp;ref&nbsp;==&nbsp;"IOR:Dummy"&nbsp;then</span></Line>  <Line no="231" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;Dummy_InPortCDR.new()</span></Line>  <Line no="232" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;idl&nbsp;==&nbsp;"IDL:omg.org/RTC/DataPushService:1.0"&nbsp;and&nbsp;ref&nbsp;==&nbsp;"IOR:Dummy"&nbsp;then</span></Line>  <Line no="233" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;Dummy_InPortCDR.new()</span></Line>  <Line no="234" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;idl&nbsp;==&nbsp;"IDL:openrtm.aist.go.jp/OpenRTM/OutPortCdr:1.0"&nbsp;and&nbsp;ref&nbsp;==&nbsp;"IOR:Dummy"&nbsp;then</span></Line>  <Line no="235" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;Dummy_OutPortCDR.new()</span></Line>  <Line no="236" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;idl&nbsp;==&nbsp;"IDL:omg.org/RTC/DataPullService:1.0"&nbsp;and&nbsp;ref&nbsp;==&nbsp;"IOR:Dummy"&nbsp;then</span></Line>  <Line no="237" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;Dummy_OutPortCDR.new()</span></Line>  <Line no="238" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="239" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="240" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;ret._non_existent&nbsp;=&nbsp;function(self)</span></Line>  <Line no="241" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="242" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="243" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;ret._is_equivalent&nbsp;=&nbsp;function(self,&nbsp;other)</span></Line>  <Line no="244" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(self,&nbsp;other)</span></Line>  <Line no="245" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;self._profile&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="246" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._profile.name&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="247" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;self._profile.name&nbsp;==&nbsp;other._profile.name&nbsp;then</span></Line>  <Line no="248" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true</span></Line>  <Line no="249" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="250" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="251" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="252" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;(self&nbsp;==&nbsp;other)</span></Line>  <Line no="253" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="254" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print("test2:",ret,ref)</span></Line>  <Line no="255" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="256" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="257" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="258" valid="False" visited="False">	<span class="blockcomment">end</span></Line>  <Line no="259" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="260" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="261" valid="False" visited="False">	<span class="blockcomment">--&nbsp;インスタンス名一致判定関数オブジェクト初期化</span></Line>  <Line no="262" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;argv&nbsp;argv.prop：プロパティ、argv._name：インスタンス名</span></Line>  <Line no="263" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;インスタンス名一致判定関数オブジェクト</span></Line>  <Line no="264" valid="False" visited="False">	<span class="blockcomment">local&nbsp;InstanceName&nbsp;=&nbsp;function(argv)</span></Line>  <Line no="265" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="266" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;argv.prop&nbsp;then</span></Line>  <Line no="267" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._name&nbsp;=&nbsp;argv.prop:getProperty("instance_name")</span></Line>  <Line no="268" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;argv.factory&nbsp;then</span></Line>  <Line no="269" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._name&nbsp;=&nbsp;argv.factory:getInstanceName()</span></Line>  <Line no="270" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;argv.name&nbsp;then</span></Line>  <Line no="271" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._name&nbsp;=&nbsp;argv.name</span></Line>  <Line no="272" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="273" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;インスタンス名一致判定</span></Line>  <Line no="274" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;comp&nbsp;RTC</span></Line>  <Line no="275" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="276" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;comp)</span></Line>  <Line no="277" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;(self._name&nbsp;==&nbsp;comp:getInstanceName())</span></Line>  <Line no="278" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="279" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="280" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="281" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="282" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="283" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成ファクトリ一致判定関数オブジェクトの初期化</span></Line>  <Line no="284" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;argv&nbsp;argv.name：型名、argv.prop：プロパティ、factory：ファクトリ</span></Line>  <Line no="285" valid="False" visited="False">	<span class="blockcomment">local&nbsp;FactoryPredicate&nbsp;=&nbsp;function(argv)</span></Line>  <Line no="286" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="287" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;argv.name&nbsp;then</span></Line>  <Line no="288" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._vendor&nbsp;=&nbsp;""</span></Line>  <Line no="289" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._category&nbsp;=&nbsp;""</span></Line>  <Line no="290" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._impleid&nbsp;=&nbsp;argv.name</span></Line>  <Line no="291" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._version&nbsp;=&nbsp;""</span></Line>  <Line no="292" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;argv.prop&nbsp;then</span></Line>  <Line no="293" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._vendor&nbsp;=&nbsp;argv.prop:getProperty("vendor")</span></Line>  <Line no="294" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._category&nbsp;=&nbsp;argv.prop:getProperty("category")</span></Line>  <Line no="295" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._impleid&nbsp;=&nbsp;argv.prop:getProperty("implementation_id")</span></Line>  <Line no="296" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(obj._impleid)</span></Line>  <Line no="297" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._version&nbsp;=&nbsp;argv.prop:getProperty("version")</span></Line>  <Line no="298" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;argv.factory&nbsp;then</span></Line>  <Line no="299" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._vendor&nbsp;=&nbsp;argv.factory:profile():getProperty("vendor")</span></Line>  <Line no="300" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._category&nbsp;=&nbsp;argv.factory:profile():getProperty("category")</span></Line>  <Line no="301" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._impleid&nbsp;=&nbsp;argv.factory:profile():getProperty("implementation_id")</span></Line>  <Line no="302" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._version&nbsp;=&nbsp;argv.factory:profile():getProperty("version")</span></Line>  <Line no="303" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="304" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="305" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC生成ファクトリ一致判定関数</span></Line>  <Line no="306" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="307" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;factory&nbsp;ファクトリ</span></Line>  <Line no="308" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="309" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;factory)</span></Line>  <Line no="310" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._impleid&nbsp;==&nbsp;""&nbsp;then</span></Line>  <Line no="311" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="312" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="313" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;_prop&nbsp;=&nbsp;Properties.new({prop=factory:profile()})</span></Line>  <Line no="314" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(factory:profile())</span></Line>  <Line no="315" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(_prop:)</span></Line>  <Line no="316" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._impleid,_prop:getProperty("implementation_id"))</span></Line>  <Line no="317" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._impleid,&nbsp;self._vendor,&nbsp;self._category,&nbsp;self._version)</span></Line>  <Line no="318" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(_prop:getProperty("implementation_id"),&nbsp;_prop:getProperty("vendor"),&nbsp;_prop:getProperty("category"),&nbsp;_prop:getProperty("implementation_id"))</span></Line>  <Line no="319" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._impleid&nbsp;~=&nbsp;_prop:getProperty("implementation_id")&nbsp;then</span></Line>  <Line no="320" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="321" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="322" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._vendor&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._vendor&nbsp;~=&nbsp;_prop:getProperty("vendor")&nbsp;then</span></Line>  <Line no="323" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="324" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="325" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._category&nbsp;&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._category&nbsp;&nbsp;~=&nbsp;_prop:getProperty("category")&nbsp;then</span></Line>  <Line no="326" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="327" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="328" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._version&nbsp;&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._version&nbsp;&nbsp;~=&nbsp;_prop:getProperty("version")&nbsp;then</span></Line>  <Line no="329" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="330" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="331" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="332" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;true</span></Line>  <Line no="333" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="334" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="335" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="336" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="337" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="338" valid="False" visited="False">	<span class="blockcomment">--&nbsp;EC生成ファクトリ一致判定関数オブジェクトの初期化</span></Line>  <Line no="339" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;argv&nbsp;argv.name：型名、argv.factory：ファクトリ</span></Line>  <Line no="340" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;EC生成ファクトリ一致判定関数オブジェクト</span></Line>  <Line no="341" valid="False" visited="False">	<span class="blockcomment">local&nbsp;ECFactoryPredicate&nbsp;=&nbsp;function(argv)</span></Line>  <Line no="342" valid="True" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="343" valid="True" visited="False">	<span class="blockcomment">&nbsp;if&nbsp;argv.name&nbsp;then</span></Line>  <Line no="344" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._name&nbsp;&nbsp;=&nbsp;argv.name</span></Line>  <Line no="345" valid="True" visited="False">	<span class="blockcomment">&nbsp;elseif&nbsp;argv.factory&nbsp;then</span></Line>  <Line no="346" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._name&nbsp;=&nbsp;argv.factory:name()</span></Line>  <Line no="347" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="348" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;EC生成ファクトリ一致判定関数</span></Line>  <Line no="349" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="350" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;factory&nbsp;ファクトリ</span></Line>  <Line no="351" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="352" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;factory)</span></Line>  <Line no="353" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;(self._name&nbsp;==&nbsp;factory:name())</span></Line>  <Line no="354" valid="True" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="355" valid="True" visited="False">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="356" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="357" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="358" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="359" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="360" valid="False" visited="False">	<span class="blockcomment">--&nbsp;モジュール一致判定関数オブジェクト初期化</span></Line>  <Line no="361" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="362" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;モジュール一致判定関数オブジェクト</span></Line>  <Line no="363" valid="False" visited="False">	<span class="blockcomment">local&nbsp;ModulePredicate&nbsp;=&nbsp;function(prop)</span></Line>  <Line no="364" valid="True" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="365" valid="True" visited="False">	<span class="blockcomment">&nbsp;obj._prop&nbsp;&nbsp;=&nbsp;prop</span></Line>  <Line no="366" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;モジュール一致判定関数</span></Line>  <Line no="367" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="368" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="369" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="370" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;prop)</span></Line>  <Line no="371" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._prop:getProperty("implementation_id")&nbsp;~=&nbsp;prop:getProperty("implementation_id")&nbsp;then</span></Line>  <Line no="372" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="373" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="374" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._prop:getProperty("vendor")&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._prop:getProperty("vendor")&nbsp;~=&nbsp;prop:getProperty("vendor")&nbsp;then</span></Line>  <Line no="375" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="376" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="377" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._prop:getProperty("category")&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._prop:getProperty("category")&nbsp;~=&nbsp;prop:getProperty("category")&nbsp;then</span></Line>  <Line no="378" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="379" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="380" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._prop:getProperty("version")&nbsp;~=&nbsp;""&nbsp;and&nbsp;self._prop:getProperty("version")&nbsp;~=&nbsp;prop:getProperty("version")&nbsp;then</span></Line>  <Line no="381" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;false</span></Line>  <Line no="382" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="383" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;true</span></Line>  <Line no="384" valid="True" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="385" valid="True" visited="False">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="386" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="387" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="388" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="389" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Finalized&nbsp;=&nbsp;{}</span></Line>  <Line no="390" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="391" valid="False" visited="False">	<span class="blockcomment">--&nbsp;終了したRTCを登録するオブジェクト初期化</span></Line>  <Line no="392" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;終了したRTCを登録するオブジェクト</span></Line>  <Line no="393" valid="False" visited="False">	<span class="blockcomment">Finalized.new&nbsp;=&nbsp;function()</span></Line>  <Line no="394" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="395" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj.comps&nbsp;=&nbsp;{}</span></Line>  <Line no="396" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="397" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="398" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="399" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャ初期化</span></Line>  <Line no="400" valid="False" visited="False">	<span class="blockcomment">--&nbsp;以下の処理を実行</span></Line>  <Line no="401" valid="False" visited="False">	<span class="blockcomment">--&nbsp;オブジェクトマネージャ(RTC、EC)初期化</span></Line>  <Line no="402" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ファクトリ初期化</span></Line>  <Line no="403" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ロガー初期化</span></Line>  <Line no="404" valid="False" visited="False">	<span class="blockcomment">--&nbsp;実行コンテキスト生成ファクトリ初期化</span></Line>  <Line no="405" valid="False" visited="False">	<span class="blockcomment">--&nbsp;複合コンポーネント生成ファクトリ初期化</span></Line>  <Line no="406" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャアクションコールバック関数オブジェクト初期化</span></Line>  <Line no="407" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;argv&nbsp;コマンドライン引数</span></Line>  <Line no="408" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-a"：マネージャサーバント無効</span></Line>  <Line no="409" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-f"：設定ファイル指定</span></Line>  <Line no="410" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-l"：ロードするモジュール指定</span></Line>  <Line no="411" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-o"：追加のオプション指定</span></Line>  <Line no="412" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-a"：アドレス、ポート番号指定</span></Line>  <Line no="413" valid="False" visited="False">	<span class="blockcomment">--&nbsp;"-d"：マスターマネージャに設定</span></Line>  <Line no="414" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:init(argv)</span></Line>  <Line no="415" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;argv&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="416" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;argv&nbsp;=&nbsp;{}</span></Line>  <Line no="417" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="418" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._initProc&nbsp;=&nbsp;nil</span></Line>  <Line no="419" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._ecs&nbsp;=&nbsp;{}</span></Line>  <Line no="420" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;self._orb&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="421" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self:createShutdownThread(1)</span></Line>  <Line no="422" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="423" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._orb&nbsp;=&nbsp;nil</span></Line>  <Line no="424" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._compManager&nbsp;=&nbsp;ObjectManager.new(InstanceName)</span></Line>  <Line no="425" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._factory&nbsp;=&nbsp;ObjectManager.new(FactoryPredicate)</span></Line>  <Line no="426" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._ecfactory&nbsp;=&nbsp;ObjectManager.new(ECFactoryPredicate)</span></Line>  <Line no="427" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initManager(argv)</span></Line>  <Line no="428" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initFactories()</span></Line>  <Line no="429" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initLogger()</span></Line>  <Line no="430" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initExecContext()</span></Line>  <Line no="431" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initComposite()</span></Line>  <Line no="432" valid="True" visited="True">	<span class="blockcomment">&nbsp;self:initTimer()</span></Line>  <Line no="433" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._finalized&nbsp;=&nbsp;Finalized.new()</span></Line>  <Line no="434" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._listeners&nbsp;=&nbsp;ManagerActionListeners.new()</span></Line>  <Line no="435" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._initThread&nbsp;=&nbsp;nil</span></Line>  <Line no="436" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="437" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="438" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="439" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="440" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="441" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャ終了処理開始</span></Line>  <Line no="442" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:terminate()</span></Line>  <Line no="443" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="444" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="445" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="446" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャ終了</span></Line>  <Line no="447" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC全削除</span></Line>  <Line no="448" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ネーミングマネージャ終了</span></Line>  <Line no="449" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ORB終了</span></Line>  <Line no="450" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ロガー終了</span></Line>  <Line no="451" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:shutdown()</span></Line>  <Line no="452" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;not&nbsp;self.shutdown_start&nbsp;then</span></Line>  <Line no="453" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.shutdown_start&nbsp;=&nbsp;true</span></Line>  <Line no="454" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._listeners.manager_:preShutdown()</span></Line>  <Line no="455" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownComponents()</span></Line>  <Line no="456" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownManagerServant()</span></Line>  <Line no="457" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownNaming()</span></Line>  <Line no="458" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownORB()</span></Line>  <Line no="459" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownManager()</span></Line>  <Line no="460" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._listeners.manager_:postShutdown()</span></Line>  <Line no="461" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:shutdownLogger()</span></Line>  <Line no="462" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="463" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="464" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="465" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="466" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="467" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:instance()</span></Line>  <Line no="468" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;self</span></Line>  <Line no="469" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="470" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="471" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャ終了まで待機</span></Line>  <Line no="472" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:join()</span></Line>  <Line no="473" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="474" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="475" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="476" valid="False" visited="False">	<span class="blockcomment">--&nbsp;初期化時実行関数の設定</span></Line>  <Line no="477" valid="False" visited="False">	<span class="blockcomment">--&nbsp;指定関数はrunManager関数で実行される</span></Line>  <Line no="478" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;proc&nbsp;関数</span></Line>  <Line no="479" valid="False" visited="False">	<span class="blockcomment">--&nbsp;proc(manager)：マネージャを引数とする関数を定義</span></Line>  <Line no="480" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:setModuleInitProc(proc)</span></Line>  <Line no="481" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._initProc&nbsp;=&nbsp;proc</span></Line>  <Line no="482" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="483" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="484" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャアクティブ化</span></Line>  <Line no="485" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:activateManager()</span></Line>  <Line no="486" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;mods&nbsp;=&nbsp;StringUtil.strip(StringUtil.split(self._config:getProperty("manager.modules.preload"),&nbsp;","))</span></Line>  <Line no="487" valid="False" visited="False">	<span class="blockcomment">&nbsp;</span></Line>  <Line no="488" valid="True" visited="True">	<span class="blockcomment">&nbsp;for&nbsp;k,mod&nbsp;in&nbsp;ipairs(mods)&nbsp;do</span></Line>  <Line no="489" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;mod&nbsp;==&nbsp;nil&nbsp;or&nbsp;mod&nbsp;==&nbsp;""&nbsp;then</span></Line>  <Line no="490" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="491" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--local&nbsp;basename&nbsp;=&nbsp;StringUtil.split(StringUtil.basename(mod),"%.")[1]</span></Line>  <Line no="492" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--basename&nbsp;=&nbsp;basename.."Init"</span></Line>  <Line no="493" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;</span></Line>  <Line no="494" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="495" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="496" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--print(mod,&nbsp;"Init")</span></Line>  <Line no="497" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._module:load(mod,&nbsp;"Init")</span></Line>  <Line no="498" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="499" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;success&nbsp;then</span></Line>  <Line no="500" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR(exception)</span></Line>  <Line no="501" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="502" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="503" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="504" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;sdofactory_&nbsp;=&nbsp;SdoServiceConsumerFactory:instance()</span></Line>  <Line no="505" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._config:setProperty("sdo.service.consumer.available_services",</span></Line>  <Line no="506" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringUtil.flatten(sdofactory_:getIdentifiers()))</span></Line>  <Line no="507" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;true</span></Line>  <Line no="508" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="509" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="510" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャ実行</span></Line>  <Line no="511" valid="False" visited="False">	<span class="blockcomment">--&nbsp;以下の処理を実行する</span></Line>  <Line no="512" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ORBの初期化</span></Line>  <Line no="513" valid="False" visited="False">	<span class="blockcomment">--&nbsp;setModuleInitProc関数で指定した関数実行</span></Line>  <Line no="514" valid="False" visited="False">	<span class="blockcomment">--&nbsp;マネージャサーバント初期化</span></Line>  <Line no="515" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ネーミングマネージャ初期化</span></Line>  <Line no="516" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;no_block&nbsp;true：ノンブロッキングモードで実行、false：この関数でブロックする</span></Line>  <Line no="517" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ブロックモードで実行する場合は、step関数を適宜実行する必要がある</span></Line>  <Line no="518" valid="False" visited="False">	<span class="blockcomment">--&nbsp;また、周期実行コンテキストなどコルーチンで実行する実行コンテキストは使用できない</span></Line>  <Line no="519" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:runManager(no_block)</span></Line>  <Line no="520" valid="True" visited="True">	<span class="blockcomment">&nbsp;self.shutdown_start&nbsp;=&nbsp;false</span></Line>  <Line no="521" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;no_block&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="522" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;no_block&nbsp;=&nbsp;false</span></Line>  <Line no="523" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="524" valid="True" visited="True">	<span class="blockcomment">&nbsp;self.no_block&nbsp;=&nbsp;no_block</span></Line>  <Line no="525" valid="True" visited="True">	<span class="blockcomment">&nbsp;oil.main(function()</span></Line>  <Line no="526" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="527" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initORB()</span></Line>  <Line no="528" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="529" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;no_block&nbsp;then</span></Line>  <Line no="530" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--oil.newthread(self._orb.step,&nbsp;self._orb)</span></Line>  <Line no="531" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;count&nbsp;=&nbsp;tonumber(self._config:getProperty("corba.step.count"))</span></Line>  <Line no="532" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;count&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="533" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:run_step(count)</span></Line>  <Line no="534" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="535" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="536" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;oil.newthread(self._orb.run,&nbsp;self._orb)</span></Line>  <Line no="537" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="538" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="539" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initManagerServant()</span></Line>  <Line no="540" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="541" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initNaming()</span></Line>  <Line no="542" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._orb,&nbsp;self._orb.run)</span></Line>  <Line no="543" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="544" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._initProc&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="545" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._initProc(self)</span></Line>  <Line no="546" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="547" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._initThread&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="548" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;oil.newthread(self._initThread,&nbsp;self)</span></Line>  <Line no="549" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="550" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="551" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="552" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="553" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initPreCreation()</span></Line>  <Line no="554" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initPreConnection()</span></Line>  <Line no="555" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initPreActivation()</span></Line>  <Line no="556" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="557" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--self:unload("ConsoleIn")</span></Line>  <Line no="558" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="559" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="560" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="561" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--cout&nbsp;=&nbsp;self:getComponent("ConsoleOut0")</span></Line>  <Line no="562" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--cin&nbsp;=&nbsp;self:getComponent("ConsoleIn0")</span></Line>  <Line no="563" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--config&nbsp;=&nbsp;self:getComponent("ConfigSample0")</span></Line>  <Line no="564" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="565" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_component_profile(cin))</span></Line>  <Line no="566" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_existing(cin))</span></Line>  <Line no="567" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_alive_in_default_ec(cin))</span></Line>  <Line no="568" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--ec_cin&nbsp;=&nbsp;CORBA_RTCUtil.get_actual_ec(cin)</span></Line>  <Line no="569" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_ec_id(cin,ec_cin))</span></Line>  <Line no="570" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="571" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.activate(cout)</span></Line>  <Line no="572" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.activate(cin)</span></Line>  <Line no="573" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--oil.tasks:suspend(10)</span></Line>  <Line no="574" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.deactivate(cout)</span></Line>  <Line no="575" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.reset(cin)</span></Line>  <Line no="576" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="577" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_state(cin))</span></Line>  <Line no="578" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="579" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--rtc&nbsp;=&nbsp;self._namingManager:string_to_component("rtcname://localhost/*/TkJoyStick0")</span></Line>  <Line no="580" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--rtc&nbsp;=&nbsp;self._namingManager:string_to_component("rtcname://localhost/openrtm.host_cxt/TkJoyStick0")</span></Line>  <Line no="581" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(#rtc)</span></Line>  <Line no="582" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--rtc&nbsp;=&nbsp;self._namingManager:string_to_component("rtcloc://localhost:2810/TkJoyStick0")</span></Line>  <Line no="583" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="584" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="585" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_state(rtc[1]))</span></Line>  <Line no="586" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_inactive(cin))</span></Line>  <Line no="587" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_inactive(rtc[1]))</span></Line>  <Line no="588" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_active(cin))</span></Line>  <Line no="589" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_active(rtc[1]))</span></Line>  <Line no="590" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_error(cin))</span></Line>  <Line no="591" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.is_in_error(rtc[1]))</span></Line>  <Line no="592" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_default_rate(cin,&nbsp;100)</span></Line>  <Line no="593" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_default_rate(rtc[1],&nbsp;800)</span></Line>  <Line no="594" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_default_rate(cin))</span></Line>  <Line no="595" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_default_rate(rtc[1]))</span></Line>  <Line no="596" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_current_rate(cin,&nbsp;0,&nbsp;200)</span></Line>  <Line no="597" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_current_rate(rtc[1],&nbsp;0,&nbsp;600)</span></Line>  <Line no="598" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_current_rate(cin,&nbsp;0))</span></Line>  <Line no="599" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_current_rate(rtc[1],&nbsp;0))</span></Line>  <Line no="600" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(#CORBA_RTCUtil.get_participants_rtc(cin))</span></Line>  <Line no="601" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_port_names(cin))</span></Line>  <Line no="602" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_inport_names(cout))</span></Line>  <Line no="603" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_outport_names(cin))</span></Line>  <Line no="604" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_svcport_names(cin))</span></Line>  <Line no="605" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--pin&nbsp;=&nbsp;CORBA_RTCUtil.get_port_by_name(cout,"ConsoleOut0.in")</span></Line>  <Line no="606" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--pout&nbsp;=&nbsp;CORBA_RTCUtil.get_port_by_name(cin,"ConsoleIn0.out")</span></Line>  <Line no="607" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(pin)</span></Line>  <Line no="608" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(#CORBA_RTCUtil.get_connector_names_by_portref(pin))</span></Line>  <Line no="609" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--local&nbsp;prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="610" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.connect("test_connector",prop,pin,pout)</span></Line>  <Line no="611" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.connect_multi("test_connector",prop,pin,{pout})</span></Line>  <Line no="612" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(#CORBA_RTCUtil.get_connector_names_by_portref(pin))</span></Line>  <Line no="613" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_connector_names(cout,&nbsp;"ConsoleOut0.in"))</span></Line>  <Line no="614" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_connector_ids_by_portref(pin))</span></Line>  <Line no="615" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(CORBA_RTCUtil.get_connector_ids(cout,&nbsp;"ConsoleOut0.in"))</span></Line>  <Line no="616" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.already_connected(pout,pin))</span></Line>  <Line no="617" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.connect_by_name("test_connector",prop,cout,"ConsoleOut0.in",cin,"ConsoleIn0.out")</span></Line>  <Line no="618" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_by_portref_connector_name(pin,&nbsp;"test_connector")</span></Line>  <Line no="619" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_port_by_url("rtcname://localhost/ConsoleIn0.out"))</span></Line>  <Line no="620" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_by_portname_connector_name("rtcname://localhost/ConsoleIn0.out",&nbsp;"test_connector")]</span></Line>  <Line no="621" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--ids&nbsp;=&nbsp;CORBA_RTCUtil.get_connector_ids_by_portref(pin)</span></Line>  <Line no="622" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_configuration(config,&nbsp;"default"))</span></Line>  <Line no="623" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_parameter_by_key(config,&nbsp;"default",&nbsp;"double_param0"))</span></Line>  <Line no="624" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_active_configuration_name(config))</span></Line>  <Line no="625" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(CORBA_RTCUtil.get_active_configuration(config))</span></Line>  <Line no="626" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_configuration(config,&nbsp;"default",&nbsp;"double_param0",&nbsp;"1.5")</span></Line>  <Line no="627" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.set_active_configuration(config,&nbsp;"double_param0",&nbsp;"10.5")</span></Line>  <Line no="628" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_by_port_name(pout,&nbsp;"ConsoleOut0.in")</span></Line>  <Line no="629" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_all_by_ref(pout)</span></Line>  <Line no="630" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_all_by_name("rtcname://localhost/ConsoleIn0.out")</span></Line>  <Line no="631" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_by_portname_connector_id("rtcname://localhost/ConsoleIn0.out",&nbsp;ids[1])</span></Line>  <Line no="632" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.disconnect_by_portref_connector_id(pout,&nbsp;ids[1])</span></Line>  <Line no="633" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(#rtc)</span></Line>  <Line no="634" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self:getManagerServant():get_components_by_name("mesure_lua0"))</span></Line>  <Line no="635" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--CORBA_RTCUtil.activate(rtc[1])</span></Line>  <Line no="636" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--self:createComponent("ConfigSample")</span></Line>  <Line no="637" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--local&nbsp;mgrs&nbsp;=&nbsp;self:getManagerServant()</span></Line>  <Line no="638" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--mgrs:create_component("mesure_lua")</span></Line>  <Line no="639" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--local&nbsp;module_name&nbsp;=&nbsp;{"rtc?manager=test"}</span></Line>  <Line no="640" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--local&nbsp;ret&nbsp;=&nbsp;mgrs:getParameterByModulename("manager",module_name)</span></Line>  <Line no="641" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(ret,&nbsp;module_name[1])</span></Line>  <Line no="642" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--self._orb:run()</span></Line>  <Line no="643" valid="True" visited="True">	<span class="blockcomment">&nbsp;end)</span></Line>  <Line no="644" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="645" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="646" valid="False" visited="False">	<span class="blockcomment">--&nbsp;CORBAの処理を1ステップ進める</span></Line>  <Line no="647" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ノンブロックモードの場合のみ有効</span></Line>  <Line no="648" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:step()</span></Line>  <Line no="649" valid="True" visited="False">	<span class="blockcomment">&nbsp;if&nbsp;self.no_block&nbsp;then</span></Line>  <Line no="650" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;oil.main(function()</span></Line>  <Line no="651" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;oil.newthread(self._orb.step,&nbsp;self._orb)</span></Line>  <Line no="652" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end)</span></Line>  <Line no="653" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="654" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="655" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="656" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="657" valid="False" visited="False">	<span class="blockcomment">--&nbsp;CORBAの処理を1ステップ進める</span></Line>  <Line no="658" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ノンブロックモードの場合のみ有効</span></Line>  <Line no="659" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:run_step(count)</span></Line>  <Line no="660" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;count&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="661" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;count&nbsp;=&nbsp;1</span></Line>  <Line no="662" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="663" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;self.no_block&nbsp;then</span></Line>  <Line no="664" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;stepfunc&nbsp;=&nbsp;function(orb)</span></Line>  <Line no="665" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i=1,count&nbsp;do</span></Line>  <Line no="666" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;orb:step()</span></Line>  <Line no="667" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="668" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="669" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;oil.newthread(stepfunc,&nbsp;self._orb)</span></Line>  <Line no="670" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="671" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="672" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="673" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="674" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="675" valid="False" visited="False">	<span class="blockcomment">--&nbsp;すべてのモジュールをアンロード</span></Line>  <Line no="676" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:unloadAll()</span></Line>  <Line no="677" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._rtcout:RTC_TRACE("Manager.unloadAll()")</span></Line>  <Line no="678" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._module:unloadAll()</span></Line>  <Line no="679" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="680" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="681" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ロード済みモジュール一覧取得</span></Line>  <Line no="682" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;ロード済みモジュール一覧</span></Line>  <Line no="683" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:getLoadedModules()</span></Line>  <Line no="684" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._rtcout:RTC_TRACE("Manager.getLoadedModules()")</span></Line>  <Line no="685" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;self._module:getLoadedModules()</span></Line>  <Line no="686" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="687" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="688" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ロード可能モジュール一覧取得</span></Line>  <Line no="689" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;ロード可能モジュール一覧</span></Line>  <Line no="690" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:getLoadableModules()</span></Line>  <Line no="691" valid="True" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;ret&nbsp;=&nbsp;{}</span></Line>  <Line no="692" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;ret</span></Line>  <Line no="693" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="694" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="695" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成ファクトリの登録</span></Line>  <Line no="696" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;profile&nbsp;プロファイル</span></Line>  <Line no="697" valid="False" visited="False">	<span class="blockcomment">--&nbsp;「manager.components.naming_policy」の要素で名前付けポリシーを指定</span></Line>  <Line no="698" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;new_func&nbsp;初期化関数</span></Line>  <Line no="699" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;delete_func&nbsp;削除関数</span></Line>  <Line no="700" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;ファクトリ</span></Line>  <Line no="701" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:registerFactory(profile,&nbsp;new_func,&nbsp;delete_func)</span></Line>  <Line no="702" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(profile:getProperty("type_name"))</span></Line>  <Line no="703" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._rtcout:RTC_TRACE("Manager.registerFactory("..profile:getProperty("type_name")..")")</span></Line>  <Line no="704" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;policy_name&nbsp;=&nbsp;self._config:getProperty("manager.components.naming_policy","process_unique")</span></Line>  <Line no="705" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;policy&nbsp;=&nbsp;NumberingPolicyFactory:instance():createObject(policy_name)</span></Line>  <Line no="706" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;factory&nbsp;=&nbsp;FactoryLua.new(profile,&nbsp;new_func,&nbsp;delete_func,&nbsp;policy)</span></Line>  <Line no="707" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(self._factory.registerObject)</span></Line>  <Line no="708" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;self._factory:registerObject(factory)</span></Line>  <Line no="709" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="710" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="711" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="712" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成ファクトリの削除</span></Line>  <Line no="713" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;id&nbsp;プロファイルのID</span></Line>  <Line no="714" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;削除したファクトリ</span></Line>  <Line no="715" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:unregisterFactory(id)</span></Line>  <Line no="716" valid="True" visited="False">	<span class="blockcomment">&nbsp;self._rtcout:RTC_TRACE("Manager.unregisterFactory("..id..")")</span></Line>  <Line no="717" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;self._factory:unregisterObject(id)</span></Line>  <Line no="718" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="719" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="720" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="721" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="722" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成ファクトリプロファイル一覧取得</span></Line>  <Line no="723" valid="False" visited="False">	<span class="blockcomment">--&nbsp;return&nbsp;RTC生成ファクトリプロファイル一覧</span></Line>  <Line no="724" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:getFactoryProfiles()</span></Line>  <Line no="725" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;factories&nbsp;=&nbsp;self._factory:getObjects()</span></Line>  <Line no="726" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="727" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;#factories&nbsp;==&nbsp;0&nbsp;then</span></Line>  <Line no="728" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;{}</span></Line>  <Line no="729" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="730" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="731" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;props&nbsp;=&nbsp;{}</span></Line>  <Line no="732" valid="True" visited="True">	<span class="blockcomment">&nbsp;for&nbsp;k,factory&nbsp;in&nbsp;ipairs(factories)&nbsp;do</span></Line>  <Line no="733" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;table.insert(props,&nbsp;factory:profile())</span></Line>  <Line no="734" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="735" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="736" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;props</span></Line>  <Line no="737" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="738" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="739" valid="False" visited="False">	<span class="blockcomment">--&nbsp;EC生成ファクトリ登録</span></Line>  <Line no="740" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;profile&nbsp;プロファイル</span></Line>  <Line no="741" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;new_func&nbsp;初期化関数</span></Line>  <Line no="742" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;delete_func&nbsp;削除関数</span></Line>  <Line no="743" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;ファクトリ</span></Line>  <Line no="744" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:registerECFactory(name,&nbsp;new_func,&nbsp;delete_func)</span></Line>  <Line no="745" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="746" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="747" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成ファクトリ一覧取得</span></Line>  <Line no="748" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;RTC生成ファクトリ一覧</span></Line>  <Line no="749" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:getModulesFactories()</span></Line>  <Line no="750" valid="True" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;ret&nbsp;=&nbsp;{}</span></Line>  <Line no="751" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;ret</span></Line>  <Line no="752" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="753" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="754" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC生成</span></Line>  <Line no="755" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;comp_args&nbsp;RTC名とオプション(RTC?param1=xxx&amp;param2=yyy)</span></Line>  <Line no="756" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTC名は「RTC:ベンダ名:カテゴリ名:実装ID:言語名:バージョン」で指定</span></Line>  <Line no="757" valid="False" visited="False">	<span class="blockcomment">--&nbsp;オプションで「instance_name」を指定した場合は、指定インスタンス名のRTCを返す</span></Line>  <Line no="758" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;RTC</span></Line>  <Line no="759" valid="False" visited="False">	<span class="blockcomment">--&nbsp;以下の場合はnilを返す</span></Line>  <Line no="760" valid="False" visited="False">	<span class="blockcomment">--&nbsp;comp_argsが不正</span></Line>  <Line no="761" valid="False" visited="False">	<span class="blockcomment">--&nbsp;指定IDのファクトリがない</span></Line>  <Line no="762" valid="False" visited="False">	<span class="blockcomment">--&nbsp;RTCの生成失敗</span></Line>  <Line no="763" valid="False" visited="False">	<span class="blockcomment">--&nbsp;initialize関数がRTC_OK以外を返す</span></Line>  <Line no="764" valid="True" visited="True">	<span class="blockcomment">function&nbsp;Manager:createComponent(comp_args)</span></Line>  <Line no="765" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._rtcout:RTC_TRACE("Manager.createComponent("..comp_args..")")</span></Line>  <Line no="766" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;comp_prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="767" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;comp_id&nbsp;&nbsp;&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="768" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;not&nbsp;self:procComponentArgs(comp_args,&nbsp;comp_id,&nbsp;comp_prop)&nbsp;then</span></Line>  <Line no="769" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="770" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="771" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;comp_prop:getProperty("instance_name")&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="772" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;comp&nbsp;=&nbsp;self:getComponent(comp_prop:getProperty("instance_name"))</span></Line>  <Line no="773" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;comp&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="774" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;comp</span></Line>  <Line no="775" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="776" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="777" valid="True" visited="True">	<span class="blockcomment">&nbsp;self._listeners.rtclifecycle_:preCreate(comp_args)</span></Line>  <Line no="778" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;comp_prop:findNode("exported_ports")&nbsp;then</span></Line>  <Line no="779" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="780" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(comp_id)</span></Line>  <Line no="781" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;factory&nbsp;=&nbsp;self._factory:find(comp_id)</span></Line>  <Line no="782" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(comp_id,&nbsp;factory)</span></Line>  <Line no="783" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print(factory)</span></Line>  <Line no="784" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;factory&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="785" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_ERROR("createComponent:&nbsp;Factory&nbsp;not&nbsp;found:&nbsp;"..</span></Line>  <Line no="786" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;comp_id:getProperty("implementation_id"))</span></Line>  <Line no="787" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;StringUtil.toBool(self._config:getProperty("manager.modules.search_auto"),&nbsp;"YES",&nbsp;"NO",&nbsp;true)&nbsp;then</span></Line>  <Line no="788" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="789" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="790" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[</span></Line>  <Line no="791" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;mp&nbsp;=&nbsp;self._module:getLoadableModules()</span></Line>  <Line no="792" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_INFO(#mp.."&nbsp;loadable&nbsp;modules&nbsp;found")</span></Line>  <Line no="793" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;found_obj&nbsp;=&nbsp;nil</span></Line>  <Line no="794" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;predicate&nbsp;=&nbsp;ModulePredicate(comp_id)</span></Line>  <Line no="795" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;k,&nbsp;_obj&nbsp;in&nbsp;pairs(mp)&nbsp;do</span></Line>  <Line no="796" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;predicate(_obj)&nbsp;then</span></Line>  <Line no="797" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;found_obj&nbsp;=&nbsp;_obj</span></Line>  <Line no="798" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;break</span></Line>  <Line no="799" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="800" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="801" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;found_obj&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="802" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("No&nbsp;module&nbsp;for&nbsp;"..comp_id:getProperty("implementation_id").."&nbsp;in&nbsp;loadable&nbsp;modules&nbsp;list")</span></Line>  <Line no="803" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="804" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="805" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;found_obj:findNode("module_file_name")&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="806" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Hmm...module_file_name&nbsp;key&nbsp;not&nbsp;found.")</span></Line>  <Line no="807" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;nil</span></Line>  <Line no="808" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="809" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_INFO("Loading&nbsp;module:&nbsp;"..found_obj:getProperty("module_file_name"))</span></Line>  <Line no="810" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self:load(found_obj:getProperty("module_file_name"),&nbsp;"")</span></Line>  <Line no="811" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--]]</span></Line>  <Line no="812" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">""</span><span class="misc">)</span></Line>  <Line no="813" valid="False" visited="False"/>  <Line no="814" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._factory</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">comp_id</span><span class="misc">)</span></Line>  <Line no="815" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="816" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Factory not found for loaded module: "</span><span class="operator">..</span><span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="817" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="818" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="819" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="820" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="821" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">inherit_prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"config.version"</span><span class="misc">,</span></Line>  <Line no="822" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"openrtm.name"</span><span class="misc">,</span></Line>  <Line no="823" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"openrtm.version"</span><span class="misc">,</span></Line>  <Line no="824" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"os.name"</span><span class="misc">,</span></Line>  <Line no="825" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"os.release"</span><span class="misc">,</span></Line>  <Line no="826" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"os.version"</span><span class="misc">,</span></Line>  <Line no="827" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"os.arch"</span><span class="misc">,</span></Line>  <Line no="828" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"os.hostname"</span><span class="misc">,</span></Line>  <Line no="829" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"corba.endpoints"</span><span class="misc">,</span></Line>  <Line no="830" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"corba.endpoints_ipv4"</span><span class="misc">,</span></Line>  <Line no="831" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"corba.endpoints_ipv6"</span><span class="misc">,</span></Line>  <Line no="832" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"corba.id"</span><span class="misc">,</span></Line>  <Line no="833" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.periodic.type"</span><span class="misc">,</span></Line>  <Line no="834" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.periodic.rate"</span><span class="misc">,</span></Line>  <Line no="835" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.event_driven.type"</span><span class="misc">,</span></Line>  <Line no="836" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.sync_transition"</span><span class="misc">,</span></Line>  <Line no="837" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.sync_activation"</span><span class="misc">,</span></Line>  <Line no="838" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.sync_deactivation"</span><span class="misc">,</span></Line>  <Line no="839" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.sync_reset"</span><span class="misc">,</span></Line>  <Line no="840" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.transition_timeout"</span><span class="misc">,</span></Line>  <Line no="841" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.activation_timeout"</span><span class="misc">,</span></Line>  <Line no="842" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.deactivation_timeout"</span><span class="misc">,</span></Line>  <Line no="843" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.reset_timeout"</span><span class="misc">,</span></Line>  <Line no="844" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"exec_cxt.cpu_affinity"</span><span class="misc">,</span></Line>  <Line no="845" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"logger.enable"</span><span class="misc">,</span></Line>  <Line no="846" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"logger.log_level"</span><span class="misc">,</span></Line>  <Line no="847" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"naming.enable"</span><span class="misc">,</span></Line>  <Line no="848" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"naming.type"</span><span class="misc">,</span></Line>  <Line no="849" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"naming.formats"</span><span class="misc">,</span></Line>  <Line no="850" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sdo.service.provider.available_services"</span><span class="misc">,</span></Line>  <Line no="851" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sdo.service.consumer.available_services"</span><span class="misc">,</span></Line>  <Line no="852" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sdo.service.provider.enabled_services"</span><span class="misc">,</span></Line>  <Line no="853" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sdo.service.consumer.enabled_services"</span><span class="misc">,</span></Line>  <Line no="854" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"manager.instance_name"</span><span class="misc">}</span></Line>  <Line no="855" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"port"</span><span class="misc">)</span></Line>  <Line no="856" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop_</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"port"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="857" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">create</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="858" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp)</span></Line>  <Line no="859" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp:getTypeName())</span></Line>  <Line no="860" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp)</span></Line>  <Line no="861" valid="False" visited="False"/>  <Line no="862" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="863" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"createComponent: RTC creation failed: "</span><span class="operator">..</span></Line>  <Line no="864" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="865" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="866" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="867" valid="False" visited="False"/>  <Line no="868" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"corba.endpoints_ipv4"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="869" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setEndpointProperty</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="870" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="871" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">inherit_prop</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="872" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="873" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(v, self._config:getProperty(v))</span></Line>  <Line no="874" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">,</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="875" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="876" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="877" valid="False" visited="False"/>  <Line no="878" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"RTC Created: "</span><span class="operator">..</span><span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="879" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">postCreate</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="880" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">comp_prop</span><span class="misc">)</span></Line>  <Line no="881" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">preConfigure</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="882" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">configureComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="883" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">postConfigure</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="884" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">preInitialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="885" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">initialize</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="886" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"RTC initialization failed: "</span><span class="operator">..</span></Line>  <Line no="887" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="888" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="operator">..</span><span class="string">" was finalized"</span><span class="misc">)</span></Line>  <Line no="889" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="890" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="operator">..</span><span class="string">" finalization was failed."</span><span class="misc">)</span></Line>  <Line no="891" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="892" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="893" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="894" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"RTC initialization succeeded: "</span><span class="operator">..</span></Line>  <Line no="895" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="896" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">postInitialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="897" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">registerComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="898" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">comp</span></Line>  <Line no="899" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="900" valid="False" visited="False"/>  <Line no="901" valid="False" visited="False">	<span class="comment">-- RTCの登録</span></Line>  <Line no="902" valid="False" visited="False">	<span class="comment">-- オブジェクトマネージャへの登録</span></Line>  <Line no="903" valid="False" visited="False">	<span class="comment">-- ネーミングマネージャへの登録</span></Line>  <Line no="904" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="905" valid="False" visited="False">	<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="906" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">registerComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="907" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.registerComponent("</span><span class="operator">..</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="908" valid="False" visited="False"/>  <Line no="909" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp:getInstanceName())</span></Line>  <Line no="910" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._compManager</span><span class="misc">:</span><span class="identifier">registerObject</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="911" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getNamingNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="912" valid="False" visited="False"/>  <Line no="913" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">preBind</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="914" valid="False" visited="False"/>  <Line no="915" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="916" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(name)</span></Line>  <Line no="917" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Bind name: "</span><span class="operator">..</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="918" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">bindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="919" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="920" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">postBind</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="921" valid="False" visited="False"/>  <Line no="922" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">publishPorts</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="923" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">subscribePorts</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="924" valid="False" visited="False"/>  <Line no="925" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="926" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="927" valid="False" visited="False"/>  <Line no="928" valid="False" visited="False">	<span class="comment">-- RTCの登録解除</span></Line>  <Line no="929" valid="False" visited="False">	<span class="comment">-- オブジェクトマネージャから登録解除</span></Line>  <Line no="930" valid="False" visited="False">	<span class="comment">-- ネーミングマネージャから登録解除</span></Line>  <Line no="931" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="932" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">unregisterComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="933" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.unregisterComponent("</span><span class="operator">..</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="934" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._compManager</span><span class="misc">:</span><span class="identifier">unregisterObject</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="935" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getNamingNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="936" valid="False" visited="False"/>  <Line no="937" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">preUnbind</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="938" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">name</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="939" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Unbind name: "</span><span class="operator">..</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="940" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="941" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="942" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">postUnbind</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="943" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="944" valid="False" visited="False"/>  <Line no="945" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト生成</span></Line>  <Line no="946" valid="False" visited="False">	<span class="comment">-- @param ec_args EC名とオプション(EC&amp;param1=xxx&amp;param2=yyy)</span></Line>  <Line no="947" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="948" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">createContext</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span></Line>  <Line no="949" valid="False" visited="False"/>  <Line no="950" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="951" valid="False" visited="False"/>  <Line no="952" valid="False" visited="False">	<span class="comment">-- RTCの削除</span></Line>  <Line no="953" valid="False" visited="False">	<span class="comment">-- @param argv argv.instance_name：インスタンス名、argv.comp：RTC</span></Line>  <Line no="954" valid="False" visited="False">	<span class="comment">-- インスタンス名指定の場合はRTCを検索する</span></Line>  <Line no="955" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">deleteComponent</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="956" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">argv.instance_name</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="957" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.instance_name</span></Line>  <Line no="958" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.deleteComponent("</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="959" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._compManager</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="960" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_comp</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="961" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"RTC "</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">" was not found in manager."</span><span class="misc">)</span></Line>  <Line no="962" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="963" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="964" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deleteComponent</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">comp</span><span class="operator">=</span><span class="identifier">_comp</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="965" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">argv.comp</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="966" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.comp</span></Line>  <Line no="967" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.deleteComponent(RTObject_impl)"</span><span class="misc">)</span></Line>  <Line no="968" valid="False" visited="False"/>  <Line no="969" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unregisterComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="970" valid="False" visited="False"/>  <Line no="971" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="972" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._factory</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">comp_id</span><span class="misc">)</span></Line>  <Line no="973" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp_id)</span></Line>  <Line no="974" valid="False" visited="False"/>  <Line no="975" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="976" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Factory not found: "</span><span class="operator">..</span></Line>  <Line no="977" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="978" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="979" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="980" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Factory found: "</span><span class="operator">..</span></Line>  <Line no="981" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"implementation_id"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="982" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">destroy</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="983" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="984" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.shutdown_on_nortcs"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="985" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="986" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#comps)</span></Line>  <Line no="987" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">comps</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="988" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createShutdownThread</span><span class="misc">(</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="989" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="990" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="991" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="992" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="993" valid="False" visited="False"/>  <Line no="994" valid="False" visited="False">	<span class="comment">-- インスタンス名からRTC取得</span></Line>  <Line no="995" valid="False" visited="False">	<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="996" valid="False" visited="False">	<span class="comment">-- @return RTC</span></Line>  <Line no="997" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getComponent</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="998" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.getComponent("</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="999" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._compManager</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="1000" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1001" valid="False" visited="False"/>  <Line no="1002" valid="False" visited="False">	<span class="comment">-- マネージャアクションコールバックの登録</span></Line>  <Line no="1003" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1004" valid="False" visited="False">	<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="1005" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">addManagerActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span><span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1006" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1007" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1008" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1009" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.manager_</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1010" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1011" valid="False" visited="False"/>  <Line no="1012" valid="False" visited="False">	<span class="comment">-- ネージャアクションコールバックの登録解除</span></Line>  <Line no="1013" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1014" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">removeManagerActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1015" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.manager_</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1016" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1017" valid="False" visited="False"/>  <Line no="1018" valid="False" visited="False">	<span class="comment">-- モジュールアクションコールバックの登録</span></Line>  <Line no="1019" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1020" valid="False" visited="False">	<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="1021" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">addModuleActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1022" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1023" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1024" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1025" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1026" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1027" valid="False" visited="False"/>  <Line no="1028" valid="False" visited="False">	<span class="comment">-- モジュールアクションコールバックの登録解除</span></Line>  <Line no="1029" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1030" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">removeModuleActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1031" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1032" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1033" valid="False" visited="False"/>  <Line no="1034" valid="False" visited="False">	<span class="comment">-- RTC状態遷移アクションコールバックの登録</span></Line>  <Line no="1035" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1036" valid="False" visited="False">	<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="1037" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">addRtcLifecycleActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1038" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1039" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1040" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1041" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1042" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1043" valid="False" visited="False"/>  <Line no="1044" valid="False" visited="False">	<span class="comment">-- RTC状態遷移アクションコールバックの登録解除</span></Line>  <Line no="1045" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1046" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">removeRtcLifecycleActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1047" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.rtclifecycle_</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1048" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1049" valid="False" visited="False"/>  <Line no="1050" valid="False" visited="False">	<span class="comment">-- ネームサーバーアクションコールバックの登録</span></Line>  <Line no="1051" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1052" valid="False" visited="False">	<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="1053" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">addNamingActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1054" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1055" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1056" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1057" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1058" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1059" valid="False" visited="False"/>  <Line no="1060" valid="False" visited="False">	<span class="comment">-- ネームサーバーアクションコールバックの登録解除</span></Line>  <Line no="1061" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1062" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">removeNamingActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1063" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.naming_</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1064" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1065" valid="False" visited="False"/>  <Line no="1066" valid="False" visited="False">	<span class="comment">-- ローカルサービスアクションコールバックの登録</span></Line>  <Line no="1067" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1068" valid="False" visited="False">	<span class="comment">-- @param autoclean 自動削除フラグ</span></Line>  <Line no="1069" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">addLocalServiceActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1070" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1071" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1072" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1073" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.localservice_</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="1074" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1075" valid="False" visited="False"/>  <Line no="1076" valid="False" visited="False">	<span class="comment">-- ローカルサービスアクションコールバックの登録解除</span></Line>  <Line no="1077" valid="False" visited="False">	<span class="comment">-- @param listener コールバック関数オブジェクト</span></Line>  <Line no="1078" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">removeLocalServiceActionListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1079" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.localservice_</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="1080" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1081" valid="False" visited="False"/>  <Line no="1082" valid="False" visited="False">	<span class="comment">-- ORB取得</span></Line>  <Line no="1083" valid="False" visited="False">	<span class="comment">-- @return ORB</span></Line>  <Line no="1084" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1085" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._rtcout)</span></Line>  <Line no="1086" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self)</span></Line>  <Line no="1087" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.getORB()"</span><span class="misc">)</span></Line>  <Line no="1088" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._orb)</span></Line>  <Line no="1089" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._orb</span></Line>  <Line no="1090" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1091" valid="False" visited="False"/>  <Line no="1092" valid="False" visited="False">	<span class="comment">-- マネージャ初期化</span></Line>  <Line no="1093" valid="False" visited="False">	<span class="comment">-- @param argv コマンドライン引数</span></Line>  <Line no="1094" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initManager</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="1095" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ManagerConfig.new</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="1096" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1097" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">configure</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">)</span></Line>  <Line no="1098" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"logger.file_name"</span><span class="misc">,</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">formatString</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.file_name"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1099" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._config</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._module</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ModuleManager.new</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">)</span></Line>  <Line no="1101" valid="False" visited="False"/>  <Line no="1102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self._module:load("testModule.lua","init")</span></Line>  <Line no="1103" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1104" valid="False" visited="False"/>  <Line no="1105" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownManagerServant</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._mgrservant</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgrservant</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgrservant</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1110" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1111" valid="False" visited="False"/>  <Line no="1112" valid="False" visited="False">	<span class="comment">-- マネージャ終了</span></Line>  <Line no="1113" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownManager</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1114" valid="False" visited="False"/>  <Line no="1115" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1116" valid="False" visited="False"/>  <Line no="1117" valid="False" visited="False">	<span class="comment">-- ロガーストリーム初期化</span></Line>  <Line no="1118" valid="False" visited="False">	<span class="comment">-- ファイル出力ロガーを初期化する</span></Line>  <Line no="1119" valid="False" visited="False">	<span class="comment">-- 「logger」の要素にプロパティを設定</span></Line>  <Line no="1120" valid="False" visited="False">	<span class="comment">-- logger.file_name：ファイル名</span></Line>  <Line no="1121" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initLogstreamFile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">logprop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"logger"</span><span class="misc">)</span></Line>  <Line no="1123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">logstream</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">LogstreamFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="string">"file"</span><span class="misc">)</span></Line>  <Line no="1124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">logstream</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1125" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="1126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">logstream</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">logprop</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1128" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">logstream</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">LogstreamFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">logstream</span><span class="misc">)</span></Line>  <Line no="1129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">addLogger</span><span class="misc">(</span><span class="identifier">logstream</span><span class="misc">)</span></Line>  <Line no="1131" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1132" valid="False" visited="False"/>  <Line no="1133" valid="False" visited="False">	<span class="comment">-- ロガープラグイン初期化</span></Line>  <Line no="1134" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initLogstreamPlugins</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1135" valid="False" visited="False"/>  <Line no="1136" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1137" valid="False" visited="False"/>  <Line no="1138" valid="False" visited="False">	<span class="comment">-- 外部ロガーモジュール初期化</span></Line>  <Line no="1139" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initLogstreamOthers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">LogstreamFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"logger.logstream"</span><span class="misc">)</span></Line>  <Line no="1142" valid="False" visited="False"/>  <Line no="1143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">leaf0</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pp</span><span class="misc">:</span><span class="identifier">getLeaf</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1144" valid="False" visited="False"/>  <Line no="1145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">l</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">leaf0</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1146" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">lstype</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">l</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">logstream</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">lstype</span><span class="misc">)</span></Line>  <Line no="1148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">logstream</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1149" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Logstream "</span><span class="operator">..</span><span class="identifier">lstype..</span><span class="string">" creation failed."</span><span class="misc">)</span></Line>  <Line no="1150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1151" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Logstream "</span><span class="operator">..</span><span class="identifier">lstype..</span><span class="string">" created."</span><span class="misc">)</span></Line>  <Line no="1152" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">logstream</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">l</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1153" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Logstream "</span><span class="operator">..</span><span class="identifier">lstype..</span><span class="string">" init failed."</span><span class="misc">)</span></Line>  <Line no="1154" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">logstream</span><span class="misc">)</span></Line>  <Line no="1155" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Logstream "</span><span class="operator">..</span><span class="identifier">lstype..</span><span class="string">" deleted."</span><span class="misc">)</span></Line>  <Line no="1156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Logstream "</span><span class="operator">..</span><span class="identifier">lstype..</span><span class="string">" added."</span><span class="misc">)</span></Line>  <Line no="1158" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">addLogger</span><span class="misc">(</span><span class="identifier">logstream</span><span class="misc">)</span></Line>  <Line no="1159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1162" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1163" valid="False" visited="False"/>  <Line no="1164" valid="False" visited="False">	<span class="comment">-- ロガー初期化</span></Line>  <Line no="1165" valid="False" visited="False">	<span class="comment">-- @param true：設定成功</span></Line>  <Line no="1166" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initLogger</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._config:getProperty("logger.enable"), StringUtil.toBool(self._config:getProperty("logger.enable"), "YES", "NO", true))</span></Line>  <Line no="1169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.enable"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1172" valid="False" visited="False"/>  <Line no="1173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">initLogstreamFile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">initLogstreamPlugins</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">initLogstreamOthers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1176" valid="False" visited="False"/>  <Line no="1177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">setLogLevel</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.log_level"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">setLogLock</span><span class="misc">(</span><span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.stream_lock"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"enable"</span><span class="misc">,</span>&nbsp;<span class="string">"disable"</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"openrtm.version"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Copyright (C) 2018"</span><span class="misc">)</span></Line>  <Line no="1182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"  Nobuhiko Miyamoto"</span><span class="misc">)</span></Line>  <Line no="1183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"  Tokyo Metropolitan University"</span><span class="misc">)</span></Line>  <Line no="1184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Manager starting."</span><span class="misc">)</span></Line>  <Line no="1185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Starting local logging."</span><span class="misc">)</span></Line>  <Line no="1186" valid="False" visited="False"/>  <Line no="1187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1188" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1189" valid="False" visited="False"/>  <Line no="1190" valid="False" visited="False">	<span class="comment">-- ロガー終了</span></Line>  <Line no="1191" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownLogger</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1192" valid="False" visited="False"/>  <Line no="1193" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1194" valid="False" visited="False"/>  <Line no="1195" valid="False" visited="False">	<span class="comment">-- ORB初期化</span></Line>  <Line no="1196" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1197" valid="False" visited="False"/>  <Line no="1198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ORB_Dummy_ENABLE</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1199" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ORB_Dummy</span></Line>  <Line no="1200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.init</span><span class="misc">{</span>&nbsp;<span class="identifier">flavor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"cooperative;corba;intercepted;typed;base;"</span>&nbsp;<span class="misc">}</span></Line>  <Line no="1202" valid="False" visited="False"/>  <Line no="1203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">oil.VERSION</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"OiL 0.5"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1206" valid="False" visited="False"/>  <Line no="1207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"CosNaming.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"RTC.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"OpenRTM.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"DataPort.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"Manager.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="string">"InterfaceDataTypes.idl"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._orb.types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="1215" valid="False" visited="False"/>  <Line no="1216" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1217" valid="False" visited="False"/>  <Line no="1218" valid="False" visited="False"/>  <Line no="1219" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">loadIdLFile</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">loadidlfile</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1221" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1222" valid="False" visited="False"/>  <Line no="1223" valid="False" visited="False">	<span class="comment">-- IDLファイルパス取得</span></Line>  <Line no="1224" valid="False" visited="False">	<span class="comment">-- @param name IDLファイル名</span></Line>  <Line no="1225" valid="False" visited="False">	<span class="comment">-- IDLファイルは、Manager.luaの存在するディレクトリの2階層上のディレクトリを検索する</span></Line>  <Line no="1226" valid="False" visited="False">	<span class="comment">-- @return IDLファイルパス</span></Line>  <Line no="1227" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">findIdLFile</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">fpath</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.dirname</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="library">debug.getinfo</span><span class="misc">(</span><span class="number">1</span><span class="misc">)</span><span class="misc">[</span><span class="string">"source"</span><span class="misc">]</span><span class="misc">,</span><span class="number">2</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local fpath = StringUtil.dirname(string.gsub(debug.getinfo(1)["source"],"@",""))</span></Line>  <Line no="1230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(fpath)</span></Line>  <Line no="1231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">fpath</span><span class="misc">,</span><span class="string">"\\"</span><span class="misc">,</span><span class="string">"/"</span><span class="misc">)</span><span class="operator">..</span><span class="string">"../idl/"</span><span class="operator">..</span><span class="identifier">name</span></Line>  <Line no="1232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_str)</span></Line>  <Line no="1233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_str</span></Line>  <Line no="1234" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1235" valid="False" visited="False"/>  <Line no="1236" valid="False" visited="False">	<span class="comment">-- ORBのオプション生成</span></Line>  <Line no="1237" valid="False" visited="False">	<span class="comment">-- @return オプション</span></Line>  <Line no="1238" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">createORBOptions</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1239" valid="False" visited="False"/>  <Line no="1240" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1241" valid="False" visited="False"/>  <Line no="1242" valid="False" visited="False">	<span class="comment">-- プロパティからエンドポイント一覧を取得</span></Line>  <Line no="1243" valid="False" visited="False">	<span class="comment">-- @param endpoints エンドポイント一覧を格納する変数</span></Line>  <Line no="1244" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">createORBEndpoints</span><span class="misc">(</span><span class="identifier">endpoints</span><span class="misc">)</span></Line>  <Line no="1245" valid="False" visited="False"/>  <Line no="1246" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1247" valid="False" visited="False"/>  <Line no="1248" valid="False" visited="False">	<span class="comment">-- エンドポイントのオプション生成</span></Line>  <Line no="1249" valid="False" visited="False">	<span class="comment">-- @param opt オプションの文字列を格納する変数</span></Line>  <Line no="1250" valid="False" visited="False">	<span class="comment">-- @param endpoints エンドポイント一覧</span></Line>  <Line no="1251" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">createORBEndpointOption</span><span class="misc">(</span><span class="identifier">opt</span><span class="misc">,</span>&nbsp;<span class="identifier">endpoints</span><span class="misc">)</span></Line>  <Line no="1252" valid="False" visited="False"/>  <Line no="1253" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1254" valid="False" visited="False"/>  <Line no="1255" valid="False" visited="False">	<span class="comment">-- ORB終了</span></Line>  <Line no="1256" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1259" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1260" valid="False" visited="False"/>  <Line no="1261" valid="False" visited="False">	<span class="comment">-- ネームサーバー接続初期化</span></Line>  <Line no="1262" valid="False" visited="False">	<span class="comment">-- 「naming.enable」のプロパティがYESの時に有効</span></Line>  <Line no="1263" valid="False" visited="False">	<span class="comment">-- 「naming.type」のプロパティでメソッドを指定</span></Line>  <Line no="1264" valid="False" visited="False">	<span class="comment">-- 「メソッド名.nameservers」で利用するアドレスを指定</span></Line>  <Line no="1265" valid="False" visited="False">	<span class="comment">-- @return true：初期化成功、false：初期化失敗</span></Line>  <Line no="1266" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initNaming</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.initNaming()"</span><span class="misc">)</span></Line>  <Line no="1268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._namingManager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NamingManager.new</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(StringUtil.toBool(self._config:getProperty("naming.enable"), "YES", "NO", true))</span></Line>  <Line no="1270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.enable"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1271" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">meths</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.type"</span><span class="misc">)</span><span class="misc">,</span><span class="string">","</span><span class="misc">)</span></Line>  <Line no="1274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">meths</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.strip</span><span class="misc">(</span><span class="identifier">meths</span><span class="misc">)</span></Line>  <Line no="1275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._config:getProperty("naming.type"))</span></Line>  <Line no="1276" valid="False" visited="False"/>  <Line no="1277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">meth</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">meths</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(meth)</span></Line>  <Line no="1279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">meth..</span><span class="string">".nameservers"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="1280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">j</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1281" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(name)</span></Line>  <Line no="1282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Register Naming Server: "</span><span class="operator">..</span><span class="identifier">meth..</span><span class="string">"/"</span><span class="operator">..</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">registerNameServer</span><span class="misc">(</span><span class="identifier">meth</span><span class="misc">,</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1284" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1285" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.update.enable"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1289" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1290" valid="False" visited="False"/>  <Line no="1291" valid="False" visited="False">	<span class="comment">-- ネームサーバー接続終了</span></Line>  <Line no="1292" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownNaming</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1293" valid="False" visited="False"/>  <Line no="1294" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1295" valid="False" visited="False"/>  <Line no="1296" valid="False" visited="False">	<span class="comment">-- 実行コンテキスト生成ファクトリ初期化</span></Line>  <Line no="1297" valid="False" visited="False">	<span class="comment">-- @return true：初期化成功、false：初期化失敗</span></Line>  <Line no="1298" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initExecContext</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1299" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.initExecContext()"</span><span class="misc">)</span></Line>  <Line no="1300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PeriodicExecutionContext.Init</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OpenHRPExecutionContext.Init</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">SimulatorExecutionContext.Init</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1303" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1305" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1306" valid="False" visited="False"/>  <Line no="1307" valid="False" visited="False">	<span class="comment">-- 複合コンポーネント生成ファクトリ初期化</span></Line>  <Line no="1308" valid="False" visited="False">	<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1309" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initComposite</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1311" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1312" valid="False" visited="False"/>  <Line no="1313" valid="False" visited="False">	<span class="comment">-- ファクトリ初期化</span></Line>  <Line no="1314" valid="False" visited="False">	<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1315" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initFactories</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">FactoryInit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1318" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1319" valid="False" visited="False"/>  <Line no="1320" valid="False" visited="False">	<span class="comment">-- タイマ初期化</span></Line>  <Line no="1321" valid="False" visited="False">	<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1322" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initTimer</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1324" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1325" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">endpointPropertySwitch</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1326" valid="False" visited="False"/>  <Line no="1327" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1328" valid="False" visited="False"/>  <Line no="1329" valid="False" visited="False">	<span class="comment">-- iPv4、iPv6のエンドポイント一覧取得</span></Line>  <Line no="1330" valid="False" visited="False">	<span class="comment">-- @return エンドポイント一覧</span></Line>  <Line no="1331" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">setEndpointProperty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1334" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1335" valid="False" visited="False"/>  <Line no="1336" valid="False" visited="False">	<span class="comment">-- マネージャサーバント初期化</span></Line>  <Line no="1337" valid="False" visited="False">	<span class="comment">-- 「manager.corba_servant」のプロパティがYESの時に有効</span></Line>  <Line no="1338" valid="False" visited="False">	<span class="comment">-- 「manager.is_master」のプロパティがYESの時にはマスターマネージャで起動</span></Line>  <Line no="1339" valid="False" visited="False">	<span class="comment">-- @return true：初期化成功、false：初期化失敗</span></Line>  <Line no="1340" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initManagerServant</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.initManagerServant()"</span><span class="misc">)</span></Line>  <Line no="1342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span></Line>  <Line no="1343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.corba_servant"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span><span class="string">"NO"</span><span class="misc">,</span><span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1344" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1345" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1346" valid="False" visited="False"/>  <Line no="1347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgrservant</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ManagerServant.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1348" valid="False" visited="False"/>  <Line no="1349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"corba.endpoints_ipv4"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setEndpointProperty</span><span class="misc">(</span><span class="identifier">self._mgrservant</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"manager"</span><span class="misc">)</span></Line>  <Line no="1353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming_formats"</span><span class="misc">)</span><span class="misc">,</span><span class="string">","</span><span class="misc">)</span></Line>  <Line no="1354" valid="False" visited="False"/>  <Line no="1355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"is_master"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"YES"</span><span class="misc">,</span><span class="string">"NO"</span><span class="misc">,</span><span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1357" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i, name in ipairs(names) do</span></Line>  <Line no="1358" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	local mgr_name = self:formatString(name, prop)</span></Line>  <Line no="1359" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	self._namingManager:bindManagerObject(mgr_name, self._mgrservant)</span></Line>  <Line no="1360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="1361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"corba.update_master_manager.enable"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span></Line>  <Line no="1364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.is_master"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1366" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1367" valid="False" visited="False"/>  <Line no="1368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">otherref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1369" valid="False" visited="False"/>  <Line no="1370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1375" valid="False" visited="False"/>  <Line no="1376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1377" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1378" valid="False" visited="False"/>  <Line no="1379" valid="False" visited="False">	<span class="comment">-- ローカルサービス初期化</span></Line>  <Line no="1380" valid="False" visited="False">	<span class="comment">-- @return true：初期化成功、false：初期化失敗</span></Line>  <Line no="1381" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initLocalService</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1382" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1383" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1384" valid="False" visited="False"/>  <Line no="1385" valid="False" visited="False">	<span class="comment">-- 全RTC終了処理</span></Line>  <Line no="1386" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">shutdownComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1387" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.shutdownComponents()"</span><span class="misc">)</span></Line>  <Line no="1388" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1389" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1390" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1391" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1392" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1393" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">key</span><span class="operator">=</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1394" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1397" valid="False" visited="False"/>  <Line no="1398" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="1399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1401" valid="False" visited="False"/>  <Line no="1402" valid="False" visited="False"/>  <Line no="1403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">ec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1404" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1405" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1406" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">ec._svr</span><span class="misc">)</span></Line>  <Line no="1407" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1408" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1409" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="1410" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1411" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1412" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1413" valid="False" visited="False"/>  <Line no="1414" valid="False" visited="False">	<span class="comment">-- RTC登録解除</span></Line>  <Line no="1415" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="1416" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">cleanupComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="1417" valid="False" visited="False"/>  <Line no="1418" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1419" valid="False" visited="False"/>  <Line no="1420" valid="False" visited="False">	<span class="comment">-- 全RTC登録解除</span></Line>  <Line no="1421" valid="False" visited="False">	<span class="comment">-- 一旦、削除リストに格納したRTCを削除する</span></Line>  <Line no="1422" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">cleanupComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1423" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_VERBOSE</span><span class="misc">(</span><span class="string">"Manager.cleanupComponents()"</span><span class="misc">)</span></Line>  <Line no="1424" valid="False" visited="False"/>  <Line no="1425" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_VERBOSE</span><span class="misc">(</span><span class="operator">#</span><span class="identifier">self._finalized.comps..</span><span class="string">" components are marked as finalized."</span><span class="misc">)</span></Line>  <Line no="1426" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">_comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._finalized.comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1427" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deleteComponent</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">comp</span><span class="operator">=</span><span class="identifier">_comp</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1428" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1429" valid="False" visited="False"/>  <Line no="1430" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._finalized.comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1431" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1432" valid="False" visited="False"/>  <Line no="1433" valid="False" visited="False">	<span class="comment">-- RTCを削除リストに追加する</span></Line>  <Line no="1434" valid="False" visited="False">	<span class="comment">-- @param _comp RTC</span></Line>  <Line no="1435" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">notifyFinalized</span><span class="misc">(</span><span class="identifier">_comp</span><span class="misc">)</span></Line>  <Line no="1436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.notifyFinalized()"</span><span class="misc">)</span></Line>  <Line no="1437" valid="False" visited="False"/>  <Line no="1438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--table.insert(self._finalized.comps, _comp)</span></Line>  <Line no="1439" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deleteComponent</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">comp</span><span class="operator">=</span><span class="identifier">_comp</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1440" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1441" valid="False" visited="False"/>  <Line no="1442" valid="False" visited="False">	<span class="comment">-- RTC名、オプションを文字列から取得</span></Line>  <Line no="1443" valid="False" visited="False">	<span class="comment">-- @param comp_arg RTC名、オプション(RTC?param1=xxx&amp;param2=yyy)</span></Line>  <Line no="1444" valid="False" visited="False">	<span class="comment">-- RTC名は「RTC:ベンダ名:カテゴリ名:実装ID:言語名:バージョン」で指定</span></Line>  <Line no="1445" valid="False" visited="False">	<span class="comment">-- @param comp_id RTC型名</span></Line>  <Line no="1446" valid="False" visited="False">	<span class="comment">-- 以下の要素を格納する</span></Line>  <Line no="1447" valid="False" visited="False">	<span class="comment">-- vendor：ベンダ名</span></Line>  <Line no="1448" valid="False" visited="False">	<span class="comment">-- category：カテゴリ名</span></Line>  <Line no="1449" valid="False" visited="False">	<span class="comment">-- implementation_id：実装ID</span></Line>  <Line no="1450" valid="False" visited="False">	<span class="comment">-- language：言語名</span></Line>  <Line no="1451" valid="False" visited="False">	<span class="comment">-- version：バージョン</span></Line>  <Line no="1452" valid="False" visited="False">	<span class="comment">-- @param comp_conf オプション</span></Line>  <Line no="1453" valid="False" visited="False">	<span class="comment">-- @return true：取得成功、false：取得失敗</span></Line>  <Line no="1454" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">procComponentArgs</span><span class="misc">(</span><span class="identifier">comp_arg</span><span class="misc">,</span>&nbsp;<span class="identifier">comp_id</span><span class="misc">,</span>&nbsp;<span class="identifier">comp_conf</span><span class="misc">)</span></Line>  <Line no="1455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id_and_conf_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">comp_arg</span><span class="misc">,</span>&nbsp;<span class="string">"?"</span><span class="misc">)</span></Line>  <Line no="1456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id_and_conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1457" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">id_and_conf_str</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">id_and_conf</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1461" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1462" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--StringUtil.print_table(id_and_conf)</span></Line>  <Line no="1463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">id_and_conf</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="operator">#</span><span class="identifier">id_and_conf</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">2</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1464" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invalid arguments. Two or more '?'"</span><span class="misc">)</span></Line>  <Line no="1465" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1466" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CompParam.prof_list</span></Line>  <Line no="1468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">param_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">prof</span></Line>  <Line no="1469" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prof[1],id_and_conf[1])</span></Line>  <Line no="1470" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id_and_conf</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="string">":"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1471" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">id_and_conf</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prof</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">":::"</span><span class="operator">..</span><span class="identifier">id_and_conf</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">"::"</span></Line>  <Line no="1472" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1473" valid="False" visited="False"/>  <Line no="1474" valid="False" visited="False"/>  <Line no="1475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">id_and_conf</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="string">":"</span><span class="misc">)</span></Line>  <Line no="1476" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1477" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(id_and_conf[1],#id_str)</span></Line>  <Line no="1478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">id_str</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1480" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1481" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1482" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">id</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">param_num</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1484" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invalid RTC id format."</span><span class="misc">)</span></Line>  <Line no="1485" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1486" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1487" valid="False" visited="False"/>  <Line no="1488" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">prof</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1489" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invalid id type."</span><span class="misc">)</span></Line>  <Line no="1490" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1491" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1492" valid="False" visited="False"/>  <Line no="1493" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span><span class="identifier">param_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1494" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prof[i], id[i])</span></Line>  <Line no="1495" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_id</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="1496" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prof[i])</span></Line>  <Line no="1497" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"RTC basic profile "</span><span class="operator">..</span><span class="identifier">prof</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">..</span><span class="string">": "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="1498" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1499" valid="False" visited="False"/>  <Line no="1500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">id_and_conf</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">2</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">id_and_conf</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="string">"&amp;"</span><span class="misc">)</span></Line>  <Line no="1502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">conf_str</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1505" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1507" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1508" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">conf</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1509" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keyval_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="string">"="</span><span class="misc">)</span></Line>  <Line no="1510" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keyval</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1511" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">keyval_str</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1513" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">keyval</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1515" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">keyval</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1517" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_conf</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">keyval</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">,</span><span class="identifier">keyval</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="1518" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"RTC property "</span><span class="operator">..</span><span class="identifier">keyval</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">": "</span><span class="operator">..</span><span class="identifier">keyval</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="1519" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1520" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1521" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1522" valid="False" visited="False"/>  <Line no="1523" valid="False" visited="False"/>  <Line no="1524" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1525" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1526" valid="False" visited="False"/>  <Line no="1527" valid="False" visited="False">	<span class="comment">-- EC名、オプションを文字列から取得</span></Line>  <Line no="1528" valid="False" visited="False">	<span class="comment">-- @param ec_args EC名、オプションの文字列</span></Line>  <Line no="1529" valid="False" visited="False">	<span class="comment">-- @param ec_id EC名</span></Line>  <Line no="1530" valid="False" visited="False">	<span class="comment">-- @param ec_conf オプション</span></Line>  <Line no="1531" valid="False" visited="False">	<span class="comment">-- @return true：取得成功、false：取得失敗</span></Line>  <Line no="1532" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">procContextArgs</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_conf</span><span class="misc">)</span></Line>  <Line no="1533" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1534" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1535" valid="False" visited="False"/>  <Line no="1536" valid="False" visited="False">	<span class="comment">-- RTCのコンフィギュレーション設定</span></Line>  <Line no="1537" valid="False" visited="False">	<span class="comment">-- 以下の名前でコンフィグレーションファイルを指定</span></Line>  <Line no="1538" valid="False" visited="False">	<span class="comment">-- カテゴリ名.型名.config_file</span></Line>  <Line no="1539" valid="False" visited="False">	<span class="comment">-- カテゴリ名.インスタンス名.config_file</span></Line>  <Line no="1540" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="1541" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="1542" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">configureComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="1543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">category</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getCategory</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">type_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getTypeName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1545" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">inst_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">type_conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">type_name..</span><span class="string">".config_file"</span></Line>  <Line no="1547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">inst_name..</span><span class="string">".config_file"</span></Line>  <Line no="1548" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">type_prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1549" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1550" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config_fname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1551" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">name_conf</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1552" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">inst_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1554" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">temp_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">inst_name</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1555" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">temp_</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1556" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="operator">#</span><span class="identifier">keys_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">keys_</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">keys_</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"config_file"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1557" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">inst_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1558" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Component name conf exists in rtc.conf. Merged."</span><span class="misc">)</span></Line>  <Line no="1559" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="identifier">name_prop</span><span class="misc">)</span></Line>  <Line no="1560" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1561" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">config_fname</span><span class="misc">,</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1562" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1563" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1564" valid="False" visited="False"/>  <Line no="1565" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1566" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">type_conf</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1567" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1568" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">type_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1569" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">temp_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">type_name</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1570" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">temp_</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1571" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="operator">#</span><span class="identifier">keys_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">keys_</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">keys_</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"config_file"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1572" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">type_prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">category..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">type_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1573" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Component name conf exists in rtc.conf. Merged."</span><span class="misc">)</span></Line>  <Line no="1574" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="identifier">type_prop</span><span class="misc">)</span></Line>  <Line no="1575" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1576" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">config_fname</span><span class="misc">,</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1577" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1578" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1579" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1580" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="1581" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">type_prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">name_prop</span><span class="misc">)</span></Line>  <Line no="1582" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">type_prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">,</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">StringUtil.unique_sv</span><span class="misc">(</span><span class="identifier">config_fname</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1583" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">type_prop</span><span class="misc">)</span></Line>  <Line no="1584" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1585" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">naming_formats</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.formats"</span><span class="misc">)</span></Line>  <Line no="1586" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp_prop</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="string">"naming.formats"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1587" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">naming_formats</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp_prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.formats"</span><span class="misc">)</span></Line>  <Line no="1588" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1589" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">naming_formats</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">StringUtil.unique_sv</span><span class="misc">(</span><span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">naming_formats</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1590" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(naming_formats)</span></Line>  <Line no="1591" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">naming_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">formatString</span><span class="misc">(</span><span class="identifier">naming_formats</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1592" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(naming_names)</span></Line>  <Line no="1593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"naming.formats"</span><span class="misc">,</span><span class="identifier">naming_formats</span><span class="misc">)</span></Line>  <Line no="1594" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"naming.names"</span><span class="misc">,</span><span class="identifier">naming_names</span><span class="misc">)</span></Line>  <Line no="1595" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp:getProperties())</span></Line>  <Line no="1596" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1597" valid="False" visited="False"/>  <Line no="1598" valid="False" visited="False">	<span class="comment">-- ファイルからプロパティを追加する</span></Line>  <Line no="1599" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="1600" valid="False" visited="False">	<span class="comment">-- @param file_name ファイルパス</span></Line>  <Line no="1601" valid="False" visited="False">	<span class="comment">-- @return true：追加成功、false：追加失敗</span></Line>  <Line no="1602" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">mergeProperty</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="1603" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1604" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1605" valid="False" visited="False"/>  <Line no="1606" valid="False" visited="False">	<span class="comment">-- フォーマットに従ってRTC名変換</span></Line>  <Line no="1607" valid="False" visited="False">	<span class="comment">-- 以下の置き換えを行う</span></Line>  <Line no="1608" valid="False" visited="False">	<span class="comment">-- %n：インスタンス名</span></Line>  <Line no="1609" valid="False" visited="False">	<span class="comment">-- %t：型名</span></Line>  <Line no="1610" valid="False" visited="False">	<span class="comment">-- %m：型名</span></Line>  <Line no="1611" valid="False" visited="False">	<span class="comment">-- %v：バージョン</span></Line>  <Line no="1612" valid="False" visited="False">	<span class="comment">-- %V：ベンダ名</span></Line>  <Line no="1613" valid="False" visited="False">	<span class="comment">-- %c：カテゴリ名</span></Line>  <Line no="1614" valid="False" visited="False">	<span class="comment">-- %h：ホスト名</span></Line>  <Line no="1615" valid="False" visited="False">	<span class="comment">-- %M：マネージャ名</span></Line>  <Line no="1616" valid="False" visited="False">	<span class="comment">-- %p：プロセスID</span></Line>  <Line no="1617" valid="False" visited="False">	<span class="comment">-- @param naming_format フォーマット</span></Line>  <Line no="1618" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="1619" valid="False" visited="False">	<span class="comment">-- @return 変換後文字列</span></Line>  <Line no="1620" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">formatString</span><span class="misc">(</span><span class="identifier">naming_format</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="1621" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">naming_format</span></Line>  <Line no="1622" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="1623" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="1624" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">len_</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">name_</span></Line>  <Line no="1625" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="1626" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local ok, ret = xpcall(</span></Line>  <Line no="1627" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--		function()</span></Line>  <Line no="1628" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">flag</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1629" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span class="misc">(</span><span class="identifier">flag</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1630" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1631" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="1632" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(n)</span></Line>  <Line no="1633" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1634" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="1635" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1636" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(n,name_)</span></Line>  <Line no="1637" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'%'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1638" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1639" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="number">2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1640" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..n</span></Line>  <Line no="1641" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1642" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'$'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1643" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="1644" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1645" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="1646" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1647" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="1648" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1649" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'{'</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'('</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1650" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1651" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="1652" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">env</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="1653" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">start</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="1654" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1655" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'}'</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">')'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1656" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="1657" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1658" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="1659" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1660" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">env</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">env..n</span></Line>  <Line no="1661" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1662" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">,</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="1663" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1664" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--envval = os.getenv(env)</span></Line>  <Line no="1665" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if envval then</span></Line>  <Line no="1666" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	str_ = str_..envval</span></Line>  <Line no="1667" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="1668" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1669" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1670" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="number">2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1671" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="1672" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"n"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">)</span></Line>  <Line no="1673" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"t"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"type_name"</span><span class="misc">)</span></Line>  <Line no="1674" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"m"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"type_name"</span><span class="misc">)</span></Line>  <Line no="1675" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"v"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"version"</span><span class="misc">)</span></Line>  <Line no="1676" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"V"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"vendor"</span><span class="misc">)</span></Line>  <Line no="1677" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"c"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"category"</span><span class="misc">)</span></Line>  <Line no="1678" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"h"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"os.hostname"</span><span class="misc">)</span></Line>  <Line no="1679" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"M"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.name"</span><span class="misc">)</span></Line>  <Line no="1680" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"p"</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.pid"</span><span class="misc">)</span></Line>  <Line no="1681" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..n</span>&nbsp;<span class="keyword">end</span></Line>  <Line no="1682" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1683" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="1684" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">str_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">str_..n</span></Line>  <Line no="1685" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1686" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1687" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1688" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str_</span></Line>  <Line no="1689" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--		end)</span></Line>  <Line no="1690" valid="False" visited="False"/>  <Line no="1691" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1692" valid="False" visited="False"/>  <Line no="1693" valid="False" visited="False">	<span class="comment">-- ロガー取得</span></Line>  <Line no="1694" valid="False" visited="False">	<span class="comment">-- @param name ロガー名</span></Line>  <Line no="1695" valid="False" visited="False">	<span class="comment">-- @return ロガー</span></Line>  <Line no="1696" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1697" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1698" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"Manager"</span></Line>  <Line no="1699" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1700" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.enable"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1701" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(LogStream.new())</span></Line>  <Line no="1702" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">LogStream.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogger</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1703" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1704" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._rtcout</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1705" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">LogStream.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1706" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._config:getProperty("logger.log_level"))</span></Line>  <Line no="1707" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">setLogLevel</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"logger.log_level"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1708" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">getLogger</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1709" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1710" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">getLogger</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="1711" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1712" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1713" valid="False" visited="False"/>  <Line no="1714" valid="False" visited="False">	<span class="comment">-- プロパティ取得</span></Line>  <Line no="1715" valid="False" visited="False">	<span class="comment">-- @return プロパティ</span></Line>  <Line no="1716" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1717" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._config</span></Line>  <Line no="1718" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1719" valid="False" visited="False"/>  <Line no="1720" valid="False" visited="False">	<span class="comment">-- モジュールを直接ロードする</span></Line>  <Line no="1721" valid="False" visited="False">	<span class="comment">-- @param file_name ファイルパス</span></Line>  <Line no="1722" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">try_direct_load</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="1723" valid="False" visited="False"/>  <Line no="1724" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1725" valid="False" visited="False"/>  <Line no="1726" valid="False" visited="False">	<span class="comment">-- ネームサーバーにポートを登録する</span></Line>  <Line no="1727" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="1728" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">publishPorts</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="1729" valid="False" visited="False"/>  <Line no="1730" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1731" valid="False" visited="False"/>  <Line no="1732" valid="False" visited="False">	<span class="comment">-- ネームサーバーからポートを取得して接続する</span></Line>  <Line no="1733" valid="False" visited="False">	<span class="comment">-- @param comp RTC</span></Line>  <Line no="1734" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">subscribePorts</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="1735" valid="False" visited="False"/>  <Line no="1736" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1737" valid="False" visited="False"/>  <Line no="1738" valid="False" visited="False">	<span class="comment">-- ネームサーバーからポート一覧を取得</span></Line>  <Line no="1739" valid="False" visited="False">	<span class="comment">-- @param nsname パス</span></Line>  <Line no="1740" valid="False" visited="False">	<span class="comment">-- @param kind kind</span></Line>  <Line no="1741" valid="False" visited="False">	<span class="comment">-- @return ポート一覧</span></Line>  <Line no="1742" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getPortsOnNameServers</span><span class="misc">(</span><span class="identifier">nsname</span><span class="misc">,</span>&nbsp;<span class="identifier">kind</span><span class="misc">)</span></Line>  <Line no="1743" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1744" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1745" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1746" valid="False" visited="False"/>  <Line no="1747" valid="False" visited="False">	<span class="comment">-- データポートを接続する</span></Line>  <Line no="1748" valid="False" visited="False">	<span class="comment">-- @param port ポート</span></Line>  <Line no="1749" valid="False" visited="False">	<span class="comment">-- @param target_ports 接続先のポート一覧</span></Line>  <Line no="1750" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">connectDataPorts</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">target_ports</span><span class="misc">)</span></Line>  <Line no="1751" valid="False" visited="False"/>  <Line no="1752" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1753" valid="False" visited="False"/>  <Line no="1754" valid="False" visited="False">	<span class="comment">-- サービスポートを接続する</span></Line>  <Line no="1755" valid="False" visited="False">	<span class="comment">-- @param port ポート</span></Line>  <Line no="1756" valid="False" visited="False">	<span class="comment">-- @param target_ports 接続先のポート一覧</span></Line>  <Line no="1757" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">connectServicePorts</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">,</span>&nbsp;<span class="identifier">target_ports</span><span class="misc">)</span></Line>  <Line no="1758" valid="False" visited="False"/>  <Line no="1759" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1760" valid="False" visited="False"/>  <Line no="1761" valid="False" visited="False">	<span class="comment">-- 起動時にポートを自動接続する関数</span></Line>  <Line no="1762" valid="False" visited="False">	<span class="comment">-- rtc.confに以下のように記述</span></Line>  <Line no="1763" valid="False" visited="False">	<span class="comment">-- manager.components.preconnect: ConsoleIn0.out?port=ConsoleOut0.in&amp;dataflow_type=pull</span></Line>  <Line no="1764" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initPreConnection</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1765" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Connection pre-creation: "</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.components.preconnect"</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1766" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">connectors</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.components.preconnect"</span><span class="misc">)</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="1767" valid="False" visited="False"/>  <Line no="1768" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1769" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1770" valid="False" visited="False"/>  <Line no="1771" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1772" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1773" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port0_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">,</span><span class="string">"?"</span><span class="misc">)</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="1774" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.urlparam2map</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1775" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(port0_str)</span></Line>  <Line no="1776" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for k,v in pairs(param) do</span></Line>  <Line no="1777" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(k,v)</span></Line>  <Line no="1778" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="1779" valid="False" visited="False"/>  <Line no="1780" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1781" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">configs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1782" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">param</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1783" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">k</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"port"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1784" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">,</span><span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="1785" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1786" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">k</span><span class="misc">,</span><span class="string">"port"</span><span class="misc">,</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="1787" valid="False" visited="False"/>  <Line no="1788" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.stringTo</span><span class="misc">(</span><span class="number">0</span><span class="misc">,</span>&nbsp;<span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="1789" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1790" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ports.append</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1791" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1792" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">configs</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span></Line>  <Line no="1793" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1794" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1795" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1796" valid="False" visited="False"/>  <Line no="1797" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">ports</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1798" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invalid format for pre-connection."</span><span class="misc">)</span></Line>  <Line no="1799" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Format must be Comp0.port0?port=Comp1.port1"</span><span class="misc">)</span></Line>  <Line no="1800" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1801" valid="False" visited="False"/>  <Line no="1802" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">configs</span><span class="misc">[</span><span class="string">"dataflow_type"</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1803" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">configs</span><span class="misc">[</span><span class="string">"dataflow_type"</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"push"</span></Line>  <Line no="1804" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1805" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">configs</span><span class="misc">[</span><span class="string">"interface_type"</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1806" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">configs</span><span class="misc">[</span><span class="string">"interface_type"</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"data_service"</span></Line>  <Line no="1807" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1808" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port0_str</span><span class="misc">,</span><span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="1809" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">tmp</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1810" valid="False" visited="False"/>  <Line no="1811" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp0_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">,</span><span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="1812" valid="False" visited="False"/>  <Line no="1813" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port0_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port0_str</span></Line>  <Line no="1814" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp0_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1815" valid="False" visited="False"/>  <Line no="1816" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">comp0_name</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1817" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp0_name)</span></Line>  <Line no="1818" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp0</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponent</span><span class="misc">(</span><span class="identifier">comp0_name</span><span class="misc">)</span></Line>  <Line no="1819" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp0)</span></Line>  <Line no="1820" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp0</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1821" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">comp0_name..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1822" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1823" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp0_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp0</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1824" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1825" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1826" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">comp0_name</span><span class="misc">)</span></Line>  <Line no="1827" valid="False" visited="False"/>  <Line no="1828" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1829" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">comp0_name..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1830" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1831" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp0_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtcs</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="1832" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port0_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port0_str</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="1833" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port0_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port0_name</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">port0_name</span><span class="misc">]</span></Line>  <Line no="1834" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1835" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1836" valid="False" visited="False"/>  <Line no="1837" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port0_var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">comp0_ref</span><span class="misc">,</span>&nbsp;<span class="identifier">port0_name</span><span class="misc">)</span></Line>  <Line no="1838" valid="False" visited="False"/>  <Line no="1839" valid="False" visited="False"/>  <Line no="1840" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port0_var</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1841" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"port "</span><span class="operator">..</span><span class="identifier">port0_str..</span><span class="string">" found: "</span><span class="misc">)</span></Line>  <Line no="1842" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1843" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">port_str</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1844" valid="False" visited="False"/>  <Line no="1845" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port_str</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="1846" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">tmp</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1847" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">,</span><span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="1848" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">port_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_str</span></Line>  <Line no="1849" valid="False" visited="False"/>  <Line no="1850" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1851" valid="False" visited="False"/>  <Line no="1852" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">comp_name</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1853" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp_name)</span></Line>  <Line no="1854" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponent</span><span class="misc">(</span><span class="identifier">comp_name</span><span class="misc">)</span></Line>  <Line no="1855" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1856" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">comp_name..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1857" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1858" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1859" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1860" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1861" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">comp_name</span><span class="misc">)</span></Line>  <Line no="1862" valid="False" visited="False"/>  <Line no="1863" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1864" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">comp_name..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1865" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1866" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtcs</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="1867" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">port_str</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="1868" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_name</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">port_name</span><span class="misc">]</span></Line>  <Line no="1869" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1870" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1871" valid="False" visited="False"/>  <Line no="1872" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1873" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port_var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.get_port_by_name</span><span class="misc">(</span><span class="identifier">comp_ref</span><span class="misc">,</span>&nbsp;<span class="identifier">port_name</span><span class="misc">)</span></Line>  <Line no="1874" valid="False" visited="False"/>  <Line no="1875" valid="False" visited="False"/>  <Line no="1876" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port_var</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1877" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"port "</span><span class="operator">..</span><span class="identifier">port_str..</span><span class="string">" found: "</span><span class="misc">)</span></Line>  <Line no="1878" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1879" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1880" valid="False" visited="False"/>  <Line no="1881" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">configs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1882" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">k</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">k</span><span class="misc">)</span></Line>  <Line no="1883" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1884" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"dataport."</span><span class="operator">..</span><span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1885" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1886" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(c)</span></Line>  <Line no="1887" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="1888" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(port0_var)</span></Line>  <Line no="1889" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(port_var)</span></Line>  <Line no="1890" valid="False" visited="False"/>  <Line no="1891" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.connect</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">port0_var</span><span class="misc">,</span>&nbsp;<span class="identifier">port_var</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1892" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_ERROR</span><span class="misc">(</span><span class="string">"Connection error: "</span><span class="operator">..</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1893" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1894" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1895" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1896" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1897" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1898" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1899" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1900" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1901" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1902" valid="False" visited="False"/>  <Line no="1903" valid="False" visited="False">	<span class="comment">-- 起動時にRTCを自動アクティブ化する関数</span></Line>  <Line no="1904" valid="False" visited="False">	<span class="comment">-- rtc.confに以下のように記述</span></Line>  <Line no="1905" valid="False" visited="False">	<span class="comment">-- manager.components.preactivation: ConsoleIn0, ConsoleOut0</span></Line>  <Line no="1906" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initPreActivation</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1907" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Components pre-activation: "</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.components.preactivation"</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1908" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.components.preactivation"</span><span class="misc">)</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="1909" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1910" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1911" valid="False" visited="False"/>  <Line no="1912" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1913" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1914" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1915" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponent</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1916" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1917" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">c..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1918" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1919" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1920" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1921" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1922" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._namingManager</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="1923" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1924" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">c..</span><span class="string">" not found."</span><span class="misc">)</span></Line>  <Line no="1925" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1926" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtcs</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="1927" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1928" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1929" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp_ref</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1930" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_RTCUtil.activate</span><span class="misc">(</span><span class="identifier">comp_ref</span><span class="misc">)</span></Line>  <Line no="1931" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1932" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">c..</span><span class="string">" activation filed."</span><span class="misc">)</span></Line>  <Line no="1933" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1934" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="identifier">c..</span><span class="string">" activated."</span><span class="misc">)</span></Line>  <Line no="1935" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1936" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1937" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1938" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1939" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1940" valid="False" visited="False"/>  <Line no="1941" valid="False" visited="False">	<span class="comment">-- 起動時にRTCを自動生成する関数</span></Line>  <Line no="1942" valid="False" visited="False">	<span class="comment">-- rtc.confに以下のように記述</span></Line>  <Line no="1943" valid="False" visited="False">	<span class="comment">-- manager.components.precreate: ConsoleIn, ConsoleOut</span></Line>  <Line no="1944" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">initPreCreation</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1945" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.strip</span><span class="misc">(</span><span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">self._config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.components.precreate"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1946" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">comps</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1947" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1948" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1949" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="1950" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1951" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1952" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1953" valid="False" visited="False"/>  <Line no="1954" valid="False" visited="False">	<span class="comment">-- マネージャサーバント取得</span></Line>  <Line no="1955" valid="False" visited="False">	<span class="comment">-- @return マネージャサーバント</span></Line>  <Line no="1956" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getManagerServant</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1957" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.getManagerServant()"</span><span class="misc">)</span></Line>  <Line no="1958" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._mgrservant</span></Line>  <Line no="1959" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1960" valid="False" visited="False"/>  <Line no="1961" valid="False" visited="False">	<span class="comment">-- RTC一覧取得</span></Line>  <Line no="1962" valid="False" visited="False">	<span class="comment">-- @return RTC一覧</span></Line>  <Line no="1963" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1964" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.getComponents()"</span><span class="misc">)</span></Line>  <Line no="1965" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._compManager</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1966" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1967" valid="False" visited="False"/>  <Line no="1968" valid="False" visited="False">	<span class="comment">-- ネーミングマネージャを取得</span></Line>  <Line no="1969" valid="False" visited="False">	<span class="comment">-- @return ネーミングマネージャ</span></Line>  <Line no="1970" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">getNaming</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1971" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.getNaming()"</span><span class="misc">)</span></Line>  <Line no="1972" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._namingManager</span></Line>  <Line no="1973" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1974" valid="False" visited="False"/>  <Line no="1975" valid="False" visited="False">	<span class="comment">-- モジュールのロード</span></Line>  <Line no="1976" valid="False" visited="False">	<span class="comment">-- @param fname ファイルパス</span></Line>  <Line no="1977" valid="False" visited="False">	<span class="comment">-- @param initfunc ファクトリ登録関数名</span></Line>  <Line no="1978" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="1979" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="1980" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.load(fname = "</span><span class="operator">..</span><span class="identifier">fname..</span><span class="string">", initfunc = "</span><span class="operator">..</span><span class="identifier">initfunc..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="1981" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span>&nbsp;<span class="string">"./"</span><span class="misc">)</span></Line>  <Line no="1982" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">preLoad</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="1983" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1984" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1985" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">initfunc</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1986" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">initfunc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"Init"</span></Line>  <Line no="1987" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1988" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(fname, initfunc)</span></Line>  <Line no="1989" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._module</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="1990" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"module path: "</span><span class="operator">..</span><span class="identifier">path</span><span class="misc">)</span></Line>  <Line no="1991" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">postLoad</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="1992" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1993" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1994" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception.type)</span></Line>  <Line no="1995" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception.name)</span></Line>  <Line no="1996" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1997" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">exception.type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"NotAllowedOperation"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1998" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Operation not allowed: "</span><span class="operator">..</span><span class="identifier">exception.reason</span><span class="misc">)</span></Line>  <Line no="1999" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="2000" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">exception.type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"NotFound"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2001" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Not found: "</span><span class="operator">..</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2002" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="2003" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">exception.type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"FileNotFound"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2004" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Not found: "</span><span class="operator">..</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2005" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="2006" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">exception.type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"InvalidArguments"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2007" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Invalid argument: "</span><span class="operator">..</span><span class="identifier">exception.reason</span><span class="misc">)</span></Line>  <Line no="2008" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="2009" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="2010" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown error."</span><span class="misc">)</span></Line>  <Line no="2011" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="2012" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2013" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2014" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="2015" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--return self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="2016" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2017" valid="False" visited="False"/>  <Line no="2018" valid="False" visited="False">	<span class="comment">-- モジュールのアンロード</span></Line>  <Line no="2019" valid="False" visited="False">	<span class="comment">-- @param fname ファイルパス</span></Line>  <Line no="2020" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">unload</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2021" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager.unload()"</span><span class="misc">)</span></Line>  <Line no="2022" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">preUnload</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2023" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._module</span><span class="misc">:</span><span class="identifier">unload</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2024" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.module_</span><span class="misc">:</span><span class="identifier">postUnload</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">)</span></Line>  <Line no="2025" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2026" valid="False" visited="False"/>  <Line no="2027" valid="False" visited="False"/>  <Line no="2028" valid="False" visited="False"/>  <Line no="2029" valid="False" visited="False"/>  <Line no="2030" valid="False" visited="False"/>  <Line no="2031" valid="False" visited="False"/>  <Line no="2032" valid="False" visited="False"/>  <Line no="2033" valid="False" visited="False"/>  <Line no="2034" valid="False" visited="False">	<span class="comment">-- 未使用</span></Line>  <Line no="2035" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">setinitThread</span><span class="misc">(</span><span class="identifier">thread</span><span class="misc">)</span></Line>  <Line no="2036" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._initThread</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">thread</span></Line>  <Line no="2037" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2038" valid="False" visited="False"/>  <Line no="2039" valid="False" visited="False"/>  <Line no="2040" valid="False" visited="False"/>  <Line no="2041" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">alignment</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">size</span><span class="misc">)</span></Line>  <Line no="2042" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">extra</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">self.cursor</span><span class="operator">-</span><span class="number">2</span><span class="misc">)</span><span class="operator">%</span><span class="identifier">size</span></Line>  <Line no="2043" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">extra</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">size</span><span class="operator">-</span><span class="identifier">extra</span>&nbsp;<span class="keyword">end</span></Line>  <Line no="2044" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">0</span></Line>  <Line no="2045" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2046" valid="False" visited="False"/>  <Line no="2047" valid="False" visited="False"/>  <Line no="2048" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">align</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">size</span><span class="misc">)</span></Line>  <Line no="2049" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">shift</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">alignment</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">size</span><span class="misc">)</span></Line>  <Line no="2050" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self.cursor, shift, size)</span></Line>  <Line no="2051" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">shift</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">jump</span><span class="misc">(</span><span class="identifier">shift</span><span class="misc">)</span>&nbsp;<span class="keyword">end</span></Line>  <Line no="2052" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2053" valid="False" visited="False"/>  <Line no="2054" valid="False" visited="False">	<span class="comment">-- CDR符号化</span></Line>  <Line no="2055" valid="False" visited="False">	<span class="comment">-- @param data 変換前のデータ</span></Line>  <Line no="2056" valid="False" visited="False">	<span class="comment">-- @param dataType データ型</span></Line>  <Line no="2057" valid="False" visited="False">	<span class="comment">-- @return CDRバイナリデータ</span></Line>  <Line no="2058" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">cdrMarshal</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">,</span>&nbsp;<span class="identifier">dataType</span><span class="misc">)</span></Line>  <Line no="2059" valid="False" visited="False"/>  <Line no="2060" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">encoder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newencoder</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2061" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--encoder.emptychar = ""</span></Line>  <Line no="2062" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--encoder.align = function(...)return 0 end</span></Line>  <Line no="2063" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">encoder.align</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">align</span></Line>  <Line no="2064" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--encoder.cursor = encoder.cursor-1</span></Line>  <Line no="2065" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">encoder</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">,</span>&nbsp;<span class="identifier">self._orb.types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="identifier">dataType</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="2066" valid="False" visited="False"/>  <Line no="2067" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">encoder</span><span class="misc">:</span><span class="identifier">getdata</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2068" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i=1,#cdr do</span></Line>  <Line no="2069" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(i,string.byte(string.sub(cdr,i,i)))</span></Line>  <Line no="2070" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="2071" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">cdr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2072" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="2073" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">,</span><span class="number">2</span><span class="misc">)</span></Line>  <Line no="2074" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--elseif #cdr == 2 then</span></Line>  <Line no="2075" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.sub(cdr,2)</span></Line>  <Line no="2076" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--elseif #cdr == 4 then</span></Line>  <Line no="2077" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.sub(cdr,3)</span></Line>  <Line no="2078" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--else</span></Line>  <Line no="2079" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.sub(cdr,5)</span></Line>  <Line no="2080" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2081" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i=1,#cdr do</span></Line>  <Line no="2082" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(i,string.byte(string.sub(cdr,i,i)))</span></Line>  <Line no="2083" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="2084" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">cdr</span></Line>  <Line no="2085" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2086" valid="False" visited="False"/>  <Line no="2087" valid="False" visited="False">	<span class="comment">-- CDR復号化</span></Line>  <Line no="2088" valid="False" visited="False">	<span class="comment">-- @param cdr CDRバイナリデータ</span></Line>  <Line no="2089" valid="False" visited="False">	<span class="comment">-- @param dataType データ型</span></Line>  <Line no="2090" valid="False" visited="False">	<span class="comment">-- @return 変換後のデータ</span></Line>  <Line no="2091" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">cdrUnmarshal</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">,</span>&nbsp;<span class="identifier">dataType</span><span class="misc">)</span></Line>  <Line no="2092" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(cdr, dataType)</span></Line>  <Line no="2093" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if #cdr == 0 then</span></Line>  <Line no="2094" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--elseif #cdr == 1 then</span></Line>  <Line no="2095" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.char(1)..cdr</span></Line>  <Line no="2096" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--elseif #cdr == 2 then</span></Line>  <Line no="2097" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.char(1)..string.char(255)..cdr</span></Line>  <Line no="2098" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--else</span></Line>  <Line no="2099" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	cdr = string.char(1)..string.char(255)..string.char(255)..string.char(255)..cdr</span></Line>  <Line no="2100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="2101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local Codec  = require "oil.corba.giop.Codec"</span></Line>  <Line no="2102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--Codec.Encoder.emptychar = ""</span></Line>  <Line no="2103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#cdr)</span></Line>  <Line no="2104" valid="False" visited="False"/>  <Line no="2105" valid="False" visited="False"/>  <Line no="2106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.char</span><span class="misc">(</span><span class="number">1</span><span class="misc">)</span><span class="operator">..</span><span class="identifier">cdr</span></Line>  <Line no="2107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">decoder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newdecoder</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">)</span></Line>  <Line no="2108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--decoder.cursor = decoder.cursor-1</span></Line>  <Line no="2109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">decoder.align</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">align</span></Line>  <Line no="2110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--decoder.align = Codec.Encoder.align</span></Line>  <Line no="2111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--decoder.align = function(...)return 0 end</span></Line>  <Line no="2112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">decoder</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">self._orb.types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="identifier">dataType</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="2113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_data</span></Line>  <Line no="2114" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2115" valid="False" visited="False"/>  <Line no="2116" valid="False" visited="False">	<span class="comment">-- スタンドアロンコンポーネントかの判定</span></Line>  <Line no="2117" valid="False" visited="False">	<span class="comment">-- @return true：スタンドアロンコンポーネント、false：rtcdでの実行</span></Line>  <Line no="2118" valid="False" visited="False">	<span class="identifier">Manager.is_main</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="library">debug.getinfo</span><span class="misc">(</span><span class="number">4</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="misc">(</span><span class="identifier">offset</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="number">0</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span><span class="misc">)</span></Line>  <Line no="2120" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2121" valid="False" visited="False"/>  <Line no="2122" valid="False" visited="False"/>  <Line no="2123" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">terminate_Task</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="2124" valid="False" visited="False">	<span class="comment">-- マネージャ終了コルーチンの初期化</span></Line>  <Line no="2125" valid="False" visited="False">	<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="2126" valid="False" visited="False">	<span class="comment">-- @param sleep_time 終了までの待機時間</span></Line>  <Line no="2127" valid="False" visited="False">	<span class="comment">-- マネージャ終了コルーチン</span></Line>  <Line no="2128" valid="False" visited="False">	<span class="identifier">terminate_Task.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">,</span>&nbsp;<span class="identifier">sleep_time</span><span class="misc">)</span></Line>  <Line no="2129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="2130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="2131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sleep_time</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sleep_time</span></Line>  <Line no="2132" valid="False" visited="False"/>  <Line no="2133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">svc</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="identifier">self._sleep_time</span><span class="misc">)</span></Line>  <Line no="2135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="2138" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2139" valid="False" visited="False"/>  <Line no="2140" valid="False" visited="False">	<span class="comment">-- マネージャ終了コルーチンの生成</span></Line>  <Line no="2141" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">createShutdownThread</span><span class="misc">(</span><span class="identifier">sleep_time</span><span class="misc">)</span></Line>  <Line no="2142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self.shutdown_start</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sleep_time</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sleep_time</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="2145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self.no_block</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="2147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Task.start</span><span class="misc">(</span><span class="identifier">terminate_Task.new</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">sleep_time</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="2148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="2149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.main</span><span class="misc">(</span><span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="2150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.newthread</span><span class="misc">(</span><span class="identifier">self._orb.run</span><span class="misc">,</span>&nbsp;<span class="identifier">self._orb</span><span class="misc">)</span></Line>  <Line no="2151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Task.start</span><span class="misc">(</span><span class="identifier">terminate_Task.new</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">sleep_time</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="2152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="2153" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="2155" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="2156" valid="False" visited="False"/>  <Line no="2157" valid="False" visited="False"/>  <Line no="2158" valid="False" visited="False"/>  <Line no="2159" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">Manager</span></Line>  <Line no="2160" valid="False" visited="False"/>  <Line no="2161" valid="False" visited="False"/>  <FileSummary valid="1164" visited="923" totalLines="2161" coverage="79"/> </File> <File name="lua\openrtm\ManagerActionListener.lua" anchor="lua_openrtm_ManagerActionListener_lua">  <PerfectCoverage/>   <FileSummary valid="198" visited="198" totalLines="250" coverage="100"/> </File> <File name="lua\openrtm\ManagerConfig.lua" anchor="lua_openrtm_ManagerConfig_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ManagerConfig.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief マネージャのコンフィギュレーション管理クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ManagerConfig</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ManagerConfig"] = ManagerConfig</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">default_config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DefaultConfiguration"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">config_file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"./rtc.conf"</span><span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False">	<span class="comment">-- マネージャのコンフィギュレーション管理オブジェクト初期化</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @param argv コマンドライン引数</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- "-a"：マネージャサーバント無効</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- "-f"：設定ファイル指定</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- "-l"：ロードするモジュール指定</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- "-o"：追加のオプション指定</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- "-a"：アドレス、ポート番号指定</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- "-d"：マスターマネージャに設定</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @return マネージャのコンフィギュレーション管理オブジェクト</span></Line>  <Line no="29" valid="False" visited="False">	<span class="identifier">ManagerConfig.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configFile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._argprop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._isMaster</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コマンドライン引数により初期化</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _argv コマンドライン引数</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">_argv</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">parseArgs</span><span class="misc">(</span><span class="identifier">_argv</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定プロパティを設定</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param プロパティ</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">configure</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setDefaults</span><span class="misc">(</span><span class="identifier">default_config</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findConfigFile</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="46" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">fd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">io.open</span><span class="misc">(</span><span class="identifier">self._configFile</span><span class="misc">,</span>&nbsp;<span class="string">"r"</span><span class="misc">)</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(fs)</span></Line>  <Line no="48" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">fd</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">fd</span><span class="misc">:</span><span class="identifier">close</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setSystemInformation</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="56" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"manager.is_master"</span><span class="misc">,</span><span class="string">"YES"</span><span class="misc">)</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._argprop</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"config_file"</span><span class="misc">,</span>&nbsp;<span class="identifier">self._configFile</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コマンドライン引数からオプション一覧取得して設定</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _argv コマンドライン引数</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">parseArgs</span><span class="misc">(</span><span class="identifier">_argv</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">opts</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.getopt</span><span class="misc">(</span><span class="identifier">_argv</span><span class="misc">,</span>&nbsp;<span class="string">"adlf:o:p:"</span><span class="misc">)</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_argv)</span></Line>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">opt</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">opts</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(opt)</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(opt.id, opt.optarg)</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"a"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._argprop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"manager.corba_servant"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"f"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt.optarg</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configFile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">opt.optarg</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"l"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt.optarg</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configFile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">opt.optarg</span></Line>  <Line no="81" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"o"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt.optarg</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">opt.optarg</span><span class="misc">,</span>&nbsp;<span class="string">":"</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">opt.optarg</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">opt.optarg</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">idx</span><span class="misc">)</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">idx</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">idx</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">idx</span><span class="misc">)</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(idx, value)</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._argprop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">idx</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"p"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt.optarg</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">":"</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">opt.optarg</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._argprop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"corba.endpoints"</span><span class="misc">,</span>&nbsp;<span class="identifier">arg_</span><span class="misc">)</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">opt.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"d"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="106" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 設定ファイルの存在確認、設定</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @retuen true：存在しない、false：存在する</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findConfigFile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configFile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">self._configFile</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">filename</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">config_file_path</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">filename</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="121" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configFile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">filename</span></Line>  <Line no="122" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="123" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- システム情報を設定する</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setSystemInformation</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファイルの存在確認</span></Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @retuen true：存在しない、false：存在する</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">filename</span><span class="misc">)</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">fd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">io.open</span><span class="misc">(</span><span class="identifier">filename</span><span class="misc">,</span>&nbsp;<span class="string">"r"</span><span class="misc">)</span></Line>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">fd</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="139" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">fd</span><span class="misc">:</span><span class="identifier">close</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">argv</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="147" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="148" valid="False" visited="False"/>  <Line no="149" valid="False" visited="False"/>  <Line no="150" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ManagerConfig</span></Line>  <FileSummary valid="87" visited="73" totalLines="150" coverage="83"/> </File> <File name="lua\openrtm\ManagerServant.lua" anchor="lua_openrtm_ManagerServant_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ManagerServant.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief マネージャサーバント定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ManagerServant</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.ManagerServant"] = ManagerServant</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="identifier">ManagerServant.CompParam</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="True">	<span class="identifier">ManagerServant.CompParam.prof_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"RTC"</span><span class="misc">,</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"vendor"</span><span class="misc">,</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"category"</span><span class="misc">,</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"implementation_id"</span><span class="misc">,</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"language"</span><span class="misc">,</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"version"</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="False" visited="False">	<span class="comment">-- マネージャのCORBAオブジェクトの一致を判定する関数オブジェクト初期化</span></Line>  <Line no="35" valid="False" visited="False">	<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="36" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="37" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">is_equiv</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャのCORBAオブジェクトの一致を判定する関数</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr 比較対象のマネージャ</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">self._mgr</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">,</span>&nbsp;<span class="identifier">self._mgr.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr.getObjRef</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="49" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False">	<span class="comment">-- RTCのパラメータ格納オブジェクト初期化</span></Line>  <Line no="55" valid="False" visited="False">	<span class="comment">-- @param module_name RTC名、オプション</span></Line>  <Line no="56" valid="False" visited="False">	<span class="comment">-- @return RTCのパラメータ格納オブジェクト</span></Line>  <Line no="57" valid="True" visited="True">	<span class="identifier">ManagerServant.CompParam.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">module_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">,</span>&nbsp;<span class="string">"?"</span><span class="misc">)</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">param_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">,</span>&nbsp;<span class="string">":"</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">param_list</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="operator">#</span><span class="identifier">ManagerServant.CompParam.prof_list</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"RTC"</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._vendor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._category</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._impl_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">module_name</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._language</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"Lua"</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._version</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._vendor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._category</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">3</span><span class="misc">]</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._impl_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">4</span><span class="misc">]</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">5</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._language</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">5</span><span class="misc">]</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._language</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"Lua"</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._version</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">param_list</span><span class="misc">[</span><span class="number">6</span><span class="misc">]</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">vendor</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._vendor</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">category</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._category</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">impl_id</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._impl_id</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._language</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">version</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._version</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="97" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="98" valid="False" visited="False"/>  <Line no="99" valid="False" visited="False">	<span class="comment">-- マネージャサーバント初期化</span></Line>  <Line no="100" valid="False" visited="False">	<span class="comment">-- @return マネージャサーバント</span></Line>  <Line no="101" valid="False" visited="False">	<span class="identifier">ManagerServant.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス初期化</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- INSマネージャへの登録</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createINSManager</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._mgr:getConfig())</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.name"</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:RTM/Manager:1.0"</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">self._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:RTM/Manager:1.0"</span><span class="misc">)</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(str)</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._objref:_non_existent())</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._masters)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">master</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._masters</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">master</span><span class="misc">:</span><span class="identifier">remove_slave_manager</span><span class="misc">(</span><span class="identifier">self._objref</span><span class="misc">)</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._masters</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">remove_master_manager</span><span class="misc">(</span><span class="identifier">self._objref</span><span class="misc">)</span></Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="136" valid="False" visited="False"/>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="138" valid="False" visited="False"/>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アドレスからマネージャを検索</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param host_port アドレス、ポート番号</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return マネージャ</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findManager</span><span class="misc">(</span><span class="identifier">host_port</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"findManager(host_port = "</span><span class="operator">..</span><span class="identifier">host_port..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"corbaloc:iiop:"</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrloc..host_port</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrloc..</span><span class="string">"/"</span><span class="operator">..</span><span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.name"</span><span class="misc">)</span></Line>  <Line no="151" valid="False" visited="False"/>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"corbaloc: "</span><span class="operator">..</span><span class="identifier">mgrloc</span><span class="misc">)</span></Line>  <Line no="153" valid="False" visited="False"/>  <Line no="154" valid="False" visited="False"/>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">mgrloc</span><span class="misc">,</span><span class="string">"IDL:RTM/Manager:1.0"</span><span class="misc">)</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._non_existent</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mgr)</span></Line>  <Line no="160" valid="False" visited="False"/>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="163" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定名のRTCを取得</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name RTC名</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- カテゴリ名とRTCインスタンス名を指定</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Category/ConsoleIn0</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- カテゴリ名は省略可能</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 一致したRTC一覧</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_components_by_name</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_components_by_name()"</span><span class="misc">)</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">crtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">rtc</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">rtcs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtc_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(rtc:getInstanceName(), rtc_name[1])</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">rtc_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">crtcs</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="189" valid="False" visited="False"/>  <Line no="190" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"*"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">rtc_name</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">crtcs</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getCategory</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">rtc_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">rtc_name</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">crtcs</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="199" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="202" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">crtcs</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="206" valid="False" visited="False"/>  <Line no="207" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マスターマネージャを追加する</span></Line>  <Line no="208" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_master_manager</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"add_master_manager(), "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._masters..</span><span class="string">" masters"</span><span class="misc">)</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._masters</span><span class="misc">,</span>&nbsp;<span class="identifier">is_equiv</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(index)</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Already exists."</span><span class="misc">)</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="217" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="218" valid="False" visited="False"/>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._masters</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_TRACE</span><span class="misc">(</span><span class="string">"add_master_manager() done, "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._masters..</span><span class="string">" masters"</span><span class="misc">)</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- スレーブマネージャを追加する</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_slave_manager</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"add_slave_manager(), "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._slaves..</span><span class="string">" slaves"</span><span class="misc">)</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">,</span>&nbsp;<span class="identifier">is_equiv</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Already exists."</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False"/>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_TRACE</span><span class="misc">(</span><span class="string">"add_slave_manager() done, "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._slaves..</span><span class="string">" slaves"</span><span class="misc">)</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="239" valid="False" visited="False"/>  <Line no="240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="245" valid="False" visited="False"/>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールのロード</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param pathname ファイルパス</span></Line>  <Line no="248" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param initfunc ファクトリ登録関数</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">load_module</span><span class="misc">(</span><span class="identifier">pathname</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"ManagerServant::load_module("</span><span class="operator">..</span><span class="identifier">pathname..</span><span class="string">", "</span><span class="operator">..</span><span class="identifier">initfunc..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">pathname</span><span class="misc">,</span>&nbsp;<span class="identifier">initfunc</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="255" valid="False" visited="False"/>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールのアンロード</span></Line>  <Line no="257" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param pathname ファイルパス</span></Line>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unload_module</span><span class="misc">(</span><span class="identifier">pathname</span><span class="misc">)</span></Line>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"ManagerServant::unload_module("</span><span class="operator">..</span><span class="identifier">pathname..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">unload</span><span class="misc">(</span><span class="identifier">pathname</span><span class="misc">)</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="264" valid="False" visited="False"/>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロード可能モジュール一覧取得</span></Line>  <Line no="266" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ロード可能モジュール一覧</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_loadable_modules</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="268" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="269" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="270" valid="False" visited="False"/>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロード済みモジュール一覧取得</span></Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ロード可能モジュール一覧</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_loaded_modules</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_loaded_modules()"</span><span class="misc">)</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getLoadedModules</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">module_profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">module_profile.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="281" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="283" valid="False" visited="False"/>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="288" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">profs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">get_loaded_modules</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.push_back_list</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">profs</span><span class="misc">)</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="292" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">)</span></Line>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="294" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="296" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves.remove</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">)</span></Line>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="300" valid="False" visited="False"/>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">cprof</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="303" valid="False" visited="False"/>  <Line no="304" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファクトリプロファイル一覧取得</span></Line>  <Line no="305" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ファクトリプロファイル一覧</span></Line>  <Line no="306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_factory_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_factory_profiles()"</span><span class="misc">)</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getFactoryProfiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="309" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cprof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">module_profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">module_profile.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="314" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="315" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="316" valid="False" visited="False"/>  <Line no="317" valid="False" visited="False"/>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="321" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">profs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">get_factory_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.push_back_list</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">profs</span><span class="misc">)</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">)</span></Line>  <Line no="326" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="327" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="328" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="329" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves.remove</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">)</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="333" valid="False" visited="False"/>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">cprof</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="336" valid="False" visited="False"/>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findManagerByName</span><span class="misc">(</span><span class="identifier">manager_name</span><span class="misc">)</span></Line>  <Line no="338" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="340" valid="False" visited="False"/>  <Line no="341" valid="False" visited="False"/>  <Line no="342" valid="False" visited="False"/>  <Line no="343" valid="False" visited="False"/>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getParameterByModulename</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">,</span>&nbsp;<span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">module_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos0</span><span class="misc">,</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="string">"&amp;"</span><span class="operator">..</span><span class="identifier">param_name..</span><span class="string">"="</span><span class="misc">)</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos1</span><span class="misc">,</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="string">"?"</span><span class="operator">..</span><span class="identifier">param_name..</span><span class="string">"="</span><span class="misc">)</span></Line>  <Line no="348" valid="False" visited="False"/>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos0</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">pos1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos0</span></Line>  <Line no="355" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos1</span></Line>  <Line no="357" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="358" valid="False" visited="False"/>  <Line no="359" valid="False" visited="False"/>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">paramstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="361" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">endpos</span><span class="misc">,</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">'&amp;'</span><span class="misc">)</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">endpos</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">endpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">'?'</span><span class="misc">)</span></Line>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">endpos</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">paramstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">)</span></Line>  <Line no="366" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="367" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">paramstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">endpos</span><span class="misc">)</span></Line>  <Line no="368" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="369" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">paramstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">endpos</span><span class="misc">)</span></Line>  <Line no="371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(arg,paramstr,endpos)</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_VERBOSE</span><span class="misc">(</span><span class="identifier">param_name..</span><span class="string">" arg: "</span><span class="operator">..</span><span class="identifier">paramstr</span><span class="misc">)</span></Line>  <Line no="374" valid="False" visited="False"/>  <Line no="375" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">eqpos</span><span class="misc">,</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">paramstr</span><span class="misc">,</span>&nbsp;<span class="string">"="</span><span class="misc">)</span></Line>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">eqpos</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="377" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">eqpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="378" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="379" valid="False" visited="False"/>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">paramstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">paramstr</span><span class="misc">,</span>&nbsp;<span class="identifier">eqpos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">)</span></Line>  <Line no="381" valid="False" visited="False"/>  <Line no="382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">param_name..</span><span class="string">" is "</span><span class="operator">..</span><span class="identifier">paramstr</span><span class="misc">)</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">endpos</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="385" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="386" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span><span class="operator">..</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="identifier">endpos</span><span class="misc">)</span></Line>  <Line no="387" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="388" valid="False" visited="False"/>  <Line no="389" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">module_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">arg</span></Line>  <Line no="390" valid="False" visited="False"/>  <Line no="391" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">paramstr</span></Line>  <Line no="392" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="393" valid="False" visited="False"/>  <Line no="394" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createComponentByManagerName</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">module_name</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">arg</span><span class="misc">}</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getParameterByModulename</span><span class="misc">(</span><span class="string">"manager_name"</span><span class="misc">,</span><span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="398" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="400" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="401" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="402" valid="False" visited="False"/>  <Line no="403" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="404" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">"manager_%p"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="405" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findManagerByName</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="407" valid="False" visited="False"/>  <Line no="408" valid="False" visited="False"/>  <Line no="409" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ManagerServant.CompParam.new</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="410" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="411" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="412" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules."</span><span class="operator">..</span><span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">".manager_cmd"</span><span class="misc">)</span></Line>  <Line no="413" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="414" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"rtcd_lua"</span></Line>  <Line no="415" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="416" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules.load_path"</span><span class="misc">)</span></Line>  <Line no="417" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">load_path_language</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules."</span><span class="operator">..</span><span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">".load_path"</span><span class="misc">)</span></Line>  <Line no="418" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">load_path..</span><span class="string">","</span><span class="operator">..</span><span class="identifier">load_path_language</span></Line>  <Line no="419" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtcd_cmd</span></Line>  <Line no="420" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">load_path</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span><span class="string">"\\\\"</span><span class="misc">)</span></Line>  <Line no="421" valid="False" visited="False"/>  <Line no="422" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.is_master:NO"</span></Line>  <Line no="423" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.corba_servant:YES"</span></Line>  <Line no="424" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"corba.master_manager:"</span><span class="operator">..</span><span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"corba.master_manager"</span><span class="misc">)</span></Line>  <Line no="425" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.name:"</span><span class="operator">..</span><span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.name"</span><span class="misc">)</span></Line>  <Line no="426" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.instance_name:"</span><span class="operator">..</span><span class="identifier">mgrstr</span></Line>  <Line no="427" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"\"manager.modules.load_path:"</span><span class="operator">..</span><span class="identifier">load_path..</span><span class="string">"\""</span></Line>  <Line no="428" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.supported_languages:"</span><span class="operator">..</span><span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="429" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o "</span><span class="operator">..</span><span class="string">"manager.shutdown_auto:NO"</span></Line>  <Line no="430" valid="False" visited="False"/>  <Line no="431" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Invoking command: "</span><span class="operator">..</span><span class="identifier">cmd..</span><span class="string">"."</span><span class="misc">)</span></Line>  <Line no="432" valid="False" visited="False"/>  <Line no="433" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">slaves_names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="434" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">regex</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">'manager_%d.*'</span></Line>  <Line no="435" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"manager_%p"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="436" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="437" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="439" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="440" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="441" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="442" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.instance_name"</span><span class="misc">)</span></Line>  <Line no="443" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.match</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">regex</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="444" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">slaves_names</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="445" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="446" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="447" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="448" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="449" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="450" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves</span><span class="misc">:</span><span class="identifier">remove</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">)</span></Line>  <Line no="451" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="452" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="453" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="454" valid="False" visited="False"/>  <Line no="455" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.execute</span><span class="misc">(</span><span class="identifier">cmd</span><span class="misc">)</span></Line>  <Line no="456" valid="False" visited="False"/>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">01</span><span class="misc">)</span></Line>  <Line no="458" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="459" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t0_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="460" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="461" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"manager_%p"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="462" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findManager</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="463" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="464" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="466" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave.get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="467" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OpenRTM_aist.Properties</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="468" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="469" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop.getProperty</span><span class="misc">(</span><span class="string">"manager.instance_name"</span><span class="misc">)</span></Line>  <Line no="470" valid="False" visited="False"/>  <Line no="471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.match</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">regex</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.includes</span><span class="misc">(</span><span class="identifier">slaves_names</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="472" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span></Line>  <Line no="473" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="474" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="475" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="476" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="477" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves</span><span class="misc">:</span><span class="identifier">remove</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">)</span></Line>  <Line no="479" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="480" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="481" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="482" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findManagerByName</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="483" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="484" valid="False" visited="False"/>  <Line no="485" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="486" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1000</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="487" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="488" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="489" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t1_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="490" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="identifier">t1_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span><span class="misc">)</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">10</span><span class="operator">.</span><span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">10</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="491" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">01</span><span class="misc">)</span></Line>  <Line no="494" valid="False" visited="False"/>  <Line no="495" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="496" valid="False" visited="False"/>  <Line no="497" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="498" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="499" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Manager cannot be found."</span><span class="misc">)</span></Line>  <Line no="500" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="501" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="502" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Creating component on "</span><span class="operator">..</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="503" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"arg: "</span><span class="operator">..</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="504" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="505" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="506" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="507" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrobj.create_component</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="508" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component created "</span><span class="operator">..</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="509" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="510" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="511" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_DEBUG</span><span class="misc">(</span><span class="string">"Exception was caught while creating component."</span><span class="misc">)</span></Line>  <Line no="512" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="514" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="515" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtobj</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="517" valid="False" visited="False"/>  <Line no="518" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createComponentByAddress</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="519" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">module_name</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">arg</span><span class="misc">}</span></Line>  <Line no="521" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getParameterByModulename</span><span class="misc">(</span><span class="string">"manager_address"</span><span class="misc">,</span><span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">arg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="523" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrstr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="524" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="525" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="526" valid="False" visited="False"/>  <Line no="527" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrvstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">,</span>&nbsp;<span class="string">":"</span><span class="misc">)</span></Line>  <Line no="528" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">mgrvstr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">2</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="529" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Invalid manager address: "</span><span class="operator">..</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="530" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="531" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="532" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findManager</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="533" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ManagerServant.CompParam.new</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="534" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="535" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="536" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules."</span><span class="operator">..</span><span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">".manager_cmd"</span><span class="misc">)</span></Line>  <Line no="537" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="538" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtcd_cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"rtcd_lua"</span></Line>  <Line no="539" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="540" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules.load_path"</span><span class="misc">)</span></Line>  <Line no="541" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">load_path_language</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules."</span><span class="operator">..</span><span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">".load_path"</span><span class="misc">)</span></Line>  <Line no="542" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">load_path..</span><span class="string">","</span><span class="operator">..</span><span class="identifier">load_path_language</span></Line>  <Line no="543" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtcd_cmd</span></Line>  <Line no="544" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">load_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">load_path</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span><span class="string">"\\\\"</span><span class="misc">)</span></Line>  <Line no="545" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o corba.master_manager:"</span></Line>  <Line no="546" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..mgrstr</span></Line>  <Line no="547" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -o \"manager.modules.load_path:"</span></Line>  <Line no="548" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..load_path</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="string">"\""</span></Line>  <Line no="549" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cmd</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cmd..</span><span class="string">" -d "</span></Line>  <Line no="550" valid="False" visited="False"/>  <Line no="551" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Invoking command: "</span><span class="operator">..</span><span class="identifier">cmd..</span><span class="string">"."</span><span class="misc">)</span></Line>  <Line no="552" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.execute</span><span class="misc">(</span><span class="identifier">cmd</span><span class="misc">)</span></Line>  <Line no="553" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">01</span><span class="misc">)</span></Line>  <Line no="554" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="555" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t0_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="556" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="557" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findManager</span><span class="misc">(</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="558" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="559" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1000</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="560" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="561" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="562" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t1_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="563" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="identifier">t1_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span><span class="misc">)</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">10</span><span class="operator">.</span><span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">10</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="564" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="565" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="566" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="number">0</span><span class="operator">.</span><span class="number">01</span><span class="misc">)</span></Line>  <Line no="567" valid="False" visited="False"/>  <Line no="568" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="569" valid="False" visited="False"/>  <Line no="570" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="571" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="572" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Manager cannot be found."</span><span class="misc">)</span></Line>  <Line no="573" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="574" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="575" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Creating component on "</span><span class="operator">..</span><span class="identifier">mgrstr</span><span class="misc">)</span></Line>  <Line no="576" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"arg: "</span><span class="operator">..</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="577" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="578" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="579" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="580" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrobj.create_component</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="581" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_DEBUG</span><span class="misc">(</span><span class="string">"Component created "</span><span class="operator">..</span><span class="identifier">arg</span><span class="misc">)</span></Line>  <Line no="582" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="583" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="584" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_DEBUG</span><span class="misc">(</span><span class="string">"Exception was caught while creating component."</span><span class="misc">)</span></Line>  <Line no="585" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="586" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="587" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="588" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtobj</span></Line>  <Line no="589" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="590" valid="False" visited="False"/>  <Line no="591" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC生成</span></Line>  <Line no="592" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param module_name RTC名、オプション(RTC?param1=xxx&amp;param2=yyy)</span></Line>  <Line no="593" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return RTC</span></Line>  <Line no="594" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">create_component</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="595" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"create_component("</span><span class="operator">..</span><span class="identifier">module_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="596" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createComponentByAddress</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="597" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="598" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span></Line>  <Line no="599" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="600" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createComponentByManagerName</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="601" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="602" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span></Line>  <Line no="603" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="604" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">module_name</span><span class="misc">}</span></Line>  <Line no="605" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getParameterByModulename</span><span class="misc">(</span><span class="string">"manager_address"</span><span class="misc">,</span><span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="606" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">module_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="607" valid="False" visited="False"/>  <Line no="608" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_param</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ManagerServant.CompParam.new</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="609" valid="False" visited="False"/>  <Line no="610" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="611" valid="False" visited="False"/>  <Line no="612" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="613" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="614" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="615" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="616" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="617" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="618" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">slave_lang</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.language"</span><span class="misc">)</span></Line>  <Line no="619" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="620" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">slave_lang</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">comp_param</span><span class="misc">:</span><span class="identifier">language</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="621" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">slave</span><span class="misc">:</span><span class="identifier">create_component</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="622" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="623" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="624" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="625" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="626" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="627" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">,</span>&nbsp;<span class="identifier">k</span><span class="misc">)</span></Line>  <Line no="628" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="629" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="630" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span></Line>  <Line no="631" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="632" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="633" valid="False" visited="False"/>  <Line no="634" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">manager_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="635" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">module_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">module_name</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="string">"&amp;manager_name=manager_%p"</span></Line>  <Line no="636" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createComponentByManagerName</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="637" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span></Line>  <Line no="638" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="639" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="640" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(module_name)</span></Line>  <Line no="641" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">createComponent</span><span class="misc">(</span><span class="identifier">module_name</span><span class="misc">)</span></Line>  <Line no="642" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="643" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="644" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="645" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="646" valid="False" visited="False"/>  <Line no="647" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="648" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="649" valid="False" visited="False"/>  <Line no="650" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC削除</span></Line>  <Line no="651" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="652" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="653" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">delete_component</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="654" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"delete_component("</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="655" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getComponent</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="656" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="657" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"No such component exists: "</span><span class="operator">..</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="658" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="659" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="660" valid="False" visited="False"/>  <Line no="661" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="662" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="663" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp_</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="664" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="665" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="666" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception was raised, when RTC was finalized."</span><span class="misc">)</span></Line>  <Line no="667" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="668" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="669" valid="False" visited="False"/>  <Line no="670" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="671" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="672" valid="False" visited="False"/>  <Line no="673" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC一覧取得</span></Line>  <Line no="674" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return RTC一覧</span></Line>  <Line no="675" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_components</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="676" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_components()"</span><span class="misc">)</span></Line>  <Line no="677" valid="False" visited="False"/>  <Line no="678" valid="False" visited="False"/>  <Line no="679" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="680" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">crtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="681" valid="False" visited="False"/>  <Line no="682" valid="False" visited="False"/>  <Line no="683" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">rtcs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="684" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">crtcs</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="685" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="686" valid="False" visited="False"/>  <Line no="687" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">crtcs</span></Line>  <Line no="688" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="689" valid="False" visited="False"/>  <Line no="690" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのプロファイル一覧取得</span></Line>  <Line no="691" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return RTCのプロファイル一覧</span></Line>  <Line no="692" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_component_profiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="693" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getComponents</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="694" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cprofs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="695" valid="False" visited="False"/>  <Line no="696" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">rtcs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="697" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">cprofs</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc</span><span class="misc">:</span><span class="identifier">get_component_profile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="698" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="699" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">cprofs</span></Line>  <Line no="700" valid="False" visited="False"/>  <Line no="701" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="702" valid="False" visited="False"/>  <Line no="703" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャのプロファイル取得</span></Line>  <Line no="704" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="705" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="706" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_profile()"</span><span class="misc">)</span></Line>  <Line no="707" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="708" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">prof.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"manager"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="709" valid="False" visited="False"/>  <Line no="710" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prof</span></Line>  <Line no="711" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="712" valid="False" visited="False"/>  <Line no="713" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャのコンフィギュレーション取得</span></Line>  <Line no="714" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーション</span></Line>  <Line no="715" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="716" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration()"</span><span class="misc">)</span></Line>  <Line no="717" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nvlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="718" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">nvlist</span><span class="misc">,</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="719" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">nvlist</span></Line>  <Line no="720" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="721" valid="False" visited="False"/>  <Line no="722" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャのコンフィギュレーション設定</span></Line>  <Line no="723" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name キー</span></Line>  <Line no="724" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value 値</span></Line>  <Line no="725" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="726" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_configuration</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="727" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"set_configuration(name = "</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">", value = "</span><span class="operator">..</span><span class="identifier">value..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="728" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="729" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="730" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="731" valid="False" visited="False"/>  <Line no="732" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マスターマネージャかスレーブマネージャかの確認</span></Line>  <Line no="733" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：マスターマネージャ、false：スレーブマネージャ</span></Line>  <Line no="734" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">is_master</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="735" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="736" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._isMaster</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="737" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"YES"</span></Line>  <Line no="738" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="739" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"NO"</span></Line>  <Line no="740" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="741" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"is_master(): "</span><span class="operator">..</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="742" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._isMaster</span></Line>  <Line no="743" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="744" valid="False" visited="False"/>  <Line no="745" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マスターマネージャ一覧取得</span></Line>  <Line no="746" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return マスターマネージャ一覧</span></Line>  <Line no="747" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_master_managers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="748" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_master_managers()"</span><span class="misc">)</span></Line>  <Line no="749" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._masters</span></Line>  <Line no="750" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="751" valid="False" visited="False"/>  <Line no="752" valid="False" visited="False"/>  <Line no="753" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マスターマネージャ削除</span></Line>  <Line no="754" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="755" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="756" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">remove_master_manager</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="757" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_master_manager(), "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._masters..</span><span class="string">" masters"</span><span class="misc">)</span></Line>  <Line no="758" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._masters</span><span class="misc">,</span>&nbsp;<span class="identifier">is_equiv</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="759" valid="False" visited="False"/>  <Line no="760" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="761" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Not found."</span><span class="misc">)</span></Line>  <Line no="762" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="763" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="764" valid="False" visited="False"/>  <Line no="765" valid="False" visited="False"/>  <Line no="766" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._masters</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="767" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_master_manager() done, "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._masters..</span><span class="string">" masters"</span><span class="misc">)</span></Line>  <Line no="768" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="769" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="770" valid="False" visited="False"/>  <Line no="771" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- スレーブマネージャ一覧取得</span></Line>  <Line no="772" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return スレーブマネージャ一覧</span></Line>  <Line no="773" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_slave_managers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="774" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_slave_managers(), "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._slaves..</span><span class="string">" slaves"</span><span class="misc">)</span></Line>  <Line no="775" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._slaves</span></Line>  <Line no="776" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="777" valid="False" visited="False"/>  <Line no="778" valid="False" visited="False"/>  <Line no="779" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- スレーブマネージャ削除</span></Line>  <Line no="780" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="781" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="782" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">remove_slave_manager</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="783" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_slave_manager(), "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._slaves..</span><span class="string">" slaves"</span><span class="misc">)</span></Line>  <Line no="784" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._slaves</span><span class="misc">,</span>&nbsp;<span class="identifier">is_equiv</span><span class="misc">(</span><span class="identifier">mgr</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="785" valid="False" visited="False"/>  <Line no="786" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="787" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Not found."</span><span class="misc">)</span></Line>  <Line no="788" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="789" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="790" valid="False" visited="False"/>  <Line no="791" valid="False" visited="False"/>  <Line no="792" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._slaves</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="793" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_slave_manager() done, "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._slaves..</span><span class="string">" slaves"</span><span class="misc">)</span></Line>  <Line no="794" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="795" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="796" valid="False" visited="False"/>  <Line no="797" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャのコピー作成</span></Line>  <Line no="798" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="799" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">fork</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="800" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="801" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="802" valid="False" visited="False"/>  <Line no="803" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャ終了</span></Line>  <Line no="804" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="805" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="806" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">createShutdownThread</span><span class="misc">(</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="807" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="808" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="809" valid="False" visited="False"/>  <Line no="810" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャ再起動</span></Line>  <Line no="811" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="812" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">restart</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="813" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="814" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="815" valid="False" visited="False"/>  <Line no="816" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのオブジェクトリファレンス取得</span></Line>  <Line no="817" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="818" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name</span></Line>  <Line no="819" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return</span></Line>  <Line no="820" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_service</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="821" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="822" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="823" valid="False" visited="False"/>  <Line no="824" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="825" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="826" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._mgr</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="827" valid="False" visited="False"/>  <Line no="828" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._owner</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="829" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._mgr</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"ManagerServant"</span><span class="misc">)</span></Line>  <Line no="830" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._isMaster</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="831" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._masters</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="832" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._slaves</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="833" valid="False" visited="False"/>  <Line no="834" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="835" valid="False" visited="False"/>  <Line no="836" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="837" valid="False" visited="False"/>  <Line no="838" valid="False" visited="False"/>  <Line no="839" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createINSManager</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="840" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Manager CORBA servant creation failed."</span><span class="misc">)</span></Line>  <Line no="841" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="842" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="843" valid="False" visited="False"/>  <Line no="844" valid="False" visited="False"/>  <Line no="845" valid="False" visited="False"/>  <Line no="846" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"Manager CORBA servant was successfully created."</span><span class="misc">)</span></Line>  <Line no="847" valid="False" visited="False"/>  <Line no="848" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.is_master"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"YES"</span><span class="misc">,</span>&nbsp;<span class="string">"NO"</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="849" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"This manager is master."</span><span class="misc">)</span></Line>  <Line no="850" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._isMaster</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="851" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="852" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="853" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"This manager is slave."</span><span class="misc">)</span></Line>  <Line no="854" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="855" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="856" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">owner</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findManager</span><span class="misc">(</span><span class="identifier">config</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"corba.master_manager"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="857" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(owner)</span></Line>  <Line no="858" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(owner)</span></Line>  <Line no="859" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">owner</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="860" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Master manager not found"</span><span class="misc">)</span></Line>  <Line no="861" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="862" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="863" valid="False" visited="False"/>  <Line no="864" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_master_manager</span><span class="misc">(</span><span class="identifier">owner</span><span class="misc">)</span></Line>  <Line no="865" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">owner</span><span class="misc">:</span><span class="identifier">add_slave_manager</span><span class="misc">(</span><span class="identifier">obj._objref</span><span class="misc">)</span></Line>  <Line no="866" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="867" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="868" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Unknown exception cought."</span><span class="misc">)</span></Line>  <Line no="869" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="870" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="871" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="872" valid="False" visited="False"/>  <Line no="873" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="874" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="875" valid="False" visited="False"/>  <Line no="876" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ManagerServant</span></Line>  <FileSummary valid="549" visited="374" totalLines="876" coverage="68"/> </File> <File name="lua\openrtm\ModuleManager.lua" anchor="lua_openrtm_ModuleManager_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ModuleManager.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief モジュール管理マネージャ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ObjectManager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ObjectManager"</span></Line>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ModuleManager</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">--_G["openrtm.ModuleManager"] = ModuleManager</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CONFIG_EXT</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.config_ext"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CONFIG_PATH</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.config_path"</span></Line>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DETECT_MOD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.detect_loadable"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">MOD_LOADPTH</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.load_path"</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">INITFUNC_SFX</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.init_func_suffix"</span></Line>  <Line no="25" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">INITFUNC_PFX</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.init_func_prefix"</span></Line>  <Line no="26" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ALLOW_ABSPATH</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.abs_path_allowed"</span></Line>  <Line no="27" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ALLOW_URL</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.download_allowed"</span></Line>  <Line no="28" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">MOD_DWNDIR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.download_dir"</span></Line>  <Line no="29" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">MOD_DELMOD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.download_cleanup"</span></Line>  <Line no="30" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">MOD_PRELOAD</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"manager.modules.preload"</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DLL</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False">	<span class="identifier">DLL.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">dll</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="37" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.dll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dll</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="39" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="False" visited="False">	<span class="comment">-- モジュール保持オブジェクト初期化</span></Line>  <Line no="42" valid="False" visited="False">	<span class="comment">-- @param dll モジュール</span></Line>  <Line no="43" valid="False" visited="False">	<span class="comment">-- @param prop 設定情報</span></Line>  <Line no="44" valid="False" visited="False">	<span class="comment">-- 「file_path」の要素にはファイルパスを格納する</span></Line>  <Line no="45" valid="False" visited="False">	<span class="comment">-- 「import_name」の要素にはモジュール名を格納する</span></Line>  <Line no="46" valid="False" visited="False">	<span class="comment">-- @return モジュール保持オブジェクト</span></Line>  <Line no="47" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DLLEntity</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="48" valid="False" visited="False">	<span class="identifier">DLLEntity.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">dll</span><span class="misc">,</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.dll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dll</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="53" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="False" visited="False">	<span class="comment">-- モジュール比較関数オブジェクトの初期化</span></Line>  <Line no="56" valid="False" visited="False">	<span class="comment">-- @param argv argv.name：ファイルパス</span></Line>  <Line no="57" valid="False" visited="False">	<span class="comment">-- @return モジュール比較関数オブジェクト</span></Line>  <Line no="58" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">DLLPred</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">argv.name</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._import_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.name</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">argv.factory</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._import_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.factory</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールの比較</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param dll 比較対象のモジュール</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファイルパスの一致で確認</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">dll</span><span class="misc">)</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._filepath, dll.properties:getProperty("file_path"))</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._import_name, dll.properties:getProperty("import_name"))</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._import_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">dll.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"import_name"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="78" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="True" visited="True">	<span class="identifier">ModuleManager.Error</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="82" valid="False" visited="False">	<span class="comment">-- エラー例外オブジェクトの初期化</span></Line>  <Line no="83" valid="False" visited="False">	<span class="comment">-- @param reason_ エラー内容</span></Line>  <Line no="84" valid="False" visited="False">	<span class="comment">-- @return エラー例外オブジェクト</span></Line>  <Line no="85" valid="True" visited="True">	<span class="identifier">ModuleManager.Error.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.reason</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">reason_</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"Error"</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.reason</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="95" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="True" visited="True">	<span class="identifier">ModuleManager.NotFound</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="99" valid="False" visited="False">	<span class="comment">-- オブジェクトが存在しない例外オブジェクトの初期化</span></Line>  <Line no="100" valid="False" visited="False">	<span class="comment">-- @param name_ エラー内容</span></Line>  <Line no="101" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="102" valid="True" visited="True">	<span class="identifier">ModuleManager.NotFound.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name_</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"NotFound"</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.name</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="112" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="True" visited="True">	<span class="identifier">ModuleManager.FileNotFound</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="116" valid="False" visited="False">	<span class="comment">-- ファイルが存在しない例外オブジェクトの初期化</span></Line>  <Line no="117" valid="False" visited="False">	<span class="comment">-- @param name_ エラー内容</span></Line>  <Line no="118" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="119" valid="True" visited="True">	<span class="identifier">ModuleManager.FileNotFound.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"FileNotFound"</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.name</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.NotFound.new</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="128" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="True" visited="True">	<span class="identifier">ModuleManager.ModuleNotFound</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="131" valid="False" visited="False">	<span class="comment">-- モジュールが存在しない例外オブジェクトの初期化</span></Line>  <Line no="132" valid="False" visited="False">	<span class="comment">-- @param name_ エラー内容</span></Line>  <Line no="133" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="134" valid="True" visited="True">	<span class="identifier">ModuleManager.ModuleNotFound.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleNotFound"</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.name</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.NotFound.new</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="143" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="True" visited="True">	<span class="identifier">ModuleManager.SymbolNotFound</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="146" valid="False" visited="False">	<span class="comment">-- シンボルが存在しない例外オブジェクトの初期化</span></Line>  <Line no="147" valid="False" visited="False">	<span class="comment">-- @param name_ エラー内容</span></Line>  <Line no="148" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="149" valid="True" visited="True">	<span class="identifier">ModuleManager.SymbolNotFound.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"SymbolNotFound"</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.name</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.NotFound.new</span><span class="misc">(</span><span class="identifier">name_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="158" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False"/>  <Line no="160" valid="False" visited="False"/>  <Line no="161" valid="True" visited="True">	<span class="identifier">ModuleManager.NotAllowedOperation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="162" valid="False" visited="False">	<span class="comment">-- 指定した操作ができない場合の例外オブジェクトの初期化</span></Line>  <Line no="163" valid="False" visited="False">	<span class="comment">-- @param reason_ エラー内容</span></Line>  <Line no="164" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="165" valid="True" visited="True">	<span class="identifier">ModuleManager.NotAllowedOperation.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"NotAllowedOperation"</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.reason</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.Error.new</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="174" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="True" visited="True">	<span class="identifier">ModuleManager.InvalidArguments</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="178" valid="False" visited="False">	<span class="comment">-- 不正な引数指定の例外オブジェクトの初期化</span></Line>  <Line no="179" valid="False" visited="False">	<span class="comment">-- @param reason_ エラー内容</span></Line>  <Line no="180" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="181" valid="True" visited="True">	<span class="identifier">ModuleManager.InvalidArguments.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"InvalidArguments"</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.reason</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.Error.new</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="190" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="191" valid="False" visited="False"/>  <Line no="192" valid="False" visited="False"/>  <Line no="193" valid="True" visited="True">	<span class="identifier">ModuleManager.InvalidOperation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="194" valid="False" visited="False">	<span class="comment">-- 不正な操作の例外オブジェクトの初期化</span></Line>  <Line no="195" valid="False" visited="False">	<span class="comment">-- @param reason_ エラー内容</span></Line>  <Line no="196" valid="False" visited="False">	<span class="comment">-- @return 例外オブジェクト</span></Line>  <Line no="197" valid="True" visited="True">	<span class="identifier">ModuleManager.InvalidOperation.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"InvalidOperation"</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"ModuleManager."</span><span class="operator">..</span><span class="identifier">self.type..</span><span class="string">":"</span><span class="operator">..</span><span class="identifier">self.reason</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">,</span>&nbsp;<span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ModuleManager.Error.new</span><span class="misc">(</span><span class="identifier">reason_</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="206" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="207" valid="False" visited="False"/>  <Line no="208" valid="False" visited="False"/>  <Line no="209" valid="False" visited="False"/>  <Line no="210" valid="False" visited="False"/>  <Line no="211" valid="False" visited="False"/>  <Line no="212" valid="False" visited="False"/>  <Line no="213" valid="False" visited="False">	<span class="comment">-- モジュール管理オブジェクトの初期化</span></Line>  <Line no="214" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="215" valid="False" visited="False">	<span class="comment">-- 「manager.modules.abs_path_allowed」がYESの時、絶対パスでファイルを指定できる</span></Line>  <Line no="216" valid="False" visited="False">	<span class="comment">-- 「manager.modules.download_allowed」がYESの時、URLでファイルを指定できる</span></Line>  <Line no="217" valid="False" visited="False">	<span class="comment">-- @return モジュール管理オブジェクト</span></Line>  <Line no="218" valid="False" visited="False">	<span class="identifier">ModuleManager.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="220" valid="False" visited="False"/>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了関数</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="223" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unloadAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="False" visited="False"/>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールのロード</span></Line>  <Line no="227" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param file_name ファイルパス</span></Line>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファイル名のみの指定の場合は「manager.modules.load_path」で設定したパスを探査する</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param init_func 初期化関数</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ファイルパス</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">,</span>&nbsp;<span class="identifier">init_func</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"load(fname = "</span><span class="operator">..</span><span class="identifier">file_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">file_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="235" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.InvalidArguments.new</span><span class="misc">(</span><span class="string">"Invalid file name."</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="236" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.isURL</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="238" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._downloadAllowed</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="239" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.NotAllowedOperation.new</span><span class="misc">(</span><span class="string">"Downloading module is not allowed."</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="241" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.NotFound.new</span><span class="misc">(</span><span class="string">"Not implemented."</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">import_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.basename</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pathChanged</span><span class="operator">=</span><span class="keyword">false</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">save_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="248" valid="False" visited="False"/>  <Line no="249" valid="False" visited="False"/>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.isAbsolutePath</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._absoluteAllowed</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="252" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.NotAllowedOperation.new</span><span class="misc">(</span><span class="string">"Absolute path is not allowed"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="254" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">save_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">package.path</span></Line>  <Line no="255" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">package.path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">package.path..</span><span class="string">";"</span><span class="operator">..</span><span class="identifier">StringUtil.dirname</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="operator">..</span><span class="string">"?.lua"</span></Line>  <Line no="256" valid="False" visited="False"/>  <Line no="257" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pathChanged</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="258" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">import_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.basename</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="259" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">file_name</span></Line>  <Line no="260" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="261" valid="False" visited="False"/>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findFile</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">,</span>&nbsp;<span class="identifier">self._loadPath</span><span class="misc">)</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="265" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.FileNotFound.new</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="266" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="268" valid="False" visited="False"/>  <Line no="269" valid="False" visited="False"/>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">file_path</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="272" valid="False" visited="False"/>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.FileNotFound.new</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="274" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="275" valid="False" visited="False"/>  <Line no="276" valid="False" visited="False"/>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">io.open</span><span class="misc">(</span><span class="identifier">file_path</span><span class="misc">,</span>&nbsp;<span class="string">"r"</span><span class="misc">)</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">init_func</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="string">"*a"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">init_func</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="281" valid="False" visited="False"/>  <Line no="282" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.FileNotFound.new</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="283" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="284" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span><span class="misc">:</span><span class="identifier">close</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="286" valid="False" visited="False"/>  <Line no="287" valid="False" visited="False"/>  <Line no="288" valid="False" visited="False"/>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">pathChanged</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">package.path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">package.path..</span><span class="string">";"</span><span class="operator">..</span><span class="identifier">StringUtil.dirname</span><span class="misc">(</span><span class="identifier">file_path</span><span class="misc">)</span><span class="operator">..</span><span class="string">"?.lua"</span></Line>  <Line no="291" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="292" valid="False" visited="False"/>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ext_pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">,</span>&nbsp;<span class="string">".lua"</span><span class="misc">)</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ext_pos</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="295" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">import_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">ext_pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="296" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="297" valid="False" visited="False"/>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(import_name)</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("testModule", tostring(import_name))</span></Line>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mo</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span><span class="misc">(</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local mo = require "testModule"</span></Line>  <Line no="302" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mo)</span></Line>  <Line no="303" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(package.path)</span></Line>  <Line no="304" valid="False" visited="False"/>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pathChanged</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="306" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">package.path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">save_path</span></Line>  <Line no="307" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="308" valid="False" visited="False"/>  <Line no="309" valid="False" visited="False"/>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">file_path</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">file_path</span><span class="misc">,</span>&nbsp;<span class="string">"//"</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="312" valid="False" visited="False"/>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mo,type(mo))</span></Line>  <Line no="314" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(file_path)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">DLLEntity.new</span><span class="misc">(</span><span class="identifier">mo</span><span class="misc">,</span><span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="316" valid="False" visited="False"/>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">dll.properties</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"file_path"</span><span class="misc">,</span><span class="identifier">file_path</span><span class="misc">)</span></Line>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">dll.properties</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"import_name"</span><span class="misc">,</span><span class="identifier">import_name</span><span class="misc">)</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">registerObject</span><span class="misc">(</span><span class="identifier">dll</span><span class="misc">)</span></Line>  <Line no="320" valid="False" visited="False"/>  <Line no="321" valid="False" visited="False"/>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">init_func</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="323" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">file_name</span></Line>  <Line no="324" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False"/>  <Line no="326" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">symbol</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">,</span><span class="identifier">init_func</span><span class="misc">)</span><span class="misc">(</span><span class="identifier">self._mgr</span><span class="misc">)</span></Line>  <Line no="327" valid="False" visited="False"/>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">file_name</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="330" valid="False" visited="False"/>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定パス一覧にファイルが存在するかを確認</span></Line>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param fname ファイル名</span></Line>  <Line no="333" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param load_path ディレクトリパスのリスト</span></Line>  <Line no="334" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ファイルが存在した場合はファイルのパスを返す</span></Line>  <Line no="335" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 存在しない場合は空文字列を返す</span></Line>  <Line no="336" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findFile</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="identifier">load_path</span><span class="misc">)</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">fname</span></Line>  <Line no="338" valid="False" visited="False"/>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">path</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">load_path</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">suffix</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules.Lua.suffixes"</span><span class="misc">)</span></Line>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="string">"."</span><span class="operator">..</span><span class="identifier">suffix</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">)</span><span class="operator">..</span><span class="string">"/"</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="operator">..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">suffix</span></Line>  <Line no="344" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="345" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">)</span><span class="operator">..</span><span class="string">"/"</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="346" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="348" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="349" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:fileExist(f))</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">,</span><span class="string">"\\"</span><span class="misc">,</span><span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">f</span><span class="misc">,</span><span class="string">"//"</span><span class="misc">,</span><span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">f</span></Line>  <Line no="354" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="355" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local filelist = {}</span></Line>  <Line no="356" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--StringUtil.findFile(path,file_name,filelist)</span></Line>  <Line no="357" valid="False" visited="False"/>  <Line no="358" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if len(filelist) &gt; 0 then</span></Line>  <Line no="359" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	return filelist[1]</span></Line>  <Line no="360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="364" valid="False" visited="False"/>  <Line no="365" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファイルの存在確認</span></Line>  <Line no="366" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param filename ファイル名</span></Line>  <Line no="367" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：存在する</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">fileExist</span><span class="misc">(</span><span class="identifier">filename</span><span class="misc">)</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">filename</span></Line>  <Line no="370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">suffix</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.modules.Lua.suffixes"</span><span class="misc">)</span></Line>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="string">"."</span><span class="operator">..</span><span class="identifier">suffix</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">fname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">filename</span><span class="misc">)</span><span class="operator">..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">suffix</span></Line>  <Line no="373" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(fname)</span></Line>  <Line no="375" valid="False" visited="False"/>  <Line no="376" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if os.path.isfile(fname)</span></Line>  <Line no="377" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	return True</span></Line>  <Line no="378" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="379" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(fname)</span></Line>  <Line no="380" valid="False" visited="False"/>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">io.open</span><span class="misc">(</span><span class="identifier">fname</span><span class="misc">,</span>&nbsp;<span class="string">"r"</span><span class="misc">)</span></Line>  <Line no="382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">f</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="384" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="386" valid="False" visited="False"/>  <Line no="387" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--return false</span></Line>  <Line no="388" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="389" valid="False" visited="False"/>  <Line no="390" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールから指定関数を取得</span></Line>  <Line no="391" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param import_name モジュール名</span></Line>  <Line no="392" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 既にモジュール名のモジュールが登録済みである必要がある</span></Line>  <Line no="393" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param func_name 関数名</span></Line>  <Line no="394" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">symbol</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">,</span>&nbsp;<span class="identifier">func_name</span><span class="misc">)</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">)</span></Line>  <Line no="397" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(dll, file_name)</span></Line>  <Line no="398" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">dll</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.ModuleNotFound.new</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="401" valid="False" visited="False"/>  <Line no="402" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dll.dll</span><span class="misc">[</span><span class="identifier">func_name</span><span class="misc">]</span></Line>  <Line no="403" valid="False" visited="False"/>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">func</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.SymbolNotFound.new</span><span class="misc">(</span><span class="identifier">import_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="407" valid="False" visited="False"/>  <Line no="408" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">func</span></Line>  <Line no="409" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="410" valid="False" visited="False"/>  <Line no="411" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モジュールのアンロード</span></Line>  <Line no="412" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param file_name ファイルパス</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unload</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">,</span>&nbsp;<span class="string">"\\"</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="415" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">file_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">,</span>&nbsp;<span class="string">"//"</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="417" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">dll</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="418" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">ModuleManager.NotFound.new</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="419" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dll_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dll.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"import_name"</span><span class="misc">)</span></Line>  <Line no="421" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(package.loaded[dll_name])</span></Line>  <Line no="422" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">package.loaded</span><span class="misc">[</span><span class="identifier">dll_name</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">unregisterObject</span><span class="misc">(</span><span class="identifier">file_name</span><span class="misc">)</span></Line>  <Line no="424" valid="False" visited="False"/>  <Line no="425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="426" valid="False" visited="False"/>  <Line no="427" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全モジュールのアンロード</span></Line>  <Line no="428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unloadAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dlls</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">dll</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">dlls</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ident</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dll.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"import_name"</span><span class="misc">)</span></Line>  <Line no="432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ident)</span></Line>  <Line no="433" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">unregisterObject</span><span class="misc">(</span><span class="identifier">ident</span><span class="misc">)</span></Line>  <Line no="434" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="436" valid="False" visited="False"/>  <Line no="437" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロード済みのモジュール全てのプロファイルを取得</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 全モジュールのプロファイル</span></Line>  <Line no="439" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getLoadedModules</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dlls</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._modules</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">modules</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">dll</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">dlls</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">modules</span><span class="misc">,</span>&nbsp;<span class="identifier">dll.properties</span><span class="misc">)</span></Line>  <Line no="444" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">modules</span></Line>  <Line no="446" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="447" valid="False" visited="False"/>  <Line no="448" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="449" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configPath</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">CONFIG_PATH</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="450" valid="False" visited="False"/>  <Line no="451" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">obj._configPath</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="452" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configPath</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="453" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._loadPath</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">MOD_LOADPTH</span><span class="misc">,</span><span class="string">"./"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">system_path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="library">package.path</span><span class="misc">,</span><span class="string">";"</span><span class="misc">)</span></Line>  <Line no="456" valid="False" visited="False"/>  <Line no="457" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">obj._loadPath</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._loadPath</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="459" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="460" valid="False" visited="False"/>  <Line no="461" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">system_path</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">path</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="464" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">path</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.dirname</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">)</span></Line>  <Line no="465" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj._loadPath</span><span class="misc">,</span>&nbsp;<span class="identifier">path</span><span class="misc">)</span></Line>  <Line no="466" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="468" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="469" valid="False" visited="False"/>  <Line no="470" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._absoluteAllowed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">ALLOW_ABSPATH</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="471" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"yes"</span><span class="misc">,</span>&nbsp;<span class="string">"no"</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="472" valid="False" visited="False"/>  <Line no="473" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._downloadAllowed</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.toBool</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">ALLOW_URL</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="474" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"yes"</span><span class="misc">,</span>&nbsp;<span class="string">"no"</span><span class="misc">,</span>&nbsp;<span class="keyword">false</span><span class="misc">)</span></Line>  <Line no="475" valid="False" visited="False"/>  <Line no="476" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._initFuncSuffix</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">INITFUNC_SFX</span><span class="misc">)</span></Line>  <Line no="477" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._initFuncPrefix</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">INITFUNC_PFX</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._modules</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ObjectManager.new</span><span class="misc">(</span><span class="identifier">DLLPred</span><span class="misc">)</span></Line>  <Line no="479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="480" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="481" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._mgr</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"ModuleManager"</span><span class="misc">)</span></Line>  <Line no="484" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="485" valid="False" visited="False"/>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._modprofs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="488" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="489" valid="False" visited="False"/>  <Line no="490" valid="False" visited="False"/>  <Line no="491" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ModuleManager</span></Line>  <FileSummary valid="260" visited="236" totalLines="491" coverage="90"/> </File> <File name="lua\openrtm\NamingManager.lua" anchor="lua_openrtm_NamingManager_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NamingManager.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ネーミングマネージャ、名前管理基底クラスの定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NamingManager</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.NamingManager"] = NamingManager</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaNaming</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CorbaNaming"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CorbaConsumer"</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="identifier">NamingManager.NamingBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="False" visited="False"/>  <Line no="24" valid="False" visited="False">	<span class="comment">-- 名前管理基底オブジェクト初期化</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @return 名前管理オブジェクト</span></Line>  <Line no="26" valid="True" visited="True">	<span class="identifier">NamingManager.NamingBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCをネームサーバーに登録</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートをネームサーバーに登録</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port ポート</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindPortObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトをネームサーバーから登録解除</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバー生存確認</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：生存、false：終了済み</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isAlive</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列からオブジェクトを取得</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name オブジェクト名</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクト一覧</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="56" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="True" visited="True">	<span class="identifier">NamingManager.NamingOnCorba</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False">	<span class="comment">-- CORBAネームサーバー管理オブジェクト初期化</span></Line>  <Line no="61" valid="False" visited="False">	<span class="comment">-- @param orb ORB</span></Line>  <Line no="62" valid="False" visited="False">	<span class="comment">-- @param names アドレス</span></Line>  <Line no="63" valid="False" visited="False">	<span class="comment">-- @return CORBAネームサーバー管理オブジェクト</span></Line>  <Line no="64" valid="True" visited="True">	<span class="identifier">NamingManager.NamingOnCorba.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">NamingManager.NamingBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"manager.namingoncorba"</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._cosnaming</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CorbaNaming.new</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span><span class="identifier">names</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._endpoint</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._replaceEndpoint</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCをネームサーバーに登録</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"bindObject(name = "</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">", rtobj or mgr)"</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._cosnaming</span><span class="misc">:</span><span class="identifier">rebindByString</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span></Line>  <Line no="83" valid="False" visited="False"/>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="91" valid="False" visited="False"/>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトをネームサーバーから登録解除</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unbindObject(name  = "</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._cosnaming</span><span class="misc">:</span><span class="identifier">unbind</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="102" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout.RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバーから指定名のRTCを検索</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param context ネーミングコンテキスト</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name RTCの登録名</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtcs 一致したRTC一覧</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getComponentByName</span><span class="misc">(</span><span class="identifier">context</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtcs</span><span class="misc">)</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">BindingType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb.types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::CosNaming::BindingType"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">500</span></Line>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">bl</span><span class="misc">,</span><span class="identifier">bi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">context</span><span class="misc">:</span><span class="identifier">list</span><span class="misc">(</span><span class="identifier">length</span><span class="misc">)</span></Line>  <Line no="120" valid="False" visited="False"/>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">i</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">bl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(i.binding_type, BindingType.ncontext)</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(NVUtil.getBindingType(i.binding_type), BindingType.ncontext)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(i.binding_name)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.getBindingType</span><span class="misc">(</span><span class="identifier">i.binding_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BindingType.ncontext</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">next_context</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">context</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">i.binding_name</span><span class="misc">)</span><span class="misc">,</span><span class="string">"IDL:omg.org/CosNaming/NamingContext:1.0"</span><span class="misc">)</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(next_context)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentByName</span><span class="misc">(</span><span class="identifier">next_context</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtcs</span><span class="misc">)</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">NVUtil.getBindingType</span><span class="misc">(</span><span class="identifier">i.binding_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BindingType.nobject</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">i.binding_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">i.binding_name</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">kind</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"rtc"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(i.binding_name[1].id, i.binding_name[1].kind)</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CorbaConsumer.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cc</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">context</span><span class="misc">:</span><span class="identifier">resolve</span><span class="misc">(</span><span class="identifier">i.binding_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">cc</span><span class="misc">:</span><span class="identifier">getObject</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span><span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/DataFlowComponent:1.0"</span><span class="misc">)</span></Line>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._non_existent</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">rtcs</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="145" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="False" visited="False"/>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- rtcname形式の文字列からRTCを取得</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name RTC名(rtcname形式)</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- rtcname://localhost/test.host_cxt/ConsoleIn0</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 一致したRTC一覧</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="158" valid="False" visited="False"/>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">tmp</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(tmp[1])</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"rtcname"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">url</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">url</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">r</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">host</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">r</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">url</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">host</span><span class="operator">+</span><span class="number">2</span><span class="misc">)</span></Line>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(rtc_name)</span></Line>  <Line no="171" valid="False" visited="False"/>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cns</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">host</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"*"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cns</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._cosnaming</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cns</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CorbaNaming.new</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span><span class="identifier">host</span><span class="misc">)</span></Line>  <Line no="182" valid="False" visited="False"/>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="184" valid="False" visited="False"/>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="186" valid="False" visited="False"/>  <Line no="187" valid="False" visited="False"/>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">names</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">2</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">names</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"*"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="189" valid="False" visited="False"/>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">root_cxt</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cns</span><span class="misc">:</span><span class="identifier">getRootContext</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="191" valid="False" visited="False"/>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentByName</span><span class="misc">(</span><span class="identifier">root_cxt</span><span class="misc">,</span>&nbsp;<span class="identifier">names</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">rtc_list</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc_list</span></Line>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc_name..</span><span class="string">".rtc"</span></Line>  <Line no="196" valid="False" visited="False"/>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cns</span><span class="misc">:</span><span class="identifier">resolveStr</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">)</span></Line>  <Line no="198" valid="False" visited="False"/>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._non_existent</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="203" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="205" valid="False" visited="False"/>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">,</span><span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/DataFlowComponent:1.0"</span><span class="misc">)</span></Line>  <Line no="207" valid="False" visited="False"/>  <Line no="208" valid="False" visited="False"/>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">rtc_list</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc_list</span></Line>  <Line no="211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="214" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="217" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="218" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="False" visited="False"/>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc_list</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="False" visited="False"/>  <Line no="223" valid="False" visited="False"/>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="225" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="226" valid="False" visited="False"/>  <Line no="227" valid="False" visited="False"/>  <Line no="228" valid="False" visited="False"/>  <Line no="229" valid="True" visited="True">	<span class="identifier">NamingManager.NamingOnManager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="230" valid="False" visited="False"/>  <Line no="231" valid="False" visited="False">	<span class="comment">-- Manager名前管理オブジェクト初期化</span></Line>  <Line no="232" valid="False" visited="False">	<span class="comment">-- @param orb ORB</span></Line>  <Line no="233" valid="False" visited="False">	<span class="comment">-- @param mgr マネージャ</span></Line>  <Line no="234" valid="False" visited="False">	<span class="comment">-- @return Manager名前管理オブジェクト</span></Line>  <Line no="235" valid="True" visited="True">	<span class="identifier">NamingManager.NamingOnManager.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">NamingManager.NamingBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"manager.namingonmanager"</span><span class="misc">)</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._cosnaming</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="243" valid="False" visited="False"/>  <Line no="244" valid="False" visited="False"/>  <Line no="245" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定ホスト名のマネージャを取得</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ホスト名(例：localhost:2810)</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return マネージャ</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getManager</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="249" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"*"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="250" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgr_sev</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getManagerServant</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="252" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgr_sev</span><span class="misc">:</span><span class="identifier">is_master</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="253" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr_sev</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="254" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="255" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">masters</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr_sev</span><span class="misc">:</span><span class="identifier">get_master_managers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="256" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">masters</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="257" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">masters</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="259" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr_sev</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="260" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="261" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="262" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="264" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="266" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"corbaloc:iiop:"</span></Line>  <Line no="267" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getConfig</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="268" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">manager_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"manager.name"</span><span class="misc">)</span></Line>  <Line no="269" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrloc..name</span></Line>  <Line no="270" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrloc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgrloc..</span><span class="string">"/"</span><span class="operator">..</span><span class="identifier">manager_name</span></Line>  <Line no="271" valid="False" visited="False"/>  <Line no="272" valid="False" visited="False"/>  <Line no="273" valid="False" visited="False"/>  <Line no="274" valid="False" visited="False"/>  <Line no="275" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">,</span>&nbsp;<span class="identifier">mgrloc</span><span class="misc">,</span><span class="string">"IDL:RTM/Manager:1.0"</span><span class="misc">)</span></Line>  <Line no="276" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--mgr = RTCUtil.newproxy(self._orb, mgrloc,"IDL:openrtm.aist.go.jp/OpenRTM/DataFlowComponent:1.0")</span></Line>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mgrloc)</span></Line>  <Line no="279" valid="False" visited="False"/>  <Line no="280" valid="False" visited="False"/>  <Line no="281" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"corbaloc: "</span><span class="operator">..</span><span class="identifier">mgrloc</span><span class="misc">)</span></Line>  <Line no="282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mgr)</span></Line>  <Line no="283" valid="False" visited="False"/>  <Line no="284" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="285" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="286" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="288" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="290" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="292" valid="False" visited="False"/>  <Line no="293" valid="False" visited="False"/>  <Line no="294" valid="False" visited="False"/>  <Line no="295" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- rtcloc形式の文字列からRTCを取得</span></Line>  <Line no="296" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name RTC名(rtcloc形式)</span></Line>  <Line no="297" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- rtcloc://localhost:2010/Category/ConsoleIn0</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 一致したRTC一覧</span></Line>  <Line no="299" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="300" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(name)</span></Line>  <Line no="301" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="302" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span></Line>  <Line no="303" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#tmp)</span></Line>  <Line no="304" valid="False" visited="False"/>  <Line no="305" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">tmp</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="306" valid="False" visited="False"/>  <Line no="307" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"rtcloc"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="308" valid="False" visited="False"/>  <Line no="309" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">url</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span></Line>  <Line no="310" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">r</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">url</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span></Line>  <Line no="311" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">r</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="312" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">host</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">r</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="313" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">url</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">host</span><span class="operator">+</span><span class="number">2</span><span class="misc">)</span></Line>  <Line no="314" valid="False" visited="False"/>  <Line no="315" valid="False" visited="False"/>  <Line no="316" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getManager</span><span class="misc">(</span><span class="identifier">host</span><span class="misc">)</span></Line>  <Line no="317" valid="False" visited="False"/>  <Line no="318" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="319" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test1")</span></Line>  <Line no="320" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(mgr:get_master_managers())</span></Line>  <Line no="321" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span><span class="misc">:</span><span class="identifier">get_components_by_name</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">)</span></Line>  <Line no="322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test2")</span></Line>  <Line no="323" valid="False" visited="False"/>  <Line no="324" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">slaves</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span><span class="misc">:</span><span class="identifier">get_slave_managers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="325" valid="False" visited="False"/>  <Line no="326" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">slave</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">slaves</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="327" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="328" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="329" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc_list.extend</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">:</span><span class="identifier">get_components_by_name</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="330" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="331" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="332" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="333" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgr</span><span class="misc">:</span><span class="identifier">remove_slave_manager</span><span class="misc">(</span><span class="identifier">slave</span><span class="misc">)</span></Line>  <Line no="334" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="335" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="336" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="337" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="338" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc_list</span></Line>  <Line no="339" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="340" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="341" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">rtc_list</span></Line>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="343" valid="False" visited="False"/>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="345" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="346" valid="False" visited="False"/>  <Line no="347" valid="False" visited="False">	<span class="comment">-- 名前管理オブジェクト格納オブジェクト初期化</span></Line>  <Line no="348" valid="False" visited="False">	<span class="comment">-- @param meth メソッド名</span></Line>  <Line no="349" valid="False" visited="False">	<span class="comment">-- @param name オブジェクト名</span></Line>  <Line no="350" valid="False" visited="False">	<span class="comment">-- @param naming 名前管理オブジェクト</span></Line>  <Line no="351" valid="False" visited="False">	<span class="comment">-- @return 名前管理オブジェクト格納オブジェクト</span></Line>  <Line no="352" valid="True" visited="True">	<span class="identifier">NamingManager.NameServer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="353" valid="True" visited="True">	<span class="identifier">NamingManager.NameServer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">meth</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">naming</span><span class="misc">)</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.method</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">meth</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.nsname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">naming</span></Line>  <Line no="358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="359" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="360" valid="False" visited="False"/>  <Line no="361" valid="False" visited="False"/>  <Line no="362" valid="True" visited="True">	<span class="identifier">NamingManager.Comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="363" valid="False" visited="False">	<span class="comment">-- RTC格納オブジェクト初期化</span></Line>  <Line no="364" valid="False" visited="False">	<span class="comment">-- @param n 名前</span></Line>  <Line no="365" valid="False" visited="False">	<span class="comment">-- @param _obj RTC</span></Line>  <Line no="366" valid="False" visited="False">	<span class="comment">-- @return RTC格納オブジェクト</span></Line>  <Line no="367" valid="True" visited="True">	<span class="identifier">NamingManager.Comps.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="372" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="373" valid="False" visited="False"/>  <Line no="374" valid="False" visited="False"/>  <Line no="375" valid="True" visited="True">	<span class="identifier">NamingManager.Mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="376" valid="True" visited="True">	<span class="identifier">NamingManager.Mgr.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="377" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="378" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="379" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="380" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="381" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="382" valid="False" visited="False"/>  <Line no="383" valid="True" visited="True">	<span class="identifier">NamingManager.Port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="384" valid="True" visited="True">	<span class="identifier">NamingManager.Port.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="385" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="386" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="387" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="388" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="389" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="390" valid="False" visited="False"/>  <Line no="391" valid="False" visited="False">	<span class="comment">-- ネーミングマネージャ初期化</span></Line>  <Line no="392" valid="False" visited="False">	<span class="comment">-- @param manager マネージャ</span></Line>  <Line no="393" valid="False" visited="False">	<span class="comment">-- @return ネーミングマネージャ</span></Line>  <Line no="394" valid="False" visited="False">	<span class="identifier">NamingManager.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">manager</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">manager</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">manager</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">'manager.namingmanager'</span><span class="misc">)</span></Line>  <Line no="398" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._compNames</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="400" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgrNames</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="401" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portNames</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 名前管理オブジェクト登録</span></Line>  <Line no="403" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param method メソッド名</span></Line>  <Line no="404" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name_server アドレス</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerNameServer</span><span class="misc">(</span><span class="identifier">method</span><span class="misc">,</span>&nbsp;<span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._rtcout)</span></Line>  <Line no="407" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"NamingManager::registerNameServer("</span><span class="operator">..</span><span class="identifier">method..</span><span class="string">", "</span><span class="operator">..</span><span class="identifier">name_server..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="408" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createNamingObj</span><span class="misc">(</span><span class="identifier">method</span><span class="misc">,</span>&nbsp;<span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="409" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(name)</span></Line>  <Line no="410" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._names</span><span class="misc">,</span>&nbsp;<span class="identifier">NamingManager.NameServer.new</span><span class="misc">(</span><span class="identifier">method</span><span class="misc">,</span>&nbsp;<span class="identifier">name_server</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="411" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="412" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 名前管理オブジェクト生成</span></Line>  <Line no="413" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param method メソッド名</span></Line>  <Line no="414" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name_server アドレス</span></Line>  <Line no="415" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 名前管理オブジェクト</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createNamingObj</span><span class="misc">(</span><span class="identifier">method</span><span class="misc">,</span>&nbsp;<span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="417" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(method)</span></Line>  <Line no="418" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"createNamingObj(method = "</span><span class="operator">..</span><span class="identifier">method..</span><span class="string">", nameserver = "</span><span class="operator">..</span><span class="identifier">name_server..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="419" valid="False" visited="False"/>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">mth</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">method</span></Line>  <Line no="421" valid="False" visited="False"/>  <Line no="422" valid="False" visited="False"/>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mth</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"corba"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="424" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="426" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="427" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NamingManager.NamingOnCorba.new</span><span class="misc">(</span><span class="identifier">self._manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span><span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="428" valid="False" visited="False"/>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"NameServer connection succeeded: "</span><span class="operator">..</span><span class="identifier">method..</span><span class="string">"/"</span><span class="operator">..</span><span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="432" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="433" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="434" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"NameServer connection failed: "</span><span class="operator">..</span><span class="identifier">method..</span><span class="string">"/"</span><span class="operator">..</span><span class="identifier">name_server</span><span class="misc">)</span></Line>  <Line no="435" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">mth</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"manager"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="438" valid="False" visited="False"/>  <Line no="439" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NamingManager.NamingOnManager.new</span><span class="misc">(</span><span class="identifier">self._manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">self._manager</span><span class="misc">)</span></Line>  <Line no="440" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(name)</span></Line>  <Line no="441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="442" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="443" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="444" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="445" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCをネームサーバーに登録</span></Line>  <Line no="446" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="447" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="448" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="449" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"NamingManager::bindObject("</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="450" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="451" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n.ns</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="452" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="453" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n.ns</span><span class="misc">:</span><span class="identifier">bindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n.ns</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="458" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="460" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="461" valid="False" visited="False"/>  <Line no="462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">registerCompName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="464" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの登録</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="466" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerCompName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">compName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">compName.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="470" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">compName.rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtobj</span></Line>  <Line no="471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="472" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="473" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="474" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">,</span>&nbsp;<span class="identifier">NamingManager.Comps.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="476" valid="False" visited="False"/>  <Line no="477" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerMgrName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">mgr</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">mgrName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._mgrNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="479" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrName.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="480" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">mgrName.mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">mgr</span></Line>  <Line no="481" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="482" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="483" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="484" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._mgrNames</span><span class="misc">,</span>&nbsp;<span class="identifier">NamingManager.Mgr.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="486" valid="False" visited="False"/>  <Line no="487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerPortName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="488" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">portName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._portNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="489" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">portNames.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="490" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">portName.port</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span></Line>  <Line no="491" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="492" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="494" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._portNames</span><span class="misc">,</span>&nbsp;<span class="identifier">NamingManager.Port.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="495" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="496" valid="False" visited="False"/>  <Line no="497" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCをネームサーバーから登録解除</span></Line>  <Line no="498" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="499" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"NamingManager::unbindObject("</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">n</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n.ns</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n.ns</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="504" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="505" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unregisterCompName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="507" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unregisterMgrName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="508" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unregisterPortName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="509" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="510" valid="False" visited="False"/>  <Line no="511" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unbindAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"NamingManager::unbindAll(): %d names."</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">self._compNames</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">compName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">compName.name</span><span class="misc">)</span></Line>  <Line no="515" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">mgrName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._mgrNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="517" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">mgrName.name</span><span class="misc">)</span></Line>  <Line no="518" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="519" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">portName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._portNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="520" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unbindObject</span><span class="misc">(</span><span class="identifier">portName.name</span><span class="misc">)</span></Line>  <Line no="521" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="523" valid="False" visited="False"/>  <Line no="524" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの登録解除</span></Line>  <Line no="525" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="526" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unregisterCompName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="527" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">compName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="528" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">compName.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="529" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="531" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="532" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="533" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="534" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マネージャの登録解除</span></Line>  <Line no="535" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unregisterMgrName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">mgrName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._mgrNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="538" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">mgrName.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="539" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._mgrNames</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="540" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="541" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="542" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="544" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートの登録解除</span></Line>  <Line no="545" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name 登録名</span></Line>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unregisterPortName</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">portName</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._portNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="548" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">portName.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="549" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._portNames</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="550" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="551" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="552" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="554" valid="False" visited="False"/>  <Line no="555" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- rtcloc、rtcname形式の文字列からRTCを取得</span></Line>  <Line no="556" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name RTC名</span></Line>  <Line no="557" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 一致したRTC一覧</span></Line>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">n</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._names</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="560" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n.ns</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n.ns</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="562" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">comps</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="563" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">comps</span></Line>  <Line no="564" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="565" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="566" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="567" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="568" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="569" valid="False" visited="False"/>  <Line no="570" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="571" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comps</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="572" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">comp</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._compNames</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">comps</span><span class="misc">,</span>&nbsp;<span class="identifier">comp.rtobj</span><span class="misc">)</span></Line>  <Line no="574" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="575" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">comps</span></Line>  <Line no="576" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="577" valid="False" visited="False"/>  <Line no="578" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="579" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="580" valid="False" visited="False"/>  <Line no="581" valid="False" visited="False"/>  <Line no="582" valid="False" visited="False"/>  <Line no="583" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NamingManager</span></Line>  <FileSummary valid="324" visited="230" totalLines="583" coverage="70"/> </File> <File name="lua\openrtm\NamingServiceNumberingPolicy.lua" anchor="lua_openrtm_NamingServiceNumberingPolicy_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NamingServiceNumberingPolicy.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ネームサーバーによる名前付けポリシー定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NamingServiceNumberingPolicy</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.NamingServiceNumberingPolicy"] = NamingServiceNumberingPolicy</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicy"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicyBase"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False">	<span class="identifier">NamingServiceNumberingPolicy.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="20" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">NumberingPolicy.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objects</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="27" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">getTypeName</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="identifier">num_str</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">num_str</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"rtcname://*/*/"</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc_name..name</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getNaming</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">)</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="57" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False">	<span class="identifier">NamingServiceNumberingPolicy.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NumberingPolicyFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"ns_unique"</span><span class="misc">,</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NamingServiceNumberingPolicy.new</span><span class="misc">,</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NamingServiceNumberingPolicy</span></Line>  <FileSummary valid="39" visited="38" totalLines="67" coverage="97"/> </File> <File name="lua\openrtm\NodeNumberingPolicy.lua" anchor="lua_openrtm_NodeNumberingPolicy_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NodeNumberingPolicy.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief マネージャノード内の名前付けポリシー</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NodeNumberingPolicy</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.NodeNumberingPolicy"] = NodeNumberingPolicy</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicy"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicyBase"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False">	<span class="identifier">NodeNumberingPolicy.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">NumberingPolicy.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mgr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="30" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;</Line>  <Line no="32" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">getTypeName</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="identifier">num_str</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="35" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">num_str</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="37" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">num</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">num</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="46" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"rtcloc://*/*/"</span></Line>  <Line no="47" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtc_name..name</span></Line>  <Line no="48" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtcs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._mgr</span><span class="misc">:</span><span class="identifier">getNaming</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">string_to_component</span><span class="misc">(</span><span class="identifier">rtc_name</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">rtcs</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="53" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="57" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False">	<span class="identifier">NodeNumberingPolicy.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NumberingPolicyFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"node_unique"</span><span class="misc">,</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NodeNumberingPolicy.new</span><span class="misc">,</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NodeNumberingPolicy</span></Line>  <FileSummary valid="38" visited="23" totalLines="67" coverage="60"/> </File> <File name="lua\openrtm\NumberingPolicy.lua" anchor="lua_openrtm_NumberingPolicy_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NumberingPolicy.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 名前付けポリシー基底クラス、プロセス内の名前付けポリシー定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicy</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.NumberingPolicy"] = NumberingPolicy</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NumberingPolicyBase"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="identifier">NumberingPolicy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- 名前付けポリシー基底オブジェクト初期化</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @return 名前付けポリシーオブジェクト</span></Line>  <Line no="23" valid="False" visited="False">	<span class="identifier">NumberingPolicy.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="30" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="True" visited="True">	<span class="identifier">NumberingPolicy.ProcessUniquePolicy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False">	<span class="comment">-- プロセス内名前付けポリシー定義オブジェクト初期化</span></Line>  <Line no="36" valid="False" visited="False">	<span class="comment">-- @return 名前付けポリシーオブジェクト</span></Line>  <Line no="37" valid="True" visited="True">	<span class="identifier">NumberingPolicy.ProcessUniquePolicy.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objects</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">NumberingPolicy.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCへの名前付け</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj RTC</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 名前</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._num</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="keyword">nil</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">StringUtil.otos</span><span class="misc">(</span><span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの登録解除</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj RTC</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._num</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの番号取得</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj RTC</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 番号</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">self._objects</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._objects</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">i</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="76" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="False" visited="False">	<span class="comment">-- プロセス内名前付けポリシー生成ファクトリ登録</span></Line>  <Line no="79" valid="True" visited="True">	<span class="identifier">NumberingPolicy.ProcessUniquePolicy.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NumberingPolicyFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"process_unique"</span><span class="misc">,</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NumberingPolicy.ProcessUniquePolicy.new</span><span class="misc">,</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="83" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False"/>  <Line no="85" valid="False" visited="False"/>  <Line no="86" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NumberingPolicy</span></Line>  <FileSummary valid="48" visited="47" totalLines="86" coverage="97"/> </File> <File name="lua\openrtm\NumberingPolicyBase.lua" anchor="lua_openrtm_NumberingPolicyBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NumberingPolicyBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 名前付けポリシー生成ファクトリの定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NumberingPolicyBase</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.NumberingPolicyBase"] = NumberingPolicyBase</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="16" valid="False" visited="False"/>  <Line no="17" valid="False" visited="False">	<span class="identifier">NumberingPolicyBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="18" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="19" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onCreate</span><span class="misc">(</span><span class="identifier">object</span><span class="misc">)</span></Line>  <Line no="20" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="21" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDelete</span><span class="misc">(</span><span class="identifier">object</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="23" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	<span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">NumberingPolicyBase.NumberingPolicyFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="32" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NumberingPolicyBase</span></Line>  <FileSummary valid="16" visited="10" totalLines="34" coverage="62"/> </File> <File name="lua\openrtm\NVUtil.lua" anchor="lua_openrtm_NVUtil_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file NVUtil.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief NameValeヘルパ関数</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.NVUtil"] = NVUtil</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- NameValue生成</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @param name キー</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @param value 値</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @return NameValue</span></Line>  <Line no="22" valid="False" visited="False">	<span class="identifier">NVUtil.newNV</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="operator">=</span><span class="identifier">value</span><span class="misc">}</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False">	<span class="comment">-- プロパティからNameValueをコピーする</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param nv NameValue</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="29" valid="False" visited="False">	<span class="identifier">NVUtil.copyFromProperties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys_len</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">keys</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nv_len</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">nv</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">nv_len</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">nv_len</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">nv</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">keys_len</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.newNV</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	<span class="comment">-- 文字列をRTC::ReturnCode_tに変換</span></Line>  <Line no="45" valid="False" visited="False">	<span class="comment">-- @param ret_code リターンコード(文字列)</span></Line>  <Line no="46" valid="False" visited="False">	<span class="comment">-- @return リターンコード</span></Line>  <Line no="47" valid="False" visited="False">	<span class="identifier">NVUtil.getReturnCode</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret_code)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"RTC_OK"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.RTC_OK</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"RTC_ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.RTC_ERROR</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BAD_PARAMETER"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"UNSUPPORTED"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.UNSUPPORTED</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"OUT_OF_RESOURCES"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.OUT_OF_RESOURCES</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PRECONDITION_NOT_MET"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_code</span></Line>  <Line no="67" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="False" visited="False">	<span class="comment">-- 文字列をOpenRTM::PortStatusに変換</span></Line>  <Line no="70" valid="False" visited="False">	<span class="comment">-- @param ret_code ポートステータス(文字列)</span></Line>  <Line no="71" valid="False" visited="False">	<span class="comment">-- @return ポートステータス</span></Line>  <Line no="72" valid="False" visited="False">	<span class="identifier">NVUtil.getPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret_code)</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="76" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_PortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::OpenRTM::PortStatus"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PORT_OK"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.PORT_OK</span></Line>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PORT_ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="81" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.PORT_ERROR</span></Line>  <Line no="82" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_FULL"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="83" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_FULL</span></Line>  <Line no="84" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_EMPTY"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="85" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_EMPTY</span></Line>  <Line no="86" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_TIMEOUT"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_TIMEOUT</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"UNKNOWN_ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="89" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.UNKNOWN_ERROR</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="92" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_code</span></Line>  <Line no="93" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="False" visited="False">	<span class="comment">-- 文字列をRTC::PortStatusに変換</span></Line>  <Line no="96" valid="False" visited="False">	<span class="comment">-- @param ret_code ポートステータス(文字列)</span></Line>  <Line no="97" valid="False" visited="False">	<span class="comment">-- @return ポートステータス</span></Line>  <Line no="98" valid="False" visited="False">	<span class="identifier">NVUtil.getPortStatus_RTC</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span></Line>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret_code)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">ret_code</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_PortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::PortStatus"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PORT_OK"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.PORT_OK</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PORT_ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.PORT_ERROR</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_FULL"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_FULL</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_EMPTY"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_EMPTY</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"BUFFER_TIMEOUT"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.BUFFER_TIMEOUT</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">ret_code</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"UNKNOWN_ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_PortStatus.UNKNOWN_ERROR</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_code</span></Line>  <Line no="119" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="120" valid="False" visited="False"/>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False">	<span class="comment">-- NameValueからプロパティにコピーする</span></Line>  <Line no="123" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="124" valid="False" visited="False">	<span class="comment">-- @param nvlist NameValue</span></Line>  <Line no="125" valid="False" visited="False">	<span class="identifier">NVUtil.copyToProperties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">nvlist</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">nv</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">nvlist</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(i,nv.value)</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv.value</span><span class="misc">)</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(val)</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">nv.name</span><span class="misc">,</span><span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="133" valid="False" visited="False"/>  <Line no="134" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">nv_find</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="False" visited="False">	<span class="comment">-- NaveValueを検索するための関数オブジェクト初期化</span></Line>  <Line no="137" valid="False" visited="False">	<span class="comment">-- return NaveValueを検索するための関数オブジェクト</span></Line>  <Line no="138" valid="False" visited="False">	<span class="identifier">nv_find.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- NameValueが指定名と一致するかを判定</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nv NameValue</span></Line>  <Line no="144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">nv</span><span class="misc">)</span></Line>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._name, nv.name)</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">nv.name</span><span class="misc">)</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="151" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="False" visited="False">	<span class="comment">-- 名前からNameValueを取得</span></Line>  <Line no="154" valid="False" visited="False">	<span class="comment">-- @param nv NameValueのリスト</span></Line>  <Line no="155" valid="False" visited="False">	<span class="comment">-- @param name 要素名</span></Line>  <Line no="156" valid="False" visited="False">	<span class="comment">-- @return 一致したNamValueの配列番号</span></Line>  <Line no="157" valid="False" visited="False">	<span class="identifier">NVUtil.find_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">nv_find.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="160" valid="False" visited="False"/>  <Line no="161" valid="False" visited="False">	<span class="comment">-- NameValueのリストに指定名、値を追加</span></Line>  <Line no="162" valid="False" visited="False">	<span class="comment">-- 既に指定名のNameValueが存在する場合は上書き</span></Line>  <Line no="163" valid="False" visited="False">	<span class="comment">-- ","で区切る値の場合は後ろに追加</span></Line>  <Line no="164" valid="False" visited="False">	<span class="comment">-- @param nv NameValueのリスト</span></Line>  <Line no="165" valid="False" visited="False">	<span class="comment">-- @param _name 要素名</span></Line>  <Line no="166" valid="False" visited="False">	<span class="comment">-- @param _value 値</span></Line>  <Line no="167" valid="False" visited="False">	<span class="identifier">NVUtil.appendStringValue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">_name</span><span class="misc">,</span>&nbsp;<span class="identifier">_value</span><span class="misc">)</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">_name</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp_nv</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">nv</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp_nv</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">tmp_nv.value</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">values</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">tmp_str</span><span class="misc">,</span><span class="string">","</span><span class="misc">)</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">find_flag</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">values</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">_value</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_flag</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">find_flag</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp_str..</span><span class="string">", "</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp_str.._value</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp_nv.value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmp_str</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="184" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">_name</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="identifier">_value</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="187" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="188" valid="False" visited="False"/>  <Line no="189" valid="False" visited="False">	<span class="comment">-- NameValueのリストを連結する</span></Line>  <Line no="190" valid="False" visited="False">	<span class="comment">-- @param dest 連結先のNameValueのリスト</span></Line>  <Line no="191" valid="False" visited="False">	<span class="comment">-- @param src 連結元のNameValueのリスト</span></Line>  <Line no="192" valid="False" visited="False">	<span class="identifier">NVUtil.append</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">dest</span><span class="misc">,</span>&nbsp;<span class="identifier">src</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">src</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">dest</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="196" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="False" visited="False"/>  <Line no="199" valid="False" visited="False">	<span class="comment">-- NameValueリストの指定名の値が指定文字列と一致するかを判定</span></Line>  <Line no="200" valid="False" visited="False">	<span class="comment">-- @param nv NameValueリスト</span></Line>  <Line no="201" valid="False" visited="False">	<span class="comment">-- @param name 要素名</span></Line>  <Line no="202" valid="False" visited="False">	<span class="comment">-- @param value 値(文字列)</span></Line>  <Line no="203" valid="False" visited="False">	<span class="comment">-- @return true：一致、false：不一致、指定要素がない</span></Line>  <Line no="204" valid="False" visited="False">	<span class="identifier">NVUtil.isStringValue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(NVUtil.toString(nv, name))</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.isString</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.toString</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="212" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="213" valid="False" visited="False"/>  <Line no="214" valid="False" visited="False">	<span class="comment">-- NameValueリストから指定要素の値を取得</span></Line>  <Line no="215" valid="False" visited="False">	<span class="comment">-- @param nv NameValueリスト</span></Line>  <Line no="216" valid="False" visited="False">	<span class="comment">-- @param name 要素名</span></Line>  <Line no="217" valid="False" visited="False">	<span class="comment">-- @return 指定要素</span></Line>  <Line no="218" valid="False" visited="False">	<span class="identifier">NVUtil.find</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">nv_find.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">nv</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">nv</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="226" valid="False" visited="False"/>  <Line no="227" valid="False" visited="False">	<span class="comment">-- オブジェクトリファレンスの一致を判定</span></Line>  <Line no="228" valid="False" visited="False">	<span class="comment">-- @param obj1 オブジェクト1</span></Line>  <Line no="229" valid="False" visited="False">	<span class="comment">-- @param obj2 オブジェクト2</span></Line>  <Line no="230" valid="False" visited="False">	<span class="comment">-- @param obj1_ref オブジェクト1のリファレンス</span></Line>  <Line no="231" valid="False" visited="False">	<span class="comment">-- @param obj2_ref オブジェクト2のリファレンス</span></Line>  <Line no="232" valid="False" visited="False">	<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="233" valid="False" visited="False">	<span class="identifier">NVUtil._is_equivalent</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">obj1</span><span class="misc">,</span>&nbsp;<span class="identifier">obj2</span><span class="misc">,</span>&nbsp;<span class="identifier">obj1_ref</span><span class="misc">,</span>&nbsp;<span class="identifier">obj2_ref</span><span class="misc">)</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">oil.VERSION</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"OiL 0.4 beta"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="235" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj1._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="236" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj2._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="237" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj1_ref</span><span class="misc">(</span><span class="identifier">obj1</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">_is_equivalent</span><span class="misc">(</span><span class="identifier">obj2_ref</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="239" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj1_ref</span><span class="misc">(</span><span class="identifier">obj1</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">_is_equivalent</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span></Line>  <Line no="240" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="242" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj2._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="243" valid="False" visited="False"/>  <Line no="244" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj1</span><span class="misc">:</span><span class="identifier">_is_equivalent</span><span class="misc">(</span><span class="identifier">obj2_ref</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="245" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="246" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj1</span><span class="misc">:</span><span class="identifier">_is_equivalent</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="248" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">oil.VERSION</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"OiL 0.5"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj1._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="251" valid="False" visited="False"/>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj1</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj1_ref</span><span class="misc">(</span><span class="identifier">obj1</span><span class="misc">)</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj2._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj2</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj2_ref</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="257" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj1,obj2,(obj1 == obj2))</span></Line>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj1._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj2._is_equivalent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">obj1</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">obj2</span><span class="misc">)</span></Line>  <Line no="260" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="261" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj1</span><span class="misc">:</span><span class="identifier">_is_equivalent</span><span class="misc">(</span><span class="identifier">obj2</span><span class="misc">)</span></Line>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="264" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="265" valid="False" visited="False"/>  <Line no="266" valid="False" visited="False">	<span class="comment">-- 指定変数がanyの場合に値を取り出す</span></Line>  <Line no="267" valid="False" visited="False">	<span class="comment">-- @param value 変数</span></Line>  <Line no="268" valid="False" visited="False">	<span class="comment">-- @return 取り出した値</span></Line>  <Line no="269" valid="False" visited="False">	<span class="identifier">NVUtil.any_from_any</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"table"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value._anyval</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="272" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">value._anyval</span></Line>  <Line no="273" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="274" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="276" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="False" visited="False">	<span class="comment">-- NameValueリストを表示用文字列に変換</span></Line>  <Line no="279" valid="False" visited="False">	<span class="comment">-- @param nv NameValueリスト</span></Line>  <Line no="280" valid="False" visited="False">	<span class="comment">-- @return 文字列</span></Line>  <Line no="281" valid="False" visited="False">	<span class="identifier">NVUtil.dump_to_stream</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">)</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">out</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="284" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">val</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out..n.name..</span><span class="string">": "</span><span class="operator">..</span><span class="identifier">val..</span><span class="string">"\n"</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="288" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out..n.name..</span><span class="string">": not a string value \n"</span></Line>  <Line no="289" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">out</span></Line>  <Line no="292" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="293" valid="False" visited="False"/>  <Line no="294" valid="False" visited="False">	<span class="comment">-- NameValueリストの指定要素を文字列に変換</span></Line>  <Line no="295" valid="False" visited="False">	<span class="comment">-- @param nv NameValueリスト</span></Line>  <Line no="296" valid="False" visited="False">	<span class="comment">-- @param name 要素名</span></Line>  <Line no="297" valid="False" visited="False">	<span class="comment">-- @return 文字列</span></Line>  <Line no="298" valid="False" visited="False">	<span class="identifier">NVUtil.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="299" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil.dump_to_stream</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">)</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="302" valid="False" visited="False"/>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_value</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">ret_value</span><span class="misc">)</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">val</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">str_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">val</span></Line>  <Line no="309" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="310" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">str_value</span></Line>  <Line no="312" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="313" valid="False" visited="False"/>  <Line no="314" valid="False" visited="False">	<span class="comment">-- NameValueの指定要素が文字列かを判定</span></Line>  <Line no="315" valid="False" visited="False">	<span class="comment">-- @param nv NameValueリスト</span></Line>  <Line no="316" valid="False" visited="False">	<span class="comment">-- @param name 要素名</span></Line>  <Line no="317" valid="False" visited="False">	<span class="comment">-- @return true：文字列、false：文字列以外</span></Line>  <Line no="318" valid="False" visited="False">	<span class="identifier">NVUtil.isString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find</span><span class="misc">(</span><span class="identifier">nv</span><span class="misc">,</span>&nbsp;<span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="library">type</span><span class="misc">(</span><span class="identifier">val</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span><span class="misc">)</span></Line>  <Line no="323" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="326" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="327" valid="False" visited="False"/>  <Line no="328" valid="False" visited="False"/>  <Line no="329" valid="False" visited="False">	<span class="comment">-- 文字列をCosNamingのBindingTypeに変換</span></Line>  <Line no="330" valid="False" visited="False">	<span class="comment">-- @param binding_type バインディング型(文字列)</span></Line>  <Line no="331" valid="False" visited="False">	<span class="comment">-- @return バインディング型</span></Line>  <Line no="332" valid="False" visited="False">	<span class="identifier">NVUtil.getBindingType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">binding_type</span><span class="misc">)</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">binding_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_BindingType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::CosNaming::BindingType"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="336" valid="False" visited="False"/>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">binding_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"ncontext"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_BindingType.ncontext</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">binding_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"nobject"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_BindingType.nobject</span></Line>  <Line no="341" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="342" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="343" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">binding_type</span></Line>  <Line no="344" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="345" valid="False" visited="False"/>  <Line no="346" valid="False" visited="False"/>  <Line no="347" valid="False" visited="False">	<span class="comment">-- 文字列をRTCの状態に変換</span></Line>  <Line no="348" valid="False" visited="False">	<span class="comment">-- @param state RTCの状態(文字列)</span></Line>  <Line no="349" valid="False" visited="False">	<span class="comment">-- @return RTCの状態</span></Line>  <Line no="350" valid="False" visited="False">	<span class="identifier">NVUtil.getLifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(state)</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"CREATED_STATE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_LifeCycleState.CREATED_STATE</span></Line>  <Line no="357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"INACTIVE_STATE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_LifeCycleState.INACTIVE_STATE</span></Line>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"ACTIVE_STATE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_LifeCycleState.ACTIVE_STATE</span></Line>  <Line no="361" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">state</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"ERROR_STATE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_LifeCycleState.ERROR_STATE</span></Line>  <Line no="363" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="364" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">state</span></Line>  <Line no="366" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="367" valid="False" visited="False"/>  <Line no="368" valid="False" visited="False">	<span class="comment">-- CORBAオブジェクトの生存確認</span></Line>  <Line no="369" valid="False" visited="False">	<span class="comment">-- @param _obj CORBAオブジェクト</span></Line>  <Line no="370" valid="False" visited="False">	<span class="comment">-- @return false：生存</span></Line>  <Line no="371" valid="False" visited="False">	<span class="identifier">NVUtil._non_existent</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_obj._non_existent)</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj._non_existent</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="374" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="378" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">_non_existent</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="382" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="383" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="384" valid="False" visited="False"/>  <Line no="385" valid="False" visited="False"/>  <Line no="386" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil</span></Line>  <FileSummary valid="190" visited="159" totalLines="386" coverage="83"/> </File> <File name="lua\openrtm\ObjectManager.lua" anchor="lua_openrtm_ObjectManager_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file ObjectManager.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief オブジェクトマネージャ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ObjectManager</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.ObjectManager"] = ObjectManager</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False">	<span class="comment">-- オブジェクトマネージャ初期化</span></Line>  <Line no="16" valid="False" visited="False">	<span class="comment">-- @param predicate 一致判定関数オブジェクト</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">-- @return オブジェクトマネージャ</span></Line>  <Line no="18" valid="False" visited="False">	<span class="identifier">ObjectManager.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">predicate</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objects</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span>&nbsp;<span class="comment">--self.Objects()</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._predicate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">predicate</span></Line>  <Line no="22" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクト登録</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param object オブジェクト</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">registerObject</span><span class="misc">(</span><span class="identifier">object</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._predicate</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">factory</span><span class="operator">=</span><span class="identifier">object</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">predi</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="30" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._objects)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">,</span>&nbsp;<span class="identifier">object</span><span class="misc">)</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._objects)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクト登録解除</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id ID</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 登録解除したオブジェクト</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unregisterObject</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._predicate</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">id</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">predi</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="47" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定関数を登録オブジェクト全てに実行</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param p 関数オブジェクト初期化関数</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">for_each</span><span class="misc">(</span><span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="57" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">predi</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">predi</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- idからオブジェクト検索</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id ID</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクト</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">find</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(id)</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._predicate</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">id</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">predi</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._predicate</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">id</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._objects</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">predi</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 登録オブジェクト一覧取得</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 登録オブジェクト一覧</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objects</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False"/>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="86" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="False" visited="False"/>  <Line no="89" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">ObjectManager</span></Line>  <FileSummary valid="45" visited="38" totalLines="89" coverage="84"/> </File> <File name="lua\openrtm\OpenHRPExecutionContext.lua" anchor="lua_openrtm_OpenHRPExecutionContext_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OpenHRPExecutionContext.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief トリガ駆動実行コンテキスト定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OpenHRPExecutionContext</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.OpenHRPExecutionContext"] = OpenHRPExecutionContext</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextBase"</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextBase"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextBase.ExecutionContextFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ECFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ECFactory"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DEFAULT_PERIOD</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span><span class="operator">.</span><span class="number">000001</span></Line>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False">	<span class="comment">-- トリガ駆動実行コンテキスト初期化</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @return OpenHRPExecutionContext</span></Line>  <Line no="28" valid="False" visited="False">	<span class="identifier">OpenHRPExecutionContext.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ExecutionContextBase.new</span><span class="misc">(</span><span class="string">"exttrig_sync_ec"</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ExecutionKind</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ExecutionKind"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"rtobject.exttrig_sync_ec"</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"OpenHRPExecutionContext.__init__()"</span><span class="misc">)</span></Line>  <Line no="36" valid="False" visited="False"/>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/ExtTrigExecutionContextService:1.0"</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/ExtTrigExecutionContextService:1.0"</span><span class="misc">)</span></Line>  <Line no="39" valid="False" visited="False"/>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObjRef</span><span class="misc">(</span><span class="identifier">ref</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setKind</span><span class="misc">(</span><span class="identifier">obj._ExecutionKind.PERIODIC</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setRate</span><span class="misc">(</span><span class="number">1</span><span class="operator">.</span><span class="number">0</span>&nbsp;<span class="operator">/</span>&nbsp;<span class="identifier">DEFAULT_PERIOD</span><span class="misc">)</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._count</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC処理実行関数</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">tick</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"tick()"</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isRunning</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t0_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t1_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t2_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">period_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getPeriod</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1000</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">excdotm</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">t1_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span></Line>  <Line no="64" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">excpdotm</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">t2_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t1_</span></Line>  <Line no="65" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">slptm_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">period_</span><span class="misc">:</span><span class="identifier">toDouble</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="misc">(</span><span class="identifier">t2_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Period:      "</span><span class="operator">..</span><span class="identifier">period_</span><span class="misc">:</span><span class="identifier">toDouble</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" [s]"</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Exec-Do:     "</span><span class="operator">..</span><span class="identifier">excdotm..</span><span class="string">" [s]"</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Exec-PostDo: "</span><span class="operator">..</span><span class="identifier">excpdotm..</span><span class="string">" [s]"</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Sleep:       "</span><span class="operator">..</span><span class="identifier">slptm_..</span><span class="string">" [s]"</span><span class="misc">)</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">period_</span><span class="misc">:</span><span class="identifier">toDouble</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="misc">(</span><span class="identifier">t2_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1000</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="73" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"sleeping..."</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">slptm_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">period_</span><span class="misc">:</span><span class="identifier">toDouble</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="misc">(</span><span class="identifier">t2_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t0_</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">oil.tasks</span><span class="misc">:</span><span class="identifier">suspend</span><span class="misc">(</span><span class="identifier">slptm_</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">1000</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="80" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">t4_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">os.clock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Slept:     "</span><span class="operator">..</span><span class="misc">(</span><span class="identifier">t4_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">t3_</span><span class="misc">)</span><span class="operator">..</span><span class="string">" [s]"</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._count</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="88" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="False" visited="False">	<span class="comment">-- OpenHRPExecutionContext生成ファクトリ登録関数</span></Line>  <Line no="91" valid="False" visited="False">	<span class="identifier">OpenHRPExecutionContext.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">manager</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"OpenHRPExecutionContext"</span><span class="misc">,</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OpenHRPExecutionContext.new</span><span class="misc">,</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ECFactory.ECDelete</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"SynchExtTriggerEC"</span><span class="misc">,</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OpenHRPExecutionContext.new</span><span class="misc">,</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ECFactory.ECDelete</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="False" visited="False"/>  <Line no="101" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OpenHRPExecutionContext</span></Line>  <FileSummary valid="61" visited="48" totalLines="101" coverage="78"/> </File> <File name="lua\openrtm\OutPort.lua" anchor="lua_openrtm_OutPort_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPort.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief アウトポート定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPort</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPort"] = OutPort</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">TimeValue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.TimeValue"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortBase"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- データ変数に時刻を設定する</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @param data データ変数</span></Line>  <Line no="20" valid="False" visited="False">	<span class="identifier">OutPort.setTimestamp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tm</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="library">os.time</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">data.tm.sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tm</span><span class="misc">:</span><span class="identifier">sec</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">data.tm.nsec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tm</span><span class="misc">:</span><span class="identifier">usec</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">*</span>&nbsp;<span class="number">1000</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False">	<span class="comment">-- アウトポート初期化</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param name ポート名</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @param value データ変数</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param data_type データ型</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- アウトポート</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">OutPort.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">data_type</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OutPortBase.new</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">data_type</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="36" valid="False" visited="False"/>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._OnWrite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._OnWriteConvert</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._name</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value 送信データ</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：送信成功、false：送信失敗</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._value</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._value.data)</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._OnWrite</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnWrite</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conn_size</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">self._connectors</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">conn_size</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._OnWriteConvert</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._OnWriteConvert</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">result</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">_data</span><span class="operator">=</span><span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">_type</span><span class="operator">=</span><span class="identifier">self._data_type</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">result</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="76" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="77" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">result</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み時コールバック関数の設定</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param on_write コールバック関数</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnWrite</span><span class="misc">(</span><span class="identifier">on_write</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnWrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">on_write</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ変換関数の設定</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param on_wconvert データ変換関数</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOnWriteConvert</span><span class="misc">(</span><span class="identifier">on_wconvert</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._OnWriteConvert</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">on_wconvert</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ型取得</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return データ型</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPortDataType</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="97" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._data_type</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="False" visited="False"/>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="102" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPort</span></Line>  <FileSummary valid="48" visited="42" totalLines="105" coverage="87"/> </File> <File name="lua\openrtm\OutPortBase.lua" anchor="lua_openrtm_OutPortBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief アウトポート基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortBase=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.OutPortBase"]&nbsp;=&nbsp;OutPortBase</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="14" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CORBA_SeqUtil&nbsp;=&nbsp;require&nbsp;"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Properties&nbsp;=&nbsp;require&nbsp;"openrtm.Properties"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener&nbsp;=&nbsp;require&nbsp;"openrtm.ConnectorListener"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListeners&nbsp;=&nbsp;ConnectorListener.ConnectorListeners</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PublisherBase&nbsp;=&nbsp;require&nbsp;"openrtm.PublisherBase"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PublisherFactory&nbsp;=&nbsp;PublisherBase.PublisherFactory</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortBase&nbsp;=&nbsp;require&nbsp;"openrtm.PortBase"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="blockcomment">local&nbsp;StringUtil&nbsp;=&nbsp;require&nbsp;"openrtm.StringUtil"</span></Line>  <Line no="22" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="23" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorDataListenerType&nbsp;=&nbsp;ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="25" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListenerType&nbsp;=&nbsp;ConnectorListener.ConnectorListenerType</span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorDataListener&nbsp;=&nbsp;ConnectorListener.ConnectorDataListener</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorListener&nbsp;=&nbsp;ConnectorListener.ConnectorListener</span></Line>  <Line no="28" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="29" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortConsumer&nbsp;=&nbsp;require&nbsp;"openrtm.InPortConsumer"</span></Line>  <Line no="31" valid="True" visited="True">	<span class="blockcomment">local&nbsp;InPortConsumerFactory&nbsp;=&nbsp;InPortConsumer.InPortConsumerFactory</span></Line>  <Line no="32" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortProvider&nbsp;=&nbsp;require&nbsp;"openrtm.OutPortProvider"</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortProviderFactory&nbsp;=&nbsp;OutPortProvider.OutPortProviderFactory</span></Line>  <Line no="34" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="35" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NVUtil&nbsp;=&nbsp;require&nbsp;"openrtm.NVUtil"</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="37" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorBase&nbsp;=&nbsp;require&nbsp;"openrtm.ConnectorBase"</span></Line>  <Line no="38" valid="True" visited="True">	<span class="blockcomment">local&nbsp;ConnectorInfo&nbsp;=&nbsp;ConnectorBase.ConnectorInfo</span></Line>  <Line no="39" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="40" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortPushConnector&nbsp;=&nbsp;require&nbsp;"openrtm.OutPortPushConnector"</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">local&nbsp;OutPortPullConnector&nbsp;=&nbsp;require&nbsp;"openrtm.OutPortPullConnector"</span></Line>  <Line no="42" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="43" valid="False" visited="False">	<span class="blockcomment">--&nbsp;アウトポート基底オブジェクト初期化</span></Line>  <Line no="44" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;name&nbsp;ポート名</span></Line>  <Line no="45" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;data_type&nbsp;データ型</span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;アウトポート</span></Line>  <Line no="47" valid="False" visited="False">	<span class="blockcomment">OutPortBase.new&nbsp;=&nbsp;function(name,&nbsp;data_type)</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="49" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__index=PortBase.new(name)})</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ReturnCode_t&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::ReturnCode_t").labelvalue</span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._rtcout&nbsp;=&nbsp;Manager:instance():getLogbuf(name)</span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._rtcout:RTC_DEBUG("Port&nbsp;name:&nbsp;"..name)</span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="56" valid="False" visited="False">	<span class="blockcomment">&nbsp;--local&nbsp;svr&nbsp;=&nbsp;Manager:instance():getORB():newservant(obj,&nbsp;nil,&nbsp;"IDL:omg.org/RTC/PortService:1.0")</span></Line>  <Line no="57" valid="False" visited="False">	<span class="blockcomment">&nbsp;--local&nbsp;str&nbsp;=&nbsp;Manager:instance():getORB():tostring(svr)</span></Line>  <Line no="58" valid="False" visited="False">	<span class="blockcomment">&nbsp;--obj._objref&nbsp;=&nbsp;Manager:instance():getORB():newproxy(str,"IDL:omg.org/RTC/PortService:1.0")</span></Line>  <Line no="59" valid="False" visited="False">	<span class="blockcomment">&nbsp;--obj._profile.port_ref&nbsp;=&nbsp;obj._objref</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="61" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="63" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("setting&nbsp;port.port_type:&nbsp;DataOutPort")</span></Line>  <Line no="64" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("port.port_type",&nbsp;"DataOutPort")</span></Line>  <Line no="65" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="66" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;_data_type&nbsp;=&nbsp;string.sub(data_type,&nbsp;3)</span></Line>  <Line no="67" valid="True" visited="True">	<span class="blockcomment">&nbsp;_data_type&nbsp;=&nbsp;string.gsub(_data_type,&nbsp;"::",&nbsp;"/")</span></Line>  <Line no="68" valid="True" visited="True">	<span class="blockcomment">&nbsp;_data_type&nbsp;=&nbsp;"IDL:".._data_type..":1.0"</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("setting&nbsp;dataport.data_type:&nbsp;"..tostring(data_type))</span></Line>  <Line no="70" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("dataport.data_type",&nbsp;_data_type)</span></Line>  <Line no="71" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="72" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;factory&nbsp;=&nbsp;PublisherFactory:instance()</span></Line>  <Line no="74" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;pubs&nbsp;=&nbsp;StringUtil.flatten(factory:getIdentifiers())</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;pubs&nbsp;=&nbsp;StringUtil.eraseHeadBlank(pubs)</span></Line>  <Line no="76" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="77" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="78" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout:RTC_DEBUG("available&nbsp;subscription_type:&nbsp;"..pubs)</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("dataport.subscription_type",&nbsp;pubs)</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj:addProperty("dataport.io_mode",&nbsp;pubs)</span></Line>  <Line no="82" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._properties&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="84" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;name</span></Line>  <Line no="85" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._connectors&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;{}</span></Line>  <Line no="86" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._consumers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;{}</span></Line>  <Line no="87" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._providerTypes&nbsp;=&nbsp;""</span></Line>  <Line no="88" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._consumerTypes&nbsp;=&nbsp;""</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._data_type&nbsp;=&nbsp;data_type</span></Line>  <Line no="90" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._listeners&nbsp;=&nbsp;ConnectorListeners.new()</span></Line>  <Line no="93" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="94" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;初期化時にプロパティを設定する</span></Line>  <Line no="95" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prop&nbsp;プロパティ</span></Line>  <Line no="96" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:init(prop)</span></Line>  <Line no="97" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("init()")</span></Line>  <Line no="98" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:createRef()</span></Line>  <Line no="99" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="100" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._properties:mergeProperties(prop)</span></Line>  <Line no="101" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="102" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="103" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:configure()</span></Line>  <Line no="104" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="105" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="106" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initConsumers()</span></Line>  <Line no="107" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:initProviders()</span></Line>  <Line no="108" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="109" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="110" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;num&nbsp;=&nbsp;tonumber(self._properties:getProperty("connection_limit","-1"))</span></Line>  <Line no="111" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;num&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="112" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("invalid&nbsp;connection_limit&nbsp;value:&nbsp;"..self._properties:getProperty("connection_limit"))</span></Line>  <Line no="113" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="114" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:setConnectionLimit(num)</span></Line>  <Line no="115" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="116" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="117" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;未実装</span></Line>  <Line no="118" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:configure()</span></Line>  <Line no="119" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="120" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスコンシューマ一覧初期化</span></Line>  <Line no="121" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;InPortConsumerFactoryからサービスコンシューマ一覧を取得する</span></Line>  <Line no="122" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;「consumer_types」のプロパティが「all」の場合は、</span></Line>  <Line no="123" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスコンシューマを全て利用可能にする</span></Line>  <Line no="124" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:initConsumers()</span></Line>  <Line no="125" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("initConsumers()")</span></Line>  <Line no="126" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="127" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="128" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;factory&nbsp;=&nbsp;InPortConsumerFactory:instance()</span></Line>  <Line no="129" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;consumer_types&nbsp;=&nbsp;factory:getIdentifiers()</span></Line>  <Line no="130" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(StringUtil.flatten(consumer_types))</span></Line>  <Line no="131" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_PARANOID("available&nbsp;InPortConsumer:&nbsp;"..StringUtil.flatten(consumer_types))</span></Line>  <Line no="132" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;tmp_str&nbsp;=&nbsp;StringUtil.normalize(self._properties:getProperty("consumer_types"))</span></Line>  <Line no="133" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._properties:getProperty("consumer_types"))</span></Line>  <Line no="134" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="135" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._properties:hasKey("consumer_types")&nbsp;and&nbsp;tmp_str&nbsp;&nbsp;~=&nbsp;"all"&nbsp;then</span></Line>  <Line no="136" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("allowed&nbsp;consumers:&nbsp;"..self._properties:getProperty("consumer_types"))</span></Line>  <Line no="137" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="138" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;temp_types&nbsp;=&nbsp;consumer_types</span></Line>  <Line no="139" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;consumer_types&nbsp;=&nbsp;{}</span></Line>  <Line no="140" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;active_types&nbsp;=&nbsp;StringUtil.split(self._properties:getProperty("consumer_types"),&nbsp;",")</span></Line>  <Line no="141" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="142" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(temp_types)</span></Line>  <Line no="143" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(active_types)</span></Line>  <Line no="144" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="145" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;consumer_types&nbsp;=&nbsp;temp_types</span></Line>  <Line no="146" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="147" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;v&nbsp;in&nbsp;ipairs(active_types)&nbsp;do</span></Line>  <Line no="148" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;consumer_types[#consumer_types+1]&nbsp;=&nbsp;v</span></Line>  <Line no="149" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="150" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="151" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="152" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="153" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="154" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="155" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="156" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;#consumer_types&nbsp;&gt;&nbsp;0&nbsp;then</span></Line>  <Line no="157" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("dataflow_type&nbsp;push&nbsp;is&nbsp;supported")</span></Line>  <Line no="158" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.dataflow_type",&nbsp;"push")</span></Line>  <Line no="159" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;consumer_type&nbsp;in&nbsp;ipairs(consumer_types)&nbsp;do</span></Line>  <Line no="160" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.interface_type",consumer_type)</span></Line>  <Line no="161" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="162" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="163" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="164" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="165" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="166" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._consumerTypes&nbsp;=&nbsp;consumer_types</span></Line>  <Line no="167" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="168" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;利用可能なサービスプロバイダ一覧初期化</span></Line>  <Line no="169" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;OutPortProviderFactoryからサービスプロバイダ一覧を取得する</span></Line>  <Line no="170" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;「provider_types」のプロパティが「all」の場合は、</span></Line>  <Line no="171" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;利用可能なサービスプロバイダを全て利用可能にする</span></Line>  <Line no="172" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:initProviders()</span></Line>  <Line no="173" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("initProviders()")</span></Line>  <Line no="174" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="175" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="176" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;factory&nbsp;=&nbsp;OutPortProviderFactory:instance()</span></Line>  <Line no="177" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;provider_types&nbsp;&nbsp;=&nbsp;factory:getIdentifiers()</span></Line>  <Line no="178" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_PARANOID("available&nbsp;OutPortProviders:&nbsp;"..StringUtil.flatten(provider_types))</span></Line>  <Line no="179" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;tmp_str&nbsp;=&nbsp;StringUtil.normalize(self._properties:getProperty("provider_types"))</span></Line>  <Line no="180" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._properties:hasKey("provider_types")&nbsp;and&nbsp;tmp_str&nbsp;&nbsp;~=&nbsp;"all"&nbsp;then</span></Line>  <Line no="181" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_DEBUG("allowed&nbsp;providers:&nbsp;"..self._properties:getProperty("allowed"))</span></Line>  <Line no="182" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="183" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;temp_types&nbsp;=&nbsp;provider_types</span></Line>  <Line no="184" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider_types&nbsp;=&nbsp;{}</span></Line>  <Line no="185" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;active_types&nbsp;=&nbsp;StringUtil.split(self._properties:getProperty("provider_types"),&nbsp;",")</span></Line>  <Line no="186" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="187" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(temp_types)</span></Line>  <Line no="188" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.sort(active_types)</span></Line>  <Line no="189" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="190" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;provider_types&nbsp;=&nbsp;temp_types</span></Line>  <Line no="191" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="192" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;v&nbsp;in&nbsp;ipairs(active_types)&nbsp;do</span></Line>  <Line no="193" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;provider_types[#provider_types+1]&nbsp;=&nbsp;v</span></Line>  <Line no="194" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="195" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="196" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="197" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="198" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="199" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;#provider_types&nbsp;&gt;&nbsp;0&nbsp;then</span></Line>  <Line no="200" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("dataflow_type&nbsp;pull&nbsp;is&nbsp;supported")</span></Line>  <Line no="201" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.dataflow_type",&nbsp;"pull")</span></Line>  <Line no="202" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;provider_type&nbsp;in&nbsp;ipairs(provider_types)&nbsp;do</span></Line>  <Line no="203" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:appendProperty("dataport.interface_type",provider_type)</span></Line>  <Line no="204" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="205" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="206" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="207" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._providerTypes&nbsp;=&nbsp;provider_types</span></Line>  <Line no="208" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="209" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="210" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイルからインターフェース取得</span></Line>  <Line no="211" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;push型の場合はコンシューマ生成して、コネクタを生成する</span></Line>  <Line no="212" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="213" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイルの以下のノードからプロパティを取得</span></Line>  <Line no="214" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport</span></Line>  <Line no="215" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;dataport.outport</span></Line>  <Line no="216" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="217" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_OK：正常終了</span></Line>  <Line no="218" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;BAD_PARAMETER：コンシューマ生成失敗、不正なデータフロー型</span></Line>  <Line no="219" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;RTC_ERROR：コネクタ生成失敗</span></Line>  <Line no="220" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:subscribeInterfaces(cprof)</span></Line>  <Line no="221" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("subscribeInterfaces()")</span></Line>  <Line no="222" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="223" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="224" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="225" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._properties)</span></Line>  <Line no="226" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="227" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prop&nbsp;=&nbsp;Properties.new(self._properties)</span></Line>  <Line no="228" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="229" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="230" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;conn_prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="231" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="232" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;NVUtil.copyToProperties(conn_prop,&nbsp;cprof.properties)</span></Line>  <Line no="233" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(cprof.properties[1].value)</span></Line>  <Line no="234" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="235" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="236" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport"))</span></Line>  <Line no="237" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="238" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="239" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;prop:mergeProperties(conn_prop:getNode("dataport.outport"))</span></Line>  <Line no="240" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="241" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="242" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;dflow_type&nbsp;=&nbsp;StringUtil.normalize(prop:getProperty("dataflow_type"))</span></Line>  <Line no="243" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;profile&nbsp;=&nbsp;ConnectorInfo.new(cprof.name,</span></Line>  <Line no="244" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cprof.connector_id,</span></Line>  <Line no="245" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CORBA_SeqUtil.refToVstring(cprof.ports),</span></Line>  <Line no="246" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prop)</span></Line>  <Line no="247" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="248" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="249" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="250" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(prop)</span></Line>  <Line no="251" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="252" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;print(exception)]]</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(dflow_type)</span></Line>  <Line no="254" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(dflow_type)</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">dflow_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"push"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"dataflow_type = push .... create PushConnector"</span><span class="misc">)</span></Line>  <Line no="259" valid="False" visited="False"/>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createConsumer</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="261" valid="False" visited="False"/>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(consumer)</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="264" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="266" valid="False" visited="False"/>  <Line no="267" valid="False" visited="False"/>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createConnector</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">consumer_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(connector)</span></Line>  <Line no="270" valid="False" visited="False"/>  <Line no="271" valid="False" visited="False"/>  <Line no="272" valid="False" visited="False"/>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="False" visited="False"/>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector</span><span class="misc">:</span><span class="identifier">setConnectorInfo</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"subscribeInterfaces() successfully finished."</span><span class="misc">)</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="281" valid="False" visited="False"/>  <Line no="282" valid="False" visited="False"/>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="284" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">dflow_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"pull"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conn</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getConnectorById</span><span class="misc">(</span><span class="identifier">cprof.connector_id</span><span class="misc">)</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">conn</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="287" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"specified connector not found: "</span><span class="operator">..</span><span class="identifier">cprof.connector_id</span><span class="misc">)</span></Line>  <Line no="288" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="290" valid="False" visited="False"/>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">conn</span><span class="misc">:</span><span class="identifier">setConnectorInfo</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="292" valid="False" visited="False"/>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"subscribeInterfaces() successfully finished."</span><span class="misc">)</span></Line>  <Line no="295" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="296" valid="False" visited="False"/>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False"/>  <Line no="300" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"unsupported dataflow_type"</span><span class="misc">)</span></Line>  <Line no="301" valid="False" visited="False"/>  <Line no="302" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="304" valid="False" visited="False"/>  <Line no="305" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロバイダの初期化してインターフェースをコネクタプロファイルに登録</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- pull型の場合はプロバイダを生成して、コネクタを生成する</span></Line>  <Line no="307" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="308" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルの以下のノードからプロパティを取得</span></Line>  <Line no="309" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport</span></Line>  <Line no="310" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.outport</span></Line>  <Line no="311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="312" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：正常終了</span></Line>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BAD_PARAMETER：プロバイダの初期化失敗、不正なデータフロー型</span></Line>  <Line no="314" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_ERROR：コネクタ生成失敗</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterfaces</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterfaces()"</span><span class="misc">)</span></Line>  <Line no="317" valid="False" visited="False"/>  <Line no="318" valid="False" visited="False"/>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">retval</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_publishInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">retval</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="321" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">retval</span></Line>  <Line no="322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="323" valid="False" visited="False"/>  <Line no="324" valid="False" visited="False"/>  <Line no="325" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="326" valid="False" visited="False"/>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">conn_prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="328" valid="False" visited="False"/>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">conn_prop</span><span class="misc">,</span>&nbsp;<span class="identifier">cprof.properties</span><span class="misc">)</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">conn_prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"dataport"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="331" valid="False" visited="False"/>  <Line no="332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">conn_prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"dataport.outport"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="333" valid="False" visited="False"/>  <Line no="334" valid="False" visited="False"/>  <Line no="335" valid="False" visited="False"/>  <Line no="336" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dflow_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.normalize</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"dataflow_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="337" valid="False" visited="False"/>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">dflow_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"push"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"dataflow_type = push .... do nothing"</span><span class="misc">)</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="341" valid="False" visited="False"/>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">dflow_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"pull"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"dataflow_type = pull .... create PullConnector"</span><span class="misc">)</span></Line>  <Line no="344" valid="False" visited="False"/>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createProvider</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="347" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="348" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="349" valid="False" visited="False"/>  <Line no="350" valid="False" visited="False"/>  <Line no="351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createConnector</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">provider_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">provider</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="353" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="354" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="355" valid="False" visited="False"/>  <Line no="356" valid="False" visited="False"/>  <Line no="357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">setConnector</span><span class="misc">(</span><span class="identifier">connector</span><span class="misc">)</span></Line>  <Line no="358" valid="False" visited="False"/>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"publishInterface() successfully finished."</span><span class="misc">)</span></Line>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="362" valid="False" visited="False"/>  <Line no="363" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"unsupported dataflow_type"</span><span class="misc">)</span></Line>  <Line no="364" valid="False" visited="False"/>  <Line no="365" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="367" valid="False" visited="False"/>  <Line no="368" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ生成</span></Line>  <Line no="369" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param args args.provider_：プロバイダ、args.consumer_：コンシューマ</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタオブジェクト</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createConnector</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">args</span><span class="misc">)</span></Line>  <Line no="374" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">provider_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">args.provider_</span></Line>  <Line no="375" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">consumer_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">args.consumer_</span></Line>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorInfo.new</span><span class="misc">(</span><span class="identifier">cprof.name</span><span class="misc">,</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cprof.connector_id</span><span class="misc">,</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.refToVstring</span><span class="misc">(</span><span class="identifier">cprof.ports</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="381" valid="False" visited="False"/>  <Line no="382" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="384" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="386" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortPushConnector.new</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer_</span><span class="misc">,</span></Line>  <Line no="387" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners</span><span class="misc">)</span></Line>  <Line no="388" valid="False" visited="False"/>  <Line no="389" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">provider_</span>&nbsp;&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="390" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortPullConnector.new</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">provider_</span><span class="misc">,</span></Line>  <Line no="391" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners</span><span class="misc">)</span></Line>  <Line no="392" valid="False" visited="False"/>  <Line no="393" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="394" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"provider or consumer is not passed. returned 0;"</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="396" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="397" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="398" valid="False" visited="False"/>  <Line no="399" valid="False" visited="False"/>  <Line no="400" valid="False" visited="False"/>  <Line no="401" valid="False" visited="False"/>  <Line no="402" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"OutPortPushConnector created"</span><span class="misc">)</span></Line>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">provider_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"OutPortPullConnector created"</span><span class="misc">)</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="407" valid="False" visited="False"/>  <Line no="408" valid="False" visited="False"/>  <Line no="409" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">,</span>&nbsp;<span class="identifier">connector</span><span class="misc">)</span></Line>  <Line no="410" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"connector push backed: "</span><span class="operator">..</span><span class="operator">#</span><span class="identifier">self._connectors</span><span class="misc">)</span></Line>  <Line no="411" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector</span></Line>  <Line no="412" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="415" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="416" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"OutPortPushConnector creation failed"</span><span class="misc">)</span></Line>  <Line no="417" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="418" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="419" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="421" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="422" valid="False" visited="False"/>  <Line no="423" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスプロバイダ作成</span></Line>  <Line no="424" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「interface_type」の要素にインターフェース型を指定</span></Line>  <Line no="425" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「provider」のノードにプロバイダのプロパティを指定</span></Line>  <Line no="426" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="427" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="428" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロバイダ</span></Line>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createProvider</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="430" valid="False" visited="False"/>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">or</span></Line>  <Line no="432" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.includes</span><span class="misc">(</span><span class="identifier">self._providerTypes</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="433" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"no provider found"</span><span class="misc">)</span></Line>  <Line no="434" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type:  "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="435" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_types: "</span><span class="operator">..</span></Line>  <Line no="436" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">self._providerTypes</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="437" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="439" valid="False" visited="False"/>  <Line no="440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type: "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="442" valid="False" visited="False"/>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="444" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"provider created"</span><span class="misc">)</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"provider"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="446" valid="False" visited="False"/>  <Line no="447" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">publishInterface</span><span class="misc">(</span><span class="identifier">cprof.properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="448" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"publishing interface information error"</span><span class="misc">)</span></Line>  <Line no="449" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="450" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="451" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="452" valid="False" visited="False"/>  <Line no="453" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">provider</span></Line>  <Line no="454" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="455" valid="False" visited="False"/>  <Line no="456" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"provider creation failed"</span><span class="misc">)</span></Line>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="459" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="460" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスコンシューマ作成</span></Line>  <Line no="461" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「interface_type」の要素にインターフェース型を指定</span></Line>  <Line no="462" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 「consumer」のノードにコンシューマのプロパティを指定</span></Line>  <Line no="463" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="464" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンシューマ</span></Line>  <Line no="466" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createConsumer</span><span class="misc">(</span><span class="identifier">cprof</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop:getProperty("interface_type"))</span></Line>  <Line no="468" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(StringUtil.includes(self._consumerTypes, prop:getProperty("interface_type")))</span></Line>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">or</span></Line>  <Line no="470" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.includes</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"no consumer  found"</span><span class="misc">)</span></Line>  <Line no="472" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type:  "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="473" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_types: "</span><span class="operator">..</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="474" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="475" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="476" valid="False" visited="False"/>  <Line no="477" valid="False" visited="False"/>  <Line no="478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"interface_type: "</span><span class="operator">..</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"interface_type"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="480" valid="False" visited="False"/>  <Line no="481" valid="False" visited="False"/>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"consumer  created"</span><span class="misc">)</span></Line>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"consumer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="485" valid="False" visited="False"/>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">cprof.properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="487" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"interface subscription failed."</span><span class="misc">)</span></Line>  <Line no="488" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">InPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="489" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="490" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="491" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="False" visited="False"/>  <Line no="494" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"provider creation failed"</span><span class="misc">)</span></Line>  <Line no="495" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="496" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="497" valid="False" visited="False"/>  <Line no="498" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IDからコネクタを取得</span></Line>  <Line no="499" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id 識別子</span></Line>  <Line no="500" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタ</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getConnectorById</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getConnectorById(id = "</span><span class="operator">..</span><span class="identifier">id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="503" valid="False" visited="False"/>  <Line no="504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="505" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">con</span></Line>  <Line no="507" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="508" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="509" valid="False" visited="False"/>  <Line no="510" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"ConnectorProfile with the id("</span><span class="operator">..</span><span class="identifier">id..</span><span class="string">") not found."</span><span class="misc">)</span></Line>  <Line no="511" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="513" valid="False" visited="False"/>  <Line no="514" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定コネクタプロファイルのコネクタを削除</span></Line>  <Line no="515" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="517" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeInterfaces()"</span><span class="misc">)</span></Line>  <Line no="518" valid="False" visited="False"/>  <Line no="519" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.connector_id</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"connector_id: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="521" valid="False" visited="False"/>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="523" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="524" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="526" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._connectors</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="527" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"delete connector: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="528" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="529" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="530" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="531" valid="False" visited="False"/>  <Line no="532" valid="False" visited="False"/>  <Line no="533" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"specified connector not found: "</span><span class="operator">..</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="534" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="535" valid="False" visited="False"/>  <Line no="536" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースのアクティブ化</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="538" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="539" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="540" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="541" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"activate connector: "</span><span class="operator">..</span></Line>  <Line no="542" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="543" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="545" valid="False" visited="False"/>  <Line no="546" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースの非アクティブ化</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="548" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"deactivateInterfaces()"</span><span class="misc">)</span></Line>  <Line no="549" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._connectors</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="550" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="551" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"deactivate connector: "</span><span class="operator">..</span></Line>  <Line no="552" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">con</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span><span class="operator">..</span><span class="string">" "</span><span class="operator">..</span><span class="identifier">con</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="553" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="554" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="555" valid="False" visited="False"/>  <Line no="556" valid="False" visited="False"/>  <Line no="557" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConnectorDataListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="558" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="560" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorDataListener()"</span><span class="misc">)</span></Line>  <Line no="562" valid="False" visited="False"/>  <Line no="563" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="564" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorDataListener(%s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorDataListener.toString</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="565" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="566" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="567" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="568" valid="False" visited="False"/>  <Line no="569" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addConnectorDataListener(): Unknown Listener Type"</span><span class="misc">)</span></Line>  <Line no="570" valid="False" visited="False"/>  <Line no="571" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="572" valid="False" visited="False"/>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConnectorDataListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="574" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorDataListener()"</span><span class="misc">)</span></Line>  <Line no="575" valid="False" visited="False"/>  <Line no="576" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorDataListenerType.CONNECTOR_DATA_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="577" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorDataListener(%s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorDataListener.toString</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="578" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="579" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="580" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="581" valid="False" visited="False"/>  <Line no="582" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"removeConnectorDataListener(): Unknown Listener Type"</span><span class="misc">)</span></Line>  <Line no="583" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="584" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="585" valid="False" visited="False"/>  <Line no="586" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addConnectorListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="587" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="588" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="589" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="590" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorListener()"</span><span class="misc">)</span></Line>  <Line no="591" valid="False" visited="False"/>  <Line no="592" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorListenerType.CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addConnectorListener(%s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorListener.toString</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="594" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="595" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="596" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="597" valid="False" visited="False"/>  <Line no="598" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addConnectorListener(): Unknown Listener Type"</span><span class="misc">)</span></Line>  <Line no="599" valid="False" visited="False"/>  <Line no="600" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="601" valid="False" visited="False"/>  <Line no="602" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeConnectorListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="603" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorListener()"</span><span class="misc">)</span></Line>  <Line no="604" valid="False" visited="False"/>  <Line no="605" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listener_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">ConnectorListenerType.CONNECTOR_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="606" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeConnectorListener(%s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">ConnectorListener.toString</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="607" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="608" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="609" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="610" valid="False" visited="False"/>  <Line no="611" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"removeConnectorListener(): Unknown Listener Type"</span><span class="misc">)</span></Line>  <Line no="612" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="613" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="614" valid="False" visited="False"/>  <Line no="615" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="616" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="617" valid="False" visited="False"/>  <Line no="618" valid="False" visited="False"/>  <Line no="619" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortBase</span></Line>  <FileSummary valid="323" visited="241" totalLines="619" coverage="74"/> </File> <File name="lua\openrtm\OutPortConnector.lua" anchor="lua_openrtm_OutPortConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortConnectorBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief OutPortコネクタ基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortConnector"] = OutPortConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorBase"</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False">	<span class="comment">-- OutPortコネクタ基底オブジェクト初期化</span></Line>  <Line no="16" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">-- @return InPortコネクタ</span></Line>  <Line no="18" valid="False" visited="False">	<span class="identifier">OutPortConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ConnectorBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"OutPortConnector"</span><span class="misc">)</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj._rtcout)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._endian</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="27" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"profile()"</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタID取得</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタID</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">id</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"id() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ名取得</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コネクタ名</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">name</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"name() = "</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">profile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル設定</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile プロファイル</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConnectorInfo</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">profile</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="56" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortConnector</span></Line>  <FileSummary valid="28" visited="26" totalLines="59" coverage="92"/> </File> <File name="lua\openrtm\OutPortConsumer.lua" anchor="lua_openrtm_OutPortConsumer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortConsumer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief OutPortコンシューマと生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! Pull型通信の独自インターフェース型を実装する場合は、</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! OutPortConsumerをメタテーブルに設定したコンシューマオブジェクトを生成する</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConsumer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortConsumer"] = OutPortConsumer</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- OutPortコンシューマオブジェクト初期化</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @return OutPortコンシューマオブジェクト</span></Line>  <Line no="20" valid="False" visited="False">	<span class="identifier">OutPortConsumer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.subscribe</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマのインターフェース追加関数オブジェクト初期化</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="25" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return インターフェース追加関数オブジェクト</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.subscribe.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース追加関数</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">self._prop</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.unsubscribe</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンシューマのインターフェース削除関数オブジェクト初期化</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- return インターフェース削除オブジェクト</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.unsubscribe.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース削除関数</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">unsubscribeInterface</span><span class="misc">(</span><span class="identifier">self._prop</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="55" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="56" valid="False" visited="False"/>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="True" visited="True">	<span class="identifier">OutPortConsumer.OutPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="59" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">OutPortConsumer.OutPortConsumerFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">OutPortConsumer.OutPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="63" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortConsumer</span></Line>  <FileSummary valid="30" visited="18" totalLines="66" coverage="60"/> </File> <File name="lua\openrtm\OutPortDSConsumer.lua" anchor="lua_openrtm_OutPortDSConsumer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortDSConsumer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CorbaCdrインターフェースで通信するOutPortConsumer定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! 「data_service」のインターフェース型で利用可能</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! RTC.idlのPortServiceインターフェース</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortDSConsumer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortDSConsumer"] = OutPortDSConsumer</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortConsumer"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CorbaConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CorbaConsumer"</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortConsumer.OutPortConsumerFactory</span></Line>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="28" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="29" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorDataListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="30" valid="False" visited="False"/>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False">	<span class="comment">-- CorbaCdrインターフェースのOutPortConsumerオブジェクト初期化</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- @return CorbaCdrインターフェースのOutPortConsumerオブジェクト</span></Line>  <Line no="34" valid="False" visited="False">	<span class="identifier">OutPortDSConsumer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OutPortConsumer.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">CorbaConsumer.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._PortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::PortStatus"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"OutPortDSConsumer"</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティ設定</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"init()"</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファの設定</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setBuffer()"</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">buffer</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コールバック関数設定</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param info プロファイル</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listeners コールバック関数</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setListener()"</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="67" valid="False" visited="False"/>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ取得</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._dataにデータを格納する</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC_OK：getオペレーションが正常終了</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- CONNECTION_LOST：通信失敗</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"get()"</span><span class="misc">)</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">outportcdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(outportcdr)</span></Line>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">outportcdr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">,</span><span class="identifier">cdr_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">outportcdr</span><span class="misc">:</span><span class="identifier">pull</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.getPortStatus_RTC</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span></Line>  <Line no="89" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="92" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Exception caught from OutPort.pull()."</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret, DataPortStatus.CONNECTION_LOST)</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"get() successful"</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">data._data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">cdr_data</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferWrite</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">full</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"InPort buffer is full."</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferFull</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="106" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">advanceWptr</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="114" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span><span class="identifier">data._data</span><span class="misc">)</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティからインターフェース情報取得</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスの設定</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列、もしくはリファレンスを取得</span></Line>  <Line no="119" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ior</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ref</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeInterface</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeInterface()"</span><span class="misc">)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">subscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">subscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="129" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="130" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティからインターフェース設定解除-- IOR文字列、もしくはリファレンスを取得</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ior</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ref</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterface</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeInterface()"</span><span class="misc">)</span></Line>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unsubscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">unsubscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンス設定</span></Line>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からIOR文字列取得</span></Line>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ior</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeFromIor()"</span><span class="misc">)</span></Line>  <Line no="154" valid="False" visited="False"/>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.outport_ior"</span><span class="misc">)</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(index)</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="159" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"outport_ior not found"</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="False" visited="False"/>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="False" visited="False"/>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"dataport.data_service.outport_ior"</span><span class="misc">)</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">,</span><span class="string">"IDL:omg.org/RTC/DataPullService:1.0"</span><span class="misc">)</span></Line>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="False" visited="False"/>  <Line no="178" valid="False" visited="False"/>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="180" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"invalid IOR string has been passed"</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False"/>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Setting object to consumer failed."</span><span class="misc">)</span></Line>  <Line no="186" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="188" valid="False" visited="False"/>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="191" valid="False" visited="False"/>  <Line no="192" valid="False" visited="False"/>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトからオブジェクトリファレンス設定</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からリファレンスを取得</span></Line>  <Line no="197" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ref</span></Line>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"subscribeFromRef()"</span><span class="misc">)</span></Line>  <Line no="201" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="202" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.outport_ior"</span><span class="misc">)</span></Line>  <Line no="203" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="204" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"outport_ref not found"</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="207" valid="False" visited="False"/>  <Line no="208" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="209" valid="False" visited="False"/>  <Line no="210" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="211" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="212" valid="False" visited="False"/>  <Line no="213" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span><span class="misc">:</span><span class="identifier">narrow</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/DataPullService:1.0"</span><span class="misc">)</span></Line>  <Line no="214" valid="False" visited="False"/>  <Line no="215" valid="False" visited="False"/>  <Line no="216" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="217" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"prop[outport_ref] is not objref"</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="219" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="False" visited="False"/>  <Line no="221" valid="False" visited="False"/>  <Line no="222" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setObject</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="223" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Setting object to consumer failed."</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="226" valid="False" visited="False"/>  <Line no="227" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="False" visited="False"/>  <Line no="231" valid="False" visited="False"/>  <Line no="232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IOR文字列からオブジェクトリファレンス設定解除</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="234" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からIOR文字列取得</span></Line>  <Line no="235" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ior</span></Line>  <Line no="236" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定解除成功、false：設定解除失敗</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeFromIor</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeFromIor()"</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.outport_ior"</span><span class="misc">)</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="242" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"outport_ior not found"</span><span class="misc">)</span></Line>  <Line no="243" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="245" valid="False" visited="False"/>  <Line no="246" valid="False" visited="False"/>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="248" valid="False" visited="False"/>  <Line no="249" valid="False" visited="False"/>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ior</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"prop[outport_ior] is not string"</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="253" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="254" valid="False" visited="False"/>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">var</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.newproxy</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">ior</span><span class="misc">,</span><span class="string">"IDL:omg.org/RTC/DataPullService:1.0"</span><span class="misc">)</span></Line>  <Line no="258" valid="False" visited="False"/>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">var.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="260" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"connector property inconsistency"</span><span class="misc">)</span></Line>  <Line no="261" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="263" valid="False" visited="False"/>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="267" valid="False" visited="False"/>  <Line no="268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトからオブジェクトリファレンス設定解除</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param properties プロパティ</span></Line>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 以下からリファレンスを取得</span></Line>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- dataport.corba_cdr.outport_ref</span></Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定解除成功、false：設定解除失敗</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeFromRef</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"unsubscribeFromRef()"</span><span class="misc">)</span></Line>  <Line no="275" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.find_index</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="276" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.data_service.outport_ref"</span><span class="misc">)</span></Line>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="279" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="281" valid="False" visited="False"/>  <Line no="282" valid="False" visited="False"/>  <Line no="283" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="False" visited="False"/>  <Line no="286" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="287" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="288" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="289" valid="False" visited="False"/>  <Line no="290" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj_ptr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_ptr</span><span class="misc">(</span><span class="keyword">true</span><span class="misc">)</span></Line>  <Line no="291" valid="False" visited="False"/>  <Line no="292" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj_ptr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">obj_ptr</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj_ptr.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="293" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="294" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="295" valid="False" visited="False"/>  <Line no="296" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">releaseObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False"/>  <Line no="300" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC::PortStatusをデータポートステータスに変換</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">status</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="302" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="303" valid="False" visited="False"/>  <Line no="304" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="305" valid="False" visited="False"/>  <Line no="306" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="307" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="308" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span></Line>  <Line no="309" valid="False" visited="False"/>  <Line no="310" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_FULL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="311" valid="False" visited="False"/>  <Line no="312" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_FULL</span></Line>  <Line no="313" valid="False" visited="False"/>  <Line no="314" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_EMPTY</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="315" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_EMPTY</span></Line>  <Line no="317" valid="False" visited="False"/>  <Line no="318" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="319" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="320" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.BUFFER_TIMEOUT</span></Line>  <Line no="321" valid="False" visited="False"/>  <Line no="322" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="323" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="324" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span></Line>  <Line no="325" valid="False" visited="False"/>  <Line no="326" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="327" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="328" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span></Line>  <Line no="329" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False"/>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ書き込み時のコールバック実行</span></Line>  <Line no="333" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferWrite</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="336" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_WRITE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="337" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="339" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファフル時のコールバック実行</span></Line>  <Line no="340" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="342" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="343" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_FULL</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="344" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="346" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ受信時のコールバック実行</span></Line>  <Line no="347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="350" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="353" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 受信データフルのコールバック実行</span></Line>  <Line no="354" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="356" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="357" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_FULL</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="358" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 送信データエンプティのコールバック実行</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderEmpty</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="363" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="364" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_SENDER_EMPTY</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="365" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="367" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 送信データ時間切れ時のコールバック実行</span></Line>  <Line no="368" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="370" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="371" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_SENDER_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="374" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 送信エラー時のコールバック実行</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="377" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="378" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_SENDER_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="379" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="381" valid="False" visited="False"/>  <Line no="382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="383" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="384" valid="False" visited="False"/>  <Line no="385" valid="False" visited="False">	<span class="comment">-- OutPortDSConsumer生成ファクトリ登録関数</span></Line>  <Line no="386" valid="False" visited="False">	<span class="identifier">OutPortDSConsumer.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="387" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"data_service"</span><span class="misc">,</span></Line>  <Line no="388" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortDSConsumer.new</span><span class="misc">,</span></Line>  <Line no="389" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="390" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="391" valid="False" visited="False"/>  <Line no="392" valid="False" visited="False"/>  <Line no="393" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortDSConsumer</span></Line>  <FileSummary valid="213" visited="126" totalLines="393" coverage="59"/> </File> <File name="lua\openrtm\OutPortDSProvider.lua" anchor="lua_openrtm_OutPortDSProvider_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortDSProvider.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief CorbaCdrインターフェースで通信するOutPortProvider定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! 「data_service」のインターフェース型で利用可能</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! RTC.idlのPortServiceインターフェース</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortDSProvider</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortDSProvider"] = OutPortDSProvider</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProvider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortProvider"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortProvider.OutPortProviderFactory</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="26" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="27" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorDataListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="28" valid="False" visited="False"/>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="False" visited="False">	<span class="comment">-- CorbaCdrインターフェースのOutPortProviderオブジェクト初期化</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @return CorbaCdrインターフェースのOutPortProviderオブジェクト</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">OutPortDSProvider.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OutPortProvider.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._PortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::PortStatus"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="37" valid="False" visited="False"/>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInterfaceType</span><span class="misc">(</span><span class="string">"data_service"</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="41" valid="False" visited="False"/>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/DataPullService:1.0"</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span><span class="misc">:</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">obj._svr</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/DataPullService:1.0"</span><span class="misc">)</span></Line>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj._properties</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.newNV</span><span class="misc">(</span><span class="string">"dataport.data_service.outport_ior"</span><span class="misc">,</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">str</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--table.insert(obj._properties, NVUtil.newNV("dataport.data_service.outport_ref",</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--												obj._objref))</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="55" valid="False" visited="False"/>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了処理</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティ設定</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ設定</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">buffer</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コールバック関数設定</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param info プロファイル</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listeners コールバック関数</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ設定</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector コネクタ</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConnector</span><span class="misc">(</span><span class="identifier">connector</span><span class="misc">)</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._connector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="85" valid="False" visited="False"/>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード、データ</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PORT_OK：正常終了</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- PORT_ERROR：バッファがない</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_EMPTY：バッファが空</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- その他、バッファフル、タイムアウト等の戻り値</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">pull</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"OutPortDSProvider.get()"</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="96" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span><span class="misc">,</span>&nbsp;<span class="string">""</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="98" valid="False" visited="False"/>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">empty</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"buffer is empty."</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_EMPTY</span><span class="misc">,</span>&nbsp;<span class="string">""</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">_data</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">cdr</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">cdr._data</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="110" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"buffer is empty."</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_EMPTY</span><span class="misc">,</span>&nbsp;<span class="string">""</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">cdr._data</span><span class="misc">)</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ書き込み時コールバック</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferRead</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_BUFFER_READ</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="False" visited="False"/>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ送信時コールバック</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSend</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_SEND</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="130" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ空時コールバック</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="136" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_BUFFER_EMPTY</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ読み込みタイムアウト時コールバック</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onBufferReadTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="142" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_BUFFER_READ_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 送信データ空時コールバック</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_SENDER_EMPTY</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ送信タイムアウト時コールバック</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="154" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_SENDER_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ送信エラー時コールバック</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_SENDER_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファステータスをRTC::PortStatusに変換</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--コールバック呼び出し</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param status バッファステータス</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ポートステータス、データ</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">convertReturn</span><span class="misc">(</span><span class="identifier">status</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferRead</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSend</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_OK</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="173" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="174" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="175" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="176" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_FULL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_FULL</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_EMPTY</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="179" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="180" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderEmpty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="181" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_EMPTY</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="182" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderError</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.PORT_ERROR</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">status</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">BufferStatus.TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="186" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onBufferReadTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSenderTimeout</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.BUFFER_TIMEOUT</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="190" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._PortStatus.UNKNOWN_ERROR</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span></Line>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="196" valid="False" visited="False"/>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="False" visited="False"/>  <Line no="199" valid="False" visited="False"/>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="201" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="202" valid="False" visited="False"/>  <Line no="203" valid="False" visited="False">	<span class="comment">-- OutPortDSProvider生成ファクトリ登録関数</span></Line>  <Line no="204" valid="False" visited="False">	<span class="identifier">OutPortDSProvider.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"data_service"</span><span class="misc">,</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortDSProvider.new</span><span class="misc">,</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="209" valid="False" visited="False"/>  <Line no="210" valid="False" visited="False"/>  <Line no="211" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortDSProvider</span></Line>  <FileSummary valid="117" visited="83" totalLines="211" coverage="70"/> </File> <File name="lua\openrtm\OutPortProvider.lua" anchor="lua_openrtm_OutPortProvider_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortProvider.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief OutPortプロバイダと生成ファクトリ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! Pull型通信の独自インターフェース型を実装する場合は、</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! OutPortProviderをメタテーブルに設定したプロバイダオブジェクトを生成する</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="7" valid="False" visited="False"/>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="10" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProvider</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="13" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortProvider"] = OutPortProvider</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False">	<span class="comment">-- OutPortプロバイダオブジェクト初期化</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @return OutPortプロバイダオブジェクト</span></Line>  <Line no="21" valid="False" visited="False">	<span class="identifier">OutPortProvider.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="22" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dataType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._interfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dataflowType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._subscriptionType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"OutPortProvider"</span><span class="misc">)</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルにインターフェース型を設定</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterfaceProfile</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterfaceProfile()"</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.appendStringValue</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="string">"dataport.interface_type"</span><span class="misc">,</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.append</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルに各種設定を行う</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">publishInterface</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"publishInterface()"</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil.isStringValue</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dataport.interface_type"</span><span class="misc">,</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.append</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート型の設定</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port_type ポート型</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setPortType</span><span class="misc">(</span><span class="identifier">port_type</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_type</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ型の設定</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port_type データ型</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataType</span><span class="misc">(</span><span class="identifier">data_type</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._dataType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">data_type</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース型の設定</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param interface_type インターフェース型</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInterfaceType</span><span class="misc">(</span><span class="identifier">interface_type</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._interfaceType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">interface_type</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データフロー型の設定</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param dataflow_type データフロー型</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataFlowType</span><span class="misc">(</span><span class="identifier">dataflow_type</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._dataflowType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">dataflow_type</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サブスクリプション型の設定</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param subs_type サブスクリプション型</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setSubscriptionType</span><span class="misc">(</span><span class="identifier">subs_type</span><span class="misc">)</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._subscriptionType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">subs_type</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="81" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="True" visited="True">	<span class="identifier">OutPortProvider.OutPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="84" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">OutPortProvider.OutPortProviderFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="85" valid="False" visited="False"/>  <Line no="86" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">OutPortProvider.OutPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="88" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortProvider</span></Line>  <FileSummary valid="51" visited="48" totalLines="91" coverage="94"/> </File> <File name="lua\openrtm\OutPortPullConnector.lua" anchor="lua_openrtm_OutPortPullConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortPullConnector.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief Pull型通信OutPortConnector定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortPullConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortPullConnector"] = OutPortPullConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConnector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortConnector"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CdrBufferBase"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferBase.CdrBufferFactory</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProvider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortProvider"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortProvider.OutPortProviderFactory</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="False" visited="False"/>  <Line no="24" valid="False" visited="False">	<span class="comment">-- Pull型通信OutPortConnectorの初期化</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="26" valid="False" visited="False">	<span class="comment">-- 「buffer」という要素名にバッファの設定を格納</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @param provider プロバイダ</span></Line>  <Line no="28" valid="False" visited="False">	<span class="comment">-- @param listeners コールバック</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- 指定しない場合はリングバッファを生成する</span></Line>  <Line no="31" valid="False" visited="False">	<span class="comment">-- @return Pull型通信OutPortConnector</span></Line>  <Line no="32" valid="False" visited="False">	<span class="identifier">OutPortPullConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OutPortConnector.new</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._dataを書き込み</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード(バッファの書き込み結果による)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="41" valid="False" visited="False"/>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">cdrMarshal</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">,</span>&nbsp;<span class="identifier">data._type</span><span class="misc">)</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(cdr_data)</span></Line>  <Line no="44" valid="False" visited="False"/>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">cdr_data</span><span class="misc">)</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect()"</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._provider</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">OutPortProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._provider</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._provider</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._buffer</span><span class="misc">)</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ取得</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getBuffer</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ作成</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リングバッファを生成する</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile コネクタプロファイル</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">buf_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"buffer_type"</span><span class="misc">,</span><span class="string">"ring_buffer"</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">buf_type</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ接続時のコールバック呼び出し</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_CONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断時のコールバック呼び出し</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_DISCONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="109" valid="False" visited="False"/>  <Line no="110" valid="False" visited="False"/>  <Line no="111" valid="False" visited="False"/>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">provider</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">buffer</span></Line>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="False" visited="False"/>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._inPortListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="125" valid="False" visited="False"/>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._provider</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="131" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Exeption: in OutPortPullConnector.__init__()."</span><span class="misc">)</span></Line>  <Line no="132" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"buffer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">obj._buffer</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">setConnector</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._provider</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._listeners</span><span class="misc">)</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="142" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortPullConnector</span></Line>  <FileSummary valid="69" visited="65" totalLines="145" coverage="94"/> </File> <File name="lua\openrtm\OutPortPushConnector.lua" anchor="lua_openrtm_OutPortPushConnector_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file OutPortPushConnector.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief Push型通信OutPortConnector定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortPushConnector</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.OutPortPushConnector"] = OutPortPushConnector</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False">	<span class="comment">--local oil = require "oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortConnector</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortConnector"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProvider</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OutPortProvider"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OutPortProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">OutPortProvider.OutPortProviderFactory</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CdrBufferBase"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CdrBufferFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferBase.CdrBufferFactory</span></Line>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConsumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.InPortConsumer"</span></Line>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">InPortConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortConsumer.InPortConsumerFactory</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.PublisherBase"</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PublisherBase.PublisherFactory</span></Line>  <Line no="25" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="28" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorListenerType</span></Line>  <Line no="29" valid="False" visited="False"/>  <Line no="30" valid="False" visited="False"/>  <Line no="31" valid="False" visited="False">	<span class="comment">-- Push型通信OutPortConnectorの初期化</span></Line>  <Line no="32" valid="False" visited="False">	<span class="comment">-- @param info プロファイル</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- 「buffer」という要素名にバッファの設定を格納</span></Line>  <Line no="34" valid="False" visited="False">	<span class="comment">-- @param consumer コンシューマ</span></Line>  <Line no="35" valid="False" visited="False">	<span class="comment">-- @param listeners コールバック</span></Line>  <Line no="36" valid="False" visited="False">	<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="37" valid="False" visited="False">	<span class="comment">-- 指定しない場合はリングバッファを生成する</span></Line>  <Line no="38" valid="False" visited="False">	<span class="comment">-- @return Push型通信OutPortConnector</span></Line>  <Line no="39" valid="False" visited="False">	<span class="identifier">OutPortPushConnector.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(consumer, listeners, buffer)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OutPortConnector.new</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data data._dataを書き込み</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード(パブリッシャのデータ書き込み結果による)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"write()"</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False"/>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cdr_data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">cdrMarshal</span><span class="misc">(</span><span class="identifier">data._data</span><span class="misc">,</span>&nbsp;<span class="identifier">data._type</span><span class="misc">)</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#cdr_data)</span></Line>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._publisher</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">cdr_data</span><span class="misc">,</span>&nbsp;<span class="number">0</span><span class="misc">,</span>&nbsp;<span class="number">0</span><span class="misc">)</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect()"</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._publisher</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"delete publisher"</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pfactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PublisherFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pfactory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._publisher</span><span class="misc">)</span></Line>  <Line no="68" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._publisher</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"delete consumer"</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cfactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">InPortConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cfactory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._consumer</span><span class="misc">)</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"delete buffer"</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">bfactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">bfactory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._buffer</span><span class="misc">)</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect() done"</span><span class="misc">)</span></Line>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._publisher</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._publisher</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ取得</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getBuffer</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- パブリッシャー生成</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile コネクタプロファイル</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return パブリッシャー</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createPublisher</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pub_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"subscription_type"</span><span class="misc">,</span><span class="string">"flush"</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pub_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.normalize</span><span class="misc">(</span><span class="identifier">pub_type</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">PublisherFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">pub_type</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ作成</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param profile コネクタプロファイル</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファ</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">buf_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"buffer_type"</span><span class="misc">,</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ring_buffer"</span><span class="misc">)</span></Line>  <Line no="122" valid="False" visited="False"/>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CdrBufferFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">buf_type</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ接続時のコールバック呼び出し</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_CONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ切断時のコールバック呼び出し</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDisconnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connector_</span><span class="misc">[</span><span class="identifier">ConnectorListenerType.ON_DISCONNECT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">)</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- InPortサーバントオブジェクト設定</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param directInPort InPortサーバントオブジェクト</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInPort</span><span class="misc">(</span><span class="identifier">directInPort</span><span class="misc">)</span></Line>  <Line no="143" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">buffer</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="149" valid="False" visited="False"/>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._directInPort</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._inPortListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._publisher</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createPublisher</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createBuffer</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">)</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False"/>  <Line no="158" valid="False" visited="False"/>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._publisher</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">obj._consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="False" visited="False"/>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">obj._publisher</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="False" visited="False"/>  <Line no="168" valid="False" visited="False"/>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"buffer"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">info.properties</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._publisher</span><span class="misc">:</span><span class="identifier">setConsumer</span><span class="misc">(</span><span class="identifier">obj._consumer</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._publisher</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">obj._buffer</span><span class="misc">)</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._publisher</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">obj._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._listeners</span><span class="misc">)</span></Line>  <Line no="174" valid="False" visited="False"/>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onConnect</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="176" valid="False" visited="False"/>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="178" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="179" valid="False" visited="False"/>  <Line no="180" valid="False" visited="False"/>  <Line no="181" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">OutPortPushConnector</span></Line>  <FileSummary valid="95" visited="90" totalLines="181" coverage="94"/> </File> <File name="lua\openrtm\PeriodicExecutionContext.lua" anchor="lua_openrtm_PeriodicExecutionContext_lua">  <PerfectCoverage/>   <FileSummary valid="82" visited="82" totalLines="149" coverage="100"/> </File> <File name="lua\openrtm\PortAdmin.lua" anchor="lua_openrtm_PortAdmin_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PortAdmin.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ポート管理クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortAdmin</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.PortAdmin"] = PortAdmin</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ObjectManager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ObjectManager"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False">	<span class="comment">-- ポートの名前が一致しているか判定する関数オブジェクト初期化</span></Line>  <Line no="20" valid="False" visited="False">	<span class="comment">-- @param argv argv.name：型名、argv.factory：ファクトリ</span></Line>  <Line no="21" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="22" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">comp_op</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">argv</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">argv.name</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.name</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">argv.factory</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">argv.factory</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートの名前が一致しているか判定する</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param obj RTC</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致 </span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="39" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="False" visited="False"/>  <Line no="42" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">find_port_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="43" valid="False" visited="False">	<span class="comment">-- ポート名が一致しているか判定する関数オブジェクト初期化</span></Line>  <Line no="44" valid="False" visited="False">	<span class="comment">-- @param name ポート名</span></Line>  <Line no="45" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="46" valid="False" visited="False">	<span class="identifier">find_port_name.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--ポート名が一致しているか判定する</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param p ポート</span></Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">)</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prof.name</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._name, name_)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">name_</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="61" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="62" valid="False" visited="False"/>  <Line no="63" valid="False" visited="False">	<span class="comment">-- ポート管理オブジェクト初期化</span></Line>  <Line no="64" valid="False" visited="False">	<span class="comment">-- @param orb ORB</span></Line>  <Line no="65" valid="False" visited="False">	<span class="comment">-- @return ポート管理オブジェクト</span></Line>  <Line no="66" valid="False" visited="False">	<span class="identifier">PortAdmin.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orb</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orb</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portRefs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portServants</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ObjectManager.new</span><span class="misc">(</span><span class="identifier">comp_op</span><span class="misc">)</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"PortAdmin"</span><span class="misc">)</span></Line>  <Line no="73" valid="False" visited="False"/>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートのインターフェースのアクティブ化</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activatePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("activatePorts1")</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portServants</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">activateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("activatePorts2")</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートのインターフェースの非アクティブ化</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivatePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portServants</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">deactivateInterfaces</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートのプロファイル一覧取得</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル一覧</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPortProfileList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._portRefs</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">get_port_profile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート追加</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port ポート</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addPort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._portRefs</span><span class="misc">,</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_port_name.new</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(port:getPortRef())</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._portRefs</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">getPortRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._portServants</span><span class="misc">:</span><span class="identifier">registerObject</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False"/>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート削除</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port ポート</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">disconnect_all</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._portRefs)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.erase_if</span><span class="misc">(</span><span class="identifier">self._portRefs</span><span class="misc">,</span>&nbsp;<span class="identifier">find_port_name.new</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._portRefs)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False"/>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">setPortRef</span><span class="misc">(</span><span class="identifier">oil.corba.idl.null</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False"/>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._portServants</span><span class="misc">:</span><span class="identifier">unregisterObject</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="140" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートのオブジェクトリファレンス一覧取得</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ポートのオブジェクトリファレンス一覧</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPortServiceList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._portRefs</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="False" visited="False"/>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全ポート削除</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">finalizePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deactivatePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portServants</span><span class="misc">:</span><span class="identifier">getObjects</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="False" visited="False"/>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="162" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="163" valid="False" visited="False"/>  <Line no="164" valid="False" visited="False"/>  <Line no="165" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PortAdmin</span></Line>  <FileSummary valid="85" visited="83" totalLines="165" coverage="97"/> </File> <File name="lua\openrtm\PortBase.lua" anchor="lua_openrtm_PortBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PortBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ポート基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortBase=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.PortBase"]&nbsp;=&nbsp;PortBase</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="True" visited="True">	<span class="blockcomment">local&nbsp;oil&nbsp;=&nbsp;require&nbsp;"oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="blockcomment">local&nbsp;CORBA_SeqUtil&nbsp;=&nbsp;require&nbsp;"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Properties&nbsp;=&nbsp;require&nbsp;"openrtm.Properties"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="blockcomment">local&nbsp;NVUtil&nbsp;=&nbsp;require&nbsp;"openrtm.NVUtil"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="blockcomment">local&nbsp;StringUtil&nbsp;=&nbsp;require&nbsp;"openrtm.StringUtil"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortConnectListener&nbsp;=&nbsp;require&nbsp;"openrtm.PortConnectListener"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortConnectListenerType&nbsp;=&nbsp;PortConnectListener.PortConnectListenerType</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">local&nbsp;PortConnectRetListenerType&nbsp;=&nbsp;PortConnectListener.PortConnectRetListenerType</span></Line>  <Line no="21" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">local&nbsp;uuid&nbsp;=&nbsp;require&nbsp;"uuid"</span></Line>  <Line no="23" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">local&nbsp;RTCUtil&nbsp;=&nbsp;require&nbsp;"openrtm.RTCUtil"</span></Line>  <Line no="25" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="26" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="27" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">local&nbsp;find_conn_id&nbsp;=&nbsp;{}</span></Line>  <Line no="29" valid="False" visited="False">	<span class="blockcomment">--&nbsp;コネクタIDが一致しているか判定する関数オブジェクト初期化</span></Line>  <Line no="30" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;id_&nbsp;コネクタID</span></Line>  <Line no="31" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;関数オブジェクト</span></Line>  <Line no="32" valid="False" visited="False">	<span class="blockcomment">find_conn_id.new&nbsp;=&nbsp;function(id_)</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="34" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._id&nbsp;=&nbsp;id_</span></Line>  <Line no="35" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタIDが一致しているか判定する</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="37" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;cprof&nbsp;コネクタプロファイル</span></Line>  <Line no="38" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="39" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;cprof)</span></Line>  <Line no="40" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;(self._id&nbsp;==&nbsp;cprof.connector_id)</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="42" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="43" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="44" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="45" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="47" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">local&nbsp;find_port_ref&nbsp;=&nbsp;{}</span></Line>  <Line no="49" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ポートのオブジェクトリファレンスが一致するかを判定する関数オブジェクト</span></Line>  <Line no="50" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;port_ref&nbsp;ポート</span></Line>  <Line no="51" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;関数オブジェクト</span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment">find_port_ref.new&nbsp;=&nbsp;function(port_ref)</span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._port_ref&nbsp;=&nbsp;port_ref</span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ポートのオブジェクトリファレンスが一致するかを判定する</span></Line>  <Line no="56" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="57" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;port_ref&nbsp;ポート</span></Line>  <Line no="58" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="59" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;port_ref)</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self._port_ref,&nbsp;port_ref,&nbsp;self._port_ref._is_equivalent,&nbsp;port_ref._is_equivalent)</span></Line>  <Line no="61" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;NVUtil._is_equivalent(self._port_ref,&nbsp;port_ref,&nbsp;self._port_ref.getPortRef,&nbsp;port_ref.getPortRef)</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[local&nbsp;ret&nbsp;=&nbsp;false</span></Line>  <Line no="63" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="64" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="65" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;(self._port_ref:get_port_profile().name&nbsp;==&nbsp;port_ref:get_port_profile().name)</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ret]]</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--return&nbsp;self._port_ref:_is_equivalent(port_ref)</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="70" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="71" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="72" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="73" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="74" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">local&nbsp;find_interface&nbsp;=&nbsp;{}</span></Line>  <Line no="76" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="77" valid="False" visited="False">	<span class="blockcomment">--&nbsp;インターフェースが一致しているか判定する関数オブジェクト</span></Line>  <Line no="78" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;name&nbsp;インターフェース名</span></Line>  <Line no="79" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;pol&nbsp;インターフェースの方向(PROVIDED、REQUIRED)</span></Line>  <Line no="80" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;関数オブジェクト</span></Line>  <Line no="81" valid="False" visited="False">	<span class="blockcomment">find_interface.new&nbsp;=&nbsp;function(name,&nbsp;pol)</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._name&nbsp;=&nbsp;name</span></Line>  <Line no="84" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._pol&nbsp;=&nbsp;pol</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;インターフェースが一致しているか判定する</span></Line>  <Line no="86" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;self&nbsp;自身のオブジェクト</span></Line>  <Line no="87" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;prof&nbsp;インターフェースのプロファイル</span></Line>  <Line no="88" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：一致、false：不一致</span></Line>  <Line no="89" valid="False" visited="False">	<span class="blockcomment">&nbsp;local&nbsp;call_func&nbsp;=&nbsp;function(self,&nbsp;prof)</span></Line>  <Line no="90" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;name&nbsp;=&nbsp;prof.instance_name</span></Line>  <Line no="91" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;((self._name&nbsp;==&nbsp;name)&nbsp;and&nbsp;(self._pol&nbsp;==&nbsp;prof.polarity))</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;setmetatable(obj,&nbsp;{__call=call_func})</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;obj</span></Line>  <Line no="95" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="96" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="98" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="99" valid="False" visited="False">	<span class="blockcomment">--&nbsp;ポート基底オブジェクト初期化</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;name&nbsp;ポート名</span></Line>  <Line no="101" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;ポート</span></Line>  <Line no="102" valid="False" visited="False">	<span class="blockcomment">PortBase.new&nbsp;=&nbsp;function(name)</span></Line>  <Line no="103" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="104" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="105" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="106" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ReturnCode_t&nbsp;=&nbsp;Manager:instance():getORB().types:lookup("::RTC::ReturnCode_t").labelvalue</span></Line>  <Line no="107" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="108" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._ownerInstanceName&nbsp;=&nbsp;"unknown"</span></Line>  <Line no="109" valid="False" visited="False">	<span class="blockcomment">&nbsp;--print("test3:",obj,&nbsp;obj._objref)</span></Line>  <Line no="110" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="111" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="112" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._profile&nbsp;=&nbsp;{name="",&nbsp;interfaces={},&nbsp;port_ref=oil.corba.idl.null,&nbsp;connector_profiles={},&nbsp;owner=oil.corba.idl.null,&nbsp;properties={}}</span></Line>  <Line no="113" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="114" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="115" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;name&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="116" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;obj._profile.name&nbsp;=&nbsp;"unknown.unknown"</span></Line>  <Line no="117" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="118" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;obj._profile.name&nbsp;=&nbsp;obj._ownerInstanceName.."."..name</span></Line>  <Line no="119" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="120" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="121" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="122" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._profile.owner&nbsp;=&nbsp;oil.corba.idl.null</span></Line>  <Line no="123" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="124" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="125" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._rtcout&nbsp;=&nbsp;Manager:instance():getLogbuf(name)</span></Line>  <Line no="126" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onPublishInterfaces&nbsp;=&nbsp;nil</span></Line>  <Line no="127" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onSubscribeInterfaces&nbsp;=&nbsp;nil</span></Line>  <Line no="128" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onConnected&nbsp;=&nbsp;nil</span></Line>  <Line no="129" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onUnsubscribeInterfaces&nbsp;=&nbsp;nil</span></Line>  <Line no="130" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onDisconnected&nbsp;=&nbsp;nil</span></Line>  <Line no="131" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._onConnectionLost&nbsp;=&nbsp;nil</span></Line>  <Line no="132" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._connectionLimit&nbsp;&nbsp;&nbsp;=&nbsp;-1</span></Line>  <Line no="133" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;obj._portconnListeners&nbsp;=&nbsp;nil</span></Line>  <Line no="134" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._properties&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="135" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._svr&nbsp;=&nbsp;nil</span></Line>  <Line no="136" valid="True" visited="True">	<span class="blockcomment">&nbsp;obj._connectors&nbsp;=&nbsp;{}</span></Line>  <Line no="137" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="138" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ポートプロファイル取得</span></Line>  <Line no="139" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロファイル</span></Line>  <Line no="140" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:get_port_profile()</span></Line>  <Line no="141" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("get_port_profile()")</span></Line>  <Line no="142" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="143" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:updateConnectors()</span></Line>  <Line no="144" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;connectors&nbsp;=&nbsp;{}</span></Line>  <Line no="145" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,con&nbsp;in&nbsp;ipairs(self._profile.connector_profiles)&nbsp;do</span></Line>  <Line no="146" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;conn_prof&nbsp;=&nbsp;{name=con.name,</span></Line>  <Line no="147" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector_id=con.connector_id,</span></Line>  <Line no="148" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports=con.ports,</span></Line>  <Line no="149" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;properties={}}</span></Line>  <Line no="150" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;j,conf&nbsp;in&nbsp;ipairs(con.properties)&nbsp;do</span></Line>  <Line no="151" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;con.properties[j]&nbsp;=&nbsp;{name=conf.name,&nbsp;value=NVUtil.any_from_any(conf.value)}</span></Line>  <Line no="152" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="153" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.insert(connectors,&nbsp;conn_prof)</span></Line>  <Line no="154" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="155" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="156" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="157" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prof&nbsp;=&nbsp;{name=self._profile.name,</span></Line>  <Line no="158" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;interfaces=self._profile.interfaces,</span></Line>  <Line no="159" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;port_ref=self._profile.port_ref,</span></Line>  <Line no="160" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--port_ref="test",</span></Line>  <Line no="161" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;connector_profiles=connectors,</span></Line>  <Line no="162" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;owner=self._profile.owner,</span></Line>  <Line no="163" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;properties=self._profile.properties}</span></Line>  <Line no="164" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;prof</span></Line>  <Line no="165" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="166" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="167" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ポートプロファイル取得</span></Line>  <Line no="168" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロファイル</span></Line>  <Line no="169" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getPortProfile()</span></Line>  <Line no="170" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("getPortProfile()")</span></Line>  <Line no="171" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._profile</span></Line>  <Line no="172" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="173" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="174" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイル一覧取得</span></Line>  <Line no="175" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロファイル一覧</span></Line>  <Line no="176" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:get_connector_profiles()</span></Line>  <Line no="177" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("get_connector_profiles()")</span></Line>  <Line no="178" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="179" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:updateConnectors()</span></Line>  <Line no="180" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="181" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._profile.connector_profiles</span></Line>  <Line no="182" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="183" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="184" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタプロファイル取得</span></Line>  <Line no="185" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_id&nbsp;コネクタID</span></Line>  <Line no="186" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロファイル</span></Line>  <Line no="187" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:get_connector_profile(connector_id)</span></Line>  <Line no="188" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("get_connector_profile("..connector_id..")")</span></Line>  <Line no="189" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="190" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self:updateConnectors()</span></Line>  <Line no="191" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="192" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;index&nbsp;=&nbsp;CORBA_SeqUtil.find(self._profile.connector_profiles,</span></Line>  <Line no="193" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_conn_id.new(connector_id))</span></Line>  <Line no="194" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;index&nbsp;&lt;&nbsp;0&nbsp;then</span></Line>  <Line no="195" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;conn_prof&nbsp;=&nbsp;{name="",&nbsp;connector_id="",&nbsp;ports={},&nbsp;properties={}}</span></Line>  <Line no="196" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;conn_prof</span></Line>  <Line no="197" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="198" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="199" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;conn_prof&nbsp;=&nbsp;{name=self._profile.connector_profiles[index].name,</span></Line>  <Line no="200" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector_id=self._profile.connector_profiles[index].connector_id,</span></Line>  <Line no="201" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports=self._profile.connector_profiles[index].ports,</span></Line>  <Line no="202" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;properties=self._profile.connector_profiles[index].properties}</span></Line>  <Line no="203" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;conn_prof</span></Line>  <Line no="204" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="205" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="206" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ接続</span></Line>  <Line no="207" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_profile&nbsp;コネクタプロファイル</span></Line>  <Line no="208" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード、コネクタプロファイル</span></Line>  <Line no="209" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:connect(connector_profile)</span></Line>  <Line no="210" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("connect()")</span></Line>  <Line no="211" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self:isEmptyId(connector_profile)&nbsp;then</span></Line>  <Line no="212" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:setUUID(connector_profile)</span></Line>  <Line no="213" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="214" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(self:isExistingConnId(connector_profile.connector_id))</span></Line>  <Line no="215" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;self:isExistingConnId(connector_profile.connector_id)&nbsp;then</span></Line>  <Line no="216" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Connection&nbsp;already&nbsp;exists.")</span></Line>  <Line no="217" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.PRECONDITION_NOT_MET,&nbsp;connector_profile</span></Line>  <Line no="218" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="219" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="220" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="221" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="222" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;retval&nbsp;=&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="223" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="224" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="225" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(#connector_profile.ports)</span></Line>  <Line no="226" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;retval,connector_profile&nbsp;=&nbsp;connector_profile.ports[1]:notify_connect(connector_profile)</span></Line>  <Line no="227" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(retval)</span></Line>  <Line no="228" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;retval&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="229" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Connection&nbsp;failed.&nbsp;cleanup.")</span></Line>  <Line no="230" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self:disconnect(connector_profile.connector_id)</span></Line>  <Line no="231" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="232" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="233" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;success&nbsp;then</span></Line>  <Line no="234" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(exception)</span></Line>  <Line no="235" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR(exception)</span></Line>  <Line no="236" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER,&nbsp;connector_profile</span></Line>  <Line no="237" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="238" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(retval)</span></Line>  <Line no="239" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--local&nbsp;conn_prof&nbsp;=&nbsp;{name="",</span></Line>  <Line no="240" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector_id="",</span></Line>  <Line no="241" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports={},</span></Line>  <Line no="242" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;properties={}}</span></Line>  <Line no="243" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;retval,&nbsp;connector_profile</span></Line>  <Line no="244" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="245" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="246" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ切断</span></Line>  <Line no="247" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_id&nbsp;コネクタID</span></Line>  <Line no="248" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="249" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:disconnect(connector_id)</span></Line>  <Line no="250" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("disconnect("..connector_id..")")</span></Line>  <Line no="251" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="252" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;index&nbsp;=&nbsp;self:findConnProfileIndex(connector_id)</span></Line>  <Line no="253" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="254" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;index&nbsp;&lt;&nbsp;0&nbsp;then</span></Line>  <Line no="255" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Invalid&nbsp;connector&nbsp;id:&nbsp;"..connector_id)</span></Line>  <Line no="256" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="257" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="258" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="259" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prof&nbsp;=&nbsp;self._profile.connector_profiles[index]</span></Line>  <Line no="260" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="261" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="262" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="263" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;#prof.ports&nbsp;&lt;&nbsp;1&nbsp;then</span></Line>  <Line no="264" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_FATAL("ConnectorProfile&nbsp;has&nbsp;empty&nbsp;port&nbsp;list.")</span></Line>  <Line no="265" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="266" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="267" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="268" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;success,&nbsp;exception&nbsp;=&nbsp;oil.pcall(</span></Line>  <Line no="269" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;function()</span></Line>  <Line no="270" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;prof.ports[1]:notify_disconnect(connector_id)</span></Line>  <Line no="271" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end)</span></Line>  <Line no="272" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;success&nbsp;then</span></Line>  <Line no="273" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_WARN(exception)</span></Line>  <Line no="274" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="275" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="276" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="277" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;ret&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="278" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("notify_disconnect()&nbsp;for&nbsp;all&nbsp;ports&nbsp;failed.")</span></Line>  <Line no="279" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="280" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="281" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="282" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="283" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="284" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="285" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ切断実行関数</span></Line>  <Line no="286" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_id&nbsp;コネクタID</span></Line>  <Line no="287" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="288" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:notify_disconnect(connector_id)</span></Line>  <Line no="289" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("notify_disconnect("..connector_id..")")</span></Line>  <Line no="290" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="291" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;index&nbsp;=&nbsp;self:findConnProfileIndex(connector_id)</span></Line>  <Line no="292" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="293" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;index&nbsp;&lt;&nbsp;0&nbsp;then</span></Line>  <Line no="294" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("Invalid&nbsp;connector&nbsp;id:&nbsp;"..connector_id)</span></Line>  <Line no="295" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._rtcout.BAD_PARAMETER</span></Line>  <Line no="296" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="297" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="298" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prof&nbsp;=&nbsp;{name&nbsp;=&nbsp;self._profile.connector_profiles[index].name,</span></Line>  <Line no="299" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;connector_id&nbsp;=&nbsp;self._profile.connector_profiles[index].connector_id,</span></Line>  <Line no="300" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;ports&nbsp;=&nbsp;self._profile.connector_profiles[index].ports,</span></Line>  <Line no="301" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;properties&nbsp;=&nbsp;self._profile.connector_profiles[index].properties}</span></Line>  <Line no="302" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="303" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onNotifyDisconnect(self:getName(),&nbsp;prof)</span></Line>  <Line no="304" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="305" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;retval&nbsp;=&nbsp;self:disconnectNext(prof)</span></Line>  <Line no="306" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onDisconnectNextport(self:getName(),&nbsp;prof,&nbsp;retval)</span></Line>  <Line no="307" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="308" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._onUnsubscribeInterfaces&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="309" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._onUnsubscribeInterfaces(prof)</span></Line>  <Line no="310" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="311" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onUnsubscribeInterfaces(self:getName(),&nbsp;prof)</span></Line>  <Line no="312" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:unsubscribeInterfaces(prof)</span></Line>  <Line no="313" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="314" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._onDisconnected&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="315" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._onDisconnected(prof)</span></Line>  <Line no="316" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="317" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="318" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;table.remove(self._profile.connector_profiles,&nbsp;index)</span></Line>  <Line no="319" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="320" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onDisconnected(self:getName(),&nbsp;prof,&nbsp;retval)</span></Line>  <Line no="321" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;retval</span></Line>  <Line no="322" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="323" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="324" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ接続実行関数</span></Line>  <Line no="325" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_profile&nbsp;コネクタプロファイル</span></Line>  <Line no="326" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード、コネクタプロファイル</span></Line>  <Line no="327" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:notify_connect(connector_profile)</span></Line>  <Line no="328" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="329" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("notify_connect()")</span></Line>  <Line no="330" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="331" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="332" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="333" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;prop&nbsp;=&nbsp;Properties.new()</span></Line>  <Line no="334" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;NVUtil.copyToProperties(prop,&nbsp;connector_profile.properties)</span></Line>  <Line no="335" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="336" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="337" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;default_value&nbsp;=&nbsp;StringUtil.toBool(self._properties:getProperty("allow_dup_connection"),&nbsp;"YES","NO",false)</span></Line>  <Line no="338" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="339" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;StringUtil.toBool(prop:getProperty("dataport.allow_dup_connection"),&nbsp;"YES","NO",default_value)&nbsp;then</span></Line>  <Line no="340" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="341" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="342" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="343" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;retval&nbsp;=&nbsp;{}</span></Line>  <Line no="344" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="345" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onNotifyConnect(self:getName(),connector_profile)</span></Line>  <Line no="346" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="347" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="348" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;retval[1]&nbsp;=&nbsp;self:publishInterfaces(connector_profile)</span></Line>  <Line no="349" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--for&nbsp;i,&nbsp;v&nbsp;in&nbsp;ipairs(connector_profile.properties)&nbsp;do</span></Line>  <Line no="350" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--&nbsp;print(v.name,&nbsp;v.value)</span></Line>  <Line no="351" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--end</span></Line>  <Line no="352" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="353" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;retval[1]&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="354" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("publishInterfaces()&nbsp;in&nbsp;notify_connect()&nbsp;failed.")</span></Line>  <Line no="355" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="356" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="357" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onPublishInterfaces(self:getName(),&nbsp;connector_profile,&nbsp;retval[1])</span></Line>  <Line no="358" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._onPublishInterfaces&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="359" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._onPublishInterfaces(connector_profile)</span></Line>  <Line no="360" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="361" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="362" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="363" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;retval[2],&nbsp;connector_profile&nbsp;=&nbsp;self:connectNext(connector_profile)</span></Line>  <Line no="364" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;retval[2]&nbsp;=&nbsp;NVUtil.getReturnCode(retval[2])</span></Line>  <Line no="365" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print("test2",&nbsp;retval[2])</span></Line>  <Line no="366" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;retval[2]&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="367" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("connectNext()&nbsp;in&nbsp;notify_connect()&nbsp;failed.")</span></Line>  <Line no="368" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="369" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="370" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="371" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onConnectNextport(self:getName(),&nbsp;connector_profile,&nbsp;retval[2])</span></Line>  <Line no="372" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="373" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._onSubscribeInterfaces&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="374" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._onSubscribeInterfaces(connector_profile)</span></Line>  <Line no="375" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="376" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="377" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;retval[3]&nbsp;=&nbsp;self:subscribeInterfaces(connector_profile)</span></Line>  <Line no="378" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;retval[3]&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="379" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_ERROR("subscribeInterfaces()&nbsp;in&nbsp;notify_connect()&nbsp;failed.")</span></Line>  <Line no="380" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="381" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="382" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="383" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onSubscribeInterfaces(self:getName(),&nbsp;connector_profile,&nbsp;retval[3])</span></Line>  <Line no="384" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="385" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_PARANOID(#self._profile.connector_profiles.."&nbsp;connectors&nbsp;are&nbsp;existing")</span></Line>  <Line no="386" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="387" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="388" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;index&nbsp;=&nbsp;self:findConnProfileIndex(connector_profile.connector_id)</span></Line>  <Line no="389" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="390" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(index)</span></Line>  <Line no="391" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;index&nbsp;&lt;&nbsp;0&nbsp;then</span></Line>  <Line no="392" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;table.insert(self._profile.connector_profiles,&nbsp;connector_profile)</span></Line>  <Line no="393" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(#self._profile.connector_profiles)</span></Line>  <Line no="394" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("New&nbsp;connector_id.&nbsp;Push&nbsp;backed.")</span></Line>  <Line no="395" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="396" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="397" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._profile.connector_profiles[index]&nbsp;=&nbsp;connector_profile</span></Line>  <Line no="398" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("Existing&nbsp;connector_id.&nbsp;Updated.")</span></Line>  <Line no="399" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="400" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="401" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="402" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="403" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,&nbsp;ret&nbsp;in&nbsp;ipairs(retval)&nbsp;do</span></Line>  <Line no="404" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(i,ret)</span></Line>  <Line no="405" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;ret&nbsp;~=&nbsp;self._ReturnCode_t.RTC_OK&nbsp;then</span></Line>  <Line no="406" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:onConnected(self:getName(),&nbsp;connector_profile,&nbsp;ret)</span></Line>  <Line no="407" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ret,&nbsp;connector_profile</span></Line>  <Line no="408" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="409" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="410" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="411" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="412" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="413" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._onConnected&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="414" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._onConnected(connector_profile)</span></Line>  <Line no="415" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="416" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self:onConnected(self:getName(),&nbsp;connector_profile,&nbsp;self._ReturnCode_t.RTC_OK)</span></Line>  <Line no="417" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="418" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;conn_prof&nbsp;=&nbsp;{name=connector_profile.name,</span></Line>  <Line no="419" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connector_id=connector_profile.connector_id,</span></Line>  <Line no="420" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ports=connector_profile.ports,</span></Line>  <Line no="421" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;properties={}}</span></Line>  <Line no="422" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="423" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,v&nbsp;in&nbsp;ipairs(connector_profile.properties)&nbsp;do</span></Line>  <Line no="424" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;conn_prof.properties[i]&nbsp;=&nbsp;{name=v.name,&nbsp;value=NVUtil.any_from_any(v.value)}</span></Line>  <Line no="425" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(v.name,&nbsp;v.value)</span></Line>  <Line no="426" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(conn_prof.properties[i].name,&nbsp;conn_prof.properties[i].value)</span></Line>  <Line no="427" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="428" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="429" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="430" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK,&nbsp;conn_prof</span></Line>  <Line no="431" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="432" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="433" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ一覧更新</span></Line>  <Line no="434" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:updateConnectors()</span></Line>  <Line no="435" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="436" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;connector_ids&nbsp;=&nbsp;{}</span></Line>  <Line no="437" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;clist&nbsp;=&nbsp;self._profile.connector_profiles</span></Line>  <Line no="438" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="439" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,&nbsp;cprof&nbsp;in&nbsp;ipairs(clist)&nbsp;do</span></Line>  <Line no="440" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;self:checkPorts(cprof.ports)&nbsp;then</span></Line>  <Line no="441" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;table.insert(connector_ids,&nbsp;cprof.connector_id)</span></Line>  <Line no="442" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_WARN("Dead&nbsp;connection:&nbsp;"..cprof.connector_id)</span></Line>  <Line no="443" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="444" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="445" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="446" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,&nbsp;cid&nbsp;in&nbsp;ipairs(connector_ids)&nbsp;do</span></Line>  <Line no="447" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:disconnect(cid)</span></Line>  <Line no="448" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="449" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="450" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="451" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="452" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ一覧取得</span></Line>  <Line no="453" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;コネクタ一覧</span></Line>  <Line no="454" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:connectors()</span></Line>  <Line no="455" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("connectors():&nbsp;size&nbsp;=&nbsp;"..#self._connectors)</span></Line>  <Line no="456" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._connectors</span></Line>  <Line no="457" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="458" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="459" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ポートが生存しているかを確認</span></Line>  <Line no="460" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ports&nbsp;ポート</span></Line>  <Line no="461" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：生存、false：消滅済み</span></Line>  <Line no="462" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:checkPorts(ports)</span></Line>  <Line no="463" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ret&nbsp;=&nbsp;true</span></Line>  <Line no="464" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;i,&nbsp;port&nbsp;in&nbsp;ipairs(ports)&nbsp;do</span></Line>  <Line no="465" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(NVUtil._non_existent(port))</span></Line>  <Line no="466" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;NVUtil._non_existent(port)&nbsp;then</span></Line>  <Line no="467" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_WARN("Dead&nbsp;Port&nbsp;reference&nbsp;detected.")</span></Line>  <Line no="468" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;false</span></Line>  <Line no="469" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="470" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="471" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="472" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;ret</span></Line>  <Line no="473" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="474" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="475" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;IDが空かを判定</span></Line>  <Line no="476" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;コネクタプロファイル</span></Line>  <Line no="477" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：空</span></Line>  <Line no="478" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:isEmptyId(connector_profile)</span></Line>  <Line no="479" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;(connector_profile.connector_id&nbsp;==&nbsp;"")</span></Line>  <Line no="480" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="481" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="482" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタIDがすでに登録済みかを確認</span></Line>  <Line no="483" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;id_&nbsp;コネクタID</span></Line>  <Line no="484" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;true：登録済み、false：未登録</span></Line>  <Line no="485" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;function&nbsp;obj:isExistingConnId(id_)</span></Line>  <Line no="486" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;(CORBA_SeqUtil.find(self._profile.connector_profiles,</span></Line>  <Line no="487" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_conn_id.new(id_))&nbsp;&gt;=&nbsp;0)</span></Line>  <Line no="488" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="489" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="490" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ接続実行時のコールバック実行</span></Line>  <Line no="491" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="492" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="493" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onNotifyConnect(portname,&nbsp;profile)</span></Line>  <Line no="494" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="495" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectListenerType.ON_NOTIFY_CONNECT</span></Line>  <Line no="496" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnect_[_type]:notify(portname,&nbsp;profile)</span></Line>  <Line no="497" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="498" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="499" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;コネクタ切断実行時のコールバック実行</span></Line>  <Line no="500" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="501" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="502" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onNotifyDisconnect(portname,&nbsp;profile)</span></Line>  <Line no="503" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="504" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectListenerType.ON_NOTIFY_DISCONNECT</span></Line>  <Line no="505" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnect_[_type]:notify(portname,&nbsp;profile)</span></Line>  <Line no="506" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="507" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="508" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;インターフェス解放時のコールバック実行</span></Line>  <Line no="509" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="510" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="511" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onUnsubscribeInterfaces(portname,&nbsp;profile)</span></Line>  <Line no="512" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="513" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectListenerType.ON_UNSUBSCRIBE_INTERFACES</span></Line>  <Line no="514" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnect_[_type]:notify(portname,&nbsp;profile)</span></Line>  <Line no="515" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="516" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="517" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;インターフェス登録時のコールバック実行</span></Line>  <Line no="518" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="519" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="520" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="521" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onPublishInterfaces(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="522" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="523" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_PUBLISH_INTERFACES</span></Line>  <Line no="524" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="525" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="526" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="527" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;次のポート接続時のコールバック実行</span></Line>  <Line no="528" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="529" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="530" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="531" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onConnectNextport(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="532" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="533" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_CONNECT_NEXTPORT</span></Line>  <Line no="534" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="535" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="536" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="537" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;インターフェ－ス取得時のコールバック実行</span></Line>  <Line no="538" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="539" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="540" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="541" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onSubscribeInterfaces(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="542" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="543" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_SUBSCRIBE_INTERFACES</span></Line>  <Line no="544" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="545" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="546" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="547" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;コネクタ接続後のコールバック実行</span></Line>  <Line no="548" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="549" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="550" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="551" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onConnected(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="552" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="553" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_CONNECTED</span></Line>  <Line no="554" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="555" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="556" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="557" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;次のポート切断時のコールバック実行</span></Line>  <Line no="558" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="559" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="560" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="561" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onDisconnectNextport(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="562" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="563" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_DISCONNECT_NEXT</span></Line>  <Line no="564" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="565" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="566" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="567" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;コネクタ接断後のコールバック実行</span></Line>  <Line no="568" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;portname&nbsp;ポート名</span></Line>  <Line no="569" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;profile&nbsp;ポートプロファイル</span></Line>  <Line no="570" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;ret&nbsp;リターンコード</span></Line>  <Line no="571" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:onDisconnected(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="572" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;self._portconnListeners&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="573" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_type&nbsp;=&nbsp;PortConnectRetListenerType.ON_DISCONNECTED</span></Line>  <Line no="574" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self._portconnListeners.portconnret_[_type]:notify(portname,&nbsp;profile,&nbsp;ret)</span></Line>  <Line no="575" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="576" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="577" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="578" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ポート名取得</span></Line>  <Line no="579" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;ポート名</span></Line>  <Line no="580" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getName()</span></Line>  <Line no="581" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self._rtcout:RTC_TRACE("getName()&nbsp;=&nbsp;"..self._profile.name)</span></Line>  <Line no="582" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._profile.name</span></Line>  <Line no="583" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="584" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="585" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;インターフェースをコネクタプロファイルに登録</span></Line>  <Line no="586" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_profile&nbsp;コネクタプロファイル</span></Line>  <Line no="587" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="588" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:publishInterfaces(connector_profile)</span></Line>  <Line no="589" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print("publishInterfaces")</span></Line>  <Line no="590" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="591" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="592" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="593" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;コネクタ接続可能かの判定</span></Line>  <Line no="594" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード</span></Line>  <Line no="595" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:_publishInterfaces()</span></Line>  <Line no="596" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;not&nbsp;(self._connectionLimit&nbsp;&lt;&nbsp;0)&nbsp;then</span></Line>  <Line no="597" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;self._connectionLimit&nbsp;&lt;=&nbsp;#self._profile.connector_profiles&nbsp;then</span></Line>  <Line no="598" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("Connected&nbsp;number&nbsp;has&nbsp;reached&nbsp;the&nbsp;limitation.")</span></Line>  <Line no="599" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID("Can&nbsp;connect&nbsp;the&nbsp;port&nbsp;up&nbsp;to&nbsp;"..self._connectionLimit.."&nbsp;ports.")</span></Line>  <Line no="600" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self._rtcout:RTC_PARANOID(#self._profile.connector_profiles.."&nbsp;connectors&nbsp;are&nbsp;existing")</span></Line>  <Line no="601" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="602" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="603" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="604" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="605" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.RTC_OK</span></Line>  <Line no="606" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="607" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="608" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;次のポートを接続</span></Line>  <Line no="609" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;connector_profile&nbsp;コネクタプロファイル</span></Line>  <Line no="610" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;リターンコード、コネクタプロファイル</span></Line>  <Line no="611" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:connectNext(connector_profile)</span></Line>  <Line no="612" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print("test:",self,self._profile.port_ref)</span></Line>  <Line no="613" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(connector_profile.ports[1]:get_port_profile().name)</span></Line>  <Line no="614" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;index&nbsp;=&nbsp;CORBA_SeqUtil.find(connector_profile.ports,</span></Line>  <Line no="615" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;find_port_ref.new(self._profile.port_ref))</span></Line>  <Line no="616" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(index)</span></Line>  <Line no="617" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="618" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="619" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="620" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;index&nbsp;&lt;&nbsp;0&nbsp;then</span></Line>  <Line no="621" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self._ReturnCode_t.BAD_PARAMETER,&nbsp;connector_profile</span></Line>  <Line no="622" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="623" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="624" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;index&nbsp;=&nbsp;index&nbsp;+&nbsp;1</span></Line>  <Line no="625" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(index)</span></Line>  <Line no="626" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;p&nbsp;=&nbsp;connector_profile.ports[index]</span></Line>  <Line no="627" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(p)</span></Line>  <Line no="628" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;p&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="629" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--[[for&nbsp;i,v&nbsp;in&nbsp;ipairs(connector_profile.properties)&nbsp;do</span></Line>  <Line no="630" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;print(v.name,v.value)</span></Line>  <Line no="631" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end]]</span></Line>  <Line no="632" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="633" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">connector_profile.properties</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="634" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">v.name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="operator">=</span><span class="identifier">NVUtil.any_from_any</span><span class="misc">(</span><span class="identifier">v.value</span><span class="misc">)</span><span class="misc">}</span></Line>  <Line no="635" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="636" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">connector_profile.properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="637" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">notify_connect</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="638" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="639" valid="False" visited="False"/>  <Line no="640" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span><span class="misc">,</span>&nbsp;<span class="identifier">connector_profile</span></Line>  <Line no="641" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="642" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 次のポートを切断</span></Line>  <Line no="643" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="644" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="645" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnectNext</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="646" valid="False" visited="False"/>  <Line no="647" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">connector_profile.ports</span><span class="misc">,</span></Line>  <Line no="648" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_port_ref.new</span><span class="misc">(</span><span class="identifier">self._profile.port_ref</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="649" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="650" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="651" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="652" valid="False" visited="False"/>  <Line no="653" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="operator">#</span><span class="identifier">connector_profile.ports</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="654" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="655" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="656" valid="False" visited="False"/>  <Line no="657" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="658" valid="False" visited="False"/>  <Line no="659" valid="False" visited="False"/>  <Line no="660" valid="False" visited="False"/>  <Line no="661" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.ports</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span></Line>  <Line no="662" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(p,index)</span></Line>  <Line no="663" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="664" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="665" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="666" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="667" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="668" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">p</span><span class="misc">:</span><span class="identifier">notify_disconnect</span><span class="misc">(</span><span class="identifier">connector_profile.connector_id</span><span class="misc">)</span></Line>  <Line no="669" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="670" valid="False" visited="False"/>  <Line no="671" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="672" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="673" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="674" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">p</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">connector_profile.ports</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span></Line>  <Line no="675" valid="False" visited="False"/>  <Line no="676" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="677" valid="False" visited="False"/>  <Line no="678" valid="False" visited="False"/>  <Line no="679" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="680" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="681" valid="False" visited="False"/>  <Line no="682" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- IDからコネクタプロファイル取得</span></Line>  <Line no="683" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id_ コネクタID</span></Line>  <Line no="684" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 配列の番号</span></Line>  <Line no="685" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findConnProfileIndex</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">)</span></Line>  <Line no="686" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._profile.connector_profiles</span><span class="misc">,</span></Line>  <Line no="687" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_conn_id.new</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="688" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="689" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルにUUIDを設定</span></Line>  <Line no="690" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param connector_profile コネクタプロファイル</span></Line>  <Line no="691" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setUUID</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="692" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">connector_profile.connector_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getUUID</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="693" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(connector_profile.connector_id)</span></Line>  <Line no="694" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="695" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- UUID生成</span></Line>  <Line no="696" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return UUID</span></Line>  <Line no="697" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getUUID</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="698" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">uuid</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="699" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="700" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルからインターフェース取得</span></Line>  <Line no="701" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cprof コネクタプロファイル</span></Line>  <Line no="702" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="703" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">subscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="704" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="705" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="706" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイルの設定</span></Line>  <Line no="707" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _key キー</span></Line>  <Line no="708" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _value 値</span></Line>  <Line no="709" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addProperty</span><span class="misc">(</span><span class="identifier">_key</span><span class="misc">,</span>&nbsp;<span class="identifier">_value</span><span class="misc">)</span></Line>  <Line no="710" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._profile.properties</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="identifier">_key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="operator">=</span><span class="identifier">_value</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="711" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="712" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイルの設定追加</span></Line>  <Line no="713" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _key キー</span></Line>  <Line no="714" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _value 値</span></Line>  <Line no="715" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">appendProperty</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="716" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(key, value)</span></Line>  <Line no="717" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.appendStringValue</span><span class="misc">(</span><span class="identifier">self._profile.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="718" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._profile.properties)</span></Line>  <Line no="719" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="720" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタプロファイルのインターフェース設定解除</span></Line>  <Line no="721" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="722" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">unsubscribeInterfaces</span><span class="misc">(</span><span class="identifier">connector_profile</span><span class="misc">)</span></Line>  <Line no="723" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="724" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="725" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コネクタ最大数設定</span></Line>  <Line no="726" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param limit_value コネクタ最大数</span></Line>  <Line no="727" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConnectionLimit</span><span class="misc">(</span><span class="identifier">limit_value</span><span class="misc">)</span></Line>  <Line no="728" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._connectionLimit</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">limit_value</span></Line>  <Line no="729" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="730" valid="False" visited="False"/>  <Line no="731" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェース追加</span></Line>  <Line no="732" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _instance_name インスタンス名</span></Line>  <Line no="733" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _type_name 型名</span></Line>  <Line no="734" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param pol 方向</span></Line>  <Line no="735" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：追加成功、false：追加失敗</span></Line>  <Line no="736" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">appendInterface</span><span class="misc">(</span><span class="identifier">_instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">_type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">pol</span><span class="misc">)</span></Line>  <Line no="737" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._profile.interfaces</span><span class="misc">,</span></Line>  <Line no="738" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">find_interface.new</span><span class="misc">(</span><span class="identifier">_instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">pol</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="739" valid="False" visited="False"/>  <Line no="740" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="741" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="742" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="743" valid="False" visited="False"/>  <Line no="744" valid="False" visited="False"/>  <Line no="745" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">instance_name</span><span class="operator">=</span><span class="identifier">_instance_name</span><span class="misc">,</span>&nbsp;<span class="identifier">type_name</span><span class="operator">=</span><span class="identifier">_type_name</span><span class="misc">,</span>&nbsp;<span class="identifier">polarity</span><span class="operator">=</span><span class="identifier">pol</span><span class="misc">}</span></Line>  <Line no="746" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._profile.interfaces</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="747" valid="False" visited="False"/>  <Line no="748" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="749" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="750" valid="False" visited="False"/>  <Line no="751" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オーナーのRTC設定</span></Line>  <Line no="752" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param owner RTC</span></Line>  <Line no="753" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setOwner</span><span class="misc">(</span><span class="identifier">owner</span><span class="misc">)</span></Line>  <Line no="754" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">owner</span><span class="misc">:</span><span class="identifier">get_component_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="755" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ownerInstanceName</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prof.instance_name</span></Line>  <Line no="756" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setOwner("</span><span class="operator">..</span><span class="identifier">self._ownerInstanceName..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="757" valid="False" visited="False"/>  <Line no="758" valid="False" visited="False"/>  <Line no="759" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">plist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">self._profile.name</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="760" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._ownerInstanceName</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="761" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Owner is not set."</span><span class="misc">)</span></Line>  <Line no="762" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addXXXPort() should be called in onInitialize()."</span><span class="misc">)</span></Line>  <Line no="763" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="764" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">portname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ownerInstanceName..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">plist</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">plist</span><span class="misc">]</span></Line>  <Line no="765" valid="False" visited="False"/>  <Line no="766" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">owner.getObjRef</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="767" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.owner</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">owner</span></Line>  <Line no="768" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="769" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.owner</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">owner</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="770" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="771" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">portname</span></Line>  <Line no="772" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="773" valid="False" visited="False"/>  <Line no="774" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポートコネクタコールバックの設定</span></Line>  <Line no="775" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param portconnListeners ポートコネクタコールバック関数</span></Line>  <Line no="776" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setPortConnectListenerHolder</span><span class="misc">(</span><span class="identifier">portconnListeners</span><span class="misc">)</span></Line>  <Line no="777" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portconnListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">portconnListeners</span></Line>  <Line no="778" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="779" valid="False" visited="False"/>  <Line no="780" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="781" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="782" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPortRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="783" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getPortRef()"</span><span class="misc">)</span></Line>  <Line no="784" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile.port_ref</span></Line>  <Line no="785" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="786" valid="False" visited="False"/>  <Line no="787" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="788" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="789" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="790" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getProfile()"</span><span class="misc">)</span></Line>  <Line no="791" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile</span></Line>  <Line no="792" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="793" valid="False" visited="False"/>  <Line no="794" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全コネクタ切断</span></Line>  <Line no="795" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="796" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disconnect_all</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="797" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"disconnect_all()"</span><span class="misc">)</span></Line>  <Line no="798" valid="False" visited="False"/>  <Line no="799" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">plist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile.connector_profiles</span></Line>  <Line no="800" valid="False" visited="False"/>  <Line no="801" valid="False" visited="False"/>  <Line no="802" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">retcode</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="803" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">len_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">plist</span></Line>  <Line no="804" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"disconnecting "</span><span class="operator">..</span><span class="identifier">len_..</span><span class="string">" connections."</span><span class="misc">)</span></Line>  <Line no="805" valid="False" visited="False"/>  <Line no="806" valid="False" visited="False"/>  <Line no="807" valid="False" visited="False"/>  <Line no="808" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">con</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">plist</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="809" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmpret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">disconnect</span><span class="misc">(</span><span class="identifier">con.connector_id</span><span class="misc">)</span></Line>  <Line no="810" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmpret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="811" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">retcode</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">tmpret</span></Line>  <Line no="812" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="813" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="814" valid="False" visited="False"/>  <Line no="815" valid="False" visited="False"/>  <Line no="816" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">retcode</span></Line>  <Line no="817" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="818" valid="False" visited="False"/>  <Line no="819" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス設定</span></Line>  <Line no="820" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port_ref オブジェクトリファレンス</span></Line>  <Line no="821" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setPortRef</span><span class="misc">(</span><span class="identifier">port_ref</span><span class="misc">)</span></Line>  <Line no="822" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setPortRef()"</span><span class="misc">)</span></Line>  <Line no="823" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.port_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">port_ref</span></Line>  <Line no="824" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="825" valid="False" visited="False"/>  <Line no="826" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス生成</span></Line>  <Line no="827" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="828" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("createRef")</span></Line>  <Line no="829" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="830" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/PortService:1.0"</span><span class="misc">)</span></Line>  <Line no="831" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">self._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:omg.org/RTC/PortService:1.0"</span><span class="misc">)</span></Line>  <Line no="832" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.port_ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="833" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="834" valid="False" visited="False"/>  <Line no="835" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インターフェースの非アクティブ化</span></Line>  <Line no="836" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="837" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="838" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="839" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="840" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="841" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="842" valid="False" visited="False"/>  <Line no="843" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="844" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="845" valid="False" visited="False"/>  <Line no="846" valid="False" visited="False"/>  <Line no="847" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PortBase</span></Line>  <FileSummary valid="429" visited="362" totalLines="847" coverage="84"/> </File> <File name="lua\openrtm\PortCallBack.lua" anchor="lua_openrtm_PortCallBack_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PortCallBack.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ポート関連のコールバック定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortCallBack</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.PortCallBack"] = PortCallBack</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="identifier">PortCallBack.ConnectionCallback</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="14" valid="True" visited="True">	<span class="identifier">PortCallBack.ConnectionCallback.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="15" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="16" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="17" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="18" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="19" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="20" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="22" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="23" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	<span class="identifier">PortCallBack.DisconnectCallback</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="True">	<span class="identifier">PortCallBack.DisconnectCallback.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="30" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">connector_id</span><span class="misc">)</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="32" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">connector_id</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">connector_id</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="38" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="39" valid="False" visited="False"/>  <Line no="40" valid="True" visited="True">	<span class="identifier">PortCallBack.OnWrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="41" valid="True" visited="True">	<span class="identifier">PortCallBack.OnWrite.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="51" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="True" visited="True">	<span class="identifier">PortCallBack.OnWriteConvert</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="54" valid="True" visited="True">	<span class="identifier">PortCallBack.OnWriteConvert.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="64" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="True" visited="True">	<span class="identifier">PortCallBack.OnRead</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="68" valid="True" visited="True">	<span class="identifier">PortCallBack.OnRead.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="78" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="79" valid="False" visited="False"/>  <Line no="80" valid="True" visited="True">	<span class="identifier">PortCallBack.OnReadConvert</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="81" valid="True" visited="True">	<span class="identifier">PortCallBack.OnReadConvert.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="91" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False"/>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PortCallBack</span></Line>  <FileSummary valid="64" visited="44" totalLines="95" coverage="68"/> </File> <File name="lua\openrtm\PortConnectListener.lua" anchor="lua_openrtm_PortConnectListener_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PortConnectListener.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コネクタ関連のコールバック定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortConnectListener</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.PortConnectListener"] = PortConnectListener</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="14" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_NOTIFY_CONNECT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="15" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_NOTIFY_DISCONNECT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="16" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_UNSUBSCRIBE_INTERFACES</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="17" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PORT_CONNECT_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="23" valid="False" visited="False"/>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False"/>  <Line no="27" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_NOTIFY_CONNECT"</span><span class="misc">,</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_NOTIFY_DISCONNECT"</span><span class="misc">,</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_UNSUBSCRIBE_INTERFACES"</span><span class="misc">,</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"PORT_CONNECT_LISTENER_NUM"</span><span class="misc">}</span></Line>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectListenerType.PORT_CONNECT_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="37" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="44" valid="False" visited="False"/>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="52" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="False" visited="False"/>  <Line no="56" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_PUBLISH_INTERFACES</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_CONNECT_NEXTPORT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span><span class="misc">,</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_SUBSCRIBE_INTERFACES</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span><span class="misc">,</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_CONNECTED</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span><span class="misc">,</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_DISCONNECT_NEXT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span><span class="misc">,</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ON_DISCONNECTED</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">6</span><span class="misc">,</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PORT_CONNECT_RET_LISTENER_NUM</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">7</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span></Line>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="False" visited="False"/>  <Line no="67" valid="False" visited="False"/>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="False" visited="False"/>  <Line no="71" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="False" visited="False"/>  <Line no="74" valid="False" visited="False"/>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListener.toString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">typeString</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="string">"ON_PUBLISH_INTERFACES"</span><span class="misc">,</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_CONNECT_NEXTPORT"</span><span class="misc">,</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_SUBSCRIBE_INTERFACES"</span><span class="misc">,</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_CONNECTED"</span><span class="misc">,</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_DISCONNECT_NEXT"</span><span class="misc">,</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ON_DISCONNECTED"</span><span class="misc">}</span></Line>  <Line no="83" valid="False" visited="False"/>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectRetListenerType.PORT_CONNECT_RET_LISTENER_NUM</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">typeString</span><span class="misc">[</span><span class="identifier">_type</span><span class="misc">]</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="88" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListener.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="103" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="False" visited="False"/>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Entry</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="109" valid="False" visited="False">	<span class="identifier">Entry.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.listener</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">autoclean</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="114" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="120" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="130" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="141" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="142" valid="False" visited="False"/>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListenerHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="148" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectRetListenerHolder.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">Entry.new</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">_listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.listener</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_listener.autoclean</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="158" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._listeners</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listener.listener</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">portname</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="169" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="170" valid="False" visited="False"/>  <Line no="171" valid="False" visited="False"/>  <Line no="172" valid="False" visited="False"/>  <Line no="173" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="174" valid="False" visited="False"/>  <Line no="175" valid="True" visited="True">	<span class="identifier">PortConnectListener.PortConnectListeners.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="177" valid="False" visited="False"/>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portconnect_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectListenerType.PORT_CONNECT_LISTENER_NUM</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portconnect_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.portconnect_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.portconnect_</span><span class="misc">,</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False"/>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portconnret_num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectRetListenerType.PORT_CONNECT_RET_LISTENER_NUM</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.portconnret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">obj.portconnret_num</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">obj.portconnret_</span><span class="misc">,</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectRetListenerHolder.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="189" valid="False" visited="False"/>  <Line no="190" valid="False" visited="False"/>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="192" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="False" visited="False"/>  <Line no="195" valid="False" visited="False"/>  <Line no="196" valid="False" visited="False"/>  <Line no="197" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PortConnectListener</span></Line>  <FileSummary valid="116" visited="107" totalLines="197" coverage="92"/> </File> <File name="lua\openrtm\Properties.lua" anchor="lua_openrtm_Properties_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file Properties.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief プロパティ操作関数定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;Properties=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.Properties"]&nbsp;=&nbsp;Properties</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="True" visited="True">	<span class="blockcomment">local&nbsp;StringUtil&nbsp;=&nbsp;require&nbsp;"openrtm.StringUtil"</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment">--string&nbsp;=&nbsp;require&nbsp;string</span></Line>  <Line no="15" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="16" valid="False" visited="False">	<span class="blockcomment">--&nbsp;プロパティ初期化</span></Line>  <Line no="17" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;argv&nbsp;argv.prop：コピー元のプロパティ、argv.key・argv.value：キーと値、argv.defaults_map：テーブル</span></Line>  <Line no="18" valid="False" visited="False">	<span class="blockcomment">Properties.new&nbsp;=&nbsp;function(argv)</span></Line>  <Line no="19" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;obj&nbsp;=&nbsp;{}</span></Line>  <Line no="20" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:init()</span></Line>  <Line no="21" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.default_value&nbsp;=&nbsp;""</span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.root&nbsp;=&nbsp;nil</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.empty&nbsp;=&nbsp;""</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.leaf&nbsp;=&nbsp;{}</span></Line>  <Line no="25" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.name&nbsp;&nbsp;=&nbsp;""</span></Line>  <Line no="26" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;self.value&nbsp;=&nbsp;""</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;argv&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="28" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;argv&nbsp;=&nbsp;{}</span></Line>  <Line no="29" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;argv.prop&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="31" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(argv.prop:str())</span></Line>  <Line no="32" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;argv.prop.name</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self.value&nbsp;=&nbsp;argv.prop.value</span></Line>  <Line no="34" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self.default_value&nbsp;=&nbsp;argv.prop.default_value</span></Line>  <Line no="35" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;keys&nbsp;=&nbsp;argv.prop:propertyNames()</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(#keys)</span></Line>  <Line no="37" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;i,&nbsp;_key&nbsp;in&nbsp;ipairs(keys)&nbsp;do</span></Line>  <Line no="38" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(i,&nbsp;_key)</span></Line>  <Line no="39" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;node&nbsp;=&nbsp;argv.prop:getNode(_key)</span></Line>  <Line no="40" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(node)</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;node&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="42" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--print(_key,&nbsp;node.default_value)</span></Line>  <Line no="43" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self:setDefault(_key,&nbsp;node.default_value)</span></Line>  <Line no="44" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self:setProperty(_key,&nbsp;node.value)</span></Line>  <Line no="45" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="47" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;argv.key&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="49" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;argv.key</span></Line>  <Line no="50" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;argv.value&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="51" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self.value&nbsp;=&nbsp;""</span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="53" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self.value&nbsp;=&nbsp;argv.value</span></Line>  <Line no="54" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="55" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="56" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;argv.defaults_map&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="57" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;_key,&nbsp;_value&nbsp;in&nbsp;pairs(argv.defaults_map)&nbsp;do</span></Line>  <Line no="58" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;_key&nbsp;=&nbsp;StringUtil.eraseBothEndsBlank(_key)</span></Line>  <Line no="59" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;_value&nbsp;=&nbsp;StringUtil.eraseBothEndsBlank(_value)</span></Line>  <Line no="60" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;self:setDefault(_key,&nbsp;_value)</span></Line>  <Line no="61" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="63" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[</span></Line>  <Line no="64" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;argv.defaults_str&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="65" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_num&nbsp;=&nbsp;argv.num</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;argv.num&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;_num&nbsp;=&nbsp;100000</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="69" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:setDefaults(argv.defaults_str,&nbsp;_num)</span></Line>  <Line no="70" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="71" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;]]</span></Line>  <Line no="72" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="73" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;キー取得</span></Line>  <Line no="74" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;キー</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getName()</span></Line>  <Line no="76" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.name</span></Line>  <Line no="77" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="78" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;値取得</span></Line>  <Line no="79" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;値</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getValue()</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.value</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="83" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;デフォルト値取得</span></Line>  <Line no="84" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;key&nbsp;キー</span></Line>  <Line no="85" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;default&nbsp;デフォルト値</span></Line>  <Line no="86" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;値</span></Line>  <Line no="87" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getDefaultValue(key,&nbsp;default)</span></Line>  <Line no="88" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.default_value</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="90" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;ルート要素の取得</span></Line>  <Line no="91" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;ルート要素</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getRoot()</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.root</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="95" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;プロパティ値取得</span></Line>  <Line no="96" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;key&nbsp;キー</span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;default&nbsp;デフォルト値</span></Line>  <Line no="98" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロパティ</span></Line>  <Line no="99" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getProperty(key,&nbsp;default)</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(key)</span></Line>  <Line no="101" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;default&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="102" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;keys&nbsp;=&nbsp;StringUtil.split(key,&nbsp;"%.")</span></Line>  <Line no="103" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;node&nbsp;=&nbsp;self:_getNode(keys,&nbsp;1,&nbsp;self)</span></Line>  <Line no="104" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;node&nbsp;then</span></Line>  <Line no="105" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;node.value&nbsp;~=&nbsp;""&nbsp;then</span></Line>  <Line no="106" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;node.value</span></Line>  <Line no="107" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="108" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;node.default_value</span></Line>  <Line no="109" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="110" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="111" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;self.empty</span></Line>  <Line no="112" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="113" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;value&nbsp;=&nbsp;self:getProperty(key)</span></Line>  <Line no="114" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;value&nbsp;~=&nbsp;""&nbsp;then</span></Line>  <Line no="115" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;value</span></Line>  <Line no="116" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;else</span></Line>  <Line no="117" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;default</span></Line>  <Line no="118" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="119" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="120" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="121" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;デフォルト値取得</span></Line>  <Line no="122" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;key&nbsp;キー</span></Line>  <Line no="123" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;デフォルト値</span></Line>  <Line no="124" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:getDefault(key)</span></Line>  <Line no="125" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;keys&nbsp;=&nbsp;StringUtil.split(key,&nbsp;"%.")</span></Line>  <Line no="126" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;node&nbsp;=&nbsp;self:_getNode(keys,&nbsp;1,&nbsp;self)</span></Line>  <Line no="127" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;node&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="128" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;node.default_value</span></Line>  <Line no="129" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="130" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.empty</span></Line>  <Line no="131" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="132" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;プロパティ設定</span></Line>  <Line no="133" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;key&nbsp;キー</span></Line>  <Line no="134" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;value&nbsp;値</span></Line>  <Line no="135" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロパティ</span></Line>  <Line no="136" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setProperty(key,&nbsp;value)</span></Line>  <Line no="137" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self.leaf)</span></Line>  <Line no="138" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;value&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="139" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;keys&nbsp;=&nbsp;StringUtil.split(key,&nbsp;"%.")</span></Line>  <Line no="140" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(key,#keys)</span></Line>  <Line no="141" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;curr&nbsp;=&nbsp;self</span></Line>  <Line no="142" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;for&nbsp;_i,&nbsp;_key&nbsp;in&nbsp;ipairs(keys)&nbsp;do</span></Line>  <Line no="143" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(curr)</span></Line>  <Line no="144" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;_next&nbsp;=&nbsp;curr:hasKey(_key)</span></Line>  <Line no="145" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;_next&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="146" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_next&nbsp;=&nbsp;Properties.new({key=_key})</span></Line>  <Line no="147" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_next.root&nbsp;=&nbsp;curr</span></Line>  <Line no="148" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;table.insert(curr.leaf,_next)</span></Line>  <Line no="149" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="150" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;curr&nbsp;=&nbsp;_next</span></Line>  <Line no="151" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="152" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="153" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;curr.value&nbsp;=&nbsp;value</span></Line>  <Line no="154" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;retval</span></Line>  <Line no="155" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;else</span></Line>  <Line no="156" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(self:getProperty(key))</span></Line>  <Line no="157" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:setProperty(key,&nbsp;self:getProperty(key))</span></Line>  <Line no="158" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;prop&nbsp;=&nbsp;self:getNode(key)</span></Line>  <Line no="159" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;prop.value</span></Line>  <Line no="160" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="161" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;self.root</span></Line>  <Line no="162" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="163" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;デフォルト値設定</span></Line>  <Line no="164" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;key&nbsp;キー</span></Line>  <Line no="165" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;value&nbsp;デフォルト値</span></Line>  <Line no="166" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;値</span></Line>  <Line no="167" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setDefault(key,&nbsp;value)</span></Line>  <Line no="168" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;keys&nbsp;=&nbsp;StringUtil.split(key,&nbsp;"%.")</span></Line>  <Line no="169" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;curr&nbsp;=&nbsp;self</span></Line>  <Line no="170" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(self.leaf)</span></Line>  <Line no="171" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--StringUtil.print_table(keys)</span></Line>  <Line no="172" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;for&nbsp;_i,&nbsp;_key&nbsp;in&nbsp;ipairs(keys)&nbsp;do</span></Line>  <Line no="173" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_next&nbsp;=&nbsp;curr:hasKey(_key)</span></Line>  <Line no="174" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;_next&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="175" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;_next&nbsp;=&nbsp;Properties.new({key=_key})</span></Line>  <Line no="176" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;_next.root&nbsp;=&nbsp;curr</span></Line>  <Line no="177" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(curr.leaf,&nbsp;_next)</span></Line>  <Line no="178" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;--print(#curr.leaf)</span></Line>  <Line no="179" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;table.insert(curr.leaf,&nbsp;_next)</span></Line>  <Line no="180" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="181" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;curr=&nbsp;_next</span></Line>  <Line no="182" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="183" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;value&nbsp;~=&nbsp;""&nbsp;and&nbsp;string.sub(value,&nbsp;-1)&nbsp;~=&nbsp;"\n"&nbsp;then</span></Line>  <Line no="184" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;value&nbsp;=&nbsp;string.sub(value,&nbsp;0,&nbsp;-1)</span></Line>  <Line no="185" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="186" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;curr.default_value&nbsp;=&nbsp;value</span></Line>  <Line no="187" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;value</span></Line>  <Line no="188" valid="True" visited="True">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="189" valid="False" visited="False">	<span class="blockcomment">&nbsp;--デフォルト値をテーブルから設定</span></Line>  <Line no="190" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;defaults&nbsp;デフォルト値のテーブル</span></Line>  <Line no="191" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@param&nbsp;num&nbsp;最大数</span></Line>  <Line no="192" valid="False" visited="False">	<span class="blockcomment">&nbsp;--&nbsp;@return&nbsp;プロパティ</span></Line>  <Line no="193" valid="True" visited="True">	<span class="blockcomment">&nbsp;function&nbsp;obj:setDefaults(defaults,&nbsp;num)</span></Line>  <Line no="194" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;num&nbsp;==&nbsp;nil&nbsp;then</span></Line>  <Line no="195" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;num&nbsp;=&nbsp;10000</span></Line>  <Line no="196" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="197" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="198" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[for&nbsp;i&nbsp;=&nbsp;1,&nbsp;#defaults/2&nbsp;do</span></Line>  <Line no="199" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;if&nbsp;i&nbsp;&gt;&nbsp;num&nbsp;then</span></Line>  <Line no="200" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;&nbsp;break</span></Line>  <Line no="201" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;end</span></Line>  <Line no="202" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_key&nbsp;=&nbsp;defaults[i*2-1]</span></Line>  <Line no="203" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;local&nbsp;_value&nbsp;=&nbsp;defaults[i*2]</span></Line>  <Line no="204" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;--print(_key,&nbsp;_value)</span></Line>  <Line no="205" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;_key&nbsp;=&nbsp;StringUtil.eraseHeadBlank(_key)</span></Line>  <Line no="206" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;_key&nbsp;=&nbsp;StringUtil.eraseTailBlank(_key)</span></Line>  <Line no="207" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;_value&nbsp;=&nbsp;StringUtil.eraseHeadBlank(_value)</span></Line>  <Line no="208" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;_value&nbsp;=&nbsp;StringUtil.eraseTailBlank(_value)</span></Line>  <Line no="209" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;self:setDefault(_key,&nbsp;_value)</span></Line>  <Line no="210" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="211" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;]]</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">_key</span><span class="misc">,</span><span class="identifier">_value</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">defaults</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="215" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">_key</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">_value</span><span class="misc">)</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setDefault</span><span class="misc">(</span><span class="identifier">_key</span><span class="misc">,</span>&nbsp;<span class="identifier">_value</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.leaf</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定ストリームにプロパティを出力</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param out アウトストリーム</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">list</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_store</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="string">""</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="229" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定ストリームからプロパティを入力</span></Line>  <Line no="231" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inStream インストリーム</span></Line>  <Line no="232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">loadStream</span><span class="misc">(</span><span class="identifier">inStream</span><span class="misc">)</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">readStr</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">inStream</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">readStr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">readStr</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">0</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"#"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"!"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\n"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--_str = _str.rstrip('\r\n')</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.isEscaped</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="244" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">0</span><span class="misc">,</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="246" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pline..tmp</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pline.._str</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">splitKeyValue</span><span class="misc">(</span><span class="identifier">pline</span><span class="misc">)</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="259" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="260" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="261" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.leaf</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="264" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定ストリームにヘッダを記述したプロパティを出力</span></Line>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param out アウトストリーム</span></Line>  <Line no="266" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param header ヘッダ</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">store</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="identifier">header</span><span class="misc">)</span></Line>  <Line no="268" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out.write</span><span class="misc">(</span><span class="string">"#"</span><span class="operator">..</span><span class="identifier">header..</span><span class="string">"\n"</span><span class="misc">)</span></Line>  <Line no="269" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_store</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="string">""</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティのキー一覧を取得</span></Line>  <Line no="272" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return キー一覧</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">names</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self.leaf</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_propertyNames</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">leaf.name</span><span class="misc">,</span>&nbsp;<span class="identifier">leaf</span><span class="misc">)</span></Line>  <Line no="277" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">names</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティのキーの数取得</span></Line>  <Line no="281" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return キーの数</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">size</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">#</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="284" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="285" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定キーのノードを検索</span></Line>  <Line no="286" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ノード</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="290" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="291" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="292" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--keys = {}</span></Line>  <Line no="293" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self:split(key, '%.', keys)</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="295" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(keys[0])</span></Line>  <Line no="296" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:_getNode(keys, 1, self))</span></Line>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_getNode</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">,</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定キーのノードを取得</span></Line>  <Line no="300" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ノード</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="304" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="305" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="307" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(leaf, type(leaf))</span></Line>  <Line no="308" valid="False" visited="False"/>  <Line no="309" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">leaf</span></Line>  <Line no="311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="313" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:findNode(key), type(self:findNode(key)))</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="316" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定キーのノードを生成</span></Line>  <Line no="317" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー</span></Line>  <Line no="318" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：生成成功、false：生成失敗</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="321" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="326" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="329" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ノード削除</span></Line>  <Line no="330" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param leaf_name キー</span></Line>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeNode</span><span class="misc">(</span><span class="identifier">leaf_name</span><span class="misc">)</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self.leaf</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">leaf.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">leaf_name</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">leaf</span></Line>  <Line no="336" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self.leaf</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop</span></Line>  <Line no="338" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="339" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="341" valid="False" visited="False"/>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="343" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- キーの存在確認</span></Line>  <Line no="344" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー</span></Line>  <Line no="345" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self.leaf)</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">leaf</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self.leaf</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">leaf.name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="350" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">leaf</span></Line>  <Line no="351" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="352" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="355" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティ全削除</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">clear</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.leaf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="359" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティの追加</span></Line>  <Line no="360" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop 追加元のプロパティ</span></Line>  <Line no="361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 追加先のプロパティ</span></Line>  <Line no="362" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">keys</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">propertyNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">size</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="366" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="369" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列からキーと値を取り出し</span></Line>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _str 文字列(key:value)</span></Line>  <Line no="371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param key キー一覧</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value 値一覧</span></Line>  <Line no="373" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="374" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">splitKeyValue</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="375" valid="False" visited="False"/>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">i</span><span class="misc">,</span><span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">":"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"="</span><span class="misc">)</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.isEscaped</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">i</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">i</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="385" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="386" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="387" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="388" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">s</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">" "</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.isEscaped</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="389" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">i</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="390" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">i</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="391" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="392" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="393" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="394" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_str</span></Line>  <Line no="395" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="396" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="398" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列を分割する</span></Line>  <Line no="399" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _str 文字列</span></Line>  <Line no="400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param delim 分割文字</span></Line>  <Line no="401" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value 値一覧</span></Line>  <Line no="402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true；分割成功、false：分割失敗</span></Line>  <Line no="403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">split</span><span class="misc">(</span>&nbsp;<span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">delim</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="404" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="405" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="407" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">begin_it</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="408" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span></Line>  <Line no="409" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">end_it</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">length</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="410" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">end_it</span><span class="misc">,</span><span class="identifier">end_it</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">delim</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.isEscaped</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">end_it</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="411" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">,</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">begin_it</span><span class="misc">,</span>&nbsp;<span class="identifier">end_it</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="412" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">begin_it</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">end_it</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="413" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="414" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="415" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="417" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ノード取得</span></Line>  <Line no="418" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param keys キー一覧</span></Line>  <Line no="419" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param index キー一覧のインデックス</span></Line>  <Line no="420" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr 現在のノード</span></Line>  <Line no="421" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 次のノード</span></Line>  <Line no="422" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_getNode</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">,</span>&nbsp;<span class="identifier">index</span><span class="misc">,</span>&nbsp;<span class="identifier">curr</span><span class="misc">)</span></Line>  <Line no="423" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(keys[index])</span></Line>  <Line no="424" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_next</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr</span><span class="misc">:</span><span class="identifier">hasKey</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="425" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_next)</span></Line>  <Line no="426" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_next</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="427" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="428" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="operator">#</span><span class="identifier">keys</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_next</span><span class="misc">:</span><span class="identifier">_getNode</span><span class="misc">(</span><span class="identifier">keys</span><span class="misc">,</span>&nbsp;<span class="identifier">index</span><span class="misc">,</span>&nbsp;<span class="identifier">_next</span><span class="misc">)</span></Line>  <Line no="432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="433" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_next</span></Line>  <Line no="434" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="436" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ノードのキー一覧取得</span></Line>  <Line no="437" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param names キー一覧</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr_name 現在探索しているキー</span></Line>  <Line no="439" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr 現在のノード</span></Line>  <Line no="440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_propertyNames</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">curr_name</span><span class="misc">,</span>&nbsp;<span class="identifier">curr</span><span class="misc">)</span></Line>  <Line no="441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">next_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr_name..</span><span class="string">"."</span><span class="operator">..</span><span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="444" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_propertyNames</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span>&nbsp;<span class="identifier">next_name</span><span class="misc">,</span>&nbsp;<span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="446" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="447" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">names</span><span class="misc">,</span><span class="identifier">curr_name</span><span class="misc">)</span></Line>  <Line no="448" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="449" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="450" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定ストリームにプロパティを出力</span></Line>  <Line no="451" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param out アウトストリーム</span></Line>  <Line no="452" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr_name 現在のキー</span></Line>  <Line no="453" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr 現在のノード</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_store</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="identifier">curr_name</span><span class="misc">,</span>&nbsp;<span class="identifier">curr</span><span class="misc">)</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="457" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">next_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">curr_name</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">next_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="460" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="461" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">next_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr_name</span><span class="operator">+</span><span class="string">"."</span><span class="operator">+</span><span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">name</span></Line>  <Line no="462" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="463" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_store</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="identifier">next_name</span><span class="misc">,</span>&nbsp;<span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="464" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="466" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr.value</span></Line>  <Line no="467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">val</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">curr.default_value</span></Line>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out.write</span><span class="misc">(</span><span class="identifier">curr_name..</span><span class="string">": "</span><span class="operator">..</span><span class="identifier">val..</span><span class="string">"\n"</span><span class="misc">)</span></Line>  <Line no="470" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="471" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="472" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="473" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インデント生成</span></Line>  <Line no="474" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param index 現在のインデント数</span></Line>  <Line no="475" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return インデント</span></Line>  <Line no="476" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">indent</span><span class="misc">(</span><span class="identifier">index</span><span class="misc">)</span></Line>  <Line no="477" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("indent")</span></Line>  <Line no="478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">space</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="identifier">index</span><span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="480" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">space</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">space..</span><span class="string">"  "</span></Line>  <Line no="481" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">space</span></Line>  <Line no="483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="484" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティを出力用に文字列に変換</span></Line>  <Line no="485" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param out 出力文字列</span></Line>  <Line no="486" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param curr 現在のノード</span></Line>  <Line no="487" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param index インデント数</span></Line>  <Line no="488" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 文字列</span></Line>  <Line no="489" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">_dump</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="identifier">curr</span><span class="misc">,</span>&nbsp;<span class="identifier">index</span><span class="misc">)</span></Line>  <Line no="490" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="491" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">indent</span><span class="misc">(</span><span class="identifier">index</span><span class="misc">)</span><span class="operator">..</span><span class="string">"- "</span><span class="operator">..</span><span class="identifier">curr.name</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="493" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="494" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test",curr.default_value, curr.value)</span></Line>  <Line no="495" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">curr.value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="496" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">": "</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">curr.default_value</span><span class="misc">)</span><span class="operator">..</span><span class="string">"\n"</span></Line>  <Line no="497" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="498" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">": "</span><span class="operator">..</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">curr.value</span><span class="misc">)</span><span class="operator">..</span><span class="string">"\n"</span></Line>  <Line no="499" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="501" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="503" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="operator">..</span><span class="string">"\n"</span></Line>  <Line no="504" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="505" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">curr.leaf</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_dump</span><span class="misc">(</span><span class="identifier">out</span><span class="misc">,</span>&nbsp;<span class="identifier">curr.leaf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">)</span></Line>  <Line no="507" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="508" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">out</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="509" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="510" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティ取得</span></Line>  <Line no="511" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getLeaf</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.leaf</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="515" valid="False" visited="False"/>  <Line no="516" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ファイルストリームからプロパティを設定</span></Line>  <Line no="517" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inStream ファイルストリーム</span></Line>  <Line no="518" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="library">load</span><span class="misc">(</span><span class="identifier">inStream</span><span class="misc">)</span></Line>  <Line no="519" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="520" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">readStr</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="identifier">inStream</span><span class="misc">:</span><span class="identifier">lines</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="521" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="522" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">readStr</span><span class="misc">)</span></Line>  <Line no="523" valid="False" visited="False"/>  <Line no="524" valid="False" visited="False"/>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"#"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"!"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\n"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="526" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="527" valid="False" visited="False"/>  <Line no="528" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="529" valid="False" visited="False"/>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.isEscaped</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="operator">#</span><span class="identifier">_str</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="531" valid="False" visited="False"/>  <Line no="532" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">_str</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="533" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">)</span></Line>  <Line no="534" valid="False" visited="False"/>  <Line no="535" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pline..tmp</span></Line>  <Line no="536" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pline.._str</span></Line>  <Line no="538" valid="False" visited="False"/>  <Line no="539" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="540" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(key)</span></Line>  <Line no="541" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">splitKeyValue</span><span class="misc">(</span><span class="identifier">pline</span><span class="misc">)</span></Line>  <Line no="542" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="545" valid="False" visited="False"/>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unescape</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="548" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="549" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(value)</span></Line>  <Line no="550" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(key, value)</span></Line>  <Line no="551" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="identifier">key</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pline</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="553" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="554" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="555" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="556" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="557" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 文字列変換関数</span></Line>  <Line no="558" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="559" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 変換後の文字列</span></Line>  <Line no="560" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="562" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="string">""</span><span class="misc">)</span></Line>  <Line no="563" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._dump)</span></Line>  <Line no="564" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">_dump</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span>&nbsp;<span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="number">0</span><span class="misc">)</span></Line>  <Line no="565" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="566" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="567" valid="False" visited="False"/>  <Line no="568" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__tostring</span>&nbsp;<span class="operator">=</span><span class="identifier">str_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="569" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="570" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="571" valid="False" visited="False"/>  <Line no="572" valid="False" visited="False"/>  <Line no="573" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">Properties</span></Line>  <FileSummary valid="318" visited="276" totalLines="573" coverage="86"/> </File> <File name="lua\openrtm\PublisherBase.lua" anchor="lua_openrtm_PublisherBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PublisherBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief パブリッシャー基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherBase</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.PublisherBase"] = PublisherBase</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="False" visited="False">	<span class="comment">-- パブリッシャー基底オブジェクト初期化</span></Line>  <Line no="19" valid="False" visited="False">	<span class="comment">-- @return パブリッシャー</span></Line>  <Line no="20" valid="False" visited="False">	<span class="identifier">PublisherBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="21" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="22" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティを設定</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="24" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="28" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスコンシューマ設定</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマオブジェクト</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConsumer</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ設定</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コールバック設定</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param info プロファイル</span></Line>  <Line no="42" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listeners コールバック関数</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">)</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param usec タイムアウト時間[us]</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">usec</span><span class="misc">)</span></Line>  <Line no="53" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態化の確認</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：アクティブ状態、false：非アクティブ状態</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isActive</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="71" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="False" visited="False"/>  <Line no="74" valid="True" visited="True">	<span class="identifier">PublisherBase.PublisherFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="75" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">PublisherBase.PublisherFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False"/>  <Line no="77" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">PublisherBase.PublisherFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="79" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False"/>  <Line no="81" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PublisherBase</span></Line>  <FileSummary valid="37" visited="29" totalLines="81" coverage="78"/> </File> <File name="lua\openrtm\PublisherFlush.lua" anchor="lua_openrtm_PublisherFlush_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file PublisherFlush.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 即座にデータ書き込みを実行するパブリッシャー定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherFlush</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.PublisherFlush"] = PublisherFlush</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">DataPortStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.DataPortStatus"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.PublisherBase"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PublisherFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PublisherBase.PublisherFactory</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Factory"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConnectorListener"</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConnectorDataListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConnectorListener.ConnectorDataListenerType</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="False" visited="False">	<span class="comment">-- PublisherFlush初期化</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @return PublisherFlush</span></Line>  <Line no="25" valid="False" visited="False">	<span class="identifier">PublisherFlush.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">PublisherBase.new</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"PublisherFlush"</span><span class="misc">)</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumer</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._active</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._retcode</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="36" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティを設定</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"init()"</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスコンシューマ設定</span></Line>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param consumer コンシューマオブジェクト</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setConsumer</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setConsumer()"</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.INVALID_ARGS</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">consumer</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ設定</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param buffer バッファ</span></Line>  <Line no="58" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setBuffer</span><span class="misc">(</span><span class="identifier">buffer</span><span class="misc">)</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setBuffer()"</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コールバック設定</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param info プロファイル</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param listeners コールバック関数</span></Line>  <Line no="66" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">info</span><span class="misc">,</span>&nbsp;<span class="identifier">listeners</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setListeners()"</span><span class="misc">)</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">listeners</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="71" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"setListeners(listeners == 0): invalid argument"</span><span class="misc">)</span></Line>  <Line no="72" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.INVALID_ARGS</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="74" valid="False" visited="False"/>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">info</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">listeners</span></Line>  <Line no="77" valid="False" visited="False"/>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param usec タイムアウト時間[us]</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">usec</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"write()"</span><span class="misc">)</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="92" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"write(): connection lost."</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onSend</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._consumer</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="103" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.PORT_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="106" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.SEND_FULL</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="107" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="108" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="109" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.SEND_TIMEOUT</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="110" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="112" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.CONNECTION_LOST</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="113" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="115" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._retcode</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">DataPortStatus.UNKNOWN_ERROR</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="116" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="117" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="120" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._retcode</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態化の確認</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：アクティブ状態、false：非アクティブ状態</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isActive</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._active</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._active</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="136" valid="False" visited="False"/>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._active</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._active</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="147" valid="False" visited="False"/>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">DataPortStatus.PORT_OK</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="False" visited="False"/>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ送信後のコールバック実行</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onSend</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_SEND</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="158" valid="False" visited="False"/>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ受信後のコールバック実行</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceived</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ受信フル時のコールバック実行</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverFull</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_FULL</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ受信タイムアウト時のコールバック実行</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverTimeout</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="176" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_TIMEOUT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ受信エラー時のコールバック実行</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param data データ</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReceiverError</span><span class="misc">(</span><span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._listeners</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self._profile</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._listeners.connectorData_</span><span class="misc">[</span><span class="identifier">ConnectorDataListenerType.ON_RECEIVER_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">self._profile</span><span class="misc">,</span>&nbsp;<span class="identifier">data</span><span class="misc">)</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="187" valid="False" visited="False"/>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="189" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="190" valid="False" visited="False"/>  <Line no="191" valid="False" visited="False">	<span class="comment">-- PublisherFlush生成ファクトリ登録</span></Line>  <Line no="192" valid="False" visited="False">	<span class="identifier">PublisherFlush.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PublisherFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"flush"</span><span class="misc">,</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">PublisherFlush.new</span><span class="misc">,</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Factory.Delete</span><span class="misc">)</span></Line>  <Line no="196" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="False" visited="False"/>  <Line no="199" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">PublisherFlush</span></Line>  <FileSummary valid="112" visited="83" totalLines="199" coverage="74"/> </File> <File name="lua\openrtm\RingBuffer.lua" anchor="lua_openrtm_RingBuffer_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file RingBuffer.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief リングバッファ定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RingBuffer</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.RingBuffer"] = RingBuffer</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferBase"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">TimeValue</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.TimeValue"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">BufferStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.BufferStatus"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="identifier">RingBuffer.RINGBUFFER_DEFAULT_LENGTH</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">8</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- リングバッファ初期化</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param length バッファ長</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @return リングバッファ</span></Line>  <Line no="25" valid="False" visited="False">	<span class="identifier">RingBuffer.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">length</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">BufferBase.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RingBuffer.RINGBUFFER_DEFAULT_LENGTH</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._overwrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._readback</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._timedwrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._timedread</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._wtimeout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="number">1</span><span class="misc">,</span><span class="number">0</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtimeout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="number">1</span><span class="misc">,</span><span class="number">0</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._length</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">length</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._wpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._fillcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._wcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にプロパティを設定</span></Line>  <Line no="45" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">__initLength</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">__initWritePolicy</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">__initReadPolicy</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ長設定、取得</span></Line>  <Line no="53" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n バッファ長</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス(nがnilの場合は長さ)</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常に設定完了、NOT_SUPPORTED：長さが不正</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">length</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._length</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="62" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.NOT_SUPPORTED</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._length</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">reset</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="70" valid="False" visited="False"/>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファポインタをリセット</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reset</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._fillcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._wcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._wpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="False" visited="False"/>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定位置まで書き込みポインタを進めた場合のバッファ取得</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 現在の位置のバッファ</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">wptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="83" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="84" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">[</span><span class="misc">(</span><span class="identifier">self._wpos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self._length</span><span class="misc">)</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="identifier">self._length</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">]</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="88" valid="False" visited="False"/>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 書き込みポインタの位置を進める</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常に位置設定完了、PRECONDITION_NOT_MET：移動不可</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">advanceWptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="identifier">n</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="misc">(</span><span class="identifier">self._length</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self._fillcount</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">or</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">(</span><span class="identifier">n</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="misc">(</span><span class="operator">-</span><span class="identifier">self._fillcount</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="102" valid="False" visited="False"/>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._wpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">self._wpos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self._length</span><span class="misc">)</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="identifier">self._length</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._fillcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._fillcount</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._wcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._wcount</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value データ</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._buffer</span><span class="misc">[</span><span class="identifier">self._wpos</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ書き込み</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value データ</span></Line>  <Line no="119" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nsec タイムアウト時間[ns]</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">write</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">nsec</span><span class="misc">)</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">nsec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">nsec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">full</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">timedwrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._timedwrite</span></Line>  <Line no="131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">overwrite</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._overwrite</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">overwrite</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_FULL</span></Line>  <Line no="136" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">put</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">advanceWptr</span><span class="misc">(</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="143" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 書き込み可能なバッファ残り長さ</span></Line>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 長さ</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">writable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._length</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self._fillcount</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="150" valid="False" visited="False"/>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファフルの判定</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：バッファフル</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">full</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._length</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._fillcount</span><span class="misc">)</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="False" visited="False"/>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定位置まで読み込みポインタを進めた場合のバッファ取得</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 現在の位置のバッファ</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">rptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="162" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">[</span><span class="misc">(</span><span class="identifier">self._rpos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self._length</span><span class="misc">)</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="identifier">self._length</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span><span class="misc">]</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="166" valid="False" visited="False"/>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 読み込みポインタの位置を進める</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param n ポインタの位置</span></Line>  <Line no="169" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常に位置設定、PRECONDITION_NOT_MET：位置が不正</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="175" valid="False" visited="False"/>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="identifier">n</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="identifier">self._fillcount</span><span class="misc">)</span>&nbsp;<span class="keyword">or</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">(</span><span class="identifier">n</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="misc">(</span><span class="identifier">self._fillcount</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self._length</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.PRECONDITION_NOT_MET</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="False" visited="False"/>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">self._rpos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self._length</span><span class="misc">)</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="identifier">self._length</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._fillcount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._fillcount</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">n</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="185" valid="False" visited="False"/>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value value._dataにデータ格納</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス(valueがnilの場合はバッファの値を返す)</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="191" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">[</span><span class="identifier">self._rpos</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value._data</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._buffer</span><span class="misc">[</span><span class="identifier">self._rpos</span><span class="operator">+</span><span class="number">1</span><span class="misc">]</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データ読み込み</span></Line>  <Line no="199" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value value._dataにデータ格納</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sec タイムアウト時間[s]、デフォルトは-1</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param nsec タイムアウト時間[ns]、デフォルトは0</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return バッファステータス</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- BUFFER_OK：正常にデータ読み込み、BUFFER_EMPTY：バッファが空</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">read</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">nsec</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="207" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">nsec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">nsec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">empty</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">timedread</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._timedread</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">readback</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._readback</span></Line>  <Line no="214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">readback</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="identifier">self._wcount</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_EMPTY</span></Line>  <Line no="217" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="219" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_EMPTY</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">get</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">advanceRptr</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">BufferStatus.BUFFER_OK</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="False" visited="False"/>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 読み込み可能なデータ長さ取得</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return データ長さ</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">readable</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._fillcount</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファが空かの判定</span></Line>  <Line no="234" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：空</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">empty</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._fillcount</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span><span class="misc">)</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にバッファ長さ設定</span></Line>  <Line no="239" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">__initLength</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"length"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">n</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">length</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ書き込み時のポリシー設定</span></Line>  <Line no="247" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">__initWritePolicy</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.normalize</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"write.full_policy"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"overwrite"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="251" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._overwrite</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="252" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._timedwrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"do_nothing"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._overwrite</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="255" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._timedwrite</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="257" valid="False" visited="False"/>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="259" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- バッファ読み込み時のポリシー設定</span></Line>  <Line no="260" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">__initReadPolicy</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.normalize</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"read.empty_policy"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"readback"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="264" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._readback</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="265" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._timedread</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">policy</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"do_nothing"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._readback</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._timedread</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reset</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="272" valid="False" visited="False"/>  <Line no="273" valid="False" visited="False"/>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="275" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="276" valid="False" visited="False"/>  <Line no="277" valid="False" visited="False"/>  <Line no="278" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">RingBuffer</span></Line>  <FileSummary valid="155" visited="141" totalLines="278" coverage="90"/> </File> <File name="lua\openrtm\RTCUtil.lua" anchor="lua_openrtm_RTCUtil_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file RTCUtil.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTCヘルパ関数</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="10" valid="True" visited="True">	<span class="blockcomment">local&nbsp;RTCUtil=&nbsp;{}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="blockcomment">--_G["openrtm.RTCUtil"]&nbsp;=&nbsp;RTCUtil</span></Line>  <Line no="12" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="14" valid="True" visited="True">	<span class="blockcomment">local&nbsp;oil&nbsp;=&nbsp;require&nbsp;"oil"</span></Line>  <Line no="15" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="16" valid="False" visited="False">	<span class="blockcomment">--&nbsp;オブジェクトのプロキシサーバント生成</span></Line>  <Line no="17" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;orb&nbsp;ORB</span></Line>  <Line no="18" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;ior&nbsp;IOR文字列</span></Line>  <Line no="19" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;idl&nbsp;IDLファイル</span></Line>  <Line no="20" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;サーバント</span></Line>  <Line no="21" valid="False" visited="False">	<span class="blockcomment">RTCUtil.newproxy&nbsp;=&nbsp;function(orb,&nbsp;ior,&nbsp;idl)</span></Line>  <Line no="22" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;type(ior)&nbsp;==&nbsp;"table"&nbsp;then</span></Line>  <Line no="23" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;ior.getObjRef&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="24" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return&nbsp;ior:getObjRef()</span></Line>  <Line no="25" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;end</span></Line>  <Line no="26" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="27" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;oil.VERSION&nbsp;==&nbsp;"OiL&nbsp;0.4&nbsp;beta"&nbsp;then</span></Line>  <Line no="28" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;orb:newproxy(ior,idl)</span></Line>  <Line no="29" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;oil.VERSION&nbsp;==&nbsp;"OiL&nbsp;0.5"&nbsp;then</span></Line>  <Line no="30" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;orb:newproxy(ior,nil,idl)</span></Line>  <Line no="31" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="32" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;nil</span></Line>  <Line no="33" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="34" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="35" valid="False" visited="False">	<span class="blockcomment">--&nbsp;オブジェクトリファレンス取得</span></Line>  <Line no="36" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;orb&nbsp;ORB</span></Line>  <Line no="37" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;servant&nbsp;サーバント</span></Line>  <Line no="38" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;idl&nbsp;IDLファイル</span></Line>  <Line no="39" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;オブジェクトリファレンス</span></Line>  <Line no="40" valid="False" visited="False">	<span class="blockcomment">RTCUtil.getReference&nbsp;=&nbsp;function(orb,&nbsp;servant,&nbsp;idl)</span></Line>  <Line no="41" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;oil.VERSION&nbsp;==&nbsp;"OiL&nbsp;0.4&nbsp;beta"&nbsp;then</span></Line>  <Line no="42" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;local&nbsp;ior&nbsp;=&nbsp;orb:tostring(servant)</span></Line>  <Line no="43" valid="True" visited="False">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;RTCUtil.newproxy(orb,&nbsp;ior,&nbsp;idl)</span></Line>  <Line no="44" valid="True" visited="True">	<span class="blockcomment">&nbsp;elseif&nbsp;oil.VERSION&nbsp;==&nbsp;"OiL&nbsp;0.5"&nbsp;then</span></Line>  <Line no="45" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;return&nbsp;servant</span></Line>  <Line no="46" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="47" valid="True" visited="False">	<span class="blockcomment">&nbsp;return&nbsp;nil</span></Line>  <Line no="48" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="49" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="50" valid="False" visited="False">	<span class="blockcomment">--&nbsp;データのインスタンスをデータ型から取得</span></Line>  <Line no="51" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;data_type&nbsp;データ型(文字列)</span></Line>  <Line no="52" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@return&nbsp;データのインスタンス</span></Line>  <Line no="53" valid="False" visited="False">	<span class="blockcomment">RTCUtil.instantiateDataType&nbsp;=&nbsp;function(data_type)</span></Line>  <Line no="54" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;Manager&nbsp;=&nbsp;require&nbsp;"openrtm.Manager"</span></Line>  <Line no="55" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;orb&nbsp;=&nbsp;Manager:getORB()</span></Line>  <Line no="56" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;data&nbsp;=&nbsp;orb.types:lookup(data_type)</span></Line>  <Line no="57" valid="True" visited="True">	<span class="blockcomment">&nbsp;local&nbsp;ret&nbsp;=&nbsp;{}</span></Line>  <Line no="58" valid="True" visited="True">	<span class="blockcomment">&nbsp;for&nbsp;k,v&nbsp;in&nbsp;pairs(data.fields)&nbsp;do</span></Line>  <Line no="59" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;RTCUtil.getDataType(v,&nbsp;ret)</span></Line>  <Line no="60" valid="False" visited="False">	<span class="blockcomment">&nbsp;end</span></Line>  <Line no="61" valid="True" visited="True">	<span class="blockcomment">&nbsp;return&nbsp;ret</span></Line>  <Line no="62" valid="False" visited="False">	<span class="blockcomment">&nbsp;--return&nbsp;{tm={sec=0,nsec=0},data={}}</span></Line>  <Line no="63" valid="True" visited="True">	<span class="blockcomment">end</span></Line>  <Line no="64" valid="False" visited="False">	<span class="blockcomment"></span></Line>  <Line no="65" valid="False" visited="False">	<span class="blockcomment">--&nbsp;データの要素を抽出する</span></Line>  <Line no="66" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;data&nbsp;データ</span></Line>  <Line no="67" valid="False" visited="False">	<span class="blockcomment">--&nbsp;@param&nbsp;ret&nbsp;データのインスタンス</span></Line>  <Line no="68" valid="False" visited="False">	<span class="blockcomment">RTCUtil.getDataType&nbsp;=&nbsp;function(data,&nbsp;ret)</span></Line>  <Line no="69" valid="True" visited="True">	<span class="blockcomment">&nbsp;if&nbsp;data.type_def&nbsp;~=&nbsp;nil&nbsp;then</span></Line>  <Line no="70" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--print(data.type_def._type)</span></Line>  <Line no="71" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;if&nbsp;data.type_def._type&nbsp;==&nbsp;"struct"&nbsp;then</span></Line>  <Line no="72" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;{}</span></Line>  <Line no="73" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"ulong"&nbsp;then</span></Line>  <Line no="74" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="75" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="76" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"long"&nbsp;then</span></Line>  <Line no="77" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="78" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="79" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"short"&nbsp;then</span></Line>  <Line no="80" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="81" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="82" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"ushort"&nbsp;then</span></Line>  <Line no="83" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="84" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="85" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"octet"&nbsp;then</span></Line>  <Line no="86" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0x00</span></Line>  <Line no="87" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="88" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"string"&nbsp;then</span></Line>  <Line no="89" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;""</span></Line>  <Line no="90" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="91" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"float"&nbsp;then</span></Line>  <Line no="92" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="93" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="94" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"double"&nbsp;then</span></Line>  <Line no="95" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="96" valid="True" visited="True">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="97" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--[[</span></Line>  <Line no="98" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"ufloat"&nbsp;then</span></Line>  <Line no="99" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="100" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="101" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;elseif&nbsp;data.type_def._type&nbsp;==&nbsp;"udouble"&nbsp;then</span></Line>  <Line no="102" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;ret[data.name]&nbsp;=&nbsp;0</span></Line>  <Line no="103" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;&nbsp;return</span></Line>  <Line no="104" valid="False" visited="False">	<span class="blockcomment">&nbsp;&nbsp;--]]</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">data.type_def._type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"char"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="106" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">data.name</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="107" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">data.type_def._type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"boolean"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">data.name</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">data.type_def._type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"sequence"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">data.name</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="115" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">data.name</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="116" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">data.type_def.fields</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">RTCUtil.getDataType</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">data.name</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="122" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="123" valid="False" visited="False"/>  <Line no="124" valid="False" visited="False"/>  <Line no="125" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">RTCUtil</span></Line>  <FileSummary valid="68" visited="59" totalLines="125" coverage="86"/> </File> <File name="lua\openrtm\RTObject.lua" anchor="lua_openrtm_RTObject_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file RTObject.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTC基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTObject</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.RTObject"] = RTObject</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortAdmin</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.PortAdmin"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ConfigAdmin</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ConfigAdmin"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceAdmin</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.SdoServiceAdmin"</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoConfiguration</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.SdoConfiguration"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Configuration_impl</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoConfiguration.Configuration_impl</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ComponentActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ComponentActionListener"</span></Line>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ComponentActionListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.ComponentActionListeners</span></Line>  <Line no="22" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortConnectListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.PortConnectListener"</span></Line>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortConnectListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PortConnectListener.PortConnectListeners</span></Line>  <Line no="24" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ManagerConfig</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ManagerConfig"</span></Line>  <Line no="25" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextBase"</span></Line>  <Line no="26" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextBase.ExecutionContextFactory</span></Line>  <Line no="27" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="28" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="29" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">CORBA_SeqUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.CORBA_SeqUtil"</span></Line>  <Line no="30" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="31" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PreComponentActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PreComponentActionListenerType</span></Line>  <Line no="32" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PostComponentActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PostComponentActionListenerType</span></Line>  <Line no="33" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PortActionListenerType</span></Line>  <Line no="34" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextActionListenerType</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.ExecutionContextActionListenerType</span></Line>  <Line no="35" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PreComponentActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PreComponentActionListener</span></Line>  <Line no="36" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PostComponentActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PostComponentActionListener</span></Line>  <Line no="37" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">PortActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.PortActionListener</span></Line>  <Line no="38" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextActionListener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.ExecutionContextActionListener</span></Line>  <Line no="39" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ComponentActionListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListener.ComponentActionListeners</span></Line>  <Line no="40" valid="False" visited="False"/>  <Line no="41" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">uuid</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"uuid"</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="True" visited="True">	<span class="identifier">RTObject.ECOTHER_OFFSET</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1000</span></Line>  <Line no="45" valid="False" visited="False"/>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">default_conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"implementation_id"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"type_name"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"description"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"version"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"vendor"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"category"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"activity_type"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"max_instance"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"language"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"lang_type"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;<span class="misc">[</span><span class="string">"conf"</span><span class="misc">]</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span></Line>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ec_copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="False" visited="False">	<span class="comment">-- 実行コンテキストのリストを連結する関数オブジェクト初期化</span></Line>  <Line no="65" valid="False" visited="False">	<span class="comment">-- @param eclist 連結先のリスト</span></Line>  <Line no="66" valid="False" visited="False">	<span class="comment">-- @return 実行コンテキストのリストを連結する関数オブジェクト</span></Line>  <Line no="67" valid="False" visited="False">	<span class="identifier">ec_copy.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">eclist</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._eclist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">eclist</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのリストを連結する</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ecs 連結元のリスト</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">ecs</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ecs</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._eclist</span><span class="misc">,</span>&nbsp;<span class="identifier">ecs</span><span class="misc">)</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="80" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="False" visited="False"/>  <Line no="84" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ec_find</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="85" valid="False" visited="False"/>  <Line no="86" valid="False" visited="False">	<span class="comment">-- 実行コンテキストのオブジェクトリファレンスが一致するかを確認する関数オブジェクト初期化</span></Line>  <Line no="87" valid="False" visited="False">	<span class="comment">-- @param _ec 実行コンテキスト</span></Line>  <Line no="88" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="89" valid="False" visited="False">	<span class="identifier">ec_find.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_ec</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_ec</span></Line>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False"/>  <Line no="94" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのオブジェクトリファレンスが一致するかを確認する</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ecs 実行コンテキスト</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">ecs</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ecs</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._ec, #ecs)</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for k, v in pairs(self._ec) do</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print( k, v )</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="108" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._ec:get_profile())</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._ec, ecs)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">self._ec</span><span class="misc">,</span>&nbsp;<span class="identifier">ecs</span><span class="misc">,</span>&nbsp;<span class="identifier">self._ec.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">ecs.getObjRef</span><span class="misc">)</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local Manager = require "openrtm.Manager"</span></Line>  <Line no="112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local orb = Manager:instance():getORB()</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--ret = (orb:tostring(self._ec) == orb:tostring(ec))</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="126" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">svc_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_id</span><span class="misc">)</span></Line>  <Line no="130" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="131" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_id</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="134" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self._id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">prof.id</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="136" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="138" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="False" visited="False">	<span class="comment">-- RTC基底オブジェクト初期化</span></Line>  <Line no="141" valid="False" visited="False">	<span class="comment">-- @param manager マネージャ</span></Line>  <Line no="142" valid="False" visited="False">	<span class="comment">-- @return RTC</span></Line>  <Line no="143" valid="False" visited="False">	<span class="identifier">RTObject.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">manager</span><span class="misc">)</span></Line>  <Line no="144" valid="False" visited="False"/>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(manager)</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">manager</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="150" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj._orb)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portAdmin</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PortAdmin.new</span><span class="misc">(</span><span class="identifier">obj._manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._manager</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"rtobject"</span><span class="misc">)</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._created</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">defaults_map</span><span class="operator">=</span><span class="identifier">default_conf</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj._properties:getNode("conf"),type(obj._properties:getNode("conf")))</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configsets</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ConfigAdmin.new</span><span class="misc">(</span><span class="identifier">obj._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"conf"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">instance_name</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">type_name</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"description"</span><span class="misc">,</span><span class="identifier">version</span><span class="operator">=</span><span class="string">"0"</span><span class="misc">,</span>&nbsp;<span class="identifier">vendor</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">category</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">port_profiles</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">parent</span><span class="operator">=</span><span class="identifier">oil.corba.idl.null</span><span class="misc">,</span><span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"implementation_id"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"type_name"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"description"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"version"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"vendor"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"category"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"activity_type"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"max_instance"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"language"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span><span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"lang_type"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span><span class="misc">,</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">{</span><span class="identifier">name</span><span class="operator">=</span><span class="string">"instance_name"</span><span class="misc">,</span><span class="identifier">value</span><span class="operator">=</span><span class="string">""</span><span class="misc">}</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoservice</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceAdmin.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._SdoConfigImpl</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Configuration_impl.new</span><span class="misc">(</span><span class="identifier">obj._configsets</span><span class="misc">,</span><span class="identifier">obj._sdoservice</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._SdoConfig</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._SdoConfigImpl</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._execContexts</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoOwnedOrganizations</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoSvcProfiles</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoOrganization</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoStatus</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ecMine</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ecOther</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._eclist</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._exiting</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._readAll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._writeAll</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._readAllCompletion</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._writeAllCompletion</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._inports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._outports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._actionListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ComponentActionListeners.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._portconnListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">PortConnectListeners.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="191" valid="False" visited="False"/>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._orb.types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="193" valid="False" visited="False"/>  <Line no="194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時のコールバック関数</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onInitialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onInitialize()"</span><span class="misc">)</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了時のコールバック関数</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onFinalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onFinalize()"</span><span class="misc">)</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始時のコールバック関数</span></Line>  <Line no="207" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="208" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onStartup("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止時のコールバック関数</span></Line>  <Line no="214" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onShutdown("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移後のコールバック関数</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="222" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onActivated("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移後のコールバック関数</span></Line>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onDeactivated("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態で実行コンテキストにより駆動されるコールバック関数</span></Line>  <Line no="235" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="236" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onExecute("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態遷移時のコールバック関数</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="244" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onAborting("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="248" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態で実行コンテキストにより駆動されるコールバック関数</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="250" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onError("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行時のコールバック関数</span></Line>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="257" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onReset("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新時のコールバック関数</span></Line>  <Line no="263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="264" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onStateUpdate("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期変更後のコールバック関数</span></Line>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="271" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"onRateChanged("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化</span></Line>  <Line no="277" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">initialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"initialize()"</span><span class="misc">)</span></Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_args_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getContextOptions</span><span class="misc">(</span><span class="identifier">ec_args_</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="283" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Valid EC options are not available. Aborting"</span><span class="misc">)</span></Line>  <Line no="284" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="285" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">createContexts</span><span class="misc">(</span><span class="identifier">ec_args_</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="287" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"EC creation failed. Maybe out of resources. Aborting."</span><span class="misc">)</span></Line>  <Line no="288" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self._rtcout:RTC_INFO(#self._ecMine.." execution context"..toSTR_(self._ecMine).." created.")</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">on_initialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._created</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="294" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"on_initialize() failed."</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="296" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"on_initialize() was properly done."</span><span class="misc">)</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">idx_</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecMine</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="299" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"EC"</span><span class="operator">..</span><span class="identifier">idx_..</span><span class="string">" starting."</span><span class="misc">)</span></Line>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_</span><span class="misc">:</span><span class="identifier">start</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="301" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="305" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"finalize()"</span><span class="misc">)</span></Line>  <Line no="309" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._created</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._exiting</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="310" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._ecOther</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="313" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ecOther</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="314" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">on_finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="319" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティ取得</span></Line>  <Line no="320" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロパティ</span></Line>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="322" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getProperties()"</span><span class="misc">)</span></Line>  <Line no="323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._properties</span></Line>  <Line no="324" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="325" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インスタンス名取得</span></Line>  <Line no="326" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return インスタンス名</span></Line>  <Line no="327" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getInstanceName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="328" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getInstanceName()"</span><span class="misc">)</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile.instance_name</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インスタンス名設定</span></Line>  <Line no="332" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param instance_name インスタンス名</span></Line>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInstanceName</span><span class="misc">(</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setInstanceName("</span><span class="operator">..</span><span class="identifier">instance_name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">,</span><span class="identifier">instance_name</span><span class="misc">)</span></Line>  <Line no="336" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">)</span></Line>  <Line no="337" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="338" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 型名取得</span></Line>  <Line no="339" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 型名</span></Line>  <Line no="340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getTypeName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getTypeName()"</span><span class="misc">)</span></Line>  <Line no="342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile.type_name</span></Line>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="344" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- カテゴリ名取得</span></Line>  <Line no="345" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return カテゴリ名</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getCategory</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getCategory()"</span><span class="misc">)</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._profile.category</span></Line>  <Line no="349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="350" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロパティ設定</span></Line>  <Line no="351" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="353" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"setProperties()"</span><span class="misc">)</span></Line>  <Line no="354" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">)</span></Line>  <Line no="356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.type_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"type_name"</span><span class="misc">)</span></Line>  <Line no="357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.description</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"description"</span><span class="misc">)</span></Line>  <Line no="358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.version</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"version"</span><span class="misc">)</span></Line>  <Line no="359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.vendor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"vendor"</span><span class="misc">)</span></Line>  <Line no="360" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._profile.category</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"category"</span><span class="misc">)</span></Line>  <Line no="361" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="362" valid="False" visited="False"/>  <Line no="363" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="364" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getObjRef()"</span><span class="misc">)</span></Line>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="369" valid="False" visited="False"/>  <Line no="370" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- Manager全体で設定したグローバルな実行コンテキストの設定取得</span></Line>  <Line no="371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param global_ec_props 実行コンテキストの設定</span></Line>  <Line no="372" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getGlobalContextOptions</span><span class="misc">(</span><span class="identifier">global_ec_props</span><span class="misc">)</span></Line>  <Line no="374" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getGlobalContextOptions()"</span><span class="misc">)</span></Line>  <Line no="375" valid="False" visited="False"/>  <Line no="376" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">findNode</span><span class="misc">(</span><span class="string">"exec_cxt.periodic"</span><span class="misc">)</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="378" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"No global EC options found."</span><span class="misc">)</span></Line>  <Line no="379" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="380" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="381" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop_)</span></Line>  <Line no="382" valid="False" visited="False"/>  <Line no="383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Global EC options are specified."</span><span class="misc">)</span></Line>  <Line no="384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">prop_</span><span class="misc">)</span></Line>  <Line no="385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getInheritedECOptions</span><span class="misc">(</span><span class="identifier">global_ec_props</span><span class="misc">)</span></Line>  <Line no="386" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">global_ec_props</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">prop_</span><span class="misc">)</span></Line>  <Line no="387" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="388" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="389" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTC固有の実行コンテキストの設定取得</span></Line>  <Line no="390" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_args 実行コンテキストの設定</span></Line>  <Line no="391" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="392" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getPrivateContextOptions</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span></Line>  <Line no="393" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getPrivateContextOptions()"</span><span class="misc">)</span></Line>  <Line no="394" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._properties.findNode</span><span class="misc">(</span><span class="string">"execution_contexts"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"No component specific EC specified."</span><span class="misc">)</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="397" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="398" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="400" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 引数に実行コンテキストのオプションを追加する</span></Line>  <Line no="401" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param default_opts オプション</span></Line>  <Line no="402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getInheritedECOptions</span><span class="misc">(</span><span class="identifier">default_opts</span><span class="misc">)</span></Line>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getPrivateContextOptions()"</span><span class="misc">)</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="406" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="407" valid="False" visited="False"/>  <Line no="408" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのオプション取得</span></Line>  <Line no="409" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_args 実行コンテキストのオプション</span></Line>  <Line no="410" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="411" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getContextOptions</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span></Line>  <Line no="412" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"getContextOptions()"</span><span class="misc">)</span></Line>  <Line no="413" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">global_props_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_global_</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getGlobalContextOptions</span><span class="misc">(</span><span class="identifier">global_props_</span><span class="misc">)</span></Line>  <Line no="415" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_private_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getPrivateContextOptions</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span></Line>  <Line no="416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_global_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">ret_private_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="417" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="418" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="419" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ret_global_, ret_private_)</span></Line>  <Line no="420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret_global_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">ret_private_</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="421" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">,</span><span class="identifier">global_props_</span><span class="misc">)</span></Line>  <Line no="422" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="424" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="425" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト生成</span></Line>  <Line no="426" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_args オプション</span></Line>  <Line no="427" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createContexts</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span></Line>  <Line no="429" valid="False" visited="False"/>  <Line no="430" valid="False" visited="False"/>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="432" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">avail_ec_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getIdentifiers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="433" valid="False" visited="False"/>  <Line no="434" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#ec_args)</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">ec_arg_</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">ec_args</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_type_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_arg_</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"type"</span><span class="misc">)</span></Line>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_name_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_arg_</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"name"</span><span class="misc">)</span></Line>  <Line no="438" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(ec_arg_)</span></Line>  <Line no="439" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_aec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">aec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">avail_ec_</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="441" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(aec)</span></Line>  <Line no="442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_type_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">aec</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="443" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret_aec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="444" valid="False" visited="False"/>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="446" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="447" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="448" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">ret_aec</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="449" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"EC "</span><span class="operator">..</span><span class="identifier">ec_type_..</span><span class="string">" is not available."</span><span class="misc">)</span></Line>  <Line no="450" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Available ECs: "</span><span class="operator">..</span></Line>  <Line no="451" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">avail_ec_</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="452" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="453" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">ec_type_</span><span class="misc">)</span></Line>  <Line no="454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">ec_arg_</span><span class="misc">)</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._eclist</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_</span><span class="misc">)</span></Line>  <Line no="456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_</span><span class="misc">:</span><span class="identifier">bindComponent</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="457" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="458" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="459" valid="False" visited="False"/>  <Line no="460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">self._eclist</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="461" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">default_opts</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="462" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_type_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"PeriodicExecutionContext"</span></Line>  <Line no="463" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">ec_type_</span><span class="misc">)</span></Line>  <Line no="464" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">default_opts</span><span class="misc">)</span></Line>  <Line no="465" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._eclist</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_</span><span class="misc">)</span></Line>  <Line no="466" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_</span><span class="misc">:</span><span class="identifier">bindComponent</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret_</span></Line>  <Line no="469" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="470" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時コールバック関数実行</span></Line>  <Line no="471" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="472" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_initialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="473" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_initialize()"</span><span class="misc">)</span></Line>  <Line no="474" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="475" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="476" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="477" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnInitialize</span><span class="misc">(</span><span class="number">0</span><span class="misc">)</span></Line>  <Line no="478" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Calling onInitialize()."</span><span class="misc">)</span></Line>  <Line no="479" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onInitialize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="480" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="481" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"onInitialize() returns an ERROR ("</span><span class="operator">..</span><span class="identifier">ret..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="482" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="483" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"onInitialize() succeeded."</span><span class="misc">)</span></Line>  <Line no="484" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="487" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="488" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="489" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="490" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">active_set</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"configuration.active_config"</span><span class="misc">,</span></Line>  <Line no="491" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"default"</span><span class="misc">)</span></Line>  <Line no="492" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">haveConfig</span><span class="misc">(</span><span class="identifier">active_set</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="493" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Active configuration set: "</span><span class="operator">..</span><span class="identifier">active_set..</span><span class="string">" exists."</span><span class="misc">)</span></Line>  <Line no="494" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">activateConfigurationSet</span><span class="misc">(</span><span class="identifier">active_set</span><span class="misc">)</span></Line>  <Line no="495" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">active_set</span><span class="misc">)</span></Line>  <Line no="496" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Initial active configuration set is "</span><span class="operator">..</span><span class="identifier">active_set..</span><span class="string">"."</span><span class="misc">)</span></Line>  <Line no="497" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="498" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Active configuration set: "</span><span class="operator">..</span><span class="identifier">active_set..</span><span class="string">" does not exists."</span><span class="misc">)</span></Line>  <Line no="499" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">activateConfigurationSet</span><span class="misc">(</span><span class="string">"default"</span><span class="misc">)</span></Line>  <Line no="500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="string">"default"</span><span class="misc">)</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Initial active configuration set is default-set."</span><span class="misc">)</span></Line>  <Line no="502" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="503" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnInitialize</span><span class="misc">(</span><span class="number">0</span><span class="misc">)</span></Line>  <Line no="504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="505" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="506" valid="False" visited="False"/>  <Line no="507" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストの関連付け</span></Line>  <Line no="508" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param exec_context 実行コンテキスト</span></Line>  <Line no="509" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキストのID</span></Line>  <Line no="510" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindContext</span><span class="misc">(</span><span class="identifier">exec_context</span><span class="misc">)</span></Line>  <Line no="511" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exec_context)</span></Line>  <Line no="512" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"bindContext()"</span><span class="misc">)</span></Line>  <Line no="513" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">exec_context</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="514" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="515" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span><span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">self._ecMine</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="517" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._ecMine</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="518" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ecMine</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">exec_context</span></Line>  <Line no="519" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAttachExecutionContext</span><span class="misc">(</span><span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="520" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">i</span><span class="operator">-</span><span class="number">1</span></Line>  <Line no="521" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="522" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="523" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._ecMine</span><span class="misc">,</span>&nbsp;<span class="identifier">exec_context</span><span class="misc">)</span></Line>  <Line no="524" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">#</span><span class="identifier">self._ecMine</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="526" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始時コールバック関数実行</span></Line>  <Line no="527" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="528" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="529" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_startup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_startup("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="531" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="532" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="533" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="534" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="535" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="536" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="537" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="538" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="539" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="540" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="541" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="542" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="544" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止時コールバック関数実行</span></Line>  <Line no="545" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="546" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_shutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="548" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_shutdown("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="549" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="550" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="551" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="552" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="553" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="554" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="555" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="556" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="557" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="558" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="559" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="560" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="561" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="562" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移後コールバック関数実行</span></Line>  <Line no="563" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="564" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="565" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_activated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="566" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_activated("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="567" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="568" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("on_activated1")</span></Line>  <Line no="569" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="570" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="571" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="572" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="574" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">activatePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="575" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="576" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="577" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="578" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="579" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="580" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="581" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="582" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(type(ret))</span></Line>  <Line no="583" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="584" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="585" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移後コールバック関数実行</span></Line>  <Line no="586" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="587" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="588" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_deactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="589" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_deactivated("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="590" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="591" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="592" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="593" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="594" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">deactivatePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="595" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="596" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="597" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="598" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="599" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="600" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="601" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="602" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="603" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="604" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態遷移後コールバック関数実行</span></Line>  <Line no="605" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="606" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="607" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_aborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="608" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_aborting("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="609" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="610" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="611" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="612" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="613" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="614" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="615" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="616" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="617" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="618" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="619" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="620" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="621" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="622" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態時コールバック関数実行</span></Line>  <Line no="623" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="624" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="625" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_error</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="626" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_error("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="627" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="628" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="629" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="630" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="631" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="632" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="633" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="634" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="635" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="636" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="637" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="638" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="639" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="640" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="641" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行時コールバック関数実行</span></Line>  <Line no="642" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="643" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="644" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_reset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="645" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_reset("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="646" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="647" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="648" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="649" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="650" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="651" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="652" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="653" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="654" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="655" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="656" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="657" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="658" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="659" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態時コールバック関数実行</span></Line>  <Line no="660" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="661" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="662" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_execute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="663" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_execute("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="664" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="665" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="666" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="667" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._readAll</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="668" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">readAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="669" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="670" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="671" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="672" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._writeAll</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="673" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">writeAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="674" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="675" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="676" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="677" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="678" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="679" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="680" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="681" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="682" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="683" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新時コールバック関数実行</span></Line>  <Line no="684" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="685" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="686" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_state_update</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="687" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_state_update("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="688" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="689" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="690" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="691" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="692" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="693" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="694" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="695" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="696" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="697" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="698" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="699" valid="False" visited="False"/>  <Line no="700" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="701" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="702" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="703" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期変更時コールバック関数実行</span></Line>  <Line no="704" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="705" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="706" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_rate_changed</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="707" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_rate_changed("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="708" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="709" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="710" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="711" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="712" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="713" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="714" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="715" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="716" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="717" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="718" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="719" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="720" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="721" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全ポート読み込み</span></Line>  <Line no="722" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">readAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="723" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"readAll()"</span><span class="misc">)</span></Line>  <Line no="724" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="725" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全ポート書き込み</span></Line>  <Line no="726" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">writeAll</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="727" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"writeAll()"</span><span class="misc">)</span></Line>  <Line no="728" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="729" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="730" valid="False" visited="False"/>  <Line no="731" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addPreComponentActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">memfunc</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="732" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="733" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="734" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="735" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Noname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="736" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="737" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Noname.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="738" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="739" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ComponentActionListener.PreComponentActionListener.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="740" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj._memfunc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">memfunc</span></Line>  <Line no="741" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="742" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._memfunc</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="743" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="744" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="745" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="746" valid="False" visited="False"/>  <Line no="747" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Noname.new</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="748" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="749" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="750" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="751" valid="False" visited="False"/>  <Line no="752" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removePreComponentActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="753" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="754" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="755" valid="False" visited="False"/>  <Line no="756" valid="False" visited="False"/>  <Line no="757" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addPostComponentActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">memfunc</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="758" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="759" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="760" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="761" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Noname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="762" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="763" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Noname.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="764" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="765" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ComponentActionListener.PostComponentActionListener.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="766" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj._memfunc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">memfunc</span></Line>  <Line no="767" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="768" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._memfunc</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="769" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="770" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="771" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="772" valid="False" visited="False"/>  <Line no="773" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Noname.new</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="774" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="775" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="776" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="777" valid="False" visited="False"/>  <Line no="778" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removePostComponentActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="779" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="780" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="781" valid="False" visited="False"/>  <Line no="782" valid="False" visited="False"/>  <Line no="783" valid="False" visited="False"/>  <Line no="784" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addPortActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">memfunc</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="785" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="786" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="787" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="788" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Noname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="789" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Noname.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="790" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="791" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ComponentActionListener.PortActionListener.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="792" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj._memfunc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">memfunc</span></Line>  <Line no="793" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="794" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._memfunc</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="795" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="796" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="797" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="798" valid="False" visited="False"/>  <Line no="799" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Noname.new</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="800" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.portaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="801" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="802" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="803" valid="False" visited="False"/>  <Line no="804" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removePortActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="805" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="806" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="807" valid="False" visited="False"/>  <Line no="808" valid="False" visited="False"/>  <Line no="809" valid="False" visited="False"/>  <Line no="810" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addExecutionContextActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">memfunc</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="811" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="812" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">autoclean</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="813" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="814" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Noname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="815" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Noname.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="816" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="817" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">_obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">ComponentActionListener.ExecutionContextActionListener.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="818" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_obj._memfunc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">memfunc</span></Line>  <Line no="819" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">_obj</span><span class="misc">:</span><span class="identifier">call</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="820" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._memfunc</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="821" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="822" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_obj</span></Line>  <Line no="823" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="824" valid="False" visited="False"/>  <Line no="825" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">listener</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Noname.new</span><span class="misc">(</span><span class="identifier">memfunc</span><span class="misc">)</span></Line>  <Line no="826" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.ecaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">addListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">,</span>&nbsp;<span class="identifier">autoclean</span><span class="misc">)</span></Line>  <Line no="827" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">listener</span></Line>  <Line no="828" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="829" valid="False" visited="False"/>  <Line no="830" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeExecutionContextActionListener</span><span class="misc">(</span><span class="identifier">listener_type</span><span class="misc">,</span>&nbsp;<span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="831" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.ecaction_</span><span class="misc">[</span><span class="identifier">listener_type</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">removeListener</span><span class="misc">(</span><span class="identifier">listener</span><span class="misc">)</span></Line>  <Line no="832" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="833" valid="False" visited="False"/>  <Line no="834" valid="False" visited="False"/>  <Line no="835" valid="False" visited="False"/>  <Line no="836" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化前のコールバック関数</span></Line>  <Line no="837" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="838" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnInitialize</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="839" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_INITIALIZE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="840" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="841" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了前のコールバック関数</span></Line>  <Line no="842" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="843" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnFinalize</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="844" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_FINALIZE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="845" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="846" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始前のコールバック関数</span></Line>  <Line no="847" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="848" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="849" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_STARTUP</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="850" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="851" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止前のコールバック関数</span></Line>  <Line no="852" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="853" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="854" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_SHUTDOWN</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="855" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="856" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化前のコールバック関数</span></Line>  <Line no="857" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="858" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="859" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_ACTIVATED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="860" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="861" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化前のコールバック関数</span></Line>  <Line no="862" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="863" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="864" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_DEACTIVATED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="865" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="866" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態遷移前のコールバック関数</span></Line>  <Line no="867" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="868" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="869" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_ABORTING</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="870" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="871" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態コールバック関数実行前のコールバック関数</span></Line>  <Line no="872" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="873" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="874" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="875" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="876" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行前のコールバック関数</span></Line>  <Line no="877" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="878" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="879" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_RESET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="880" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="881" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態コールバック関数実行前のコールバック関数</span></Line>  <Line no="882" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="883" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="884" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_EXECUTE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="885" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="886" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新前のコールバック関数</span></Line>  <Line no="887" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="888" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="889" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_STATE_UPDATE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="890" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="891" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期変更前のコールバック関数</span></Line>  <Line no="892" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="893" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">preOnRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="894" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.preaction_</span><span class="misc">[</span><span class="identifier">PreComponentActionListenerType.PRE_ON_RATE_CHANGED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="895" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="896" valid="False" visited="False"/>  <Line no="897" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化後のコールバック関数</span></Line>  <Line no="898" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="899" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnInitialize</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="900" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_INITIALIZE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="901" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="902" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了後のコールバック関数</span></Line>  <Line no="903" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="904" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnFinalize</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="905" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_FINALIZE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="906" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="907" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始後のコールバック関数</span></Line>  <Line no="908" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="909" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnStartup</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="910" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_STARTUP</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="911" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="912" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止後のコールバック関数</span></Line>  <Line no="913" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="914" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnShutdown</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="915" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_SHUTDOWN</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="916" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="917" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ化後のコールバック関数</span></Line>  <Line no="918" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="919" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnActivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="920" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_ACTIVATED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="921" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="922" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ化後のコールバック関数</span></Line>  <Line no="923" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="924" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnDeactivated</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="925" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_DEACTIVATED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="926" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="927" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態遷移後のコールバック関数</span></Line>  <Line no="928" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="929" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnAborting</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="930" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_ABORTING</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="931" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="932" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態コールバック関数実行後のコールバック関数</span></Line>  <Line no="933" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="934" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnError</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="935" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_ERROR</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="936" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="937" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行後のコールバック関数</span></Line>  <Line no="938" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="939" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnReset</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="940" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_RESET</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="941" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="942" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態コールバック関数実行後のコールバック関数</span></Line>  <Line no="943" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="944" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnExecute</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="945" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_EXECUTE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="946" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="947" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新後のコールバック関数</span></Line>  <Line no="948" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="949" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnStateUpdate</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="950" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_STATE_UPDATE</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="951" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="952" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行周期変更後のコールバック関数</span></Line>  <Line no="953" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="954" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">postOnRateChanged</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="955" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.postaction_</span><span class="misc">[</span><span class="identifier">PostComponentActionListenerType.POST_ON_RATE_CHANGED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="956" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="957" valid="False" visited="False"/>  <Line no="958" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータの変数をバインド</span></Line>  <Line no="959" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param param_name パラメータ名</span></Line>  <Line no="960" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param var 変数</span></Line>  <Line no="961" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param def_val デフォルト値</span></Line>  <Line no="962" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param trans 変換関数</span></Line>  <Line no="963" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：バインド成功</span></Line>  <Line no="964" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">bindParameter</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">,</span>&nbsp;<span class="identifier">trans</span><span class="misc">)</span></Line>  <Line no="965" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"bindParameter()"</span><span class="misc">)</span></Line>  <Line no="966" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">trans</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="967" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">trans</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.stringTo</span></Line>  <Line no="968" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="969" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(param_name, var, def_val, trans)</span></Line>  <Line no="970" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">bindParameter</span><span class="misc">(</span><span class="identifier">param_name</span><span class="misc">,</span>&nbsp;<span class="identifier">var</span><span class="misc">,</span>&nbsp;<span class="identifier">def_val</span><span class="misc">,</span>&nbsp;<span class="identifier">trans</span><span class="misc">)</span></Line>  <Line no="971" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="972" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="973" valid="False" visited="False"/>  <Line no="974" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション管理オブジェクト取得</span></Line>  <Line no="975" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーション管理オブジェクト</span></Line>  <Line no="976" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getConfigService</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="977" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._configsets</span></Line>  <Line no="978" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="979" valid="False" visited="False"/>  <Line no="980" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータ更新</span></Line>  <Line no="981" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_set コンフィギュレーションセット</span></Line>  <Line no="982" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">updateParameters</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="983" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"updateParameters("</span><span class="operator">..</span><span class="identifier">config_set..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="984" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">update</span><span class="misc">(</span><span class="identifier">config_set</span><span class="misc">)</span></Line>  <Line no="985" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="986" valid="False" visited="False"/>  <Line no="987" valid="False" visited="False"/>  <Line no="988" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト取得</span></Line>  <Line no="989" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="990" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="991" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getExecutionContext</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="992" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">get_context</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="993" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="994" valid="False" visited="False"/>  <Line no="995" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト取得</span></Line>  <Line no="996" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="997" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト</span></Line>  <Line no="998" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_context</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="999" valid="False" visited="False"/>  <Line no="1000" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_context("</span><span class="operator">..</span><span class="identifier">ec_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="1001" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1002" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1003" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._ecMine</span><span class="misc">[</span><span class="identifier">ec_id</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1004" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ecMine</span><span class="misc">[</span><span class="identifier">ec_id</span><span class="misc">]</span></Line>  <Line no="1005" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="1006" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="1007" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1008" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1009" valid="False" visited="False"/>  <Line no="1010" valid="False" visited="False"/>  <Line no="1011" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span></Line>  <Line no="1012" valid="False" visited="False"/>  <Line no="1013" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._ecOther</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1014" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ecOther</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span></Line>  <Line no="1015" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1016" valid="False" visited="False"/>  <Line no="1017" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="1018" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1019" valid="False" visited="False"/>  <Line no="1020" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 自身がオーナーの実行コンテキスト一覧を取得</span></Line>  <Line no="1021" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト一覧</span></Line>  <Line no="1022" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_owned_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1023" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_owned_contexts()"</span><span class="misc">)</span></Line>  <Line no="1024" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">execlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1025" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.for_each</span><span class="misc">(</span><span class="identifier">self._ecMine</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_copy.new</span><span class="misc">(</span><span class="identifier">execlist</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1026" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#execlist)</span></Line>  <Line no="1027" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">execlist</span></Line>  <Line no="1028" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1029" valid="False" visited="False"/>  <Line no="1030" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 別のRTCがオーナーの実行コンテキスト一覧を取得</span></Line>  <Line no="1031" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 実行コンテキスト一覧</span></Line>  <Line no="1032" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_participating_contexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1033" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_participating_contexts()"</span><span class="misc">)</span></Line>  <Line no="1034" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">execlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1035" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">CORBA_SeqUtil.for_each</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_copy.new</span><span class="misc">(</span><span class="identifier">execlist</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1036" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#self._ecOther)</span></Line>  <Line no="1037" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">execlist</span></Line>  <Line no="1038" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1039" valid="False" visited="False"/>  <Line no="1040" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのIDを取得</span></Line>  <Line no="1041" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param cxt 実行コンテキスト</span></Line>  <Line no="1042" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ID</span></Line>  <Line no="1043" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_context_handle</span><span class="misc">(</span><span class="identifier">cxt</span><span class="misc">)</span></Line>  <Line no="1044" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_context_handle()"</span><span class="misc">)</span></Line>  <Line no="1045" valid="False" visited="False"/>  <Line no="1046" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i,v in ipairs(self._ecMine) do</span></Line>  <Line no="1047" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(v)</span></Line>  <Line no="1048" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="1049" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._ecMine</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_find.new</span><span class="misc">(</span><span class="identifier">cxt</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1050" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(num)</span></Line>  <Line no="1051" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1052" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">num</span><span class="operator">-</span><span class="number">1</span></Line>  <Line no="1053" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1054" valid="False" visited="False"/>  <Line no="1055" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_find.new</span><span class="misc">(</span><span class="identifier">cxt</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1056" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">num</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="operator">-</span><span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1057" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">num</span><span class="operator">-</span><span class="number">1</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1000</span></Line>  <Line no="1058" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1059" valid="False" visited="False"/>  <Line no="1060" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="1061" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1062" valid="False" visited="False"/>  <Line no="1063" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ネームサーバー登録名取得</span></Line>  <Line no="1064" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ネームサーバー登録名</span></Line>  <Line no="1065" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getNamingNames</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1066" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"getNamingNames()"</span><span class="misc">)</span></Line>  <Line no="1067" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._properties)</span></Line>  <Line no="1068" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"naming.names"</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="1069" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1070" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">ret_str</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1071" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseHeadBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1072" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseTailBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1073" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="1074" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1075" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1076" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1077" valid="False" visited="False"/>  <Line no="1078" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーション取得</span></Line>  <Line no="1079" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーション</span></Line>  <Line no="1080" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1081" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration()"</span><span class="misc">)</span></Line>  <Line no="1082" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._SdoConfig</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1083" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InterfaceNotImplemented"</span><span class="misc">,</span></Line>  <Line no="1084" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"InterfaceNotImplemented: get_configuration"</span></Line>  <Line no="1085" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1086" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1087" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._SdoConfig</span></Line>  <Line no="1088" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1089" valid="False" visited="False"/>  <Line no="1090" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート追加</span></Line>  <Line no="1091" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port ポート</span></Line>  <Line no="1092" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1093" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addPort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1094" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addPort()"</span><span class="misc">)</span></Line>  <Line no="1095" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addPort(CorbaPort)"</span><span class="misc">)</span></Line>  <Line no="1096" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">propkey</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"port.corbaport."</span></Line>  <Line no="1097" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span></Line>  <Line no="1098" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1099" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"port.corba"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1101" valid="False" visited="False"/>  <Line no="1102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port</span><span class="misc">:</span><span class="identifier">setOwner</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1104" valid="False" visited="False"/>  <Line no="1105" valid="False" visited="False"/>  <Line no="1106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">addPort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1108" valid="False" visited="False"/>  <Line no="1109" valid="False" visited="False"/>  <Line no="1110" valid="False" visited="False"/>  <Line no="1111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インポート追加</span></Line>  <Line no="1112" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ポート名</span></Line>  <Line no="1113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inport インポート</span></Line>  <Line no="1114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addInPort</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">inport</span><span class="misc">)</span></Line>  <Line no="1116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addInPort("</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="1117" valid="False" visited="False"/>  <Line no="1118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">propkey</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"port.inport."</span><span class="operator">..</span><span class="identifier">name</span></Line>  <Line no="1119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop_</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"port.inport.dataport"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">inport</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop_</span><span class="misc">)</span></Line>  <Line no="1122" valid="False" visited="False"/>  <Line no="1123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">inport</span><span class="misc">:</span><span class="identifier">setOwner</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1124" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">inport</span><span class="misc">:</span><span class="identifier">setPortConnectListenerHolder</span><span class="misc">(</span><span class="identifier">self._portconnListeners</span><span class="misc">)</span></Line>  <Line no="1125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAddPort</span><span class="misc">(</span><span class="identifier">inport</span><span class="misc">:</span><span class="identifier">getPortProfile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1126" valid="False" visited="False"/>  <Line no="1127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">addPort</span><span class="misc">(</span><span class="identifier">inport</span><span class="misc">)</span></Line>  <Line no="1128" valid="False" visited="False"/>  <Line no="1129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addInPort() failed."</span><span class="misc">)</span></Line>  <Line no="1131" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1133" valid="False" visited="False"/>  <Line no="1134" valid="False" visited="False"/>  <Line no="1135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._inports</span><span class="misc">,</span>&nbsp;<span class="identifier">inport</span><span class="misc">)</span></Line>  <Line no="1136" valid="False" visited="False"/>  <Line no="1137" valid="False" visited="False"/>  <Line no="1138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1140" valid="False" visited="False"/>  <Line no="1141" valid="False" visited="False"/>  <Line no="1142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アウトポート追加</span></Line>  <Line no="1143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ポート名</span></Line>  <Line no="1144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inport アウトポート</span></Line>  <Line no="1145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：登録成功、false：登録失敗</span></Line>  <Line no="1146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addOutPort</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">outport</span><span class="misc">)</span></Line>  <Line no="1147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addOutPort("</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="1148" valid="False" visited="False"/>  <Line no="1149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">propkey</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"port.outport."</span><span class="operator">..</span><span class="identifier">name</span></Line>  <Line no="1150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">prop</span><span class="operator">=</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop_</span><span class="misc">:</span><span class="identifier">mergeProperties</span><span class="misc">(</span><span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="string">"port.outport.dataport"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">outport</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">prop_</span><span class="misc">)</span></Line>  <Line no="1153" valid="False" visited="False"/>  <Line no="1154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">outport</span><span class="misc">:</span><span class="identifier">setOwner</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">outport</span><span class="misc">:</span><span class="identifier">setPortConnectListenerHolder</span><span class="misc">(</span><span class="identifier">self._portconnListeners</span><span class="misc">)</span></Line>  <Line no="1156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAddPort</span><span class="misc">(</span><span class="identifier">outport</span><span class="misc">:</span><span class="identifier">getPortProfile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1157" valid="False" visited="False"/>  <Line no="1158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">addPort</span><span class="misc">(</span><span class="identifier">outport</span><span class="misc">)</span></Line>  <Line no="1159" valid="False" visited="False"/>  <Line no="1160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"addOutPort() failed."</span><span class="misc">)</span></Line>  <Line no="1162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1164" valid="False" visited="False"/>  <Line no="1165" valid="False" visited="False"/>  <Line no="1166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._outports</span><span class="misc">,</span>&nbsp;<span class="identifier">outport</span><span class="misc">)</span></Line>  <Line no="1167" valid="False" visited="False"/>  <Line no="1168" valid="False" visited="False"/>  <Line no="1169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1171" valid="False" visited="False"/>  <Line no="1172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- インポート削除</span></Line>  <Line no="1173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ポート名</span></Line>  <Line no="1174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inport インポート</span></Line>  <Line no="1175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="1176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeInPort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeInPort()"</span><span class="misc">)</span></Line>  <Line no="1178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1179" valid="False" visited="False"/>  <Line no="1180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">inport</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._inports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1182" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">inport</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._inports</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="1184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1190" valid="False" visited="False"/>  <Line no="1191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アウトポート削除</span></Line>  <Line no="1192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ポート名</span></Line>  <Line no="1193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param inport アウトポート</span></Line>  <Line no="1194" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="1195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeOutPort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeOutPort()"</span><span class="misc">)</span></Line>  <Line no="1197" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1198" valid="False" visited="False"/>  <Line no="1199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">outport</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._outports</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">port</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">outport</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._outports</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="1203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1204" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1209" valid="False" visited="False"/>  <Line no="1210" valid="False" visited="False"/>  <Line no="1211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート削除</span></Line>  <Line no="1212" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param port ポート</span></Line>  <Line no="1213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功、false：削除失敗</span></Line>  <Line no="1214" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1215" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removePort()"</span><span class="misc">)</span></Line>  <Line no="1216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onRemovePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">:</span><span class="identifier">getPortProfile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">removePort</span><span class="misc">(</span><span class="identifier">port</span><span class="misc">)</span></Line>  <Line no="1218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1219" valid="False" visited="False"/>  <Line no="1220" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- プロファイル取得</span></Line>  <Line no="1221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return プロファイル</span></Line>  <Line no="1222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_component_profile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_component_profile()"</span><span class="misc">)</span></Line>  <Line no="1224" valid="False" visited="False"/>  <Line no="1225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">instance_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">type_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"type_name"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"description"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">version</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"version"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1229" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">vendor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"vendor"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">category</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"category"</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">port_profiles</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">getPortProfileList</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="1232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">parent</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile.parent</span><span class="misc">,</span></Line>  <Line no="1233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._profile.properties</span><span class="misc">}</span></Line>  <Line no="1234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">self._profile.properties</span><span class="misc">,</span>&nbsp;<span class="identifier">self._properties</span><span class="misc">)</span></Line>  <Line no="1235" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(oil.corba.idl.null)</span></Line>  <Line no="1236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prop_</span></Line>  <Line no="1237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1238" valid="False" visited="False"/>  <Line no="1239" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート追加時のコールバック実行</span></Line>  <Line no="1240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param pprof ポートプロファイル</span></Line>  <Line no="1241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAddPort</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="1242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.portaction_</span><span class="misc">[</span><span class="identifier">PortActionListenerType.ADD_PORT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="1243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート削除時のコールバック実行</span></Line>  <Line no="1245" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param pprof ポートプロファイル</span></Line>  <Line no="1246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRemovePort</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="1247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.portaction_</span><span class="misc">[</span><span class="identifier">PortActionListenerType.REMOVE_PORT</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="1248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストアタッチ時のコールバック実行</span></Line>  <Line no="1250" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="1251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAttachExecutionContext</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1252" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.ecaction_</span><span class="misc">[</span><span class="identifier">ExecutionContextActionListenerType.EC_ATTACHED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストデタッチ時のコールバック実行</span></Line>  <Line no="1256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="1257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDetachExecutionContext</span><span class="misc">(</span><span class="identifier">pprof</span><span class="misc">)</span></Line>  <Line no="1258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners.ecaction_</span><span class="misc">[</span><span class="identifier">ExecutionContextActionListenerType.EC_DETACHED</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">notify</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1260" valid="False" visited="False"/>  <Line no="1261" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 生存確認</span></Line>  <Line no="1262" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param exec_context 実行コンテキスト</span></Line>  <Line no="1263" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：生存、false：消滅</span></Line>  <Line no="1264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">is_alive</span><span class="misc">(</span><span class="identifier">exec_context</span><span class="misc">)</span></Line>  <Line no="1265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"is_alive()"</span><span class="misc">)</span></Line>  <Line no="1266" valid="False" visited="False"/>  <Line no="1267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecMine</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if exec_context:_is_equivalent(ec) then</span></Line>  <Line no="1269" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="1270" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1271" valid="False" visited="False"/>  <Line no="1272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">exec_context</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span><span class="misc">,</span>&nbsp;<span class="identifier">exec_context.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">ec.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1276" valid="False" visited="False"/>  <Line no="1277" valid="False" visited="False"/>  <Line no="1278" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1279" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1280" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">exec_context</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span><span class="misc">,</span>&nbsp;<span class="identifier">exec_context.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">ec.getObjRef</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1281" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1283" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1284" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1285" valid="False" visited="False"/>  <Line no="1286" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="1287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1288" valid="False" visited="False"/>  <Line no="1289" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの終了実行</span></Line>  <Line no="1290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="1291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"exit()"</span><span class="misc">)</span></Line>  <Line no="1293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._created</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1294" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="1295" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1296" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._exiting</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="1298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1299" valid="False" visited="False"/>  <Line no="1300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1301" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">NVUtil._non_existent</span><span class="misc">(</span><span class="identifier">ec</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1302" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">remove_component</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1303" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1304" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1305" valid="False" visited="False"/>  <Line no="1306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._exiting</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="1307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1309" valid="False" visited="False"/>  <Line no="1310" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのアタッチ</span></Line>  <Line no="1311" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param exec_context 実行コンテキスト</span></Line>  <Line no="1312" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ID</span></Line>  <Line no="1313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">attach_context</span><span class="misc">(</span><span class="identifier">exec_context</span><span class="misc">)</span></Line>  <Line no="1314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span></Line>  <Line no="1315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"attach_context()"</span><span class="misc">)</span></Line>  <Line no="1316" valid="False" visited="False"/>  <Line no="1317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ecs</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">exec_context</span></Line>  <Line no="1318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ecs</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1319" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="1320" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1321" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1322" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1323" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">oec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1324" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">oec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1325" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ecOther</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ecs</span></Line>  <Line no="1326" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span></Line>  <Line no="1327" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAttachExecutionContext</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1328" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec_id</span></Line>  <Line no="1329" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1330" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1331" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._ecOther</span><span class="misc">,</span><span class="identifier">ecs</span><span class="misc">)</span></Line>  <Line no="1332" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="operator">#</span><span class="identifier">self._ecOther</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span><span class="misc">)</span></Line>  <Line no="1333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onAttachExecutionContext</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1334" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ec_id</span></Line>  <Line no="1335" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキストのデタッチ</span></Line>  <Line no="1337" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ec_id 実行コンテキストのID</span></Line>  <Line no="1338" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコードリターンコード</span></Line>  <Line no="1339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">detach_context</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1340" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ec_id</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="1341" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTObject.ECOTHER_OFFSET</span></Line>  <Line no="1342" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"detach_context(%d)"</span><span class="misc">,</span>&nbsp;<span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">len_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">self._ecOther</span></Line>  <Line no="1344" valid="False" visited="False"/>  <Line no="1345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="misc">(</span><span class="library">tonumber</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">ECOTHER_OFFSET</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="misc">(</span><span class="library">tonumber</span><span class="misc">(</span><span class="identifier">ec_id</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span><span class="misc">)</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="identifier">len_</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1346" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="1347" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1348" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1349" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">ec_id</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">ECOTHER_OFFSET</span><span class="misc">)</span></Line>  <Line no="1350" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">self._ecOther</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">oil.corba.idl.null</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1352" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="1353" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1354" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1355" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;</Line>  <Line no="1356" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._ecOther</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.corba.idl.null</span></Line>  <Line no="1357" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onDetachExecutionContext</span><span class="misc">(</span><span class="identifier">ec_id</span><span class="misc">)</span></Line>  <Line no="1358" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="1359" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1360" valid="False" visited="False"/>  <Line no="1361" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ポート一覧取得</span></Line>  <Line no="1362" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ポート一覧</span></Line>  <Line no="1363" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_ports</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_ports()"</span><span class="misc">)</span></Line>  <Line no="1365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">getPortServiceList</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1367" valid="False" visited="False"/>  <Line no="1368" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス生成</span></Line>  <Line no="1369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/DataFlowComponent:1.0"</span><span class="misc">)</span></Line>  <Line no="1371" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(type(self._svr))</span></Line>  <Line no="1372" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">,</span>&nbsp;<span class="identifier">self._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/DataFlowComponent:1.0"</span><span class="misc">)</span></Line>  <Line no="1373" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1374" valid="False" visited="False"/>  <Line no="1375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了時コールバック実行</span></Line>  <Line no="1376" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="1377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">on_finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"on_finalize()"</span><span class="misc">)</span></Line>  <Line no="1379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="1380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1381" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1382" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">preOnFinalize</span><span class="misc">(</span><span class="number">0</span><span class="misc">)</span></Line>  <Line no="1383" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">onFinalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1384" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1386" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="1387" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="1388" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="1389" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1390" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">postOnFinalize</span><span class="misc">(</span><span class="number">0</span><span class="misc">,</span>&nbsp;<span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="1391" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="1392" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1393" valid="False" visited="False"/>  <Line no="1394" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了処理</span></Line>  <Line no="1395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"shutdown()"</span><span class="misc">)</span></Line>  <Line no="1397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1398" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1399" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">finalizePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1400" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">finalizeContexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1401" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self._orb:deactivate(self._SdoConfigImpl)</span></Line>  <Line no="1402" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self._orb:deactivate(self._objref)</span></Line>  <Line no="1403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._SdoConfigImpl</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="1406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1407" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1408" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1409" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1410" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="1411" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="1412" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1413" valid="False" visited="False"/>  <Line no="1414" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._manager</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1415" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Cleanup on Manager"</span><span class="misc">)</span></Line>  <Line no="1416" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._manager</span><span class="misc">:</span><span class="identifier">notifyFinalized</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="1417" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1418" valid="False" visited="False"/>  <Line no="1419" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._actionListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1420" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portconnListeners</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="1421" valid="False" visited="False"/>  <Line no="1422" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1423" valid="False" visited="False"/>  <Line no="1424" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全ポートの終了</span></Line>  <Line no="1425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">finalizePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1426" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"finalizePorts()"</span><span class="misc">)</span></Line>  <Line no="1427" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._portAdmin</span><span class="misc">:</span><span class="identifier">finalizePorts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._inports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._outports</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1431" valid="False" visited="False"/>  <Line no="1432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 全実行コンテキストの終了</span></Line>  <Line no="1433" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">finalizeContexts</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1434" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"finalizeContexts()"</span><span class="misc">)</span></Line>  <Line no="1435" valid="False" visited="False"/>  <Line no="1436" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">ec</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._eclist</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="1437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">stop</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1438" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="1439" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1440" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">ec._svr</span><span class="misc">)</span></Line>  <Line no="1441" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="1442" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1443" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1444" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ec</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1445" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1446" valid="False" visited="False"/>  <Line no="1447" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._eclist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="1448" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1449" valid="False" visited="False"/>  <Line no="1450" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addSdoServiceProvider</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="1451" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">addSdoServiceProvider</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="1452" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1453" valid="False" visited="False"/>  <Line no="1454" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeSdoServiceProvider</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="1455" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">removeSdoServiceProvider</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="1456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1457" valid="False" visited="False"/>  <Line no="1458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="1459" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">addSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">)</span></Line>  <Line no="1460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1461" valid="False" visited="False"/>  <Line no="1462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="1463" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">removeSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="1464" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1465" valid="False" visited="False"/>  <Line no="1466" valid="False" visited="False"/>  <Line no="1467" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_sdo_service</span><span class="misc">(</span><span class="identifier">_id</span><span class="misc">)</span></Line>  <Line no="1468" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_sdo_service(%s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">_id</span><span class="misc">)</span></Line>  <Line no="1469" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sdoSvcProfiles</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._SdoConfigImpl</span><span class="misc">:</span><span class="identifier">getServiceProfiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="1470" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1472" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="1473" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"get_service(): Empty name."</span></Line>  <Line no="1474" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1475" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1476" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1477" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">CORBA_SeqUtil.find</span><span class="misc">(</span><span class="identifier">self._sdoSvcProfiles</span><span class="misc">,</span>&nbsp;<span class="identifier">svc_name</span><span class="misc">(</span><span class="identifier">_id</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1478" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1479" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">index</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="1480" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="1481" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"get_service(): Not found"</span></Line>  <Line no="1482" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="1483" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1484" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1485" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="1486" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sdoSvcProfiles</span><span class="misc">[</span><span class="identifier">index</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">service</span></Line>  <Line no="1487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="1488" valid="False" visited="False"/>  <Line no="1489" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setInstanceName</span><span class="misc">(</span><span class="identifier">uuid</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="1490" valid="False" visited="False"/>  <Line no="1491" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="1492" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="1493" valid="False" visited="False"/>  <Line no="1494" valid="False" visited="False"/>  <Line no="1495" valid="False" visited="False"/>  <Line no="1496" valid="False" visited="False"/>  <Line no="1497" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">RTObject</span></Line>  <FileSummary valid="940" visited="823" totalLines="1497" coverage="87"/> </File> <File name="lua\openrtm\RTObjectStateMachine.lua" anchor="lua_openrtm_RTObjectStateMachine_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file RTObjectStateMachine.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief RTC状態遷移マシン定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTObjectStateMachine</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.RTObjectStateMachine"] = RTObjectStateMachine</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StateMachine</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StateMachine"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StateHolder</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StateMachine.StateHolder</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NUM_OF_LIFECYCLESTATE</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ActionPredicate</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	<span class="comment">-- アクション実行関数オブジェクト初期化</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param object 状態遷移マシン</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @param func アクション</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="26" valid="False" visited="False">	<span class="identifier">ActionPredicate.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">object</span><span class="misc">,</span>&nbsp;<span class="identifier">func</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.instance</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">object</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクション実行関数</span></Line>  <Line no="30" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="32" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">func</span><span class="misc">(</span><span class="identifier">self.instance</span><span class="misc">,</span>&nbsp;<span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="37" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="False" visited="False"/>  <Line no="40" valid="False" visited="False">	<span class="identifier">RTObjectStateMachine.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">,</span>&nbsp;<span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ReturnCode_t</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::ReturnCode_t"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._LifeCycleState</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">types</span><span class="misc">:</span><span class="identifier">lookup</span><span class="misc">(</span><span class="string">"::RTC::LifeCycleState"</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">labelvalue</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">id</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StateMachine.new</span><span class="misc">(</span><span class="identifier">NUM_OF_LIFECYCLESTATE</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._ca</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dfc</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._fsm</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._mode</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._caVar</span>&nbsp;&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._dfcVar</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._fsmVar</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._modeVar</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtObjPtr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCの設定</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp.getObjRef</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="63" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._caVar</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtObjPtr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._caVar</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- データフローコンポーネントの設定</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataFlowComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- FSMコンポーネントの設定</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setFsmParticipantAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マルチモードコンポーネントの設定</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setMultiModeComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新前の処理</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">workerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">worker_pre</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False"/>  <Line no="88" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新時の処理</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">workerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">worker_do</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="92" valid="False" visited="False"/>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新後の処理</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">workerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="95" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">worker_post</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False"/>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態の取得</span></Line>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 状態</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getState</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="101" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._sm:getState())</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">getState</span><span class="misc">(</span><span class="misc">)</span><span class="operator">-</span><span class="number">1</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 現在の状態が指定状態と一致するかの確認</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self:getState(),state)</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">self</span><span class="misc">:</span><span class="identifier">getState</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態遷移マシンで保持しているRTCが一致するかの確認</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param comp RTC</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：一致、false：不一致</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isEquivalent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local Manager = require "openrtm.Manager"</span></Line>  <Line no="118" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--orb = Manager:instance():getORB()</span></Line>  <Line no="119" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._rtobj,comp)</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp:getInstanceName())</span></Line>  <Line no="121" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._rtobj:getInstanceName())</span></Line>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--return (orb:tostring(self._rtobj)==orb:tostring(comp))</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("abcde")</span></Line>  <Line no="124" valid="False" visited="False"/>  <Line no="125" valid="False" visited="False"/>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp, self._rtobj)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">NVUtil._is_equivalent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">,</span>&nbsp;<span class="identifier">self._rtobj</span><span class="misc">,</span>&nbsp;<span class="identifier">comp.getObjRef</span><span class="misc">,</span>&nbsp;<span class="identifier">self._rtobj.getObjRef</span><span class="misc">)</span></Line>  <Line no="128" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--return (comp:getInstanceName()==self._rtobj:getInstanceName())</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="130" valid="False" visited="False"/>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定状態への移行</span></Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param state 状態</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">state</span><span class="misc">)</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">state</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="136" valid="False" visited="False"/>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- RTCのオブジェクトリファレンス取得</span></Line>  <Line no="138" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="139" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="140" valid="False" visited="False"/>  <Line no="141" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._rtObjPtr</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._rtObjPtr</span></Line>  <Line no="143" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self._caVar</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="144" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._caVar</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="146" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="147" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="149" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト開始時の処理実行</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStartup</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_startup</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 実行コンテキスト停止時の処理実行</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onShutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_shutdown</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="161" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="163" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態遷移後の処理実行</span></Line>  <Line no="164" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onActivated</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(self._caVar)</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("test",self._caVar)</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--local ret = self._caVar:on_activated(self._id)</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(type(ret), type(self._ReturnCode_t.RTC_OK))</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--if ret ~= "RTC_OK" then</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("aaaa")</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_activated</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="177" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("onActivated:ERROR")</span></Line>  <Line no="178" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="179" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("OK")</span></Line>  <Line no="181" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 非アクティブ状態遷移後の処理実行</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onDeactivated</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_deactivated</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="191" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態遷移時の処理実行</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAborting</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="196" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="197" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_aborting</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エラー状態の処理実行</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onError</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="205" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_error</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- リセット実行時の処理実行</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onReset</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="214" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="216" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_reset</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="217" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="218" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="220" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブ状態の処理実行</span></Line>  <Line no="221" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onExecute</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="225" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_execute</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("onExecute:ERROR")</span></Line>  <Line no="229" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 状態更新時の処理実行</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onStateUpdate</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="237" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">NVUtil.getReturnCode</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_state_update</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print("onStateUpdate:ERROR")</span></Line>  <Line no="241" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 周期変更後の処理実行</span></Line>  <Line no="245" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="246" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return リターンコード</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onRateChanged</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="250" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="251" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">comp</span><span class="misc">:</span><span class="identifier">on_rate_changed</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="254" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="257" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクション実行</span></Line>  <Line no="259" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onAction</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="261" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="262" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._fsmVar</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="263" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="264" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="265" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._fsmVar</span><span class="misc">:</span><span class="identifier">on_action</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="266" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="268" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- モード変更後の処理実行</span></Line>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param st RTCの状態</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">onModeChanged</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="272" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">comp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getComponentObj</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="273" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._modeVar</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="274" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span></Line>  <Line no="275" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._modeVar</span><span class="misc">:</span><span class="identifier">on_mode_changed</span><span class="misc">(</span><span class="identifier">self._id</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="277" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="280" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getRTObject</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="282" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._rtobj</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getExecutionContextHandle</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="286" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._id</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="289" valid="False" visited="False"/>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(comp)</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="292" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj._caVar)</span></Line>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setDataFlowComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setFsmParticipantAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setMultiModeComponentAction</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="296" valid="False" visited="False"/>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setListener</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">)</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(obj.onActivated)</span></Line>  <Line no="299" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--obj:onActivated(1)</span></Line>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setEntryAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onActivated</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setDoAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onExecute</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setPostDoAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onStateUpdate</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setExitAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onDeactivated</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setEntryAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="309" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onAborting</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="310" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setDoAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onError</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="312" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setExitAction</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.ERROR_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">,</span></Line>  <Line no="313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ActionPredicate.new</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="identifier">obj.onReset</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">st</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StateHolder.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">st.prev</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._LifeCycleState.INACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">st.curr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._LifeCycleState.INACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">st.next</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._LifeCycleState.INACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">setStartState</span><span class="misc">(</span><span class="identifier">st</span><span class="misc">)</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sm</span><span class="misc">:</span><span class="identifier">goTo</span><span class="misc">(</span><span class="identifier">obj._LifeCycleState.INACTIVE_STATE</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="320" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="321" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="322" valid="False" visited="False"/>  <Line no="323" valid="False" visited="False"/>  <Line no="324" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">RTObjectStateMachine</span></Line>  <FileSummary valid="182" visited="155" totalLines="324" coverage="85"/> </File> <File name="lua\openrtm\SdoConfiguration.lua" anchor="lua_openrtm_SdoConfiguration_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file SdoConfiguration.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief コンフィギュレーション操作クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoConfiguration</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.SdoConfiguration"] = SdoConfiguration</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Properties"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="17" valid="False" visited="False"/>  <Line no="18" valid="True" visited="True">	<span class="identifier">SdoConfiguration.Configuration_impl</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False">	<span class="comment">-- プロパティからコンフィギュレーションセットに変換</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @param conf コンフィギュレーションセット</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="24" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">toConfigurationSet</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf.description</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"description"</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf.id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getName</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="27" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(prop)</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">conf.configuration_data</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="30" valid="False" visited="False"/>  <Line no="31" valid="False" visited="False">	<span class="comment">-- コンフィギュレーションセットからプロパティに変換</span></Line>  <Line no="32" valid="False" visited="False">	<span class="comment">-- @param prop プロパティ</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- @param conf コンフィギュレーションセット</span></Line>  <Line no="34" valid="False" visited="False">	<span class="keyword">local</span>&nbsp;<span class="identifier">toProperties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">conf</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyToProperties</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">,</span>&nbsp;<span class="identifier">conf.configuration_data</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="37" valid="False" visited="False"/>  <Line no="38" valid="False" visited="False">	<span class="comment">-- コンフィギュレーション操作オブジェクト初期化</span></Line>  <Line no="39" valid="False" visited="False">	<span class="comment">-- @param configAdmin コンフィギュレーション管理オブジェクト</span></Line>  <Line no="40" valid="False" visited="False">	<span class="comment">-- @param sdoServiceAdmin SDOサービス管理オブジェクト</span></Line>  <Line no="41" valid="False" visited="False">	<span class="comment">-- @return コンフィギュレーション操作オブジェクト</span></Line>  <Line no="42" valid="True" visited="True">	<span class="identifier">SdoConfiguration.Configuration_impl.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">configAdmin</span><span class="misc">,</span>&nbsp;<span class="identifier">sdoServiceAdmin</span><span class="misc">)</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="44" valid="False" visited="False"/>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._deviceProfile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">device_type</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">manufacturer</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">model</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">version</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">properties</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._serviceProfiles</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._parameters</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._configsets</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">configAdmin</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._sdoservice</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sdoServiceAdmin</span></Line>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._organizations</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="52" valid="False" visited="False"/>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="False" visited="False"/>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._orb</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:org.omg/SDOPackage/Configuration:1.0"</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">obj._orb</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:org.omg/SDOPackage/Configuration:1.0"</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False"/>  <Line no="61" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"rtobject.sdo_config"</span><span class="misc">)</span></Line>  <Line no="62" valid="False" visited="False"/>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス取得</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return オブジェクトリファレンス</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getObjRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._objref</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンスの非アクティブ化	</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="75" valid="False" visited="False"/>  <Line no="76" valid="False" visited="False"/>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット取得</span></Line>  <Line no="78" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットのID</span></Line>  <Line no="79" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーションセット</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration_set</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration_set("</span><span class="operator">..</span><span class="identifier">config_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"ID is empty"</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">haveConfig</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"No such ConfigurationSet"</span><span class="misc">)</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"No such ConfigurationSet"</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="93" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">configset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="98" valid="False" visited="False"/>  <Line no="99" valid="False" visited="False"/>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">id</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">description</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">configuration_data</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">toConfigurationSet</span><span class="misc">(</span><span class="identifier">config</span><span class="misc">,</span>&nbsp;<span class="identifier">configset</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">config</span></Line>  <Line no="103" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="False" visited="False"/>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- アクティブなコンフィギュレーションセット取得</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーションセット</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_active_configuration_set</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_active_configuration_set()"</span><span class="misc">)</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">isActive</span><span class="misc">(</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="110" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::NotAvailable"</span><span class="misc">,</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"NotAvailable: Configuration.get_active_configuration_set()"</span></Line>  <Line no="112" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="False" visited="False"/>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">id</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">description</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">configuration_data</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">toConfigurationSet</span><span class="misc">(</span><span class="identifier">config</span><span class="misc">,</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getActiveConfigurationSet</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">config</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定のコンフィギュレーションセットをアクティブにする</span></Line>  <Line no="123" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param config_id コンフィギュレーションセットのID</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：アクティブ化成功</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate_configuration_set</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span></Line>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"activate_configuration_set("</span><span class="operator">..</span><span class="identifier">config_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="127" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">config_id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"ID is empty."</span></Line>  <Line no="130" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">activateConfigurationSet</span><span class="misc">(</span><span class="identifier">config_id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Configuration.activate_configuration_set()."</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False"/>  <Line no="142" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセットの設定</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param configuration_set コンフィギュレーションセット</span></Line>  <Line no="144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：設定成功、false：設定失敗</span></Line>  <Line no="145" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_configuration_set_values</span><span class="misc">(</span><span class="identifier">configuration_set</span><span class="misc">)</span></Line>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"set_configuration_set_values()"</span><span class="misc">)</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">configuration_set</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="identifier">configuration_set.id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"ID is empty."</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">conf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Properties.new</span><span class="misc">(</span><span class="misc">{</span><span class="identifier">key</span><span class="operator">=</span><span class="identifier">configuration_set.id</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="157" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">toProperties</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">,</span>&nbsp;<span class="identifier">configuration_set</span><span class="misc">)</span></Line>  <Line no="158" valid="False" visited="False"/>  <Line no="159" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">setConfigurationSetValues</span><span class="misc">(</span><span class="identifier">conf</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="162" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="163" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Configuration::set_configuration_set_values()"</span></Line>  <Line no="165" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="166" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="169" valid="False" visited="False"/>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- デバイスプロファイル設定</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param dProfile デバイスプロファイル</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_device_profile</span><span class="misc">(</span><span class="identifier">dProfile</span><span class="misc">)</span></Line>  <Line no="174" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"set_device_profile()"</span><span class="misc">)</span></Line>  <Line no="175" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="176" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"dProfile is empty."</span></Line>  <Line no="177" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="False" visited="False"/>  <Line no="180" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスプロファイル追加</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param sProfile サービスプロファイル</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：追加成功</span></Line>  <Line no="183" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_service_profile</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"add_service_profile()"</span><span class="misc">)</span></Line>  <Line no="185" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sProfile</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="186" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="187" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"sProfile is empty."</span></Line>  <Line no="188" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="189" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="190" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="192" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">addSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="195" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="196" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="197" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="198" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Configuration.add_service_profile"</span></Line>  <Line no="199" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="202" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オーガナイゼーションオブジェクト追加</span></Line>  <Line no="205" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="206" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param org オーガナイゼーションオブジェクト</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">add_organization</span><span class="misc">(</span><span class="identifier">org</span><span class="misc">)</span></Line>  <Line no="208" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"add_organization()"</span><span class="misc">)</span></Line>  <Line no="209" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="210" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"org is empty."</span></Line>  <Line no="211" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="False" visited="False"/>  <Line no="214" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- サービスプロファイル削除</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param id_ ID</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return true：削除成功</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">remove_service_profile</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">)</span></Line>  <Line no="218" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_service_profile("</span><span class="operator">..</span><span class="identifier">id_..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id_</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"id is empty."</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="226" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="227" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._sdoservice</span><span class="misc">:</span><span class="identifier">removeSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">id_</span><span class="misc">)</span></Line>  <Line no="228" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="229" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="230" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="231" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="232" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Configuration.remove_service_profile"</span></Line>  <Line no="233" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="234" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="237" valid="False" visited="False"/>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オーガナイゼーションオブジェクト削除</span></Line>  <Line no="239" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="240" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param organization_id ID</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">remove_organization</span><span class="misc">(</span><span class="identifier">organization_id</span><span class="misc">)</span></Line>  <Line no="242" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"remove_organization("</span><span class="operator">..</span><span class="identifier">organization_id..</span><span class="string">")"</span><span class="misc">)</span></Line>  <Line no="243" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="244" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"id is empty."</span></Line>  <Line no="245" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="247" valid="False" visited="False"/>  <Line no="248" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータ一覧取得</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="250" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーションパラメータ一覧</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration_parameters</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration_parameters()"</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._parameters</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="255" valid="False" visited="False"/>  <Line no="256" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータのNameValueリスト取得</span></Line>  <Line no="257" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="258" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return NameValueリスト取得</span></Line>  <Line no="259" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration_parameter_values</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="260" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration_parameter_values()"</span><span class="misc">)</span></Line>  <Line no="261" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">nvlist</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="262" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">nvlist</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="264" valid="False" visited="False"/>  <Line no="265" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションパラメータの設定</span></Line>  <Line no="266" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 未実装</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name パラメータ名</span></Line>  <Line no="268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param value 値</span></Line>  <Line no="269" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_configuration_parameter</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="270" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"set_configuration_parameter("</span><span class="operator">..</span><span class="identifier">name..</span><span class="string">", value)"</span><span class="misc">)</span></Line>  <Line no="271" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="272" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Name/Value is empty."</span></Line>  <Line no="273" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="274" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="275" valid="False" visited="False"/>  <Line no="276" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- コンフィギュレーションセット一覧取得</span></Line>  <Line no="277" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return コンフィギュレーションセット一覧</span></Line>  <Line no="278" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">get_configuration_sets</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="279" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"get_configuration_sets()"</span><span class="misc">)</span></Line>  <Line no="280" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">config_sets</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="281" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">success</span><span class="misc">,</span>&nbsp;<span class="identifier">exception</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">oil.pcall</span><span class="misc">(</span></Line>  <Line no="282" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="283" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">cf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._configsets</span><span class="misc">:</span><span class="identifier">getConfigurationSets</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="284" valid="False" visited="False"/>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">len_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">cf</span></Line>  <Line no="286" valid="False" visited="False"/>  <Line no="287" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">len_</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">config_sets</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">id</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">description</span><span class="operator">=</span><span class="string">""</span><span class="misc">,</span><span class="identifier">configuration_data</span><span class="operator">=</span><span class="misc">{</span><span class="misc">}</span><span class="misc">}</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">toConfigurationSet</span><span class="misc">(</span><span class="identifier">config_sets</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="identifier">cf</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span><span class="misc">)</span></Line>  <Line no="292" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">success</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="293" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(exception)</span></Line>  <Line no="294" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">exception</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InternalError"</span><span class="misc">,</span></Line>  <Line no="296" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">"Configuration.get_configuration_sets"</span></Line>  <Line no="297" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="298" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="299" valid="False" visited="False"/>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">config_sets</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="302" valid="False" visited="False"/>  <Line no="303" valid="False" visited="False"/>  <Line no="304" valid="False" visited="False"/>  <Line no="305" valid="False" visited="False"/>  <Line no="306" valid="False" visited="False"/>  <Line no="307" valid="False" visited="False"/>  <Line no="308" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="309" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="310" valid="False" visited="False"/>  <Line no="311" valid="False" visited="False"/>  <Line no="312" valid="False" visited="False"/>  <Line no="313" valid="False" visited="False"/>  <Line no="314" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">SdoConfiguration</span></Line>  <FileSummary valid="176" visited="136" totalLines="314" coverage="77"/> </File> <File name="lua\openrtm\SdoServiceAdmin.lua" anchor="lua_openrtm_SdoServiceAdmin_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file SdoServiceAdmin.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief SDOサービス管理クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceAdmin</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceProviderBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.SdoServiceProviderBase"</span></Line>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceProviderBase.SdoServiceProviderFactory</span></Line>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.StringUtil"</span></Line>  <Line no="15" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NVUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.NVUtil"</span></Line>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceConsumerBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.SdoServiceConsumerBase"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceConsumerFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceConsumerBase.SdoServiceConsumerFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">uuid</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"uuid"</span></Line>  <Line no="19" valid="False" visited="False"/>  <Line no="20" valid="False" visited="False">	<span class="comment">--_G["openrtm.SdoServiceAdmin"] = SdoServiceAdmin</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="False" visited="False">	<span class="comment">-- SDOサービス管理オブジェクト初期化</span></Line>  <Line no="24" valid="False" visited="False">	<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="25" valid="False" visited="False">	<span class="comment">-- @return SDOサービス管理オブジェクト</span></Line>  <Line no="26" valid="False" visited="False">	<span class="identifier">SdoServiceAdmin.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="28" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">rtobj</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumerTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._providers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._consumers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._allConsumerEnabled</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="35" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._rtcout</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._manager</span><span class="misc">:</span><span class="identifier">getLogbuf</span><span class="misc">(</span><span class="string">"rtobject.sdo_config"</span><span class="misc">)</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 初期化時にRTC設定</span></Line>  <Line no="38" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param rtobj RTC</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"SdoServiceAdmin::SdoServiceAdmin(%s)"</span><span class="misc">,</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"instance_name"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prop</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._rtobj</span><span class="misc">:</span><span class="identifier">getProperties</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="44" valid="False" visited="False"/>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">enabledProviderTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"sdo.service.provider.enabled_services"</span><span class="misc">)</span><span class="misc">,</span><span class="string">","</span><span class="misc">)</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">enabledProviderTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.strip</span><span class="misc">(</span><span class="identifier">enabledProviderTypes</span><span class="misc">)</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo.service.provider.enabled_services: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"sdo.service.provider.enabled_services"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="49" valid="False" visited="False"/>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">availableProviderTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getIdentifiers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"sdo.service.provider.available_services"</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">availableProviderTypes</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo.service.provider.available_services: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"sdo.service.provider.available_services"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="53" valid="False" visited="False"/>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">activeProviderTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="57" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">ep_type</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">enabledProviderTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">ep_type</span><span class="misc">)</span></Line>  <Line no="59" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"all"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(tmp)</span></Line>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">activeProviderTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">availableProviderTypes</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo.service.provider.enabled_services: ALL"</span><span class="misc">)</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">break</span></Line>  <Line no="65" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">j</span><span class="misc">,</span><span class="identifier">ap_type</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">availableProviderTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ap_type</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">ep_type</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="68" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">activeProviderTypes</span><span class="misc">,</span>&nbsp;<span class="identifier">ap_type</span><span class="misc">)</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="70" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">ap_type</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">activeProviderTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">svc</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">ap_type</span><span class="misc">)</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">propkey</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">ifrToKey</span><span class="misc">(</span><span class="identifier">ap_type</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.copyFromProperties</span><span class="misc">(</span><span class="identifier">properties</span><span class="misc">,</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getNode</span><span class="misc">(</span><span class="library">tostring</span><span class="misc">(</span><span class="identifier">propkey</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">ap_type</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="81" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">interface_type</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">ap_type</span><span class="misc">)</span><span class="misc">,</span></Line>  <Line no="82" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">properties</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">properties</span><span class="misc">,</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">service</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">svc._svr</span><span class="misc">}</span></Line>  <Line no="84" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">svc</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">,</span>&nbsp;<span class="identifier">prof</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">svc</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">,</span>&nbsp;<span class="identifier">svc</span><span class="misc">)</span></Line>  <Line no="91" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="92" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="93" valid="False" visited="False"/>  <Line no="94" valid="False" visited="False"/>  <Line no="95" valid="False" visited="False"/>  <Line no="96" valid="False" visited="False"/>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">constypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"sdo.service.consumer.enabled_services"</span><span class="misc">)</span></Line>  <Line no="98" valid="False" visited="False"/>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumerTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">constypes</span><span class="misc">,</span><span class="string">","</span><span class="misc">)</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumerTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.strip</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">)</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo.service.consumer.enabled_services: %s"</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">constypes</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="103" valid="False" visited="False"/>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">setProperty</span><span class="misc">(</span><span class="string">"sdo.service.consumer.available_services"</span><span class="misc">,</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">SdoServiceConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getIdentifiers</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo.service.consumer.available_services: %s"</span><span class="misc">,</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prop</span><span class="misc">:</span><span class="identifier">getProperty</span><span class="misc">(</span><span class="string">"sdo.service.consumer.available_services"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="108" valid="False" visited="False"/>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="110" valid="False" visited="False"/>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">ctype</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">ctype</span><span class="misc">)</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"all"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._allConsumerEnabled</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"sdo_service.consumer_types: ALL"</span><span class="misc">)</span></Line>  <Line no="116" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="119" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 終了処理</span></Line>  <Line no="120" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">exit</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="121" valid="False" visited="False"/>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="False" visited="False"/>  <Line no="126" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._providers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="130" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="132" valid="False" visited="False"/>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._consumers</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="135" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getServiceProviderProfiles</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="139" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prof</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="False" visited="False"/>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getServiceProviderProfile</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="145" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">idstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">id</span></Line>  <Line no="146" valid="False" visited="False"/>  <Line no="147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="148" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">idstr</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="149" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="150" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False"/>  <Line no="153" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">error</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newexcept</span><span class="misc">{</span><span class="string">"SDOPackage::InvalidParameter"</span><span class="misc">,</span></Line>  <Line no="154" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">description</span><span class="operator">=</span><span class="string">""</span></Line>  <Line no="155" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="misc">}</span><span class="misc">)</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False"/>  <Line no="158" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getServiceProvider</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="159" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">prof</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">getServiceProviderProfile</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="160" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">prof.service</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="162" valid="False" visited="False"/>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addSdoServiceProvider</span><span class="misc">(</span><span class="identifier">prof</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="164" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"SdoServiceAdmin::addSdoServiceProvider(if=%s)"</span><span class="misc">,</span></Line>  <Line no="165" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">prof.interface_type</span><span class="misc">)</span></Line>  <Line no="166" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">prof.id</span></Line>  <Line no="167" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="168" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="169" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"SDO service(id=%s, ifr=%s) already exists"</span><span class="misc">,</span></Line>  <Line no="170" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">prof.id</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">prof.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="171" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="172" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="174" valid="False" visited="False"/>  <Line no="175" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">,</span>&nbsp;<span class="identifier">provider</span><span class="misc">)</span></Line>  <Line no="176" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="178" valid="False" visited="False"/>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeSdoServiceProvider</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="180" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeSdoServiceProvider(%d)"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="182" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">strid</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">id</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">provider</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="185" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">strid</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">provider</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="186" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">provider</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="187" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="188" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">[</span><span class="identifier">idx</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="189" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._providers</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="190" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"SDO service provider has been deleted: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="191" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="192" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="193" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="194" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Specified SDO service provider not found: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="195" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="196" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False"/>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="199" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"addSdoServiceConsumer(IFR = %s)"</span><span class="misc">,</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sProfile.interface_type</span><span class="misc">)</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">profile</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sProfile</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="203" valid="False" visited="False"/>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isEnabledConsumerType</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="205" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"Not supported consumer type. %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">profile.interface_type</span><span class="misc">)</span></Line>  <Line no="206" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="207" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="208" valid="False" visited="False">	&nbsp;&nbsp;</Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">isExistingConsumerType</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"type %s not exists."</span><span class="misc">,</span>&nbsp;<span class="identifier">profile.interface_type</span><span class="misc">)</span></Line>  <Line no="211" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="212" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">profile.id</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="214" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"No id specified. It should be given by clients."</span><span class="misc">)</span></Line>  <Line no="215" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="217" valid="False" visited="False"/>  <Line no="218" valid="False" visited="False"/>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.id</span><span class="misc">)</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"Existing consumer is reinitilized."</span><span class="misc">)</span></Line>  <Line no="223" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"Propeteis are: %s"</span><span class="misc">,</span></Line>  <Line no="224" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">NVUtil.toString</span><span class="misc">(</span><span class="identifier">sProfile.properties</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="225" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">reinit</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="226" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="228" valid="False" visited="False"/>  <Line no="229" valid="False" visited="False"/>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ctype</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">profile.interface_type</span><span class="misc">)</span></Line>  <Line no="232" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">createObject</span><span class="misc">(</span><span class="identifier">ctype</span><span class="misc">)</span></Line>  <Line no="233" valid="False" visited="False"/>  <Line no="234" valid="False" visited="False"/>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">consumer</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">self._rtobj</span><span class="misc">,</span>&nbsp;<span class="identifier">sProfile</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"SDO service initialization was failed."</span><span class="misc">)</span></Line>  <Line no="237" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"id:         %s"</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.id</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="238" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"IFR:        %s"</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="239" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"properties: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">NVUtil.toString</span><span class="misc">(</span><span class="identifier">sProfile.properties</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="241" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"SDO consumer was deleted by initialization failure"</span><span class="misc">)</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="244" valid="False" visited="False"/>  <Line no="245" valid="False" visited="False"/>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span><span class="misc">)</span></Line>  <Line no="247" valid="False" visited="False"/>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="249" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="250" valid="False" visited="False"/>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">removeSdoServiceConsumer</span><span class="misc">(</span><span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">id</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="253" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="string">"removeSdoServiceConsumer(): id is invalid."</span><span class="misc">)</span></Line>  <Line no="254" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="string">"removeSdoServiceConsumer(id = %s)"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="257" valid="False" visited="False"/>  <Line no="258" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">strid</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">id</span></Line>  <Line no="259" valid="False" visited="False"/>  <Line no="260" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">idx</span><span class="misc">,</span><span class="identifier">cons</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="261" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">strid</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">cons</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span><span class="operator">.</span><span class="identifier">id</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="262" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">cons</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="263" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">self._consumers</span><span class="misc">,</span>&nbsp;<span class="identifier">idx</span><span class="misc">)</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">deleteObject</span><span class="misc">(</span><span class="identifier">cons</span><span class="misc">)</span></Line>  <Line no="266" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="string">"SDO service has been deleted: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="267" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="268" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="270" valid="False" visited="False"/>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Specified SDO consumer not found: %s"</span><span class="misc">,</span>&nbsp;<span class="identifier">id</span><span class="misc">)</span></Line>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="274" valid="False" visited="False"/>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isEnabledConsumerType</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._allConsumerEnabled</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="278" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="279" valid="False" visited="False"/>  <Line no="280" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">self._consumerTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="281" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="282" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"%s is supported SDO service."</span><span class="misc">,</span></Line>  <Line no="283" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="284" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="285" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="286" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="287" valid="False" visited="False"/>  <Line no="288" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"Consumer type is not supported: %s"</span><span class="misc">,</span></Line>  <Line no="289" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="290" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="292" valid="False" visited="False"/>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">isExistingConsumerType</span><span class="misc">(</span><span class="identifier">sProfile</span><span class="misc">)</span></Line>  <Line no="294" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">SdoServiceConsumerFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="295" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">consumerTypes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">factory</span><span class="misc">:</span><span class="identifier">getIdentifiers</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="296" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(#consumerTypes, sProfile.interface_type)</span></Line>  <Line no="297" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">consumerTypes</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="298" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">consumer</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="299" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="string">"%s exists in the SDO service factory."</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="300" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="string">"Available SDO serices in the factory: %s"</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">consumerTypes</span><span class="misc">)</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="302" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="303" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._rtcout</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="string">"No available SDO service in the factory: %s"</span><span class="misc">,</span></Line>  <Line no="305" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">sProfile.interface_type</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="306" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="308" valid="False" visited="False"/>  <Line no="309" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getUUID</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="310" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">uuid</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="311" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="312" valid="False" visited="False"/>  <Line no="313" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">ifrToKey</span><span class="misc">(</span><span class="identifier">ifr</span><span class="misc">)</span></Line>  <Line no="314" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ifrvstr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">ifr</span><span class="misc">,</span>&nbsp;<span class="string">":"</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">,</span>&nbsp;<span class="string">"_"</span><span class="misc">)</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">,</span>&nbsp;<span class="string">"%."</span><span class="misc">)</span></Line>  <Line no="318" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ifrvstr</span><span class="misc">[</span><span class="number">2</span><span class="misc">]</span></Line>  <Line no="319" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="320" valid="False" visited="False"/>  <Line no="321" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="322" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="323" valid="False" visited="False"/>  <Line no="324" valid="False" visited="False"/>  <Line no="325" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">SdoServiceAdmin</span></Line>  <FileSummary valid="218" visited="154" totalLines="325" coverage="70"/> </File> <File name="lua\openrtm\SdoServiceConsumerBase.lua" anchor="lua_openrtm_SdoServiceConsumerBase_lua">  <PerfectCoverage/>   <FileSummary valid="20" visited="20" totalLines="38" coverage="100"/> </File> <File name="lua\openrtm\SdoServiceProviderBase.lua" anchor="lua_openrtm_SdoServiceProviderBase_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file SdoServiceProviderBase.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief SDOサービスプロバイダ基底クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SdoServiceProviderBase</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">GlobalFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.GlobalFactory"</span></Line>  <Line no="12" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Factory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">GlobalFactory.Factory</span></Line>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="14" valid="False" visited="False">	<span class="comment">--_G["openrtm.SdoServiceProviderBase"] = SdoServiceProviderBase</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="False" visited="False">	<span class="identifier">SdoServiceProviderBase.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="17" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="19" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="20" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._orb</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj._manager</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- オブジェクトリファレンス生成</span></Line>  <Line no="23" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">createRef</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._orb</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:org.omg/SDOPackage/SDOService:1.0"</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._objref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">self._orb</span><span class="misc">,</span>&nbsp;<span class="identifier">self._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:org.omg/SDOPackage/SDOService:1.0"</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="27" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">init</span><span class="misc">(</span><span class="identifier">rtobj</span><span class="misc">,</span>&nbsp;<span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="28" valid="False" visited="False"/>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reinit</span><span class="misc">(</span><span class="identifier">profile</span><span class="misc">)</span></Line>  <Line no="31" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getProfile</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="34" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">finalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="37" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">deactivate</span><span class="misc">(</span><span class="identifier">self._svr</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="41" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="True" visited="True">	<span class="identifier">SdoServiceProviderBase.SdoServiceProviderFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="45" valid="True" visited="True">	<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">SdoServiceProviderBase.SdoServiceProviderFactory</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">Factory.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="46" valid="False" visited="False"/>  <Line no="47" valid="True" visited="True">	<span class="keyword">function</span>&nbsp;<span class="identifier">SdoServiceProviderBase.SdoServiceProviderFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="49" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="50" valid="False" visited="False"/>  <Line no="51" valid="False" visited="False"/>  <Line no="52" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">SdoServiceProviderBase</span></Line>  <FileSummary valid="30" visited="28" totalLines="52" coverage="93"/> </File> <File name="lua\openrtm\SimulatorExecutionContext.lua" anchor="lua_openrtm_SimulatorExecutionContext_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file SimulatorExecutionContext.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief トリガ駆動実行コンテキスト定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False"/>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="9" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="10" valid="False" visited="False"/>  <Line no="11" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">SimulatorExecutionContext</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="12" valid="False" visited="False">	<span class="comment">--_G["openrtm.SimulatorExecutionContext"] = SimulatorExecutionContext</span></Line>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextBase"</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextBase</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ExecutionContextBase"</span></Line>  <Line no="17" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ExecutionContextFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ExecutionContextBase.ExecutionContextFactory</span></Line>  <Line no="18" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">ECFactory</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.ECFactory"</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">oil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"oil"</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">RTCUtil</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.RTCUtil"</span></Line>  <Line no="22" valid="False" visited="False"/>  <Line no="23" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">OpenHRPExecutionContext</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.OpenHRPExecutionContext"</span></Line>  <Line no="24" valid="False" visited="False"/>  <Line no="25" valid="False" visited="False"/>  <Line no="26" valid="False" visited="False">	<span class="comment">-- シミュレーション用コンテキスト初期化</span></Line>  <Line no="27" valid="False" visited="False">	<span class="comment">-- @return SimulatorExecutionContext</span></Line>  <Line no="28" valid="False" visited="False">	<span class="identifier">SimulatorExecutionContext.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="29" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="30" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__index</span><span class="operator">=</span><span class="identifier">OpenHRPExecutionContext.new</span><span class="misc">(</span><span class="misc">)</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="31" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">Manager</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">require</span>&nbsp;<span class="string">"openrtm.Manager"</span></Line>  <Line no="32" valid="False" visited="False"/>  <Line no="33" valid="False" visited="False"/>  <Line no="34" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._svr</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">newservant</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="keyword">nil</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/ExtTrigExecutionContextService:1.0"</span><span class="misc">)</span></Line>  <Line no="35" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ref</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">RTCUtil.getReference</span><span class="misc">(</span><span class="identifier">Manager</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">getORB</span><span class="misc">(</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">obj._svr</span><span class="misc">,</span>&nbsp;<span class="string">"IDL:openrtm.aist.go.jp/OpenRTM/ExtTrigExecutionContextService:1.0"</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setObjRef</span><span class="misc">(</span><span class="identifier">ref</span><span class="misc">)</span></Line>  <Line no="37" valid="False" visited="False"/>  <Line no="38" valid="False" visited="False"/>  <Line no="39" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">activate_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="43" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="45" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="52" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncActivation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">activateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="55" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="56" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="57" valid="False" visited="False"/>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="63" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="64" valid="False" visited="False"/>  <Line no="65" valid="False" visited="False"/>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">deactivate_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="69" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="70" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="72" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="74" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncDeactivation</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">deactivateComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="81" valid="False" visited="False"/>  <Line no="82" valid="False" visited="False"/>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="85" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False"/>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False"/>  <Line no="90" valid="False" visited="False"/>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">reset_component</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._worker</span><span class="misc">:</span><span class="identifier">findComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="94" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.BAD_PARAMETER</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.ERROR_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.PRECONDITION_NOT_MET</span></Line>  <Line no="98" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="99" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._syncReset</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="101" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">resetComponent</span><span class="misc">(</span><span class="identifier">comp</span><span class="misc">)</span></Line>  <Line no="102" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="103" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPreDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="104" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="105" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self</span><span class="misc">:</span><span class="identifier">invokeWorkerPostDo</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="106" valid="False" visited="False"/>  <Line no="107" valid="False" visited="False"/>  <Line no="108" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">rtobj</span><span class="misc">:</span><span class="identifier">isCurrentState</span><span class="misc">(</span><span class="identifier">self._LifeCycleState.INACTIVE_STATE</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="109" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_OK</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="111" valid="False" visited="False"/>  <Line no="112" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._ReturnCode_t.RTC_ERROR</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="114" valid="False" visited="False"/>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="116" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="117" valid="False" visited="False"/>  <Line no="118" valid="False" visited="False"/>  <Line no="119" valid="False" visited="False">	<span class="comment">-- SimulatorExecutionContext生成ファクトリ登録関数</span></Line>  <Line no="120" valid="False" visited="False">	<span class="identifier">SimulatorExecutionContext.Init</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">manager</span><span class="misc">)</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ExecutionContextFactory</span><span class="misc">:</span><span class="identifier">instance</span><span class="misc">(</span><span class="misc">)</span><span class="misc">:</span><span class="identifier">addFactory</span><span class="misc">(</span><span class="string">"SimulatorExecutionContext"</span><span class="misc">,</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">SimulatorExecutionContext.new</span><span class="misc">,</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ECFactory.ECDelete</span><span class="misc">)</span></Line>  <Line no="124" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="125" valid="False" visited="False"/>  <Line no="126" valid="False" visited="False"/>  <Line no="127" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">SimulatorExecutionContext</span></Line>  <FileSummary valid="64" visited="51" totalLines="127" coverage="79"/> </File> <File name="lua\openrtm\StateMachine.lua" anchor="lua_openrtm_StateMachine_lua">  <PerfectCoverage/>   <FileSummary valid="111" visited="111" totalLines="193" coverage="100"/> </File> <File name="lua\openrtm\StringUtil.lua" anchor="lua_openrtm_StringUtil_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file StringUtil.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 文字列操作関数定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">StringUtil</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.StringUtil"] = StringUtil</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="False" visited="False"/>  <Line no="14" valid="False" visited="False">	<span class="comment">-- 文字列先頭の空白削除</span></Line>  <Line no="15" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="16" valid="False" visited="False">	<span class="comment">-- @return 空白削除後の文字列</span></Line>  <Line no="17" valid="False" visited="False">	<span class="identifier">StringUtil.eraseHeadBlank</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">"^%s*(.-)$"</span><span class="misc">,</span>&nbsp;<span class="string">"%1"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="19" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="20" valid="False" visited="False"/>  <Line no="21" valid="False" visited="False">	<span class="comment">-- 文字列末尾の空白削除</span></Line>  <Line no="22" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="23" valid="False" visited="False">	<span class="comment">-- @return 空白削除後の文字列</span></Line>  <Line no="24" valid="False" visited="False">	<span class="identifier">StringUtil.eraseTailBlank</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">"^(.-)%s*$"</span><span class="misc">,</span>&nbsp;<span class="string">"%1"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="26" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="27" valid="False" visited="False"/>  <Line no="28" valid="False" visited="False">	<span class="comment">-- 文字列先頭と末尾の空白削除</span></Line>  <Line no="29" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="30" valid="False" visited="False">	<span class="comment">-- @return 空白削除後の文字列</span></Line>  <Line no="31" valid="False" visited="False">	<span class="identifier">StringUtil.eraseBothEndsBlank</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="32" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">"^%s*(.-)%s*$"</span><span class="misc">,</span>&nbsp;<span class="string">"%1"</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="33" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="34" valid="False" visited="False"/>  <Line no="35" valid="False" visited="False"/>  <Line no="36" valid="False" visited="False">	<span class="comment">-- 文字列の正規化</span></Line>  <Line no="37" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="38" valid="False" visited="False">	<span class="comment">-- @return 正規化後の文字列</span></Line>  <Line no="39" valid="False" visited="False">	<span class="identifier">StringUtil.normalize</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.gsub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">"^%s*(.-)%s*$"</span><span class="misc">,</span>&nbsp;<span class="string">"%1"</span><span class="misc">)</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">)</span></Line>  <Line no="42" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="43" valid="False" visited="False"/>  <Line no="44" valid="False" visited="False">	<span class="comment">-- リストの要素全ての文字列の前後の空白を削除</span></Line>  <Line no="45" valid="False" visited="False">	<span class="comment">-- @param str_list 文字列のリスト</span></Line>  <Line no="46" valid="False" visited="False">	<span class="comment">-- @return 前後の空白削除後の文字列のリスト</span></Line>  <Line no="47" valid="False" visited="False">	<span class="identifier">StringUtil.strip</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">str_list</span><span class="misc">)</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">str_list</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="51" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="53" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="54" valid="False" visited="False"/>  <Line no="55" valid="False" visited="False">	<span class="comment">-- 文字列にエスケープ文字が含まれるかを判定</span></Line>  <Line no="56" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="57" valid="False" visited="False">	<span class="comment">-- @param pos 位置</span></Line>  <Line no="58" valid="False" visited="False">	<span class="comment">-- @return true；エスケープ文字が含まれる、false：含まれない</span></Line>  <Line no="59" valid="False" visited="False">	<span class="identifier">StringUtil.isEscaped</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span><span class="misc">)</span></Line>  <Line no="60" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--pos = pos-1</span></Line>  <Line no="61" valid="False" visited="False"/>  <Line no="62" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(string.sub(_str, pos, pos))</span></Line>  <Line no="64" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">i</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span></Line>  <Line no="67" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">(</span><span class="identifier">i</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="number">2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span><span class="misc">)</span></Line>  <Line no="70" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="71" valid="False" visited="False"/>  <Line no="72" valid="False" visited="False"/>  <Line no="73" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">unescape_functor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="74" valid="False" visited="False">	<span class="comment">-- エスケープ文字に変換する関数オブジェクト初期化</span></Line>  <Line no="75" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="76" valid="False" visited="False">	<span class="identifier">unescape_functor.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="77" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.count</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._str</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- エスケープ文字に変換する</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param c 文字</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">c</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="number">2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="87" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self._str..c</span></Line>  <Line no="88" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="90" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">%</span>&nbsp;<span class="number">2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'t'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="93" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\t'</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'n'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="95" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\n'</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'f'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="97" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\f'</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'r'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\r'</span></Line>  <Line no="100" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'\"'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="101" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\"'</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">c</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'\''</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="103" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..</span><span class="string">'\''</span></Line>  <Line no="104" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="105" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..c</span></Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="109" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._str</span><span class="operator">=</span><span class="identifier">self._str..c</span></Line>  <Line no="110" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="111" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="114" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="115" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="116" valid="False" visited="False"/>  <Line no="117" valid="False" visited="False">	<span class="comment">-- 文字列のアンエスケープ</span></Line>  <Line no="118" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="119" valid="False" visited="False">	<span class="comment">-- @return アンエスケープ後の文字列</span></Line>  <Line no="120" valid="False" visited="False">	<span class="identifier">StringUtil.unescape</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">functor</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">unescape_functor.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="operator">=</span><span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">_str</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">functor</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span><span class="identifier">i</span><span class="misc">,</span><span class="identifier">i</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">functor._str</span></Line>  <Line no="126" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False"/>  <Line no="128" valid="False" visited="False">	<span class="comment">-- テーブルのコピー</span></Line>  <Line no="129" valid="False" visited="False">	<span class="comment">-- @param orig コピー物のテーブル</span></Line>  <Line no="130" valid="False" visited="False">	<span class="comment">-- @return コピー後のテーブル</span></Line>  <Line no="131" valid="False" visited="False">	<span class="identifier">StringUtil.copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span></Line>  <Line no="132" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'table'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="134" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">copy</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">v</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="137" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orig</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">copy</span></Line>  <Line no="141" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="142" valid="False" visited="False"/>  <Line no="143" valid="False" visited="False">	<span class="comment">-- テーブルのコピー</span></Line>  <Line no="144" valid="False" visited="False">	<span class="comment">-- @param orig コピー物のテーブル</span></Line>  <Line no="145" valid="False" visited="False">	<span class="comment">-- @return コピー後のテーブル</span></Line>  <Line no="146" valid="False" visited="False">	<span class="identifier">StringUtil.deepcopy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="148" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">'table'</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">orig</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">copy</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.deepcopy</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">copy</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">orig</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">copy</span></Line>  <Line no="156" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False"/>  <Line no="158" valid="False" visited="False"/>  <Line no="159" valid="False" visited="False"/>  <Line no="160" valid="False" visited="False">	<span class="comment">-- 文字列の分割</span></Line>  <Line no="161" valid="False" visited="False">	<span class="comment">-- @param input 文字列</span></Line>  <Line no="162" valid="False" visited="False">	<span class="comment">-- @param delimiter 分割文字</span></Line>  <Line no="163" valid="False" visited="False">	<span class="comment">-- @return 文字列のリスト</span></Line>  <Line no="164" valid="False" visited="False">	<span class="identifier">StringUtil.split</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">input</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(input:find(delimiter))</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">input</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="167" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="misc">{</span>&nbsp;<span class="identifier">input</span>&nbsp;<span class="misc">}</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">result</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pat</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"(.-)"</span>&nbsp;<span class="operator">..</span>&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">..</span>&nbsp;<span class="string">"()"</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">lastPos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="172" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">part</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">string.gmatch</span><span class="misc">(</span><span class="identifier">input</span><span class="misc">,</span>&nbsp;<span class="identifier">pat</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="173" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">result</span><span class="misc">,</span>&nbsp;<span class="identifier">part</span><span class="misc">)</span></Line>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">lastPos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span></Line>  <Line no="175" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="176" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">result</span><span class="misc">,</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">input</span><span class="misc">,</span>&nbsp;<span class="identifier">lastPos</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">result</span></Line>  <Line no="178" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="179" valid="False" visited="False"/>  <Line no="180" valid="False" visited="False">	<span class="comment">-- テーブルを標準出力</span></Line>  <Line no="181" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="182" valid="False" visited="False">	<span class="identifier">StringUtil.print_table</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span></Line>  <Line no="183" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="184" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span><span class="operator">==</span><span class="string">"table"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print( k..":" )</span></Line>  <Line no="186" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">StringUtil.print_table</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="188" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">print</span><span class="misc">(</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="misc">)</span></Line>  <Line no="189" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="190" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="191" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="192" valid="False" visited="False"/>  <Line no="193" valid="False" visited="False">	<span class="comment">-- 文字列をboolに変換</span></Line>  <Line no="194" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="195" valid="False" visited="False">	<span class="comment">-- @param yes trueの場合の文字列</span></Line>  <Line no="196" valid="False" visited="False">	<span class="comment">-- @param no falseの場合の文字列</span></Line>  <Line no="197" valid="False" visited="False">	<span class="comment">-- @param default_value デフォルト値</span></Line>  <Line no="198" valid="False" visited="False">	<span class="comment">-- @return bool値</span></Line>  <Line no="199" valid="False" visited="False">	<span class="identifier">StringUtil.toBool</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">yes</span><span class="misc">,</span>&nbsp;<span class="identifier">no</span><span class="misc">,</span>&nbsp;<span class="identifier">default_value</span><span class="misc">)</span></Line>  <Line no="200" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">default_value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="201" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">default_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="203" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(_str)</span></Line>  <Line no="204" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_str</span><span class="misc">:</span><span class="identifier">lower</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">yes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">yes</span><span class="misc">:</span><span class="identifier">lower</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">no</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">no</span><span class="misc">:</span><span class="identifier">lower</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">_str</span><span class="misc">:</span><span class="identifier">match</span><span class="misc">(</span><span class="identifier">yes</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="209" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">_str</span><span class="misc">:</span><span class="identifier">match</span><span class="misc">(</span><span class="identifier">no</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="210" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">default_value</span></Line>  <Line no="213" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="214" valid="False" visited="False"/>  <Line no="215" valid="False" visited="False"/>  <Line no="216" valid="False" visited="False"/>  <Line no="217" valid="False" visited="False">	<span class="comment">-- 数値を文字列に変換</span></Line>  <Line no="218" valid="False" visited="False">	<span class="comment">-- @param n 数値</span></Line>  <Line no="219" valid="False" visited="False">	<span class="comment">-- @return 文字列</span></Line>  <Line no="220" valid="False" visited="False">	<span class="identifier">StringUtil.otos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">n</span><span class="misc">)</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span><span class="operator">..</span><span class="identifier">n</span></Line>  <Line no="222" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="223" valid="False" visited="False"/>  <Line no="224" valid="False" visited="False">	<span class="comment">-- テーブルに値が含まれるかの判定</span></Line>  <Line no="225" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="226" valid="False" visited="False">	<span class="comment">-- @param val 値</span></Line>  <Line no="227" valid="False" visited="False">	<span class="comment">-- @return true；含まれる、false：含まれない</span></Line>  <Line no="228" valid="False" visited="False">	<span class="identifier">StringUtil.in_value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">,</span>&nbsp;<span class="identifier">val</span><span class="misc">)</span></Line>  <Line no="229" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span>&nbsp;<span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="230" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">v</span><span class="operator">==</span><span class="identifier">val</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="232" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="233" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="235" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="236" valid="False" visited="False"/>  <Line no="237" valid="False" visited="False">	<span class="comment">-- テーブルにキーが含まれるかの判定</span></Line>  <Line no="238" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="239" valid="False" visited="False">	<span class="comment">-- @param key キー</span></Line>  <Line no="240" valid="False" visited="False">	<span class="comment">-- @return true；含まれる、false：含まれない</span></Line>  <Line no="241" valid="False" visited="False">	<span class="identifier">StringUtil.in_key</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">,</span>&nbsp;<span class="identifier">key</span><span class="misc">)</span></Line>  <Line no="242" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tbl</span><span class="misc">[</span><span class="identifier">key</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="243" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="246" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="247" valid="False" visited="False"/>  <Line no="248" valid="False" visited="False">	<span class="comment">-- テーブルから重複する値を削除</span></Line>  <Line no="249" valid="False" visited="False">	<span class="comment">-- @param sv テーブル</span></Line>  <Line no="250" valid="False" visited="False">	<span class="comment">-- @return 値削除後のテーブル</span></Line>  <Line no="251" valid="False" visited="False">	<span class="identifier">StringUtil.unique_sv</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">sv</span><span class="misc">)</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">unique_strvec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.unique_strvec.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="253" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">sv</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="254" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">unique_strvec</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="255" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">unique_strvec._str</span></Line>  <Line no="257" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="258" valid="False" visited="False"/>  <Line no="259" valid="True" visited="True">	<span class="identifier">StringUtil.unique_strvec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="260" valid="False" visited="False"/>  <Line no="261" valid="False" visited="False">	<span class="comment">-- テーブルに同じ値が含まれなかった場合に追加する関数オブジェクト初期化</span></Line>  <Line no="262" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="263" valid="True" visited="True">	<span class="identifier">StringUtil.unique_strvec.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="264" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="265" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="266" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- テーブルに同じ値が含まれなかった場合に追加する</span></Line>  <Line no="267" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="268" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param s 値</span></Line>  <Line no="269" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return テーブル</span></Line>  <Line no="270" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">call_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="271" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="identifier">StringUtil.in_value</span><span class="misc">(</span><span class="identifier">self._str</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="272" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._str</span><span class="misc">,</span>&nbsp;<span class="identifier">s</span><span class="misc">)</span></Line>  <Line no="273" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self._str</span></Line>  <Line no="274" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="275" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="276" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__call</span><span class="operator">=</span><span class="identifier">call_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="277" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="278" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="279" valid="False" visited="False"/>  <Line no="280" valid="False" visited="False">	<span class="comment">-- テーブルを文字列に変換</span></Line>  <Line no="281" valid="False" visited="False">	<span class="comment">-- @param sv テーブル</span></Line>  <Line no="282" valid="False" visited="False">	<span class="comment">-- @param delimiter 区切り文字</span></Line>  <Line no="283" valid="False" visited="False">	<span class="comment">-- @return 文字列</span></Line>  <Line no="284" valid="False" visited="False">	<span class="identifier">StringUtil.flatten</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">sv</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="285" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="286" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">", "</span></Line>  <Line no="287" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="288" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">sv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="289" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="string">""</span></Line>  <Line no="290" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="291" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_str</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">table.concat</span><span class="misc">(</span><span class="identifier">sv</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="292" valid="False" visited="False"/>  <Line no="293" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">_str</span></Line>  <Line no="294" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="295" valid="False" visited="False"/>  <Line no="296" valid="False" visited="False">	<span class="comment">-- テーブルに指定の値が含まれる数を取得</span></Line>  <Line no="297" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="298" valid="False" visited="False">	<span class="comment">-- @param value 値</span></Line>  <Line no="299" valid="False" visited="False">	<span class="comment">-- @return 含まれていた数</span></Line>  <Line no="300" valid="False" visited="False">	<span class="identifier">StringUtil.table_count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="301" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="302" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="303" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="304" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">count</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">count</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="305" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="306" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="307" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">count</span></Line>  <Line no="308" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="309" valid="False" visited="False"/>  <Line no="310" valid="False" visited="False">	<span class="comment">-- テーブルに指定の値が何番目に含まれているかを取得</span></Line>  <Line no="311" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="312" valid="False" visited="False">	<span class="comment">-- @param value 値</span></Line>  <Line no="313" valid="False" visited="False">	<span class="comment">-- @return キー</span></Line>  <Line no="314" valid="False" visited="False">	<span class="identifier">StringUtil.table_index</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="315" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="316" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="317" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">i</span></Line>  <Line no="318" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="319" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="320" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="321" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="322" valid="False" visited="False"/>  <Line no="323" valid="False" visited="False">	<span class="comment">-- テーブルに値が含まれるかの確認</span></Line>  <Line no="324" valid="False" visited="False">	<span class="comment">-- @param _list テーブル、文字列の場合はテーブルに変換</span></Line>  <Line no="325" valid="False" visited="False">	<span class="comment">-- @param value 値</span></Line>  <Line no="326" valid="False" visited="False">	<span class="comment">-- @param ignore_case true：小文字化して判定</span></Line>  <Line no="327" valid="False" visited="False">	<span class="comment">-- @return true：含まれる、false：含まれない</span></Line>  <Line no="328" valid="False" visited="False">	<span class="identifier">StringUtil.includes</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">,</span>&nbsp;<span class="identifier">ignore_case</span><span class="misc">)</span></Line>  <Line no="329" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ignore_case</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="330" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ignore_case</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="331" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="332" valid="False" visited="False"/>  <Line no="333" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="keyword">not</span>&nbsp;<span class="misc">(</span><span class="library">type</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"table"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="334" valid="False" visited="False"/>  <Line no="335" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="336" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="337" valid="False" visited="False"/>  <Line no="338" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="339" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="340" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="341" valid="False" visited="False"/>  <Line no="342" valid="False" visited="False"/>  <Line no="343" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_list</span></Line>  <Line no="344" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">ignore_case</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="345" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">value</span><span class="misc">)</span></Line>  <Line no="346" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">tmp_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="347" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">_list</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="348" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">tmp_list</span><span class="misc">,</span>&nbsp;<span class="library">string.lower</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="349" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="350" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="351" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">StringUtil.table_count</span><span class="misc">(</span><span class="identifier">tmp_list</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span><span class="misc">)</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="352" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="353" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="354" valid="False" visited="False"/>  <Line no="355" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="356" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="357" valid="False" visited="False"/>  <Line no="358" valid="False" visited="False">	<span class="comment">-- 文字列をリストに変換</span></Line>  <Line no="359" valid="False" visited="False">	<span class="comment">-- @param _type 変換後の型</span></Line>  <Line no="360" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="361" valid="False" visited="False">	<span class="comment">-- @return ret(true：変換成功),リスト</span></Line>  <Line no="362" valid="False" visited="False">	<span class="identifier">StringUtil._stringToList</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="363" valid="False" visited="False"/>  <Line no="364" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">list_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">","</span><span class="misc">)</span></Line>  <Line no="365" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ans</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="366" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">_type</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="operator">#</span><span class="identifier">list_</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="367" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">sub</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">list_</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="operator">#</span><span class="identifier">_type</span></Line>  <Line no="368" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="identifier">sub</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="369" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">_type</span><span class="misc">[</span><span class="number">1</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="370" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="371" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="operator">#</span><span class="identifier">_type</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="operator">#</span><span class="identifier">list_</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="372" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">sub</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">_type</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="operator">#</span><span class="identifier">list_</span></Line>  <Line no="373" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">list_</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">_type_</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="374" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.remove</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">i</span><span class="misc">)</span></Line>  <Line no="375" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="376" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="377" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">i</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span><span class="misc">,</span><span class="operator">#</span><span class="identifier">list_</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="378" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"number"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="379" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ans</span><span class="misc">,</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">list_</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="380" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="381" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ans</span><span class="misc">,</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">list_</span><span class="misc">[</span><span class="identifier">i</span><span class="misc">]</span><span class="misc">)</span><span class="misc">)</span></Line>  <Line no="382" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="383" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="384" valid="False" visited="False"/>  <Line no="385" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span><span class="misc">,</span>&nbsp;<span class="identifier">ans</span></Line>  <Line no="386" valid="False" visited="False"/>  <Line no="387" valid="False" visited="False"/>  <Line no="388" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="389" valid="False" visited="False"/>  <Line no="390" valid="False" visited="False">	<span class="comment">-- 文字列を指定した型に変換</span></Line>  <Line no="391" valid="False" visited="False">	<span class="comment">-- @param _type 変換後の型</span></Line>  <Line no="392" valid="False" visited="False">	<span class="comment">-- @param _str 文字列</span></Line>  <Line no="393" valid="False" visited="False">	<span class="comment">-- @return ret(true：変換成功、false：変換失敗)、変換後の値</span></Line>  <Line no="394" valid="False" visited="False">	<span class="identifier">StringUtil.stringTo</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="395" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"number"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="396" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="397" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="398" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="399" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="400" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span><span class="misc">,</span>&nbsp;<span class="identifier">_type</span></Line>  <Line no="401" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="402" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="403" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="404" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">value</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="405" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span><span class="misc">,</span>&nbsp;<span class="identifier">value</span></Line>  <Line no="406" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="407" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span><span class="misc">,</span>&nbsp;<span class="identifier">_type</span></Line>  <Line no="408" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="409" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"table"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="410" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">StringUtil._stringToList</span><span class="misc">(</span><span class="identifier">_type</span><span class="misc">,</span>&nbsp;<span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="411" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="412" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span><span class="misc">,</span>&nbsp;<span class="identifier">_type</span></Line>  <Line no="413" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="414" valid="False" visited="False"/>  <Line no="415" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="416" valid="False" visited="False"/>  <Line no="417" valid="False" visited="False">	<span class="comment">-- 文字列から設定か可能なオプションのリスト取得</span></Line>  <Line no="418" valid="False" visited="False">	<span class="comment">-- @param options 文字列</span></Line>  <Line no="419" valid="False" visited="False">	<span class="comment">-- @return オプション一覧。optargがtrueの場合はオプションの後ろに値を設定する。</span></Line>  <Line no="420" valid="False" visited="False">	<span class="identifier">StringUtil.createopt</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">options</span><span class="misc">)</span></Line>  <Line no="421" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="422" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="423" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">options</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="424" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">opt</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">options</span><span class="misc">,</span><span class="identifier">pos</span><span class="misc">,</span><span class="identifier">pos</span><span class="misc">)</span></Line>  <Line no="425" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">opt</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="426" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="427" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">options</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="428" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">opt2</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">options</span><span class="misc">,</span><span class="identifier">pos</span><span class="misc">,</span><span class="identifier">pos</span><span class="misc">)</span></Line>  <Line no="429" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt2</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">":"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="430" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">opt</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">optarg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="431" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="432" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="433" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span><span class="misc">[</span><span class="identifier">opt</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">optarg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="434" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="435" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="436" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="437" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="438" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="439" valid="False" visited="False"/>  <Line no="440" valid="False" visited="False">	<span class="comment">-- 文字列からオプション取得</span></Line>  <Line no="441" valid="False" visited="False">	<span class="comment">-- @param arg 文字列</span></Line>  <Line no="442" valid="False" visited="False">	<span class="comment">-- @param options オプション一覧の文字列</span></Line>  <Line no="443" valid="False" visited="False">	<span class="comment">-- @return オプション一覧。optargに値が入る。</span></Line>  <Line no="444" valid="False" visited="False">	<span class="identifier">StringUtil.getopt</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">,</span>&nbsp;<span class="identifier">options</span><span class="misc">)</span></Line>  <Line no="445" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="446" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="447" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">opt</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.createopt</span><span class="misc">(</span><span class="identifier">options</span><span class="misc">)</span></Line>  <Line no="448" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--for i,v in pairs(opt) do</span></Line>  <Line no="449" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--	print(i,v.value)</span></Line>  <Line no="450" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--end</span></Line>  <Line no="451" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">arg</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="452" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.eraseBothEndsBlank</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span><span class="misc">)</span></Line>  <Line no="453" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="454" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="455" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"-"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="456" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">_id</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span><span class="misc">,</span><span class="number">2</span><span class="misc">)</span></Line>  <Line no="457" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt</span><span class="misc">[</span><span class="identifier">_id</span><span class="misc">]</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="458" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="identifier">id</span><span class="operator">=</span><span class="identifier">_id</span><span class="misc">}</span></Line>  <Line no="459" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">opt</span><span class="misc">[</span><span class="identifier">_id</span><span class="misc">]</span><span class="operator">.</span><span class="identifier">optarg</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="460" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="461" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">#</span><span class="identifier">arg</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="462" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v.optarg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">arg</span><span class="misc">[</span><span class="identifier">pos</span><span class="misc">]</span></Line>  <Line no="463" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="464" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="465" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--print(v)</span></Line>  <Line no="466" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">ret</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span><span class="misc">)</span></Line>  <Line no="467" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="468" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="469" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="470" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="471" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="472" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="473" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="474" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="475" valid="False" visited="False"/>  <Line no="476" valid="False" visited="False">	<span class="comment">-- パスからディレクトリパスを取り出し</span></Line>  <Line no="477" valid="False" visited="False">	<span class="comment">-- @param path パス</span></Line>  <Line no="478" valid="False" visited="False">	<span class="comment">-- @return ディレクトリパス</span></Line>  <Line no="479" valid="False" visited="False">	<span class="identifier">StringUtil.dirname</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">)</span></Line>  <Line no="480" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"\\"</span></Line>  <Line no="481" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">,</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="482" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"/"</span></Line>  <Line no="483" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="484" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">path_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="485" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">path_list</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">path_list</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">nil</span></Line>  <Line no="486" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.flatten</span><span class="misc">(</span><span class="identifier">path_list</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="487" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="operator">#</span><span class="identifier">ret</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="488" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="489" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="490" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret..delimiter</span></Line>  <Line no="491" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="492" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="493" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="494" valid="False" visited="False"/>  <Line no="495" valid="False" visited="False"/>  <Line no="496" valid="False" visited="False">	<span class="comment">-- パスからファイル名を取得</span></Line>  <Line no="497" valid="False" visited="False">	<span class="comment">-- @param path パス</span></Line>  <Line no="498" valid="False" visited="False">	<span class="comment">-- @return ファイル名</span></Line>  <Line no="499" valid="False" visited="False">	<span class="identifier">StringUtil.basename</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">)</span></Line>  <Line no="500" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"\\"</span></Line>  <Line no="501" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">,</span>&nbsp;<span class="string">"/"</span><span class="misc">,</span>&nbsp;<span class="number">1</span><span class="misc">,</span>&nbsp;<span class="keyword">true</span><span class="misc">)</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="502" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">delimiter</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">"/"</span></Line>  <Line no="503" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="504" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">path_list</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="identifier">path</span><span class="misc">,</span>&nbsp;<span class="identifier">delimiter</span><span class="misc">)</span></Line>  <Line no="505" valid="False" visited="False"/>  <Line no="506" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">path_list</span><span class="misc">[</span><span class="operator">#</span><span class="identifier">path_list</span><span class="misc">]</span></Line>  <Line no="507" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="508" valid="False" visited="False"/>  <Line no="509" valid="False" visited="False"/>  <Line no="510" valid="False" visited="False">	<span class="comment">-- テーブルの要素数取得</span></Line>  <Line no="511" valid="False" visited="False">	<span class="comment">-- @param tbl テーブル</span></Line>  <Line no="512" valid="False" visited="False">	<span class="comment">-- @return 要素数</span></Line>  <Line no="513" valid="False" visited="False">	<span class="identifier">StringUtil.getKeyCount</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span></Line>  <Line no="514" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="515" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">tbl</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="516" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="517" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="518" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="519" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="520" valid="False" visited="False"/>  <Line no="521" valid="False" visited="False">	<span class="comment">-- 文字列がURLかを判定</span></Line>  <Line no="522" valid="False" visited="False">	<span class="comment">-- @param str 文字列</span></Line>  <Line no="523" valid="False" visited="False">	<span class="comment">-- @return true：URL</span></Line>  <Line no="524" valid="False" visited="False">	<span class="identifier">StringUtil.isURL</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">)</span></Line>  <Line no="525" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">str</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">""</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="526" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="527" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="528" valid="False" visited="False"/>  <Line no="529" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">pos</span><span class="misc">,</span><span class="identifier">c</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span>&nbsp;<span class="string">"://"</span><span class="misc">)</span></Line>  <Line no="530" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="531" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="532" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="533" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="534" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="535" valid="False" visited="False"/>  <Line no="536" valid="False" visited="False"/>  <Line no="537" valid="False" visited="False"/>  <Line no="538" valid="False" visited="False"/>  <Line no="539" valid="False" visited="False">	<span class="comment">-- 文字列が絶対パスかを判定</span></Line>  <Line no="540" valid="False" visited="False">	<span class="comment">-- @param 文字列</span></Line>  <Line no="541" valid="False" visited="False">	<span class="comment">-- @return true：絶対パス</span></Line>  <Line no="542" valid="False" visited="False">	<span class="identifier">StringUtil.isAbsolutePath</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">)</span></Line>  <Line no="543" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"/"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="544" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="545" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="546" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.match</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">'[a-zA-Z]'</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="547" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">2</span><span class="misc">,</span><span class="number">2</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">":"</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">3</span><span class="misc">,</span><span class="number">3</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">or</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">3</span><span class="misc">,</span><span class="number">3</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"/"</span><span class="misc">)</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="548" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="549" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="550" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="551" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="number">1</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">str</span><span class="misc">,</span><span class="number">2</span><span class="misc">,</span><span class="number">2</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"\\"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="552" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="553" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="554" valid="False" visited="False"/>  <Line no="555" valid="True" visited="True">	&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="556" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="557" valid="False" visited="False"/>  <Line no="558" valid="False" visited="False">	<span class="comment">-- URL形式の文字列からパラメータを取得</span></Line>  <Line no="559" valid="False" visited="False">	<span class="comment">-- @param _str URL形式の文字列</span></Line>  <Line no="560" valid="False" visited="False">	<span class="comment">-- param?key1=value1&amp;key2=value2</span></Line>  <Line no="561" valid="False" visited="False">	<span class="comment">-- @return パラメータを格納したテーブル</span></Line>  <Line no="562" valid="False" visited="False">	<span class="identifier">StringUtil.urlparam2map</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">)</span></Line>  <Line no="563" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">qpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="string">"?"</span><span class="misc">)</span></Line>  <Line no="564" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">qpos</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="565" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">qpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="566" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="567" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">qpos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">qpos</span><span class="operator">+</span><span class="number">1</span></Line>  <Line no="568" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="569" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">tmp</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">StringUtil.split</span><span class="misc">(</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">_str</span><span class="misc">,</span>&nbsp;<span class="identifier">qpos</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="string">"&amp;"</span><span class="misc">)</span></Line>  <Line no="570" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">retmap</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="571" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span>&nbsp;<span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">ipairs</span><span class="misc">(</span><span class="identifier">tmp</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="572" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.find</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">,</span>&nbsp;<span class="string">"="</span><span class="misc">)</span></Line>  <Line no="573" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">pos</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="574" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">retmap</span><span class="misc">[</span><span class="library">string.sub</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">,</span><span class="number">1</span><span class="misc">,</span><span class="identifier">pos</span><span class="operator">-</span><span class="number">1</span><span class="misc">)</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">string.sub</span><span class="misc">(</span><span class="identifier">v</span><span class="misc">,</span>&nbsp;<span class="identifier">pos</span><span class="operator">+</span><span class="number">1</span><span class="misc">)</span></Line>  <Line no="575" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="576" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">retmap</span><span class="misc">[</span><span class="identifier">v</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="577" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="578" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="579" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">retmap</span></Line>  <Line no="580" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="581" valid="False" visited="False"/>  <Line no="582" valid="False" visited="False"/>  <Line no="583" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">StringUtil</span></Line>  <FileSummary valid="287" visited="251" totalLines="583" coverage="87"/> </File> <File name="lua\openrtm\SystemLogger.lua" anchor="lua_openrtm_SystemLogger_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file SystemLogger.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief ロガー管理クラス定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">--! SILENT ログ出力無し</span></Line>  <Line no="5" valid="False" visited="False">	<span class="comment">--! 出力する場合は以下の8段階</span></Line>  <Line no="6" valid="False" visited="False">	<span class="comment">--! FATAL、ERROR、WARN、INFO、DEBUG、TRACE、VERBOSE、PARANOID</span></Line>  <Line no="7" valid="False" visited="False">	<span class="comment">--! 現状、loggingライブラリの都合で以下の5段階になっている</span></Line>  <Line no="8" valid="False" visited="False">	<span class="comment">--! FATAL、ERROR、WARN、INFO、DEBUG</span></Line>  <Line no="9" valid="False" visited="False">	<span class="comment">--! DEBUG、TRACE、VERBOSE、PARANOIDはDEBUGの出力になる</span></Line>  <Line no="10" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="11" valid="False" visited="False"/>  <Line no="12" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="13" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="14" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="15" valid="False" visited="False"/>  <Line no="16" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">Logger</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="17" valid="False" visited="False">	<span class="comment">--_G["openrtm.SystemLogger"] = SystemLogger</span></Line>  <Line no="18" valid="False" visited="False"/>  <Line no="19" valid="True" visited="True">	<span class="identifier">Logger.LogStream</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="20" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">NO_LOGGER</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="21" valid="False" visited="False"/>  <Line no="22" valid="True" visited="True">	<span class="identifier">Logger.SILENT</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="23" valid="True" visited="True">	<span class="identifier">Logger.FATAL</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1</span></Line>  <Line no="24" valid="True" visited="True">	<span class="identifier">Logger.ERROR</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">2</span></Line>  <Line no="25" valid="True" visited="True">	<span class="identifier">Logger.WARN</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">3</span></Line>  <Line no="26" valid="True" visited="True">	<span class="identifier">Logger.INFO</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">4</span></Line>  <Line no="27" valid="True" visited="True">	<span class="identifier">Logger.DEBUG</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">5</span></Line>  <Line no="28" valid="True" visited="True">	<span class="identifier">Logger.TRACE</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">6</span></Line>  <Line no="29" valid="True" visited="True">	<span class="identifier">Logger.VERBOSE</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">7</span></Line>  <Line no="30" valid="True" visited="True">	<span class="identifier">Logger.PARANOID</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">8</span></Line>  <Line no="31" valid="False" visited="False"/>  <Line no="32" valid="False" visited="False">	<span class="comment">-- 文字列をログレベルに変換</span></Line>  <Line no="33" valid="False" visited="False">	<span class="comment">-- @oaram lv 文字列</span></Line>  <Line no="34" valid="False" visited="False">	<span class="comment">-- @return ログレベル</span></Line>  <Line no="35" valid="False" visited="False">	<span class="identifier">Logger.strToLogLevel</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">lv</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"SILENT"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="37" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.SILENT</span></Line>  <Line no="38" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"FATAL"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="39" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.FATAL</span></Line>  <Line no="40" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"ERROR"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="41" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.ERROR</span></Line>  <Line no="42" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"WARN"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="43" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.WARN</span></Line>  <Line no="44" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"INFO"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.INFO</span></Line>  <Line no="46" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"DEBUG"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="47" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.DEBUG</span></Line>  <Line no="48" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"TRACE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="49" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.TRACE</span></Line>  <Line no="50" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"VERBOSE"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.VERBOSE</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lv</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"PARANOID"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.PARANOID</span></Line>  <Line no="54" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="55" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">Logger.INFO</span></Line>  <Line no="56" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="57" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="58" valid="False" visited="False"/>  <Line no="59" valid="False" visited="False"/>  <Line no="60" valid="False" visited="False">	<span class="identifier">Logger.printf</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">fmt</span><span class="misc">)</span></Line>  <Line no="61" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">fmt</span></Line>  <Line no="62" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="63" valid="False" visited="False"/>  <Line no="64" valid="False" visited="False">	<span class="comment">-- ロガーストリーム初期化</span></Line>  <Line no="65" valid="False" visited="False">	<span class="comment">-- @return ロガーストリーム</span></Line>  <Line no="66" valid="True" visited="True">	<span class="identifier">Logger.LogStream.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="68" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._LogLock</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="69" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._logger_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span></Line>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._loggerObj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="71" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj._log_enable</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="73" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロガーストリーム終了処理</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="76" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">shutdown</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._loggerObj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="80" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ロガー追加</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param loggerObj ロガー</span></Line>  <Line no="83" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">addLogger</span><span class="misc">(</span><span class="identifier">loggerObj</span><span class="misc">)</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">table.insert</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">,</span>&nbsp;<span class="identifier">loggerObj</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="86" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="87" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="88" valid="False" visited="False"/>  <Line no="89" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログレベル設定</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param level ログレベル(文字列) </span></Line>  <Line no="91" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setLogLevel</span><span class="misc">(</span><span class="identifier">level</span><span class="misc">)</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">lvl</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">Logger.strToLogLevel</span><span class="misc">(</span><span class="identifier">level</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">setLogLevel</span><span class="misc">(</span><span class="identifier">lvl</span><span class="misc">)</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="96" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="97" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">setLogLock</span><span class="misc">(</span><span class="identifier">lock</span><span class="misc">)</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">lock</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="100" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._LogLock</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">lock</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="102" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._LogLock</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="105" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="106" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">enableLogLock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="107" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._LogLock</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">true</span></Line>  <Line no="108" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">disableLogLock</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="111" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self._LogLock</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">false</span></Line>  <Line no="112" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力</span></Line>  <Line no="115" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param LV ログレベル</span></Line>  <Line no="116" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="117" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="118" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_LOG</span><span class="misc">(</span><span class="identifier">LV</span><span class="misc">,</span>&nbsp;<span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="119" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="120" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="121" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="122" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="123" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">LV</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="124" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="125" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="126" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="127" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="128" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="129" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="130" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(FATAL)</span></Line>  <Line no="131" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="133" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_FATAL</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="134" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="135" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="137" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="138" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.FATAL</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="139" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="140" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="141" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="142" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="144" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(ERROR)</span></Line>  <Line no="145" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="146" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="147" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_ERROR</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="150" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="151" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.ERROR</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="153" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="154" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="155" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="156" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="157" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(WARN)</span></Line>  <Line no="159" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="160" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_WARN</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="162" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="165" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.WARN</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="169" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="170" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="171" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(INFO)</span></Line>  <Line no="173" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="174" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_INFO</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="178" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.INFO</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="181" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="182" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="184" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="185" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="186" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(DEBUG)</span></Line>  <Line no="187" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="188" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="189" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_DEBUG</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="190" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="191" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="192" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="193" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="194" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.DEBUG</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="195" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="196" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="197" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="198" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="199" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="200" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(TRACE)</span></Line>  <Line no="201" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="202" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="203" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_TRACE</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="204" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="205" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="206" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="207" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="208" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.TRACE</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="209" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="210" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="211" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="212" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="213" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="214" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(VERBOSE)</span></Line>  <Line no="215" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="216" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="217" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_VERBOSE</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="218" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="219" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="220" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="221" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="222" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.VERBOSE</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="223" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="224" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="225" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="226" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="227" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="228" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- ログ出力(PARANOID)</span></Line>  <Line no="229" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param msg 出力フォーマット</span></Line>  <Line no="230" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param ... 値</span></Line>  <Line no="231" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">RTC_PARANOID</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">,</span>&nbsp;<span class="misc">...</span><span class="misc">)</span></Line>  <Line no="232" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.acquire()</span></Line>  <Line no="233" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self._log_enable</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="234" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">msg</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tostring</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">)</span></Line>  <Line no="235" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self._loggerObj</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="236" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">v</span><span class="misc">:</span><span class="identifier">log</span><span class="misc">(</span><span class="identifier">msg</span><span class="misc">:</span><span class="identifier">format</span><span class="misc">(</span><span class="misc">...</span><span class="misc">)</span><span class="misc">,</span>&nbsp;<span class="identifier">Logger.PARANOID</span><span class="misc">,</span>&nbsp;<span class="identifier">self._logger_name</span><span class="misc">)</span></Line>  <Line no="237" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="238" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="239" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">--self.release()</span></Line>  <Line no="240" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="241" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;</Line>  <Line no="242" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 指定名のロガー取得</span></Line>  <Line no="243" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param name ロガー名</span></Line>  <Line no="244" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return ロガー</span></Line>  <Line no="245" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">getLogger</span><span class="misc">(</span><span class="identifier">name</span><span class="misc">)</span></Line>  <Line no="246" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">syslogger</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="247" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span>&nbsp;<span class="identifier">k</span><span class="misc">,</span><span class="identifier">v</span>&nbsp;<span class="keyword">in</span>&nbsp;<span class="library">pairs</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="248" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">syslogger</span><span class="misc">[</span><span class="identifier">k</span><span class="misc">]</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">v</span></Line>  <Line no="249" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="250" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">syslogger._logger_name</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">name</span></Line>  <Line no="251" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">syslogger</span></Line>  <Line no="252" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="253" valid="False" visited="False"/>  <Line no="254" valid="False" visited="False"/>  <Line no="255" valid="False" visited="False"/>  <Line no="256" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="257" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="258" valid="False" visited="False"/>  <Line no="259" valid="False" visited="False"/>  <Line no="260" valid="False" visited="False"/>  <Line no="261" valid="False" visited="False"/>  <Line no="262" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">Logger</span></Line>  <FileSummary valid="129" visited="123" totalLines="262" coverage="95"/> </File> <File name="lua\openrtm\Task.lua" anchor="lua_openrtm_Task_lua">  <PerfectCoverage/>   <FileSummary valid="7" visited="7" totalLines="40" coverage="100"/> </File> <File name="lua\openrtm\TimeValue.lua" anchor="lua_openrtm_TimeValue_lua">  <Line no="1" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="2" valid="False" visited="False">	<span class="comment">--! @file TimeValue.lua</span></Line>  <Line no="3" valid="False" visited="False">	<span class="comment">--! @brief 時間ヘルパ関数定義</span></Line>  <Line no="4" valid="False" visited="False">	<span class="comment">---------------------------------</span></Line>  <Line no="5" valid="False" visited="False"/>  <Line no="6" valid="False" visited="False">	<span class="blockcomment">--[[</span></Line>  <Line no="7" valid="False" visited="False">	<span class="blockcomment">Copyright&nbsp;(c)&nbsp;2017&nbsp;Nobuhiko&nbsp;Miyamoto</span></Line>  <Line no="8" valid="False" visited="False">	<span class="blockcomment">]]</span></Line>  <Line no="9" valid="False" visited="False"/>  <Line no="10" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">TimeValue</span><span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="11" valid="False" visited="False">	<span class="comment">--_G["openrtm.TimeValue"] = TimeValue</span></Line>  <Line no="12" valid="False" visited="False"/>  <Line no="13" valid="True" visited="True">	<span class="keyword">local</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">1000000</span></Line>  <Line no="14" valid="False" visited="False"/>  <Line no="15" valid="False" visited="False">	<span class="comment">-- 時間ヘルパ関数オブジェクト初期化</span></Line>  <Line no="16" valid="False" visited="False">	<span class="comment">-- @return 関数オブジェクト</span></Line>  <Line no="17" valid="False" visited="False">	<span class="identifier">TimeValue.new</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">sec</span><span class="misc">,</span>&nbsp;<span class="identifier">usec</span><span class="misc">)</span></Line>  <Line no="18" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">obj</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">{</span><span class="misc">}</span></Line>  <Line no="19" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間を引く際のオペレータ</span></Line>  <Line no="20" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="21" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param tm 引く時間関数オブジェクト</span></Line>  <Line no="22" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 引き算後の時間</span></Line>  <Line no="23" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">sub_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">tm</span><span class="misc">)</span></Line>  <Line no="24" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">res</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="25" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">tm.tv_sec</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="26" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">tm.tv_usec</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="27" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">tm.tv_sec</span></Line>  <Line no="28" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">tm.tv_usec</span></Line>  <Line no="29" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="30" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">tm.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="31" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span><span class="misc">)</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">tm.tv_usec</span></Line>  <Line no="32" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="33" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="34" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">tm.tv_usec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="35" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="misc">(</span><span class="identifier">tm.tv_sec</span>&nbsp;&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self.tv_sec</span><span class="misc">)</span></Line>  <Line no="36" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="misc">(</span><span class="identifier">tm.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self.tv_usec</span><span class="misc">)</span></Line>  <Line no="37" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="38" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="misc">(</span><span class="identifier">tm.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span><span class="misc">)</span></Line>  <Line no="39" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="misc">(</span><span class="identifier">tm.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span><span class="misc">)</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self.tv_usec</span></Line>  <Line no="40" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="41" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="42" valid="False" visited="False"/>  <Line no="43" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res</span><span class="misc">:</span><span class="identifier">normalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="44" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">res</span></Line>  <Line no="45" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="46" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間を足す際のオペレータ</span></Line>  <Line no="47" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="48" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param tm 足す時間関数オブジェクト</span></Line>  <Line no="49" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 足し算後の時間</span></Line>  <Line no="50" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">add_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">,</span>&nbsp;<span class="identifier">tm</span><span class="misc">)</span></Line>  <Line no="51" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">res</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">TimeValue.new</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="52" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">tm.tv_sec</span></Line>  <Line no="53" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">tm.tv_usec</span></Line>  <Line no="54" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="55" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">res.tv_sec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="56" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">res.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="57" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="58" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">res</span><span class="misc">:</span><span class="identifier">normalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="59" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">res</span></Line>  <Line no="60" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="61" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間を文字列に変換するオペレータ</span></Line>  <Line no="62" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param self 自身のオブジェクト</span></Line>  <Line no="63" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 文字列</span></Line>  <Line no="64" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">str_func</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="keyword">function</span><span class="misc">(</span><span class="identifier">self</span><span class="misc">)</span></Line>  <Line no="65" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">ret</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="string">""</span><span class="operator">..</span><span class="identifier">self.tv_sec..</span><span class="misc">(</span><span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">/</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span><span class="misc">)</span></Line>  <Line no="66" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">ret</span></Line>  <Line no="67" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="68" valid="False" visited="False"/>  <Line no="69" valid="False" visited="False"/>  <Line no="70" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="library">setmetatable</span><span class="misc">(</span><span class="identifier">obj</span><span class="misc">,</span>&nbsp;<span class="misc">{</span><span class="identifier">__add</span>&nbsp;<span class="operator">=</span><span class="identifier">add_func</span><span class="misc">,</span><span class="identifier">__sub</span><span class="operator">=</span><span class="identifier">sub_func</span><span class="misc">,</span><span class="identifier">__tostring</span><span class="operator">=</span><span class="identifier">str_func</span><span class="misc">}</span><span class="misc">)</span></Line>  <Line no="71" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 秒数取得</span></Line>  <Line no="72" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 秒数</span></Line>  <Line no="73" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">sec</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="74" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.tv_sec</span></Line>  <Line no="75" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="76" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マイクロ秒数取得</span></Line>  <Line no="77" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return マイクロ秒数</span></Line>  <Line no="78" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">usec</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="79" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.tv_usec</span></Line>  <Line no="80" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="81" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間設定</span></Line>  <Line no="82" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @param _time 時間</span></Line>  <Line no="83" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 自身のオブジェクト</span></Line>  <Line no="84" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">set_time</span><span class="misc">(</span><span class="identifier">_time</span><span class="misc">)</span></Line>  <Line no="85" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">_time</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">_time</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="86" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">_time</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self.tv_sec</span><span class="misc">)</span>&nbsp;<span class="operator">*</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="87" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">self.tv_usec</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="88" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self</span></Line>  <Line no="89" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="90" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間を数値に変換</span></Line>  <Line no="91" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 数値</span></Line>  <Line no="92" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">toDouble</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="93" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">/</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="94" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="95" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間の正負を判定</span></Line>  <Line no="96" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- @return 1：正、-1：負、0：0</span></Line>  <Line no="97" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">sign</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="98" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="99" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">1</span></Line>  <Line no="100" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="101" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="102" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="103" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="104" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="105" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">1</span></Line>  <Line no="106" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="107" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="108" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="operator">-</span><span class="number">1</span></Line>  <Line no="109" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="110" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="number">0</span></Line>  <Line no="111" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="112" valid="False" visited="False"/>  <Line no="113" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- 時間の正規化</span></Line>  <Line no="114" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">-- マイクロ秒数が1000000を超えていた場合に秒に変換</span></Line>  <Line no="115" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">function</span>&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">normalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="116" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="117" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="118" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="119" valid="False" visited="False"/>  <Line no="120" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="121" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="122" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="123" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="124" valid="False" visited="False"/>  <Line no="125" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="126" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="127" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="128" valid="False" visited="False"/>  <Line no="129" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&lt;</span><span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="keyword">do</span></Line>  <Line no="130" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="131" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="132" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="133" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="134" valid="False" visited="False"/>  <Line no="135" valid="False" visited="False"/>  <Line no="136" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">1</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="137" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="number">1</span></Line>  <Line no="138" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="139" valid="False" visited="False"/>  <Line no="140" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">elseif</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">&lt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">&gt;</span>&nbsp;<span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="141" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_sec</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="number">1</span></Line>  <Line no="142" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">self.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span></Line>  <Line no="143" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="144" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="145" valid="False" visited="False"/>  <Line no="146" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">sec</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="147" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">sec</span><span class="misc">)</span></Line>  <Line no="148" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="149" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="library">type</span><span class="misc">(</span><span class="identifier">usec</span><span class="misc">)</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="string">"string"</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="150" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="library">tonumber</span><span class="misc">(</span><span class="identifier">usec</span><span class="misc">)</span></Line>  <Line no="151" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="152" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">~=</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">and</span>&nbsp;<span class="identifier">usec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="153" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">local</span>&nbsp;<span class="identifier">dbHalfAdj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span><span class="operator">.</span><span class="number">0</span></Line>  <Line no="154" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">&gt;</span><span class="operator">=</span>&nbsp;<span class="number">0</span><span class="operator">.</span><span class="number">0</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="155" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">dbHalfAdj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span><span class="operator">.</span><span class="number">5</span></Line>  <Line no="156" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="157" valid="True" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">dbHalfAdj_</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="operator">-</span><span class="number">0</span><span class="operator">.</span><span class="number">5</span></Line>  <Line no="158" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="159" valid="False" visited="False"/>  <Line no="160" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">sec</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="161" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="misc">(</span><span class="identifier">sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">obj.tv_sec</span><span class="misc">)</span>&nbsp;<span class="operator">*</span></Line>  <Line no="162" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">TIMEVALUE_ONE_SECOND_IN_USECS</span>&nbsp;<span class="operator">+</span>&nbsp;<span class="identifier">dbHalfAdj_</span></Line>  <Line no="163" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">obj.tv_usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">obj.tv_usec</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="164" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">normalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="165" valid="False" visited="False"/>  <Line no="166" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="167" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="168" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="169" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="170" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="171" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_sec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">sec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">sec</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="172" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="173" valid="False" visited="False"/>  <Line no="174" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;<span class="identifier">usec</span>&nbsp;<span class="operator">==</span>&nbsp;<span class="keyword">nil</span>&nbsp;<span class="keyword">then</span></Line>  <Line no="175" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="number">0</span></Line>  <Line no="176" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span></Line>  <Line no="177" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj.tv_usec</span>&nbsp;<span class="operator">=</span>&nbsp;<span class="identifier">usec</span>&nbsp;<span class="operator">-</span>&nbsp;<span class="identifier">usec</span><span class="operator">%</span><span class="number">1</span></Line>  <Line no="178" valid="False" visited="False">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">end</span></Line>  <Line no="179" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="identifier">obj</span><span class="misc">:</span><span class="identifier">normalize</span><span class="misc">(</span><span class="misc">)</span></Line>  <Line no="180" valid="True" visited="True">	&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span>&nbsp;<span class="identifier">obj</span></Line>  <Line no="181" valid="False" visited="False"/>  <Line no="182" valid="True" visited="True">	<span class="keyword">end</span></Line>  <Line no="183" valid="False" visited="False"/>  <Line no="184" valid="False" visited="False"/>  <Line no="185" valid="True" visited="True">	<span class="keyword">return</span>&nbsp;<span class="identifier">TimeValue</span></Line>  <FileSummary valid="104" visited="67" totalLines="185" coverage="64"/> </File> <File name="lua\openrtm\version.lua" anchor="lua_openrtm_version_lua">  <PerfectCoverage/>   <FileSummary valid="5" visited="5" totalLines="19" coverage="100"/> </File><Summary totalLines="21710" totalVisited="9786" totalValid="11817" timeTaken="21.9"/></CoverageReport>